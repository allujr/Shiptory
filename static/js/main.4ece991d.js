/*! For license information please see main.4ece991d.js.LICENSE.txt */
!function(){var e={1360:function(e){"use strict";for(var g="qpzry9x8gf2tvdw0s3jn54khce6mua7l",t={},n=0;n<32;n++){var I=g.charAt(n);if(void 0!==t[I])throw new TypeError(I+" is ambiguous");t[I]=n}function r(e){var g=e>>25;return(33554431&e)<<5^996825010&-(g>>0&1)^642813549&-(g>>1&1)^513874426&-(g>>2&1)^1027748829&-(g>>3&1)^705979059&-(g>>4&1)}function C(e){for(var g=1,t=0;t<e.length;++t){var n=e.charCodeAt(t);if(n<33||n>126)return"Invalid prefix ("+e+")";g=r(g)^n>>5}for(g=r(g),t=0;t<e.length;++t){var I=e.charCodeAt(t);g=r(g)^31&I}return g}function l(e,g){if(g=g||90,e.length<8)return e+" too short";if(e.length>g)return"Exceeds length limit";var n=e.toLowerCase(),I=e.toUpperCase();if(e!==n&&e!==I)return"Mixed-case string "+e;var l=(e=n).lastIndexOf("1");if(-1===l)return"No separator character for "+e;if(0===l)return"Missing prefix for "+e;var a=e.slice(0,l),o=e.slice(l+1);if(o.length<6)return"Data too short";var i=C(a);if("string"===typeof i)return i;for(var c=[],u=0;u<o.length;++u){var s=o.charAt(u),A=t[s];if(void 0===A)return"Unknown character "+s;i=r(i)^A,u+6>=o.length||c.push(A)}return 1!==i?"Invalid checksum for "+e:{prefix:a,words:c}}function a(e,g,t,n){for(var I=0,r=0,C=(1<<t)-1,l=[],a=0;a<e.length;++a)for(I=I<<g|e[a],r+=g;r>=t;)r-=t,l.push(I>>r&C);if(n)r>0&&l.push(I<<t-r&C);else{if(r>=g)return"Excess padding";if(I<<t-r&C)return"Non-zero padding"}return l}e.exports={decodeUnsafe:function(){var e=l.apply(null,arguments);if("object"===typeof e)return e},decode:function(e){var g=l.apply(null,arguments);if("object"===typeof g)return g;throw new Error(g)},encode:function(e,t,n){if(n=n||90,e.length+7+t.length>n)throw new TypeError("Exceeds length limit");var I=C(e=e.toLowerCase());if("string"===typeof I)throw new Error(I);for(var l=e+"1",a=0;a<t.length;++a){var o=t[a];if(o>>5!==0)throw new Error("Non 5-bit word");I=r(I)^o,l+=g.charAt(o)}for(a=0;a<6;++a)I=r(I);for(I^=1,a=0;a<6;++a){l+=g.charAt(I>>5*(5-a)&31)}return l},toWordsUnsafe:function(e){var g=a(e,8,5,!0);if(Array.isArray(g))return g},toWords:function(e){var g=a(e,8,5,!0);if(Array.isArray(g))return g;throw new Error(g)},fromWordsUnsafe:function(e){var g=a(e,5,8,!1);if(Array.isArray(g))return g},fromWords:function(e){var g=a(e,5,8,!1);if(Array.isArray(g))return g;throw new Error(g)}}},518:function(e,g,t){!function(e,g){"use strict";function n(e,g){if(!e)throw new Error(g||"Assertion failed")}function I(e,g){e.super_=g;var t=function(){};t.prototype=g.prototype,e.prototype=new t,e.prototype.constructor=e}function r(e,g,t){if(r.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==g&&"be"!==g||(t=g,g=10),this._init(e||0,g||10,t||"be"))}var C;"object"===typeof e?e.exports=r:g.BN=r,r.BN=r,r.wordSize=26;try{C="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:t(6601).Buffer}catch(V){}function l(e,g){var t=e.charCodeAt(g);return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:void n(!1,"Invalid character in "+e)}function a(e,g,t){var n=l(e,t);return t-1>=g&&(n|=l(e,t-1)<<4),n}function o(e,g,t,I){for(var r=0,C=0,l=Math.min(e.length,t),a=g;a<l;a++){var o=e.charCodeAt(a)-48;r*=I,C=o>=49?o-49+10:o>=17?o-17+10:o,n(o>=0&&C<I,"Invalid character"),r+=C}return r}function i(e,g){e.words=g.words,e.length=g.length,e.negative=g.negative,e.red=g.red}if(r.isBN=function(e){return e instanceof r||null!==e&&"object"===typeof e&&e.constructor.wordSize===r.wordSize&&Array.isArray(e.words)},r.max=function(e,g){return e.cmp(g)>0?e:g},r.min=function(e,g){return e.cmp(g)<0?e:g},r.prototype._init=function(e,g,t){if("number"===typeof e)return this._initNumber(e,g,t);if("object"===typeof e)return this._initArray(e,g,t);"hex"===g&&(g=16),n(g===(0|g)&&g>=2&&g<=36);var I=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(I++,this.negative=1),I<e.length&&(16===g?this._parseHex(e,I,t):(this._parseBase(e,g,I),"le"===t&&this._initArray(this.toArray(),g,t)))},r.prototype._initNumber=function(e,g,t){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===t&&this._initArray(this.toArray(),g,t)},r.prototype._initArray=function(e,g,t){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var r,C,l=0;if("be"===t)for(I=e.length-1,r=0;I>=0;I-=3)C=e[I]|e[I-1]<<8|e[I-2]<<16,this.words[r]|=C<<l&67108863,this.words[r+1]=C>>>26-l&67108863,(l+=24)>=26&&(l-=26,r++);else if("le"===t)for(I=0,r=0;I<e.length;I+=3)C=e[I]|e[I+1]<<8|e[I+2]<<16,this.words[r]|=C<<l&67108863,this.words[r+1]=C>>>26-l&67108863,(l+=24)>=26&&(l-=26,r++);return this._strip()},r.prototype._parseHex=function(e,g,t){this.length=Math.ceil((e.length-g)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var I,r=0,C=0;if("be"===t)for(n=e.length-1;n>=g;n-=2)I=a(e,g,n)<<r,this.words[C]|=67108863&I,r>=18?(r-=18,C+=1,this.words[C]|=I>>>26):r+=8;else for(n=(e.length-g)%2===0?g+1:g;n<e.length;n+=2)I=a(e,g,n)<<r,this.words[C]|=67108863&I,r>=18?(r-=18,C+=1,this.words[C]|=I>>>26):r+=8;this._strip()},r.prototype._parseBase=function(e,g,t){this.words=[0],this.length=1;for(var n=0,I=1;I<=67108863;I*=g)n++;n--,I=I/g|0;for(var r=e.length-t,C=r%n,l=Math.min(r,r-C)+t,a=0,i=t;i<l;i+=n)a=o(e,i,i+n,g),this.imuln(I),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a);if(0!==C){var c=1;for(a=o(e,i,e.length,g),i=0;i<C;i++)c*=g;this.imuln(c),this.words[0]+a<67108864?this.words[0]+=a:this._iaddn(a)}this._strip()},r.prototype.copy=function(e){e.words=new Array(this.length);for(var g=0;g<this.length;g++)e.words[g]=this.words[g];e.length=this.length,e.negative=this.negative,e.red=this.red},r.prototype._move=function(e){i(e,this)},r.prototype.clone=function(){var e=new r(null);return this.copy(e),e},r.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},r.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},r.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!==typeof Symbol&&"function"===typeof Symbol.for)try{r.prototype[Symbol.for("nodejs.util.inspect.custom")]=c}catch(V){r.prototype.inspect=c}else r.prototype.inspect=c;function c(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],A=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];r.prototype.toString=function(e,g){var t;if(g=0|g||1,16===(e=e||10)||"hex"===e){t="";for(var I=0,r=0,C=0;C<this.length;C++){var l=this.words[C],a=(16777215&(l<<I|r)).toString(16);r=l>>>24-I&16777215,(I+=2)>=26&&(I-=26,C--),t=0!==r||C!==this.length-1?u[6-a.length]+a+t:a+t}for(0!==r&&(t=r.toString(16)+t);t.length%g!==0;)t="0"+t;return 0!==this.negative&&(t="-"+t),t}if(e===(0|e)&&e>=2&&e<=36){var o=s[e],i=A[e];t="";var c=this.clone();for(c.negative=0;!c.isZero();){var d=c.modrn(i).toString(e);t=(c=c.idivn(i)).isZero()?d+t:u[o-d.length]+d+t}for(this.isZero()&&(t="0"+t);t.length%g!==0;)t="0"+t;return 0!==this.negative&&(t="-"+t),t}n(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},r.prototype.toJSON=function(){return this.toString(16,2)},C&&(r.prototype.toBuffer=function(e,g){return this.toArrayLike(C,e,g)}),r.prototype.toArray=function(e,g){return this.toArrayLike(Array,e,g)};function d(e,g,t){t.negative=g.negative^e.negative;var n=e.length+g.length|0;t.length=n,n=n-1|0;var I=0|e.words[0],r=0|g.words[0],C=I*r,l=67108863&C,a=C/67108864|0;t.words[0]=l;for(var o=1;o<n;o++){for(var i=a>>>26,c=67108863&a,u=Math.min(o,g.length-1),s=Math.max(0,o-e.length+1);s<=u;s++){var A=o-s|0;i+=(C=(I=0|e.words[A])*(r=0|g.words[s])+c)/67108864|0,c=67108863&C}t.words[o]=0|c,a=0|i}return 0!==a?t.words[o]=0|a:t.length--,t._strip()}r.prototype.toArrayLike=function(e,g,t){this._strip();var I=this.byteLength(),r=t||Math.max(1,I);n(I<=r,"byte array longer than desired length"),n(r>0,"Requested array length <= 0");var C=function(e,g){return e.allocUnsafe?e.allocUnsafe(g):new e(g)}(e,r);return this["_toArrayLike"+("le"===g?"LE":"BE")](C,I),C},r.prototype._toArrayLikeLE=function(e,g){for(var t=0,n=0,I=0,r=0;I<this.length;I++){var C=this.words[I]<<r|n;e[t++]=255&C,t<e.length&&(e[t++]=C>>8&255),t<e.length&&(e[t++]=C>>16&255),6===r?(t<e.length&&(e[t++]=C>>24&255),n=0,r=0):(n=C>>>24,r+=2)}if(t<e.length)for(e[t++]=n;t<e.length;)e[t++]=0},r.prototype._toArrayLikeBE=function(e,g){for(var t=e.length-1,n=0,I=0,r=0;I<this.length;I++){var C=this.words[I]<<r|n;e[t--]=255&C,t>=0&&(e[t--]=C>>8&255),t>=0&&(e[t--]=C>>16&255),6===r?(t>=0&&(e[t--]=C>>24&255),n=0,r=0):(n=C>>>24,r+=2)}if(t>=0)for(e[t--]=n;t>=0;)e[t--]=0},Math.clz32?r.prototype._countBits=function(e){return 32-Math.clz32(e)}:r.prototype._countBits=function(e){var g=e,t=0;return g>=4096&&(t+=13,g>>>=13),g>=64&&(t+=7,g>>>=7),g>=8&&(t+=4,g>>>=4),g>=2&&(t+=2,g>>>=2),t+g},r.prototype._zeroBits=function(e){if(0===e)return 26;var g=e,t=0;return 0===(8191&g)&&(t+=13,g>>>=13),0===(127&g)&&(t+=7,g>>>=7),0===(15&g)&&(t+=4,g>>>=4),0===(3&g)&&(t+=2,g>>>=2),0===(1&g)&&t++,t},r.prototype.bitLength=function(){var e=this.words[this.length-1],g=this._countBits(e);return 26*(this.length-1)+g},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,g=0;g<this.length;g++){var t=this._zeroBits(this.words[g]);if(e+=t,26!==t)break}return e},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},r.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var g=0;g<e.length;g++)this.words[g]=this.words[g]|e.words[g];return this._strip()},r.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},r.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},r.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},r.prototype.iuand=function(e){var g;g=this.length>e.length?e:this;for(var t=0;t<g.length;t++)this.words[t]=this.words[t]&e.words[t];return this.length=g.length,this._strip()},r.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},r.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},r.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},r.prototype.iuxor=function(e){var g,t;this.length>e.length?(g=this,t=e):(g=e,t=this);for(var n=0;n<t.length;n++)this.words[n]=g.words[n]^t.words[n];if(this!==g)for(;n<g.length;n++)this.words[n]=g.words[n];return this.length=g.length,this._strip()},r.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},r.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},r.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},r.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var g=0|Math.ceil(e/26),t=e%26;this._expand(g),t>0&&g--;for(var I=0;I<g;I++)this.words[I]=67108863&~this.words[I];return t>0&&(this.words[I]=~this.words[I]&67108863>>26-t),this._strip()},r.prototype.notn=function(e){return this.clone().inotn(e)},r.prototype.setn=function(e,g){n("number"===typeof e&&e>=0);var t=e/26|0,I=e%26;return this._expand(t+1),this.words[t]=g?this.words[t]|1<<I:this.words[t]&~(1<<I),this._strip()},r.prototype.iadd=function(e){var g,t,n;if(0!==this.negative&&0===e.negative)return this.negative=0,g=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,g=this.isub(e),e.negative=1,g._normSign();this.length>e.length?(t=this,n=e):(t=e,n=this);for(var I=0,r=0;r<n.length;r++)g=(0|t.words[r])+(0|n.words[r])+I,this.words[r]=67108863&g,I=g>>>26;for(;0!==I&&r<t.length;r++)g=(0|t.words[r])+I,this.words[r]=67108863&g,I=g>>>26;if(this.length=t.length,0!==I)this.words[this.length]=I,this.length++;else if(t!==this)for(;r<t.length;r++)this.words[r]=t.words[r];return this},r.prototype.add=function(e){var g;return 0!==e.negative&&0===this.negative?(e.negative=0,g=this.sub(e),e.negative^=1,g):0===e.negative&&0!==this.negative?(this.negative=0,g=e.sub(this),this.negative=1,g):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},r.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var g=this.iadd(e);return e.negative=1,g._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var t,n,I=this.cmp(e);if(0===I)return this.negative=0,this.length=1,this.words[0]=0,this;I>0?(t=this,n=e):(t=e,n=this);for(var r=0,C=0;C<n.length;C++)r=(g=(0|t.words[C])-(0|n.words[C])+r)>>26,this.words[C]=67108863&g;for(;0!==r&&C<t.length;C++)r=(g=(0|t.words[C])+r)>>26,this.words[C]=67108863&g;if(0===r&&C<t.length&&t!==this)for(;C<t.length;C++)this.words[C]=t.words[C];return this.length=Math.max(this.length,C),t!==this&&(this.negative=1),this._strip()},r.prototype.sub=function(e){return this.clone().isub(e)};var m=function(e,g,t){var n,I,r,C=e.words,l=g.words,a=t.words,o=0,i=0|C[0],c=8191&i,u=i>>>13,s=0|C[1],A=8191&s,d=s>>>13,m=0|C[2],h=8191&m,b=m>>>13,Z=0|C[3],p=8191&Z,y=Z>>>13,G=0|C[4],f=8191&G,B=G>>>13,v=0|C[5],S=8191&v,W=v>>>13,V=0|C[6],k=8191&V,R=V>>>13,X=0|C[7],J=8191&X,Y=X>>>13,w=0|C[8],H=8191&w,N=w>>>13,F=0|C[9],K=8191&F,x=F>>>13,E=0|l[0],M=8191&E,z=E>>>13,U=0|l[1],Q=8191&U,L=U>>>13,T=0|l[2],D=8191&T,j=T>>>13,P=0|l[3],O=8191&P,_=P>>>13,q=0|l[4],$=8191&q,ee=q>>>13,ge=0|l[5],te=8191&ge,ne=ge>>>13,Ie=0|l[6],re=8191&Ie,Ce=Ie>>>13,le=0|l[7],ae=8191&le,oe=le>>>13,ie=0|l[8],ce=8191&ie,ue=ie>>>13,se=0|l[9],Ae=8191&se,de=se>>>13;t.negative=e.negative^g.negative,t.length=19;var me=(o+(n=Math.imul(c,M))|0)+((8191&(I=(I=Math.imul(c,z))+Math.imul(u,M)|0))<<13)|0;o=((r=Math.imul(u,z))+(I>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(A,M),I=(I=Math.imul(A,z))+Math.imul(d,M)|0,r=Math.imul(d,z);var he=(o+(n=n+Math.imul(c,Q)|0)|0)+((8191&(I=(I=I+Math.imul(c,L)|0)+Math.imul(u,Q)|0))<<13)|0;o=((r=r+Math.imul(u,L)|0)+(I>>>13)|0)+(he>>>26)|0,he&=67108863,n=Math.imul(h,M),I=(I=Math.imul(h,z))+Math.imul(b,M)|0,r=Math.imul(b,z),n=n+Math.imul(A,Q)|0,I=(I=I+Math.imul(A,L)|0)+Math.imul(d,Q)|0,r=r+Math.imul(d,L)|0;var be=(o+(n=n+Math.imul(c,D)|0)|0)+((8191&(I=(I=I+Math.imul(c,j)|0)+Math.imul(u,D)|0))<<13)|0;o=((r=r+Math.imul(u,j)|0)+(I>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(p,M),I=(I=Math.imul(p,z))+Math.imul(y,M)|0,r=Math.imul(y,z),n=n+Math.imul(h,Q)|0,I=(I=I+Math.imul(h,L)|0)+Math.imul(b,Q)|0,r=r+Math.imul(b,L)|0,n=n+Math.imul(A,D)|0,I=(I=I+Math.imul(A,j)|0)+Math.imul(d,D)|0,r=r+Math.imul(d,j)|0;var Ze=(o+(n=n+Math.imul(c,O)|0)|0)+((8191&(I=(I=I+Math.imul(c,_)|0)+Math.imul(u,O)|0))<<13)|0;o=((r=r+Math.imul(u,_)|0)+(I>>>13)|0)+(Ze>>>26)|0,Ze&=67108863,n=Math.imul(f,M),I=(I=Math.imul(f,z))+Math.imul(B,M)|0,r=Math.imul(B,z),n=n+Math.imul(p,Q)|0,I=(I=I+Math.imul(p,L)|0)+Math.imul(y,Q)|0,r=r+Math.imul(y,L)|0,n=n+Math.imul(h,D)|0,I=(I=I+Math.imul(h,j)|0)+Math.imul(b,D)|0,r=r+Math.imul(b,j)|0,n=n+Math.imul(A,O)|0,I=(I=I+Math.imul(A,_)|0)+Math.imul(d,O)|0,r=r+Math.imul(d,_)|0;var pe=(o+(n=n+Math.imul(c,$)|0)|0)+((8191&(I=(I=I+Math.imul(c,ee)|0)+Math.imul(u,$)|0))<<13)|0;o=((r=r+Math.imul(u,ee)|0)+(I>>>13)|0)+(pe>>>26)|0,pe&=67108863,n=Math.imul(S,M),I=(I=Math.imul(S,z))+Math.imul(W,M)|0,r=Math.imul(W,z),n=n+Math.imul(f,Q)|0,I=(I=I+Math.imul(f,L)|0)+Math.imul(B,Q)|0,r=r+Math.imul(B,L)|0,n=n+Math.imul(p,D)|0,I=(I=I+Math.imul(p,j)|0)+Math.imul(y,D)|0,r=r+Math.imul(y,j)|0,n=n+Math.imul(h,O)|0,I=(I=I+Math.imul(h,_)|0)+Math.imul(b,O)|0,r=r+Math.imul(b,_)|0,n=n+Math.imul(A,$)|0,I=(I=I+Math.imul(A,ee)|0)+Math.imul(d,$)|0,r=r+Math.imul(d,ee)|0;var ye=(o+(n=n+Math.imul(c,te)|0)|0)+((8191&(I=(I=I+Math.imul(c,ne)|0)+Math.imul(u,te)|0))<<13)|0;o=((r=r+Math.imul(u,ne)|0)+(I>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(k,M),I=(I=Math.imul(k,z))+Math.imul(R,M)|0,r=Math.imul(R,z),n=n+Math.imul(S,Q)|0,I=(I=I+Math.imul(S,L)|0)+Math.imul(W,Q)|0,r=r+Math.imul(W,L)|0,n=n+Math.imul(f,D)|0,I=(I=I+Math.imul(f,j)|0)+Math.imul(B,D)|0,r=r+Math.imul(B,j)|0,n=n+Math.imul(p,O)|0,I=(I=I+Math.imul(p,_)|0)+Math.imul(y,O)|0,r=r+Math.imul(y,_)|0,n=n+Math.imul(h,$)|0,I=(I=I+Math.imul(h,ee)|0)+Math.imul(b,$)|0,r=r+Math.imul(b,ee)|0,n=n+Math.imul(A,te)|0,I=(I=I+Math.imul(A,ne)|0)+Math.imul(d,te)|0,r=r+Math.imul(d,ne)|0;var Ge=(o+(n=n+Math.imul(c,re)|0)|0)+((8191&(I=(I=I+Math.imul(c,Ce)|0)+Math.imul(u,re)|0))<<13)|0;o=((r=r+Math.imul(u,Ce)|0)+(I>>>13)|0)+(Ge>>>26)|0,Ge&=67108863,n=Math.imul(J,M),I=(I=Math.imul(J,z))+Math.imul(Y,M)|0,r=Math.imul(Y,z),n=n+Math.imul(k,Q)|0,I=(I=I+Math.imul(k,L)|0)+Math.imul(R,Q)|0,r=r+Math.imul(R,L)|0,n=n+Math.imul(S,D)|0,I=(I=I+Math.imul(S,j)|0)+Math.imul(W,D)|0,r=r+Math.imul(W,j)|0,n=n+Math.imul(f,O)|0,I=(I=I+Math.imul(f,_)|0)+Math.imul(B,O)|0,r=r+Math.imul(B,_)|0,n=n+Math.imul(p,$)|0,I=(I=I+Math.imul(p,ee)|0)+Math.imul(y,$)|0,r=r+Math.imul(y,ee)|0,n=n+Math.imul(h,te)|0,I=(I=I+Math.imul(h,ne)|0)+Math.imul(b,te)|0,r=r+Math.imul(b,ne)|0,n=n+Math.imul(A,re)|0,I=(I=I+Math.imul(A,Ce)|0)+Math.imul(d,re)|0,r=r+Math.imul(d,Ce)|0;var fe=(o+(n=n+Math.imul(c,ae)|0)|0)+((8191&(I=(I=I+Math.imul(c,oe)|0)+Math.imul(u,ae)|0))<<13)|0;o=((r=r+Math.imul(u,oe)|0)+(I>>>13)|0)+(fe>>>26)|0,fe&=67108863,n=Math.imul(H,M),I=(I=Math.imul(H,z))+Math.imul(N,M)|0,r=Math.imul(N,z),n=n+Math.imul(J,Q)|0,I=(I=I+Math.imul(J,L)|0)+Math.imul(Y,Q)|0,r=r+Math.imul(Y,L)|0,n=n+Math.imul(k,D)|0,I=(I=I+Math.imul(k,j)|0)+Math.imul(R,D)|0,r=r+Math.imul(R,j)|0,n=n+Math.imul(S,O)|0,I=(I=I+Math.imul(S,_)|0)+Math.imul(W,O)|0,r=r+Math.imul(W,_)|0,n=n+Math.imul(f,$)|0,I=(I=I+Math.imul(f,ee)|0)+Math.imul(B,$)|0,r=r+Math.imul(B,ee)|0,n=n+Math.imul(p,te)|0,I=(I=I+Math.imul(p,ne)|0)+Math.imul(y,te)|0,r=r+Math.imul(y,ne)|0,n=n+Math.imul(h,re)|0,I=(I=I+Math.imul(h,Ce)|0)+Math.imul(b,re)|0,r=r+Math.imul(b,Ce)|0,n=n+Math.imul(A,ae)|0,I=(I=I+Math.imul(A,oe)|0)+Math.imul(d,ae)|0,r=r+Math.imul(d,oe)|0;var Be=(o+(n=n+Math.imul(c,ce)|0)|0)+((8191&(I=(I=I+Math.imul(c,ue)|0)+Math.imul(u,ce)|0))<<13)|0;o=((r=r+Math.imul(u,ue)|0)+(I>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(K,M),I=(I=Math.imul(K,z))+Math.imul(x,M)|0,r=Math.imul(x,z),n=n+Math.imul(H,Q)|0,I=(I=I+Math.imul(H,L)|0)+Math.imul(N,Q)|0,r=r+Math.imul(N,L)|0,n=n+Math.imul(J,D)|0,I=(I=I+Math.imul(J,j)|0)+Math.imul(Y,D)|0,r=r+Math.imul(Y,j)|0,n=n+Math.imul(k,O)|0,I=(I=I+Math.imul(k,_)|0)+Math.imul(R,O)|0,r=r+Math.imul(R,_)|0,n=n+Math.imul(S,$)|0,I=(I=I+Math.imul(S,ee)|0)+Math.imul(W,$)|0,r=r+Math.imul(W,ee)|0,n=n+Math.imul(f,te)|0,I=(I=I+Math.imul(f,ne)|0)+Math.imul(B,te)|0,r=r+Math.imul(B,ne)|0,n=n+Math.imul(p,re)|0,I=(I=I+Math.imul(p,Ce)|0)+Math.imul(y,re)|0,r=r+Math.imul(y,Ce)|0,n=n+Math.imul(h,ae)|0,I=(I=I+Math.imul(h,oe)|0)+Math.imul(b,ae)|0,r=r+Math.imul(b,oe)|0,n=n+Math.imul(A,ce)|0,I=(I=I+Math.imul(A,ue)|0)+Math.imul(d,ce)|0,r=r+Math.imul(d,ue)|0;var ve=(o+(n=n+Math.imul(c,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(c,de)|0)+Math.imul(u,Ae)|0))<<13)|0;o=((r=r+Math.imul(u,de)|0)+(I>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(K,Q),I=(I=Math.imul(K,L))+Math.imul(x,Q)|0,r=Math.imul(x,L),n=n+Math.imul(H,D)|0,I=(I=I+Math.imul(H,j)|0)+Math.imul(N,D)|0,r=r+Math.imul(N,j)|0,n=n+Math.imul(J,O)|0,I=(I=I+Math.imul(J,_)|0)+Math.imul(Y,O)|0,r=r+Math.imul(Y,_)|0,n=n+Math.imul(k,$)|0,I=(I=I+Math.imul(k,ee)|0)+Math.imul(R,$)|0,r=r+Math.imul(R,ee)|0,n=n+Math.imul(S,te)|0,I=(I=I+Math.imul(S,ne)|0)+Math.imul(W,te)|0,r=r+Math.imul(W,ne)|0,n=n+Math.imul(f,re)|0,I=(I=I+Math.imul(f,Ce)|0)+Math.imul(B,re)|0,r=r+Math.imul(B,Ce)|0,n=n+Math.imul(p,ae)|0,I=(I=I+Math.imul(p,oe)|0)+Math.imul(y,ae)|0,r=r+Math.imul(y,oe)|0,n=n+Math.imul(h,ce)|0,I=(I=I+Math.imul(h,ue)|0)+Math.imul(b,ce)|0,r=r+Math.imul(b,ue)|0;var Se=(o+(n=n+Math.imul(A,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(A,de)|0)+Math.imul(d,Ae)|0))<<13)|0;o=((r=r+Math.imul(d,de)|0)+(I>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(K,D),I=(I=Math.imul(K,j))+Math.imul(x,D)|0,r=Math.imul(x,j),n=n+Math.imul(H,O)|0,I=(I=I+Math.imul(H,_)|0)+Math.imul(N,O)|0,r=r+Math.imul(N,_)|0,n=n+Math.imul(J,$)|0,I=(I=I+Math.imul(J,ee)|0)+Math.imul(Y,$)|0,r=r+Math.imul(Y,ee)|0,n=n+Math.imul(k,te)|0,I=(I=I+Math.imul(k,ne)|0)+Math.imul(R,te)|0,r=r+Math.imul(R,ne)|0,n=n+Math.imul(S,re)|0,I=(I=I+Math.imul(S,Ce)|0)+Math.imul(W,re)|0,r=r+Math.imul(W,Ce)|0,n=n+Math.imul(f,ae)|0,I=(I=I+Math.imul(f,oe)|0)+Math.imul(B,ae)|0,r=r+Math.imul(B,oe)|0,n=n+Math.imul(p,ce)|0,I=(I=I+Math.imul(p,ue)|0)+Math.imul(y,ce)|0,r=r+Math.imul(y,ue)|0;var We=(o+(n=n+Math.imul(h,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(h,de)|0)+Math.imul(b,Ae)|0))<<13)|0;o=((r=r+Math.imul(b,de)|0)+(I>>>13)|0)+(We>>>26)|0,We&=67108863,n=Math.imul(K,O),I=(I=Math.imul(K,_))+Math.imul(x,O)|0,r=Math.imul(x,_),n=n+Math.imul(H,$)|0,I=(I=I+Math.imul(H,ee)|0)+Math.imul(N,$)|0,r=r+Math.imul(N,ee)|0,n=n+Math.imul(J,te)|0,I=(I=I+Math.imul(J,ne)|0)+Math.imul(Y,te)|0,r=r+Math.imul(Y,ne)|0,n=n+Math.imul(k,re)|0,I=(I=I+Math.imul(k,Ce)|0)+Math.imul(R,re)|0,r=r+Math.imul(R,Ce)|0,n=n+Math.imul(S,ae)|0,I=(I=I+Math.imul(S,oe)|0)+Math.imul(W,ae)|0,r=r+Math.imul(W,oe)|0,n=n+Math.imul(f,ce)|0,I=(I=I+Math.imul(f,ue)|0)+Math.imul(B,ce)|0,r=r+Math.imul(B,ue)|0;var Ve=(o+(n=n+Math.imul(p,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(p,de)|0)+Math.imul(y,Ae)|0))<<13)|0;o=((r=r+Math.imul(y,de)|0)+(I>>>13)|0)+(Ve>>>26)|0,Ve&=67108863,n=Math.imul(K,$),I=(I=Math.imul(K,ee))+Math.imul(x,$)|0,r=Math.imul(x,ee),n=n+Math.imul(H,te)|0,I=(I=I+Math.imul(H,ne)|0)+Math.imul(N,te)|0,r=r+Math.imul(N,ne)|0,n=n+Math.imul(J,re)|0,I=(I=I+Math.imul(J,Ce)|0)+Math.imul(Y,re)|0,r=r+Math.imul(Y,Ce)|0,n=n+Math.imul(k,ae)|0,I=(I=I+Math.imul(k,oe)|0)+Math.imul(R,ae)|0,r=r+Math.imul(R,oe)|0,n=n+Math.imul(S,ce)|0,I=(I=I+Math.imul(S,ue)|0)+Math.imul(W,ce)|0,r=r+Math.imul(W,ue)|0;var ke=(o+(n=n+Math.imul(f,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(f,de)|0)+Math.imul(B,Ae)|0))<<13)|0;o=((r=r+Math.imul(B,de)|0)+(I>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(K,te),I=(I=Math.imul(K,ne))+Math.imul(x,te)|0,r=Math.imul(x,ne),n=n+Math.imul(H,re)|0,I=(I=I+Math.imul(H,Ce)|0)+Math.imul(N,re)|0,r=r+Math.imul(N,Ce)|0,n=n+Math.imul(J,ae)|0,I=(I=I+Math.imul(J,oe)|0)+Math.imul(Y,ae)|0,r=r+Math.imul(Y,oe)|0,n=n+Math.imul(k,ce)|0,I=(I=I+Math.imul(k,ue)|0)+Math.imul(R,ce)|0,r=r+Math.imul(R,ue)|0;var Re=(o+(n=n+Math.imul(S,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(S,de)|0)+Math.imul(W,Ae)|0))<<13)|0;o=((r=r+Math.imul(W,de)|0)+(I>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(K,re),I=(I=Math.imul(K,Ce))+Math.imul(x,re)|0,r=Math.imul(x,Ce),n=n+Math.imul(H,ae)|0,I=(I=I+Math.imul(H,oe)|0)+Math.imul(N,ae)|0,r=r+Math.imul(N,oe)|0,n=n+Math.imul(J,ce)|0,I=(I=I+Math.imul(J,ue)|0)+Math.imul(Y,ce)|0,r=r+Math.imul(Y,ue)|0;var Xe=(o+(n=n+Math.imul(k,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(k,de)|0)+Math.imul(R,Ae)|0))<<13)|0;o=((r=r+Math.imul(R,de)|0)+(I>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,n=Math.imul(K,ae),I=(I=Math.imul(K,oe))+Math.imul(x,ae)|0,r=Math.imul(x,oe),n=n+Math.imul(H,ce)|0,I=(I=I+Math.imul(H,ue)|0)+Math.imul(N,ce)|0,r=r+Math.imul(N,ue)|0;var Je=(o+(n=n+Math.imul(J,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(J,de)|0)+Math.imul(Y,Ae)|0))<<13)|0;o=((r=r+Math.imul(Y,de)|0)+(I>>>13)|0)+(Je>>>26)|0,Je&=67108863,n=Math.imul(K,ce),I=(I=Math.imul(K,ue))+Math.imul(x,ce)|0,r=Math.imul(x,ue);var Ye=(o+(n=n+Math.imul(H,Ae)|0)|0)+((8191&(I=(I=I+Math.imul(H,de)|0)+Math.imul(N,Ae)|0))<<13)|0;o=((r=r+Math.imul(N,de)|0)+(I>>>13)|0)+(Ye>>>26)|0,Ye&=67108863;var we=(o+(n=Math.imul(K,Ae))|0)+((8191&(I=(I=Math.imul(K,de))+Math.imul(x,Ae)|0))<<13)|0;return o=((r=Math.imul(x,de))+(I>>>13)|0)+(we>>>26)|0,we&=67108863,a[0]=me,a[1]=he,a[2]=be,a[3]=Ze,a[4]=pe,a[5]=ye,a[6]=Ge,a[7]=fe,a[8]=Be,a[9]=ve,a[10]=Se,a[11]=We,a[12]=Ve,a[13]=ke,a[14]=Re,a[15]=Xe,a[16]=Je,a[17]=Ye,a[18]=we,0!==o&&(a[19]=o,t.length++),t};function h(e,g,t){t.negative=g.negative^e.negative,t.length=e.length+g.length;for(var n=0,I=0,r=0;r<t.length-1;r++){var C=I;I=0;for(var l=67108863&n,a=Math.min(r,g.length-1),o=Math.max(0,r-e.length+1);o<=a;o++){var i=r-o,c=(0|e.words[i])*(0|g.words[o]),u=67108863&c;l=67108863&(u=u+l|0),I+=(C=(C=C+(c/67108864|0)|0)+(u>>>26)|0)>>>26,C&=67108863}t.words[r]=l,n=C,C=I}return 0!==n?t.words[r]=n:t.length--,t._strip()}function b(e,g,t){return h(e,g,t)}function Z(e,g){this.x=e,this.y=g}Math.imul||(m=d),r.prototype.mulTo=function(e,g){var t=this.length+e.length;return 10===this.length&&10===e.length?m(this,e,g):t<63?d(this,e,g):t<1024?h(this,e,g):b(this,e,g)},Z.prototype.makeRBT=function(e){for(var g=new Array(e),t=r.prototype._countBits(e)-1,n=0;n<e;n++)g[n]=this.revBin(n,t,e);return g},Z.prototype.revBin=function(e,g,t){if(0===e||e===t-1)return e;for(var n=0,I=0;I<g;I++)n|=(1&e)<<g-I-1,e>>=1;return n},Z.prototype.permute=function(e,g,t,n,I,r){for(var C=0;C<r;C++)n[C]=g[e[C]],I[C]=t[e[C]]},Z.prototype.transform=function(e,g,t,n,I,r){this.permute(r,e,g,t,n,I);for(var C=1;C<I;C<<=1)for(var l=C<<1,a=Math.cos(2*Math.PI/l),o=Math.sin(2*Math.PI/l),i=0;i<I;i+=l)for(var c=a,u=o,s=0;s<C;s++){var A=t[i+s],d=n[i+s],m=t[i+s+C],h=n[i+s+C],b=c*m-u*h;h=c*h+u*m,m=b,t[i+s]=A+m,n[i+s]=d+h,t[i+s+C]=A-m,n[i+s+C]=d-h,s!==l&&(b=a*c-o*u,u=a*u+o*c,c=b)}},Z.prototype.guessLen13b=function(e,g){var t=1|Math.max(g,e),n=1&t,I=0;for(t=t/2|0;t;t>>>=1)I++;return 1<<I+1+n},Z.prototype.conjugate=function(e,g,t){if(!(t<=1))for(var n=0;n<t/2;n++){var I=e[n];e[n]=e[t-n-1],e[t-n-1]=I,I=g[n],g[n]=-g[t-n-1],g[t-n-1]=-I}},Z.prototype.normalize13b=function(e,g){for(var t=0,n=0;n<g/2;n++){var I=8192*Math.round(e[2*n+1]/g)+Math.round(e[2*n]/g)+t;e[n]=67108863&I,t=I<67108864?0:I/67108864|0}return e},Z.prototype.convert13b=function(e,g,t,I){for(var r=0,C=0;C<g;C++)r+=0|e[C],t[2*C]=8191&r,r>>>=13,t[2*C+1]=8191&r,r>>>=13;for(C=2*g;C<I;++C)t[C]=0;n(0===r),n(0===(-8192&r))},Z.prototype.stub=function(e){for(var g=new Array(e),t=0;t<e;t++)g[t]=0;return g},Z.prototype.mulp=function(e,g,t){var n=2*this.guessLen13b(e.length,g.length),I=this.makeRBT(n),r=this.stub(n),C=new Array(n),l=new Array(n),a=new Array(n),o=new Array(n),i=new Array(n),c=new Array(n),u=t.words;u.length=n,this.convert13b(e.words,e.length,C,n),this.convert13b(g.words,g.length,o,n),this.transform(C,r,l,a,n,I),this.transform(o,r,i,c,n,I);for(var s=0;s<n;s++){var A=l[s]*i[s]-a[s]*c[s];a[s]=l[s]*c[s]+a[s]*i[s],l[s]=A}return this.conjugate(l,a,n),this.transform(l,a,u,r,n,I),this.conjugate(u,r,n),this.normalize13b(u,n),t.negative=e.negative^g.negative,t.length=e.length+g.length,t._strip()},r.prototype.mul=function(e){var g=new r(null);return g.words=new Array(this.length+e.length),this.mulTo(e,g)},r.prototype.mulf=function(e){var g=new r(null);return g.words=new Array(this.length+e.length),b(this,e,g)},r.prototype.imul=function(e){return this.clone().mulTo(e,this)},r.prototype.imuln=function(e){var g=e<0;g&&(e=-e),n("number"===typeof e),n(e<67108864);for(var t=0,I=0;I<this.length;I++){var r=(0|this.words[I])*e,C=(67108863&r)+(67108863&t);t>>=26,t+=r/67108864|0,t+=C>>>26,this.words[I]=67108863&C}return 0!==t&&(this.words[I]=t,this.length++),g?this.ineg():this},r.prototype.muln=function(e){return this.clone().imuln(e)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(e){var g=function(e){for(var g=new Array(e.bitLength()),t=0;t<g.length;t++){var n=t/26|0,I=t%26;g[t]=e.words[n]>>>I&1}return g}(e);if(0===g.length)return new r(1);for(var t=this,n=0;n<g.length&&0===g[n];n++,t=t.sqr());if(++n<g.length)for(var I=t.sqr();n<g.length;n++,I=I.sqr())0!==g[n]&&(t=t.mul(I));return t},r.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var g,t=e%26,I=(e-t)/26,r=67108863>>>26-t<<26-t;if(0!==t){var C=0;for(g=0;g<this.length;g++){var l=this.words[g]&r,a=(0|this.words[g])-l<<t;this.words[g]=a|C,C=l>>>26-t}C&&(this.words[g]=C,this.length++)}if(0!==I){for(g=this.length-1;g>=0;g--)this.words[g+I]=this.words[g];for(g=0;g<I;g++)this.words[g]=0;this.length+=I}return this._strip()},r.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},r.prototype.iushrn=function(e,g,t){var I;n("number"===typeof e&&e>=0),I=g?(g-g%26)/26:0;var r=e%26,C=Math.min((e-r)/26,this.length),l=67108863^67108863>>>r<<r,a=t;if(I-=C,I=Math.max(0,I),a){for(var o=0;o<C;o++)a.words[o]=this.words[o];a.length=C}if(0===C);else if(this.length>C)for(this.length-=C,o=0;o<this.length;o++)this.words[o]=this.words[o+C];else this.words[0]=0,this.length=1;var i=0;for(o=this.length-1;o>=0&&(0!==i||o>=I);o--){var c=0|this.words[o];this.words[o]=i<<26-r|c>>>r,i=c&l}return a&&0!==i&&(a.words[a.length++]=i),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},r.prototype.ishrn=function(e,g,t){return n(0===this.negative),this.iushrn(e,g,t)},r.prototype.shln=function(e){return this.clone().ishln(e)},r.prototype.ushln=function(e){return this.clone().iushln(e)},r.prototype.shrn=function(e){return this.clone().ishrn(e)},r.prototype.ushrn=function(e){return this.clone().iushrn(e)},r.prototype.testn=function(e){n("number"===typeof e&&e>=0);var g=e%26,t=(e-g)/26,I=1<<g;return!(this.length<=t)&&!!(this.words[t]&I)},r.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var g=e%26,t=(e-g)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=t)return this;if(0!==g&&t++,this.length=Math.min(t,this.length),0!==g){var I=67108863^67108863>>>g<<g;this.words[this.length-1]&=I}return this._strip()},r.prototype.maskn=function(e){return this.clone().imaskn(e)},r.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},r.prototype._iaddn=function(e){this.words[0]+=e;for(var g=0;g<this.length&&this.words[g]>=67108864;g++)this.words[g]-=67108864,g===this.length-1?this.words[g+1]=1:this.words[g+1]++;return this.length=Math.max(this.length,g+1),this},r.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var g=0;g<this.length&&this.words[g]<0;g++)this.words[g]+=67108864,this.words[g+1]-=1;return this._strip()},r.prototype.addn=function(e){return this.clone().iaddn(e)},r.prototype.subn=function(e){return this.clone().isubn(e)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(e,g,t){var I,r,C=e.length+t;this._expand(C);var l=0;for(I=0;I<e.length;I++){r=(0|this.words[I+t])+l;var a=(0|e.words[I])*g;l=((r-=67108863&a)>>26)-(a/67108864|0),this.words[I+t]=67108863&r}for(;I<this.length-t;I++)l=(r=(0|this.words[I+t])+l)>>26,this.words[I+t]=67108863&r;if(0===l)return this._strip();for(n(-1===l),l=0,I=0;I<this.length;I++)l=(r=-(0|this.words[I])+l)>>26,this.words[I]=67108863&r;return this.negative=1,this._strip()},r.prototype._wordDiv=function(e,g){var t=(this.length,e.length),n=this.clone(),I=e,C=0|I.words[I.length-1];0!==(t=26-this._countBits(C))&&(I=I.ushln(t),n.iushln(t),C=0|I.words[I.length-1]);var l,a=n.length-I.length;if("mod"!==g){(l=new r(null)).length=a+1,l.words=new Array(l.length);for(var o=0;o<l.length;o++)l.words[o]=0}var i=n.clone()._ishlnsubmul(I,1,a);0===i.negative&&(n=i,l&&(l.words[a]=1));for(var c=a-1;c>=0;c--){var u=67108864*(0|n.words[I.length+c])+(0|n.words[I.length+c-1]);for(u=Math.min(u/C|0,67108863),n._ishlnsubmul(I,u,c);0!==n.negative;)u--,n.negative=0,n._ishlnsubmul(I,1,c),n.isZero()||(n.negative^=1);l&&(l.words[c]=u)}return l&&l._strip(),n._strip(),"div"!==g&&0!==t&&n.iushrn(t),{div:l||null,mod:n}},r.prototype.divmod=function(e,g,t){return n(!e.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===e.negative?(l=this.neg().divmod(e,g),"mod"!==g&&(I=l.div.neg()),"div"!==g&&(C=l.mod.neg(),t&&0!==C.negative&&C.iadd(e)),{div:I,mod:C}):0===this.negative&&0!==e.negative?(l=this.divmod(e.neg(),g),"mod"!==g&&(I=l.div.neg()),{div:I,mod:l.mod}):0!==(this.negative&e.negative)?(l=this.neg().divmod(e.neg(),g),"div"!==g&&(C=l.mod.neg(),t&&0!==C.negative&&C.isub(e)),{div:l.div,mod:C}):e.length>this.length||this.cmp(e)<0?{div:new r(0),mod:this}:1===e.length?"div"===g?{div:this.divn(e.words[0]),mod:null}:"mod"===g?{div:null,mod:new r(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new r(this.modrn(e.words[0]))}:this._wordDiv(e,g);var I,C,l},r.prototype.div=function(e){return this.divmod(e,"div",!1).div},r.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},r.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},r.prototype.divRound=function(e){var g=this.divmod(e);if(g.mod.isZero())return g.div;var t=0!==g.div.negative?g.mod.isub(e):g.mod,n=e.ushrn(1),I=e.andln(1),r=t.cmp(n);return r<0||1===I&&0===r?g.div:0!==g.div.negative?g.div.isubn(1):g.div.iaddn(1)},r.prototype.modrn=function(e){var g=e<0;g&&(e=-e),n(e<=67108863);for(var t=(1<<26)%e,I=0,r=this.length-1;r>=0;r--)I=(t*I+(0|this.words[r]))%e;return g?-I:I},r.prototype.modn=function(e){return this.modrn(e)},r.prototype.idivn=function(e){var g=e<0;g&&(e=-e),n(e<=67108863);for(var t=0,I=this.length-1;I>=0;I--){var r=(0|this.words[I])+67108864*t;this.words[I]=r/e|0,t=r%e}return this._strip(),g?this.ineg():this},r.prototype.divn=function(e){return this.clone().idivn(e)},r.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var g=this,t=e.clone();g=0!==g.negative?g.umod(e):g.clone();for(var I=new r(1),C=new r(0),l=new r(0),a=new r(1),o=0;g.isEven()&&t.isEven();)g.iushrn(1),t.iushrn(1),++o;for(var i=t.clone(),c=g.clone();!g.isZero();){for(var u=0,s=1;0===(g.words[0]&s)&&u<26;++u,s<<=1);if(u>0)for(g.iushrn(u);u-- >0;)(I.isOdd()||C.isOdd())&&(I.iadd(i),C.isub(c)),I.iushrn(1),C.iushrn(1);for(var A=0,d=1;0===(t.words[0]&d)&&A<26;++A,d<<=1);if(A>0)for(t.iushrn(A);A-- >0;)(l.isOdd()||a.isOdd())&&(l.iadd(i),a.isub(c)),l.iushrn(1),a.iushrn(1);g.cmp(t)>=0?(g.isub(t),I.isub(l),C.isub(a)):(t.isub(g),l.isub(I),a.isub(C))}return{a:l,b:a,gcd:t.iushln(o)}},r.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var g=this,t=e.clone();g=0!==g.negative?g.umod(e):g.clone();for(var I,C=new r(1),l=new r(0),a=t.clone();g.cmpn(1)>0&&t.cmpn(1)>0;){for(var o=0,i=1;0===(g.words[0]&i)&&o<26;++o,i<<=1);if(o>0)for(g.iushrn(o);o-- >0;)C.isOdd()&&C.iadd(a),C.iushrn(1);for(var c=0,u=1;0===(t.words[0]&u)&&c<26;++c,u<<=1);if(c>0)for(t.iushrn(c);c-- >0;)l.isOdd()&&l.iadd(a),l.iushrn(1);g.cmp(t)>=0?(g.isub(t),C.isub(l)):(t.isub(g),l.isub(C))}return(I=0===g.cmpn(1)?C:l).cmpn(0)<0&&I.iadd(e),I},r.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var g=this.clone(),t=e.clone();g.negative=0,t.negative=0;for(var n=0;g.isEven()&&t.isEven();n++)g.iushrn(1),t.iushrn(1);for(;;){for(;g.isEven();)g.iushrn(1);for(;t.isEven();)t.iushrn(1);var I=g.cmp(t);if(I<0){var r=g;g=t,t=r}else if(0===I||0===t.cmpn(1))break;g.isub(t)}return t.iushln(n)},r.prototype.invm=function(e){return this.egcd(e).a.umod(e)},r.prototype.isEven=function(){return 0===(1&this.words[0])},r.prototype.isOdd=function(){return 1===(1&this.words[0])},r.prototype.andln=function(e){return this.words[0]&e},r.prototype.bincn=function(e){n("number"===typeof e);var g=e%26,t=(e-g)/26,I=1<<g;if(this.length<=t)return this._expand(t+1),this.words[t]|=I,this;for(var r=I,C=t;0!==r&&C<this.length;C++){var l=0|this.words[C];r=(l+=r)>>>26,l&=67108863,this.words[C]=l}return 0!==r&&(this.words[C]=r,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(e){var g,t=e<0;if(0!==this.negative&&!t)return-1;if(0===this.negative&&t)return 1;if(this._strip(),this.length>1)g=1;else{t&&(e=-e),n(e<=67108863,"Number is too big");var I=0|this.words[0];g=I===e?0:I<e?-1:1}return 0!==this.negative?0|-g:g},r.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var g=this.ucmp(e);return 0!==this.negative?0|-g:g},r.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var g=0,t=this.length-1;t>=0;t--){var n=0|this.words[t],I=0|e.words[t];if(n!==I){n<I?g=-1:n>I&&(g=1);break}}return g},r.prototype.gtn=function(e){return 1===this.cmpn(e)},r.prototype.gt=function(e){return 1===this.cmp(e)},r.prototype.gten=function(e){return this.cmpn(e)>=0},r.prototype.gte=function(e){return this.cmp(e)>=0},r.prototype.ltn=function(e){return-1===this.cmpn(e)},r.prototype.lt=function(e){return-1===this.cmp(e)},r.prototype.lten=function(e){return this.cmpn(e)<=0},r.prototype.lte=function(e){return this.cmp(e)<=0},r.prototype.eqn=function(e){return 0===this.cmpn(e)},r.prototype.eq=function(e){return 0===this.cmp(e)},r.red=function(e){return new S(e)},r.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},r.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(e){return this.red=e,this},r.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},r.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},r.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},r.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},r.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},r.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},r.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},r.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},r.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var p={k256:null,p224:null,p192:null,p25519:null};function y(e,g){this.name=e,this.p=new r(g,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function G(){y.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function f(){y.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function B(){y.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function v(){y.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var g=r._prime(e);this.m=g.p,this.prime=g}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function W(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}y.prototype._tmp=function(){var e=new r(null);return e.words=new Array(Math.ceil(this.n/13)),e},y.prototype.ireduce=function(e){var g,t=e;do{this.split(t,this.tmp),g=(t=(t=this.imulK(t)).iadd(this.tmp)).bitLength()}while(g>this.n);var n=g<this.n?-1:t.ucmp(this.p);return 0===n?(t.words[0]=0,t.length=1):n>0?t.isub(this.p):void 0!==t.strip?t.strip():t._strip(),t},y.prototype.split=function(e,g){e.iushrn(this.n,0,g)},y.prototype.imulK=function(e){return e.imul(this.k)},I(G,y),G.prototype.split=function(e,g){for(var t=4194303,n=Math.min(e.length,9),I=0;I<n;I++)g.words[I]=e.words[I];if(g.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var r=e.words[9];for(g.words[g.length++]=r&t,I=10;I<e.length;I++){var C=0|e.words[I];e.words[I-10]=(C&t)<<4|r>>>22,r=C}r>>>=22,e.words[I-10]=r,0===r&&e.length>10?e.length-=10:e.length-=9},G.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var g=0,t=0;t<e.length;t++){var n=0|e.words[t];g+=977*n,e.words[t]=67108863&g,g=64*n+(g/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},I(f,y),I(B,y),I(v,y),v.prototype.imulK=function(e){for(var g=0,t=0;t<e.length;t++){var n=19*(0|e.words[t])+g,I=67108863&n;n>>>=26,e.words[t]=I,g=n}return 0!==g&&(e.words[e.length++]=g),e},r._prime=function(e){if(p[e])return p[e];var g;if("k256"===e)g=new G;else if("p224"===e)g=new f;else if("p192"===e)g=new B;else{if("p25519"!==e)throw new Error("Unknown prime "+e);g=new v}return p[e]=g,g},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,g){n(0===(e.negative|g.negative),"red works only with positives"),n(e.red&&e.red===g.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(i(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,g){this._verify2(e,g);var t=e.add(g);return t.cmp(this.m)>=0&&t.isub(this.m),t._forceRed(this)},S.prototype.iadd=function(e,g){this._verify2(e,g);var t=e.iadd(g);return t.cmp(this.m)>=0&&t.isub(this.m),t},S.prototype.sub=function(e,g){this._verify2(e,g);var t=e.sub(g);return t.cmpn(0)<0&&t.iadd(this.m),t._forceRed(this)},S.prototype.isub=function(e,g){this._verify2(e,g);var t=e.isub(g);return t.cmpn(0)<0&&t.iadd(this.m),t},S.prototype.shl=function(e,g){return this._verify1(e),this.imod(e.ushln(g))},S.prototype.imul=function(e,g){return this._verify2(e,g),this.imod(e.imul(g))},S.prototype.mul=function(e,g){return this._verify2(e,g),this.imod(e.mul(g))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var g=this.m.andln(3);if(n(g%2===1),3===g){var t=this.m.add(new r(1)).iushrn(2);return this.pow(e,t)}for(var I=this.m.subn(1),C=0;!I.isZero()&&0===I.andln(1);)C++,I.iushrn(1);n(!I.isZero());var l=new r(1).toRed(this),a=l.redNeg(),o=this.m.subn(1).iushrn(1),i=this.m.bitLength();for(i=new r(2*i*i).toRed(this);0!==this.pow(i,o).cmp(a);)i.redIAdd(a);for(var c=this.pow(i,I),u=this.pow(e,I.addn(1).iushrn(1)),s=this.pow(e,I),A=C;0!==s.cmp(l);){for(var d=s,m=0;0!==d.cmp(l);m++)d=d.redSqr();n(m<A);var h=this.pow(c,new r(1).iushln(A-m-1));u=u.redMul(h),c=h.redSqr(),s=s.redMul(c),A=m}return u},S.prototype.invm=function(e){var g=e._invmp(this.m);return 0!==g.negative?(g.negative=0,this.imod(g).redNeg()):this.imod(g)},S.prototype.pow=function(e,g){if(g.isZero())return new r(1).toRed(this);if(0===g.cmpn(1))return e.clone();var t=new Array(16);t[0]=new r(1).toRed(this),t[1]=e;for(var n=2;n<t.length;n++)t[n]=this.mul(t[n-1],e);var I=t[0],C=0,l=0,a=g.bitLength()%26;for(0===a&&(a=26),n=g.length-1;n>=0;n--){for(var o=g.words[n],i=a-1;i>=0;i--){var c=o>>i&1;I!==t[0]&&(I=this.sqr(I)),0!==c||0!==C?(C<<=1,C|=c,(4===++l||0===n&&0===i)&&(I=this.mul(I,t[C]),l=0,C=0)):l=0}a=26}return I},S.prototype.convertTo=function(e){var g=e.umod(this.m);return g===e?g.clone():g},S.prototype.convertFrom=function(e){var g=e.clone();return g.red=null,g},r.mont=function(e){return new W(e)},I(W,S),W.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},W.prototype.convertFrom=function(e){var g=this.imod(e.mul(this.rinv));return g.red=null,g},W.prototype.imul=function(e,g){if(e.isZero()||g.isZero())return e.words[0]=0,e.length=1,e;var t=e.imul(g),n=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=t.isub(n).iushrn(this.shift),r=I;return I.cmp(this.m)>=0?r=I.isub(this.m):I.cmpn(0)<0&&(r=I.iadd(this.m)),r._forceRed(this)},W.prototype.mul=function(e,g){if(e.isZero()||g.isZero())return new r(0)._forceRed(this);var t=e.mul(g),n=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),I=t.isub(n).iushrn(this.shift),C=I;return I.cmp(this.m)>=0?C=I.isub(this.m):I.cmpn(0)<0&&(C=I.iadd(this.m)),C._forceRed(this)},W.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=t.nmd(e),this)},1694:function(e,g){var t;!function(){"use strict";var n={}.hasOwnProperty;function I(){for(var e=[],g=0;g<arguments.length;g++){var t=arguments[g];if(t){var r=typeof t;if("string"===r||"number"===r)e.push(t);else if(Array.isArray(t)){if(t.length){var C=I.apply(null,t);C&&e.push(C)}}else if("object"===r){if(t.toString!==Object.prototype.toString&&!t.toString.toString().includes("[native code]")){e.push(t.toString());continue}for(var l in t)n.call(t,l)&&t[l]&&e.push(l)}}}return e.join(" ")}e.exports?(I.default=I,e.exports=I):void 0===(t=function(){return I}.apply(g,[]))||(e.exports=t)}()},951:function(e){"use strict";var g={single_source_shortest_paths:function(e,t,n){var I={},r={};r[t]=0;var C,l,a,o,i,c,u,s=g.PriorityQueue.make();for(s.push(t,0);!s.empty();)for(a in l=(C=s.pop()).value,o=C.cost,i=e[l]||{})i.hasOwnProperty(a)&&(c=o+i[a],u=r[a],("undefined"===typeof r[a]||u>c)&&(r[a]=c,s.push(a,c),I[a]=l));if("undefined"!==typeof n&&"undefined"===typeof r[n]){var A=["Could not find a path from ",t," to ",n,"."].join("");throw new Error(A)}return I},extract_shortest_path_from_predecessor_list:function(e,g){for(var t=[],n=g;n;)t.push(n),e[n],n=e[n];return t.reverse(),t},find_path:function(e,t,n){var I=g.single_source_shortest_paths(e,t,n);return g.extract_shortest_path_from_predecessor_list(I,n)},PriorityQueue:{make:function(e){var t,n=g.PriorityQueue,I={};for(t in e=e||{},n)n.hasOwnProperty(t)&&(I[t]=n[t]);return I.queue=[],I.sorter=e.sorter||n.default_sorter,I},default_sorter:function(e,g){return e.cost-g.cost},push:function(e,g){var t={value:e,cost:g};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=g},153:function(e){"use strict";e.exports=function(e){for(var g=[],t=e.length,n=0;n<t;n++){var I=e.charCodeAt(n);if(I>=55296&&I<=56319&&t>n+1){var r=e.charCodeAt(n+1);r>=56320&&r<=57343&&(I=1024*(I-55296)+r-56320+65536,n+=1)}I<128?g.push(I):I<2048?(g.push(I>>6|192),g.push(63&I|128)):I<55296||I>=57344&&I<65536?(g.push(I>>12|224),g.push(I>>6&63|128),g.push(63&I|128)):I>=65536&&I<=1114111?(g.push(I>>18|240),g.push(I>>12&63|128),g.push(I>>6&63|128),g.push(63&I|128)):g.push(239,191,189)}return new Uint8Array(g).buffer}},3125:function(e,g,t){var n=g;n.utils=t(9046),n.common=t(9684),n.sha=t(9194),n.ripemd=t(6645),n.hmac=t(3609),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},9684:function(e,g,t){"use strict";var n=t(9046),I=t(2325);function r(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}g.BlockHash=r,r.prototype.update=function(e,g){if(e=n.toArray(e,g),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var t=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-t,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-t,this.endian);for(var I=0;I<e.length;I+=this._delta32)this._update(e,I,I+this._delta32)}return this},r.prototype.digest=function(e){return this.update(this._pad()),I(null===this.pending),this._digest(e)},r.prototype._pad=function(){var e=this.pendingTotal,g=this._delta8,t=g-(e+this.padLength)%g,n=new Array(t+this.padLength);n[0]=128;for(var I=1;I<t;I++)n[I]=0;if(e<<=3,"big"===this.endian){for(var r=8;r<this.padLength;r++)n[I++]=0;n[I++]=0,n[I++]=0,n[I++]=0,n[I++]=0,n[I++]=e>>>24&255,n[I++]=e>>>16&255,n[I++]=e>>>8&255,n[I++]=255&e}else for(n[I++]=255&e,n[I++]=e>>>8&255,n[I++]=e>>>16&255,n[I++]=e>>>24&255,n[I++]=0,n[I++]=0,n[I++]=0,n[I++]=0,r=8;r<this.padLength;r++)n[I++]=0;return n}},3609:function(e,g,t){"use strict";var n=t(9046),I=t(2325);function r(e,g,t){if(!(this instanceof r))return new r(e,g,t);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(g,t))}e.exports=r,r.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),I(e.length<=this.blockSize);for(var g=e.length;g<this.blockSize;g++)e.push(0);for(g=0;g<e.length;g++)e[g]^=54;for(this.inner=(new this.Hash).update(e),g=0;g<e.length;g++)e[g]^=106;this.outer=(new this.Hash).update(e)},r.prototype.update=function(e,g){return this.inner.update(e,g),this},r.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},6645:function(e,g,t){"use strict";var n=t(9046),I=t(9684),r=n.rotl32,C=n.sum32,l=n.sum32_3,a=n.sum32_4,o=I.BlockHash;function i(){if(!(this instanceof i))return new i;o.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function c(e,g,t,n){return e<=15?g^t^n:e<=31?g&t|~g&n:e<=47?(g|~t)^n:e<=63?g&n|t&~n:g^(t|~n)}function u(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function s(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(i,o),g.ripemd160=i,i.blockSize=512,i.outSize=160,i.hmacStrength=192,i.padLength=64,i.prototype._update=function(e,g){for(var t=this.h[0],n=this.h[1],I=this.h[2],o=this.h[3],i=this.h[4],b=t,Z=n,p=I,y=o,G=i,f=0;f<80;f++){var B=C(r(a(t,c(f,n,I,o),e[A[f]+g],u(f)),m[f]),i);t=i,i=o,o=r(I,10),I=n,n=B,B=C(r(a(b,c(79-f,Z,p,y),e[d[f]+g],s(f)),h[f]),G),b=G,G=y,y=r(p,10),p=Z,Z=B}B=l(this.h[1],I,y),this.h[1]=l(this.h[2],o,G),this.h[2]=l(this.h[3],i,b),this.h[3]=l(this.h[4],t,Z),this.h[4]=l(this.h[0],n,p),this.h[0]=B},i.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var A=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],d=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],h=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},9194:function(e,g,t){"use strict";g.sha1=t(7361),g.sha224=t(7753),g.sha256=t(6966),g.sha384=t(1233),g.sha512=t(9063)},7361:function(e,g,t){"use strict";var n=t(9046),I=t(9684),r=t(4343),C=n.rotl32,l=n.sum32,a=n.sum32_5,o=r.ft_1,i=I.BlockHash,c=[1518500249,1859775393,2400959708,3395469782];function u(){if(!(this instanceof u))return new u;i.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(u,i),e.exports=u,u.blockSize=512,u.outSize=160,u.hmacStrength=80,u.padLength=64,u.prototype._update=function(e,g){for(var t=this.W,n=0;n<16;n++)t[n]=e[g+n];for(;n<t.length;n++)t[n]=C(t[n-3]^t[n-8]^t[n-14]^t[n-16],1);var I=this.h[0],r=this.h[1],i=this.h[2],u=this.h[3],s=this.h[4];for(n=0;n<t.length;n++){var A=~~(n/20),d=a(C(I,5),o(A,r,i,u),s,t[n],c[A]);s=u,u=i,i=C(r,30),r=I,I=d}this.h[0]=l(this.h[0],I),this.h[1]=l(this.h[1],r),this.h[2]=l(this.h[2],i),this.h[3]=l(this.h[3],u),this.h[4]=l(this.h[4],s)},u.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},7753:function(e,g,t){"use strict";var n=t(9046),I=t(6966);function r(){if(!(this instanceof r))return new r;I.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(r,I),e.exports=r,r.blockSize=512,r.outSize=224,r.hmacStrength=192,r.padLength=64,r.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},6966:function(e,g,t){"use strict";var n=t(9046),I=t(9684),r=t(4343),C=t(2325),l=n.sum32,a=n.sum32_4,o=n.sum32_5,i=r.ch32,c=r.maj32,u=r.s0_256,s=r.s1_256,A=r.g0_256,d=r.g1_256,m=I.BlockHash,h=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=h,this.W=new Array(64)}n.inherits(b,m),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,g){for(var t=this.W,n=0;n<16;n++)t[n]=e[g+n];for(;n<t.length;n++)t[n]=a(d(t[n-2]),t[n-7],A(t[n-15]),t[n-16]);var I=this.h[0],r=this.h[1],m=this.h[2],h=this.h[3],b=this.h[4],Z=this.h[5],p=this.h[6],y=this.h[7];for(C(this.k.length===t.length),n=0;n<t.length;n++){var G=o(y,s(b),i(b,Z,p),this.k[n],t[n]),f=l(u(I),c(I,r,m));y=p,p=Z,Z=b,b=l(h,G),h=m,m=r,r=I,I=l(G,f)}this.h[0]=l(this.h[0],I),this.h[1]=l(this.h[1],r),this.h[2]=l(this.h[2],m),this.h[3]=l(this.h[3],h),this.h[4]=l(this.h[4],b),this.h[5]=l(this.h[5],Z),this.h[6]=l(this.h[6],p),this.h[7]=l(this.h[7],y)},b.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},1233:function(e,g,t){"use strict";var n=t(9046),I=t(9063);function r(){if(!(this instanceof r))return new r;I.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(r,I),e.exports=r,r.blockSize=1024,r.outSize=384,r.hmacStrength=192,r.padLength=128,r.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},9063:function(e,g,t){"use strict";var n=t(9046),I=t(9684),r=t(2325),C=n.rotr64_hi,l=n.rotr64_lo,a=n.shr64_hi,o=n.shr64_lo,i=n.sum64,c=n.sum64_hi,u=n.sum64_lo,s=n.sum64_4_hi,A=n.sum64_4_lo,d=n.sum64_5_hi,m=n.sum64_5_lo,h=I.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Z(){if(!(this instanceof Z))return new Z;h.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}function p(e,g,t,n,I){var r=e&t^~e&I;return r<0&&(r+=4294967296),r}function y(e,g,t,n,I,r){var C=g&n^~g&r;return C<0&&(C+=4294967296),C}function G(e,g,t,n,I){var r=e&t^e&I^t&I;return r<0&&(r+=4294967296),r}function f(e,g,t,n,I,r){var C=g&n^g&r^n&r;return C<0&&(C+=4294967296),C}function B(e,g){var t=C(e,g,28)^C(g,e,2)^C(g,e,7);return t<0&&(t+=4294967296),t}function v(e,g){var t=l(e,g,28)^l(g,e,2)^l(g,e,7);return t<0&&(t+=4294967296),t}function S(e,g){var t=C(e,g,14)^C(e,g,18)^C(g,e,9);return t<0&&(t+=4294967296),t}function W(e,g){var t=l(e,g,14)^l(e,g,18)^l(g,e,9);return t<0&&(t+=4294967296),t}function V(e,g){var t=C(e,g,1)^C(e,g,8)^a(e,g,7);return t<0&&(t+=4294967296),t}function k(e,g){var t=l(e,g,1)^l(e,g,8)^o(e,g,7);return t<0&&(t+=4294967296),t}function R(e,g){var t=C(e,g,19)^C(g,e,29)^a(e,g,6);return t<0&&(t+=4294967296),t}function X(e,g){var t=l(e,g,19)^l(g,e,29)^o(e,g,6);return t<0&&(t+=4294967296),t}n.inherits(Z,h),e.exports=Z,Z.blockSize=1024,Z.outSize=512,Z.hmacStrength=192,Z.padLength=128,Z.prototype._prepareBlock=function(e,g){for(var t=this.W,n=0;n<32;n++)t[n]=e[g+n];for(;n<t.length;n+=2){var I=R(t[n-4],t[n-3]),r=X(t[n-4],t[n-3]),C=t[n-14],l=t[n-13],a=V(t[n-30],t[n-29]),o=k(t[n-30],t[n-29]),i=t[n-32],c=t[n-31];t[n]=s(I,r,C,l,a,o,i,c),t[n+1]=A(I,r,C,l,a,o,i,c)}},Z.prototype._update=function(e,g){this._prepareBlock(e,g);var t=this.W,n=this.h[0],I=this.h[1],C=this.h[2],l=this.h[3],a=this.h[4],o=this.h[5],s=this.h[6],A=this.h[7],h=this.h[8],b=this.h[9],Z=this.h[10],V=this.h[11],k=this.h[12],R=this.h[13],X=this.h[14],J=this.h[15];r(this.k.length===t.length);for(var Y=0;Y<t.length;Y+=2){var w=X,H=J,N=S(h,b),F=W(h,b),K=p(h,b,Z,V,k),x=y(h,b,Z,V,k,R),E=this.k[Y],M=this.k[Y+1],z=t[Y],U=t[Y+1],Q=d(w,H,N,F,K,x,E,M,z,U),L=m(w,H,N,F,K,x,E,M,z,U);w=B(n,I),H=v(n,I),N=G(n,I,C,l,a),F=f(n,I,C,l,a,o);var T=c(w,H,N,F),D=u(w,H,N,F);X=k,J=R,k=Z,R=V,Z=h,V=b,h=c(s,A,Q,L),b=u(A,A,Q,L),s=a,A=o,a=C,o=l,C=n,l=I,n=c(Q,L,T,D),I=u(Q,L,T,D)}i(this.h,0,n,I),i(this.h,2,C,l),i(this.h,4,a,o),i(this.h,6,s,A),i(this.h,8,h,b),i(this.h,10,Z,V),i(this.h,12,k,R),i(this.h,14,X,J)},Z.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},4343:function(e,g,t){"use strict";var n=t(9046).rotr32;function I(e,g,t){return e&g^~e&t}function r(e,g,t){return e&g^e&t^g&t}function C(e,g,t){return e^g^t}g.ft_1=function(e,g,t,n){return 0===e?I(g,t,n):1===e||3===e?C(g,t,n):2===e?r(g,t,n):void 0},g.ch32=I,g.maj32=r,g.p32=C,g.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},g.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},g.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},g.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},9046:function(e,g,t){"use strict";var n=t(2325),I=t(2534);function r(e,g){return 55296===(64512&e.charCodeAt(g))&&(!(g<0||g+1>=e.length)&&56320===(64512&e.charCodeAt(g+1)))}function C(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function l(e){return 1===e.length?"0"+e:e}function a(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}g.inherits=I,g.toArray=function(e,g){if(Array.isArray(e))return e.slice();if(!e)return[];var t=[];if("string"===typeof e)if(g){if("hex"===g)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!==0&&(e="0"+e),I=0;I<e.length;I+=2)t.push(parseInt(e[I]+e[I+1],16))}else for(var n=0,I=0;I<e.length;I++){var C=e.charCodeAt(I);C<128?t[n++]=C:C<2048?(t[n++]=C>>6|192,t[n++]=63&C|128):r(e,I)?(C=65536+((1023&C)<<10)+(1023&e.charCodeAt(++I)),t[n++]=C>>18|240,t[n++]=C>>12&63|128,t[n++]=C>>6&63|128,t[n++]=63&C|128):(t[n++]=C>>12|224,t[n++]=C>>6&63|128,t[n++]=63&C|128)}else for(I=0;I<e.length;I++)t[I]=0|e[I];return t},g.toHex=function(e){for(var g="",t=0;t<e.length;t++)g+=l(e[t].toString(16));return g},g.htonl=C,g.toHex32=function(e,g){for(var t="",n=0;n<e.length;n++){var I=e[n];"little"===g&&(I=C(I)),t+=a(I.toString(16))}return t},g.zero2=l,g.zero8=a,g.join32=function(e,g,t,I){var r=t-g;n(r%4===0);for(var C=new Array(r/4),l=0,a=g;l<C.length;l++,a+=4){var o;o="big"===I?e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3]:e[a+3]<<24|e[a+2]<<16|e[a+1]<<8|e[a],C[l]=o>>>0}return C},g.split32=function(e,g){for(var t=new Array(4*e.length),n=0,I=0;n<e.length;n++,I+=4){var r=e[n];"big"===g?(t[I]=r>>>24,t[I+1]=r>>>16&255,t[I+2]=r>>>8&255,t[I+3]=255&r):(t[I+3]=r>>>24,t[I+2]=r>>>16&255,t[I+1]=r>>>8&255,t[I]=255&r)}return t},g.rotr32=function(e,g){return e>>>g|e<<32-g},g.rotl32=function(e,g){return e<<g|e>>>32-g},g.sum32=function(e,g){return e+g>>>0},g.sum32_3=function(e,g,t){return e+g+t>>>0},g.sum32_4=function(e,g,t,n){return e+g+t+n>>>0},g.sum32_5=function(e,g,t,n,I){return e+g+t+n+I>>>0},g.sum64=function(e,g,t,n){var I=e[g],r=n+e[g+1]>>>0,C=(r<n?1:0)+t+I;e[g]=C>>>0,e[g+1]=r},g.sum64_hi=function(e,g,t,n){return(g+n>>>0<g?1:0)+e+t>>>0},g.sum64_lo=function(e,g,t,n){return g+n>>>0},g.sum64_4_hi=function(e,g,t,n,I,r,C,l){var a=0,o=g;return a+=(o=o+n>>>0)<g?1:0,a+=(o=o+r>>>0)<r?1:0,e+t+I+C+(a+=(o=o+l>>>0)<l?1:0)>>>0},g.sum64_4_lo=function(e,g,t,n,I,r,C,l){return g+n+r+l>>>0},g.sum64_5_hi=function(e,g,t,n,I,r,C,l,a,o){var i=0,c=g;return i+=(c=c+n>>>0)<g?1:0,i+=(c=c+r>>>0)<r?1:0,i+=(c=c+l>>>0)<l?1:0,e+t+I+C+a+(i+=(c=c+o>>>0)<o?1:0)>>>0},g.sum64_5_lo=function(e,g,t,n,I,r,C,l,a,o){return g+n+r+l+o>>>0},g.rotr64_hi=function(e,g,t){return(g<<32-t|e>>>t)>>>0},g.rotr64_lo=function(e,g,t){return(e<<32-t|g>>>t)>>>0},g.shr64_hi=function(e,g,t){return e>>>t},g.shr64_lo=function(e,g,t){return(e<<32-t|g>>>t)>>>0}},2110:function(e,g,t){"use strict";var n=t(7441),I={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},C={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function a(e){return n.isMemo(e)?C:l[e.$$typeof]||I}l[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},l[n.Memo]=C;var o=Object.defineProperty,i=Object.getOwnPropertyNames,c=Object.getOwnPropertySymbols,u=Object.getOwnPropertyDescriptor,s=Object.getPrototypeOf,A=Object.prototype;e.exports=function e(g,t,n){if("string"!==typeof t){if(A){var I=s(t);I&&I!==A&&e(g,I,n)}var C=i(t);c&&(C=C.concat(c(t)));for(var l=a(g),d=a(t),m=0;m<C.length;++m){var h=C[m];if(!r[h]&&(!n||!n[h])&&(!d||!d[h])&&(!l||!l[h])){var b=u(t,h);try{o(g,h,b)}catch(Z){}}}}return g}},2534:function(e){"function"===typeof Object.create?e.exports=function(e,g){g&&(e.super_=g,e.prototype=Object.create(g.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,g){if(g){e.super_=g;var t=function(){};t.prototype=g.prototype,e.prototype=new t,e.prototype.constructor=e}}},2176:function(e){"use strict";e.exports=function(e,g,t,n,I,r,C,l){if(!e){var a;if(void 0===g)a=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var o=[t,n,I,r,C,l],i=0;(a=new Error(g.replace(/%s/g,(function(){return o[i++]})))).name="Invariant Violation"}throw a.framesToPop=1,a}}},7898:function(e,g,t){var n;!function(){"use strict";var I="input is invalid type",r="object"===typeof window,C=r?window:{};C.JS_SHA3_NO_WINDOW&&(r=!1);var l=!r&&"object"===typeof self;!C.JS_SHA3_NO_NODE_JS&&"object"===typeof process&&process.versions&&process.versions.node?C=t.g:l&&(C=self);var a=!C.JS_SHA3_NO_COMMON_JS&&e.exports,o=t.amdO,i=!C.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!==typeof ArrayBuffer,c="0123456789abcdef".split(""),u=[4,1024,262144,67108864],s=[0,8,16,24],A=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],d=[224,256,384,512],m=[128,256],h=["hex","buffer","arrayBuffer","array","digest"],b={128:168,256:136};!C.JS_SHA3_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!i||!C.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"===typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});for(var Z=function(e,g,t){return function(n){return new w(e,g,e).update(n)[t]()}},p=function(e,g,t){return function(n,I){return new w(e,g,I).update(n)[t]()}},y=function(e,g,t){return function(g,n,I,r){return S["cshake"+e].update(g,n,I,r)[t]()}},G=function(e,g,t){return function(g,n,I,r){return S["kmac"+e].update(g,n,I,r)[t]()}},f=function(e,g,t,n){for(var I=0;I<h.length;++I){var r=h[I];e[r]=g(t,n,r)}return e},B=function(e,g){var t=Z(e,g,"hex");return t.create=function(){return new w(e,g,e)},t.update=function(e){return t.create().update(e)},f(t,Z,e,g)},v=[{name:"keccak",padding:[1,256,65536,16777216],bits:d,createMethod:B},{name:"sha3",padding:[6,1536,393216,100663296],bits:d,createMethod:B},{name:"shake",padding:[31,7936,2031616,520093696],bits:m,createMethod:function(e,g){var t=p(e,g,"hex");return t.create=function(t){return new w(e,g,t)},t.update=function(e,g){return t.create(g).update(e)},f(t,p,e,g)}},{name:"cshake",padding:u,bits:m,createMethod:function(e,g){var t=b[e],n=y(e,0,"hex");return n.create=function(n,I,r){return I||r?new w(e,g,n).bytepad([I,r],t):S["shake"+e].create(n)},n.update=function(e,g,t,I){return n.create(g,t,I).update(e)},f(n,y,e,g)}},{name:"kmac",padding:u,bits:m,createMethod:function(e,g){var t=b[e],n=G(e,0,"hex");return n.create=function(n,I,r){return new H(e,g,I).bytepad(["KMAC",r],t).bytepad([n],t)},n.update=function(e,g,t,I){return n.create(e,t,I).update(g)},f(n,G,e,g)}}],S={},W=[],V=0;V<v.length;++V)for(var k=v[V],R=k.bits,X=0;X<R.length;++X){var J=k.name+"_"+R[X];if(W.push(J),S[J]=k.createMethod(R[X],k.padding),"sha3"!==k.name){var Y=k.name+R[X];W.push(Y),S[Y]=S[J]}}function w(e,g,t){this.blocks=[],this.s=[],this.padding=g,this.outputBits=t,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=t>>5,this.extraBytes=(31&t)>>3;for(var n=0;n<50;++n)this.s[n]=0}function H(e,g,t){w.call(this,e,g,t)}w.prototype.update=function(e){if(this.finalized)throw new Error("finalize already called");var g,t=typeof e;if("string"!==t){if("object"!==t)throw new Error(I);if(null===e)throw new Error(I);if(i&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!i||!ArrayBuffer.isView(e)))throw new Error(I);g=!0}for(var n,r,C=this.blocks,l=this.byteCount,a=e.length,o=this.blockCount,c=0,u=this.s;c<a;){if(this.reset)for(this.reset=!1,C[0]=this.block,n=1;n<o+1;++n)C[n]=0;if(g)for(n=this.start;c<a&&n<l;++c)C[n>>2]|=e[c]<<s[3&n++];else for(n=this.start;c<a&&n<l;++c)(r=e.charCodeAt(c))<128?C[n>>2]|=r<<s[3&n++]:r<2048?(C[n>>2]|=(192|r>>6)<<s[3&n++],C[n>>2]|=(128|63&r)<<s[3&n++]):r<55296||r>=57344?(C[n>>2]|=(224|r>>12)<<s[3&n++],C[n>>2]|=(128|r>>6&63)<<s[3&n++],C[n>>2]|=(128|63&r)<<s[3&n++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++c)),C[n>>2]|=(240|r>>18)<<s[3&n++],C[n>>2]|=(128|r>>12&63)<<s[3&n++],C[n>>2]|=(128|r>>6&63)<<s[3&n++],C[n>>2]|=(128|63&r)<<s[3&n++]);if(this.lastByteIndex=n,n>=l){for(this.start=n-l,this.block=C[o],n=0;n<o;++n)u[n]^=C[n];N(u),this.reset=!0}else this.start=n}return this},w.prototype.encode=function(e,g){var t=255&e,n=1,I=[t];for(t=255&(e>>=8);t>0;)I.unshift(t),t=255&(e>>=8),++n;return g?I.push(n):I.unshift(n),this.update(I),I.length},w.prototype.encodeString=function(e){var g,t=typeof e;if("string"!==t){if("object"!==t)throw new Error(I);if(null===e)throw new Error(I);if(i&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!Array.isArray(e)&&(!i||!ArrayBuffer.isView(e)))throw new Error(I);g=!0}var n=0,r=e.length;if(g)n=r;else for(var C=0;C<e.length;++C){var l=e.charCodeAt(C);l<128?n+=1:l<2048?n+=2:l<55296||l>=57344?n+=3:(l=65536+((1023&l)<<10|1023&e.charCodeAt(++C)),n+=4)}return n+=this.encode(8*n),this.update(e),n},w.prototype.bytepad=function(e,g){for(var t=this.encode(g),n=0;n<e.length;++n)t+=this.encodeString(e[n]);var I=g-t%g,r=[];return r.length=I,this.update(r),this},w.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,g=this.lastByteIndex,t=this.blockCount,n=this.s;if(e[g>>2]|=this.padding[3&g],this.lastByteIndex===this.byteCount)for(e[0]=e[t],g=1;g<t+1;++g)e[g]=0;for(e[t-1]|=2147483648,g=0;g<t;++g)n[g]^=e[g];N(n)}},w.prototype.toString=w.prototype.hex=function(){this.finalize();for(var e,g=this.blockCount,t=this.s,n=this.outputBlocks,I=this.extraBytes,r=0,C=0,l="";C<n;){for(r=0;r<g&&C<n;++r,++C)e=t[r],l+=c[e>>4&15]+c[15&e]+c[e>>12&15]+c[e>>8&15]+c[e>>20&15]+c[e>>16&15]+c[e>>28&15]+c[e>>24&15];C%g===0&&(N(t),r=0)}return I&&(e=t[r],l+=c[e>>4&15]+c[15&e],I>1&&(l+=c[e>>12&15]+c[e>>8&15]),I>2&&(l+=c[e>>20&15]+c[e>>16&15])),l},w.prototype.arrayBuffer=function(){this.finalize();var e,g=this.blockCount,t=this.s,n=this.outputBlocks,I=this.extraBytes,r=0,C=0,l=this.outputBits>>3;e=I?new ArrayBuffer(n+1<<2):new ArrayBuffer(l);for(var a=new Uint32Array(e);C<n;){for(r=0;r<g&&C<n;++r,++C)a[C]=t[r];C%g===0&&N(t)}return I&&(a[r]=t[r],e=e.slice(0,l)),e},w.prototype.buffer=w.prototype.arrayBuffer,w.prototype.digest=w.prototype.array=function(){this.finalize();for(var e,g,t=this.blockCount,n=this.s,I=this.outputBlocks,r=this.extraBytes,C=0,l=0,a=[];l<I;){for(C=0;C<t&&l<I;++C,++l)e=l<<2,g=n[C],a[e]=255&g,a[e+1]=g>>8&255,a[e+2]=g>>16&255,a[e+3]=g>>24&255;l%t===0&&N(n)}return r&&(e=l<<2,g=n[C],a[e]=255&g,r>1&&(a[e+1]=g>>8&255),r>2&&(a[e+2]=g>>16&255)),a},H.prototype=new w,H.prototype.finalize=function(){return this.encode(this.outputBits,!0),w.prototype.finalize.call(this)};var N=function(e){var g,t,n,I,r,C,l,a,o,i,c,u,s,d,m,h,b,Z,p,y,G,f,B,v,S,W,V,k,R,X,J,Y,w,H,N,F,K,x,E,M,z,U,Q,L,T,D,j,P,O,_,q,$,ee,ge,te,ne,Ie,re,Ce,le,ae,oe,ie;for(n=0;n<48;n+=2)I=e[0]^e[10]^e[20]^e[30]^e[40],r=e[1]^e[11]^e[21]^e[31]^e[41],C=e[2]^e[12]^e[22]^e[32]^e[42],l=e[3]^e[13]^e[23]^e[33]^e[43],a=e[4]^e[14]^e[24]^e[34]^e[44],o=e[5]^e[15]^e[25]^e[35]^e[45],i=e[6]^e[16]^e[26]^e[36]^e[46],c=e[7]^e[17]^e[27]^e[37]^e[47],g=(u=e[8]^e[18]^e[28]^e[38]^e[48])^(C<<1|l>>>31),t=(s=e[9]^e[19]^e[29]^e[39]^e[49])^(l<<1|C>>>31),e[0]^=g,e[1]^=t,e[10]^=g,e[11]^=t,e[20]^=g,e[21]^=t,e[30]^=g,e[31]^=t,e[40]^=g,e[41]^=t,g=I^(a<<1|o>>>31),t=r^(o<<1|a>>>31),e[2]^=g,e[3]^=t,e[12]^=g,e[13]^=t,e[22]^=g,e[23]^=t,e[32]^=g,e[33]^=t,e[42]^=g,e[43]^=t,g=C^(i<<1|c>>>31),t=l^(c<<1|i>>>31),e[4]^=g,e[5]^=t,e[14]^=g,e[15]^=t,e[24]^=g,e[25]^=t,e[34]^=g,e[35]^=t,e[44]^=g,e[45]^=t,g=a^(u<<1|s>>>31),t=o^(s<<1|u>>>31),e[6]^=g,e[7]^=t,e[16]^=g,e[17]^=t,e[26]^=g,e[27]^=t,e[36]^=g,e[37]^=t,e[46]^=g,e[47]^=t,g=i^(I<<1|r>>>31),t=c^(r<<1|I>>>31),e[8]^=g,e[9]^=t,e[18]^=g,e[19]^=t,e[28]^=g,e[29]^=t,e[38]^=g,e[39]^=t,e[48]^=g,e[49]^=t,d=e[0],m=e[1],D=e[11]<<4|e[10]>>>28,j=e[10]<<4|e[11]>>>28,k=e[20]<<3|e[21]>>>29,R=e[21]<<3|e[20]>>>29,le=e[31]<<9|e[30]>>>23,ae=e[30]<<9|e[31]>>>23,U=e[40]<<18|e[41]>>>14,Q=e[41]<<18|e[40]>>>14,H=e[2]<<1|e[3]>>>31,N=e[3]<<1|e[2]>>>31,h=e[13]<<12|e[12]>>>20,b=e[12]<<12|e[13]>>>20,P=e[22]<<10|e[23]>>>22,O=e[23]<<10|e[22]>>>22,X=e[33]<<13|e[32]>>>19,J=e[32]<<13|e[33]>>>19,oe=e[42]<<2|e[43]>>>30,ie=e[43]<<2|e[42]>>>30,ge=e[5]<<30|e[4]>>>2,te=e[4]<<30|e[5]>>>2,F=e[14]<<6|e[15]>>>26,K=e[15]<<6|e[14]>>>26,Z=e[25]<<11|e[24]>>>21,p=e[24]<<11|e[25]>>>21,_=e[34]<<15|e[35]>>>17,q=e[35]<<15|e[34]>>>17,Y=e[45]<<29|e[44]>>>3,w=e[44]<<29|e[45]>>>3,v=e[6]<<28|e[7]>>>4,S=e[7]<<28|e[6]>>>4,ne=e[17]<<23|e[16]>>>9,Ie=e[16]<<23|e[17]>>>9,x=e[26]<<25|e[27]>>>7,E=e[27]<<25|e[26]>>>7,y=e[36]<<21|e[37]>>>11,G=e[37]<<21|e[36]>>>11,$=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,L=e[8]<<27|e[9]>>>5,T=e[9]<<27|e[8]>>>5,W=e[18]<<20|e[19]>>>12,V=e[19]<<20|e[18]>>>12,re=e[29]<<7|e[28]>>>25,Ce=e[28]<<7|e[29]>>>25,M=e[38]<<8|e[39]>>>24,z=e[39]<<8|e[38]>>>24,f=e[48]<<14|e[49]>>>18,B=e[49]<<14|e[48]>>>18,e[0]=d^~h&Z,e[1]=m^~b&p,e[10]=v^~W&k,e[11]=S^~V&R,e[20]=H^~F&x,e[21]=N^~K&E,e[30]=L^~D&P,e[31]=T^~j&O,e[40]=ge^~ne&re,e[41]=te^~Ie&Ce,e[2]=h^~Z&y,e[3]=b^~p&G,e[12]=W^~k&X,e[13]=V^~R&J,e[22]=F^~x&M,e[23]=K^~E&z,e[32]=D^~P&_,e[33]=j^~O&q,e[42]=ne^~re&le,e[43]=Ie^~Ce&ae,e[4]=Z^~y&f,e[5]=p^~G&B,e[14]=k^~X&Y,e[15]=R^~J&w,e[24]=x^~M&U,e[25]=E^~z&Q,e[34]=P^~_&$,e[35]=O^~q&ee,e[44]=re^~le&oe,e[45]=Ce^~ae&ie,e[6]=y^~f&d,e[7]=G^~B&m,e[16]=X^~Y&v,e[17]=J^~w&S,e[26]=M^~U&H,e[27]=z^~Q&N,e[36]=_^~$&L,e[37]=q^~ee&T,e[46]=le^~oe&ge,e[47]=ae^~ie&te,e[8]=f^~d&h,e[9]=B^~m&b,e[18]=Y^~v&W,e[19]=w^~S&V,e[28]=U^~H&F,e[29]=Q^~N&K,e[38]=$^~L&D,e[39]=ee^~T&j,e[48]=oe^~ge&ne,e[49]=ie^~te&Ie,e[0]^=A[n],e[1]^=A[n+1]};if(a)e.exports=S;else{for(V=0;V<W.length;++V)C[W[V]]=S[W[V]];o&&(void 0===(n=function(){return S}.call(g,t,g,e))||(e.exports=n))}}()},2325:function(e){function g(e,g){if(!e)throw new Error(g||"Assertion failed")}e.exports=g,g.equal=function(e,g,t){if(e!=g)throw new Error(t||"Assertion failed: "+e+" != "+g)}},2426:function(e,g,t){(e=t.nmd(e)).exports=function(){"use strict";var g,t;function n(){return g.apply(null,arguments)}function I(e){g=e}function r(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function C(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function l(e,g){return Object.prototype.hasOwnProperty.call(e,g)}function a(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var g;for(g in e)if(l(e,g))return!1;return!0}function o(e){return void 0===e}function i(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function c(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,g){var t,n=[],I=e.length;for(t=0;t<I;++t)n.push(g(e[t],t));return n}function s(e,g){for(var t in g)l(g,t)&&(e[t]=g[t]);return l(g,"toString")&&(e.toString=g.toString),l(g,"valueOf")&&(e.valueOf=g.valueOf),e}function A(e,g,t,n){return Dt(e,g,t,n,!0).utc()}function d(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=d()),e._pf}function h(e){if(null==e._isValid){var g=m(e),n=t.call(g.parsedDateParts,(function(e){return null!=e})),I=!isNaN(e._d.getTime())&&g.overflow<0&&!g.empty&&!g.invalidEra&&!g.invalidMonth&&!g.invalidWeekday&&!g.weekdayMismatch&&!g.nullInput&&!g.invalidFormat&&!g.userInvalidated&&(!g.meridiem||g.meridiem&&n);if(e._strict&&(I=I&&0===g.charsLeftOver&&0===g.unusedTokens.length&&void 0===g.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return I;e._isValid=I}return e._isValid}function b(e){var g=A(NaN);return null!=e?s(m(g),e):m(g).userInvalidated=!0,g}t=Array.prototype.some?Array.prototype.some:function(e){var g,t=Object(this),n=t.length>>>0;for(g=0;g<n;g++)if(g in t&&e.call(this,t[g],g,t))return!0;return!1};var Z=n.momentProperties=[],p=!1;function y(e,g){var t,n,I,r=Z.length;if(o(g._isAMomentObject)||(e._isAMomentObject=g._isAMomentObject),o(g._i)||(e._i=g._i),o(g._f)||(e._f=g._f),o(g._l)||(e._l=g._l),o(g._strict)||(e._strict=g._strict),o(g._tzm)||(e._tzm=g._tzm),o(g._isUTC)||(e._isUTC=g._isUTC),o(g._offset)||(e._offset=g._offset),o(g._pf)||(e._pf=m(g)),o(g._locale)||(e._locale=g._locale),r>0)for(t=0;t<r;t++)o(I=g[n=Z[t]])||(e[n]=I);return e}function G(e){y(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===p&&(p=!0,n.updateOffset(this),p=!1)}function f(e){return e instanceof G||null!=e&&null!=e._isAMomentObject}function B(e){!1===n.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function v(e,g){var t=!0;return s((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),t){var I,r,C,a=[],o=arguments.length;for(r=0;r<o;r++){if(I="","object"===typeof arguments[r]){for(C in I+="\n["+r+"] ",arguments[0])l(arguments[0],C)&&(I+=C+": "+arguments[0][C]+", ");I=I.slice(0,-2)}else I=arguments[r];a.push(I)}B(e+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),t=!1}return g.apply(this,arguments)}),g)}var S,W={};function V(e,g){null!=n.deprecationHandler&&n.deprecationHandler(e,g),W[e]||(B(g),W[e]=!0)}function k(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function R(e){var g,t;for(t in e)l(e,t)&&(k(g=e[t])?this[t]=g:this["_"+t]=g);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function X(e,g){var t,n=s({},e);for(t in g)l(g,t)&&(C(e[t])&&C(g[t])?(n[t]={},s(n[t],e[t]),s(n[t],g[t])):null!=g[t]?n[t]=g[t]:delete n[t]);for(t in e)l(e,t)&&!l(g,t)&&C(e[t])&&(n[t]=s({},n[t]));return n}function J(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,S=Object.keys?Object.keys:function(e){var g,t=[];for(g in e)l(e,g)&&t.push(g);return t};var Y={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function w(e,g,t){var n=this._calendar[e]||this._calendar.sameElse;return k(n)?n.call(g,t):n}function H(e,g,t){var n=""+Math.abs(e),I=g-n.length;return(e>=0?t?"+":"":"-")+Math.pow(10,Math.max(0,I)).toString().substr(1)+n}var N=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,F=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,K={},x={};function E(e,g,t,n){var I=n;"string"===typeof n&&(I=function(){return this[n]()}),e&&(x[e]=I),g&&(x[g[0]]=function(){return H(I.apply(this,arguments),g[1],g[2])}),t&&(x[t]=function(){return this.localeData().ordinal(I.apply(this,arguments),e)})}function M(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function z(e){var g,t,n=e.match(N);for(g=0,t=n.length;g<t;g++)x[n[g]]?n[g]=x[n[g]]:n[g]=M(n[g]);return function(g){var I,r="";for(I=0;I<t;I++)r+=k(n[I])?n[I].call(g,e):n[I];return r}}function U(e,g){return e.isValid()?(g=Q(g,e.localeData()),K[g]=K[g]||z(g),K[g](e)):e.localeData().invalidDate()}function Q(e,g){var t=5;function n(e){return g.longDateFormat(e)||e}for(F.lastIndex=0;t>=0&&F.test(e);)e=e.replace(F,n),F.lastIndex=0,t-=1;return e}var L={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function T(e){var g=this._longDateFormat[e],t=this._longDateFormat[e.toUpperCase()];return g||!t?g:(this._longDateFormat[e]=t.match(N).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var D="Invalid date";function j(){return this._invalidDate}var P="%d",O=/\d{1,2}/;function _(e){return this._ordinal.replace("%d",e)}var q={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function $(e,g,t,n){var I=this._relativeTime[t];return k(I)?I(e,g,t,n):I.replace(/%d/i,e)}function ee(e,g){var t=this._relativeTime[e>0?"future":"past"];return k(t)?t(g):t.replace(/%s/i,g)}var ge={};function te(e,g){var t=e.toLowerCase();ge[t]=ge[t+"s"]=ge[g]=e}function ne(e){return"string"===typeof e?ge[e]||ge[e.toLowerCase()]:void 0}function Ie(e){var g,t,n={};for(t in e)l(e,t)&&(g=ne(t))&&(n[g]=e[t]);return n}var re={};function Ce(e,g){re[e]=g}function le(e){var g,t=[];for(g in e)l(e,g)&&t.push({unit:g,priority:re[g]});return t.sort((function(e,g){return e.priority-g.priority})),t}function ae(e){return e%4===0&&e%100!==0||e%400===0}function oe(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function ie(e){var g=+e,t=0;return 0!==g&&isFinite(g)&&(t=oe(g)),t}function ce(e,g){return function(t){return null!=t?(se(this,e,t),n.updateOffset(this,g),this):ue(this,e)}}function ue(e,g){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+g]():NaN}function se(e,g,t){e.isValid()&&!isNaN(t)&&("FullYear"===g&&ae(e.year())&&1===e.month()&&29===e.date()?(t=ie(t),e._d["set"+(e._isUTC?"UTC":"")+g](t,e.month(),$e(t,e.month()))):e._d["set"+(e._isUTC?"UTC":"")+g](t))}function Ae(e){return k(this[e=ne(e)])?this[e]():this}function de(e,g){if("object"===typeof e){var t,n=le(e=Ie(e)),I=n.length;for(t=0;t<I;t++)this[n[t].unit](e[n[t].unit])}else if(k(this[e=ne(e)]))return this[e](g);return this}var me,he=/\d/,be=/\d\d/,Ze=/\d{3}/,pe=/\d{4}/,ye=/[+-]?\d{6}/,Ge=/\d\d?/,fe=/\d\d\d\d?/,Be=/\d\d\d\d\d\d?/,ve=/\d{1,3}/,Se=/\d{1,4}/,We=/[+-]?\d{1,6}/,Ve=/\d+/,ke=/[+-]?\d+/,Re=/Z|[+-]\d\d:?\d\d/gi,Xe=/Z|[+-]\d\d(?::?\d\d)?/gi,Je=/[+-]?\d+(\.\d{1,3})?/,Ye=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i;function we(e,g,t){me[e]=k(g)?g:function(e,n){return e&&t?t:g}}function He(e,g){return l(me,e)?me[e](g._strict,g._locale):new RegExp(Ne(e))}function Ne(e){return Fe(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,g,t,n,I){return g||t||n||I})))}function Fe(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}me={};var Ke={};function xe(e,g){var t,n,I=g;for("string"===typeof e&&(e=[e]),i(g)&&(I=function(e,t){t[g]=ie(e)}),n=e.length,t=0;t<n;t++)Ke[e[t]]=I}function Ee(e,g){xe(e,(function(e,t,n,I){n._w=n._w||{},g(e,n._w,n,I)}))}function Me(e,g,t){null!=g&&l(Ke,e)&&Ke[e](g,t._a,t,e)}var ze,Ue=0,Qe=1,Le=2,Te=3,De=4,je=5,Pe=6,Oe=7,_e=8;function qe(e,g){return(e%g+g)%g}function $e(e,g){if(isNaN(e)||isNaN(g))return NaN;var t=qe(g,12);return e+=(g-t)/12,1===t?ae(e)?29:28:31-t%7%2}ze=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var g;for(g=0;g<this.length;++g)if(this[g]===e)return g;return-1},E("M",["MM",2],"Mo",(function(){return this.month()+1})),E("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),E("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),te("month","M"),Ce("month",8),we("M",Ge),we("MM",Ge,be),we("MMM",(function(e,g){return g.monthsShortRegex(e)})),we("MMMM",(function(e,g){return g.monthsRegex(e)})),xe(["M","MM"],(function(e,g){g[Qe]=ie(e)-1})),xe(["MMM","MMMM"],(function(e,g,t,n){var I=t._locale.monthsParse(e,n,t._strict);null!=I?g[Qe]=I:m(t).invalidMonth=e}));var eg="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),gg="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),tg=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,ng=Ye,Ig=Ye;function rg(e,g){return e?r(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||tg).test(g)?"format":"standalone"][e.month()]:r(this._months)?this._months:this._months.standalone}function Cg(e,g){return e?r(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[tg.test(g)?"format":"standalone"][e.month()]:r(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function lg(e,g,t){var n,I,r,C=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)r=A([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(r,"").toLocaleLowerCase();return t?"MMM"===g?-1!==(I=ze.call(this._shortMonthsParse,C))?I:null:-1!==(I=ze.call(this._longMonthsParse,C))?I:null:"MMM"===g?-1!==(I=ze.call(this._shortMonthsParse,C))||-1!==(I=ze.call(this._longMonthsParse,C))?I:null:-1!==(I=ze.call(this._longMonthsParse,C))||-1!==(I=ze.call(this._shortMonthsParse,C))?I:null}function ag(e,g,t){var n,I,r;if(this._monthsParseExact)return lg.call(this,e,g,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(I=A([2e3,n]),t&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(I,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(I,"").replace(".","")+"$","i")),t||this._monthsParse[n]||(r="^"+this.months(I,"")+"|^"+this.monthsShort(I,""),this._monthsParse[n]=new RegExp(r.replace(".",""),"i")),t&&"MMMM"===g&&this._longMonthsParse[n].test(e))return n;if(t&&"MMM"===g&&this._shortMonthsParse[n].test(e))return n;if(!t&&this._monthsParse[n].test(e))return n}}function og(e,g){var t;if(!e.isValid())return e;if("string"===typeof g)if(/^\d+$/.test(g))g=ie(g);else if(!i(g=e.localeData().monthsParse(g)))return e;return t=Math.min(e.date(),$e(e.year(),g)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](g,t),e}function ig(e){return null!=e?(og(this,e),n.updateOffset(this,!0),this):ue(this,"Month")}function cg(){return $e(this.year(),this.month())}function ug(e){return this._monthsParseExact?(l(this,"_monthsRegex")||Ag.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=ng),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function sg(e){return this._monthsParseExact?(l(this,"_monthsRegex")||Ag.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=Ig),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function Ag(){function e(e,g){return g.length-e.length}var g,t,n=[],I=[],r=[];for(g=0;g<12;g++)t=A([2e3,g]),n.push(this.monthsShort(t,"")),I.push(this.months(t,"")),r.push(this.months(t,"")),r.push(this.monthsShort(t,""));for(n.sort(e),I.sort(e),r.sort(e),g=0;g<12;g++)n[g]=Fe(n[g]),I[g]=Fe(I[g]);for(g=0;g<24;g++)r[g]=Fe(r[g]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+I.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+n.join("|")+")","i")}function dg(e){return ae(e)?366:365}E("Y",0,0,(function(){var e=this.year();return e<=9999?H(e,4):"+"+e})),E(0,["YY",2],0,(function(){return this.year()%100})),E(0,["YYYY",4],0,"year"),E(0,["YYYYY",5],0,"year"),E(0,["YYYYYY",6,!0],0,"year"),te("year","y"),Ce("year",1),we("Y",ke),we("YY",Ge,be),we("YYYY",Se,pe),we("YYYYY",We,ye),we("YYYYYY",We,ye),xe(["YYYYY","YYYYYY"],Ue),xe("YYYY",(function(e,g){g[Ue]=2===e.length?n.parseTwoDigitYear(e):ie(e)})),xe("YY",(function(e,g){g[Ue]=n.parseTwoDigitYear(e)})),xe("Y",(function(e,g){g[Ue]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return ie(e)+(ie(e)>68?1900:2e3)};var mg=ce("FullYear",!0);function hg(){return ae(this.year())}function bg(e,g,t,n,I,r,C){var l;return e<100&&e>=0?(l=new Date(e+400,g,t,n,I,r,C),isFinite(l.getFullYear())&&l.setFullYear(e)):l=new Date(e,g,t,n,I,r,C),l}function Zg(e){var g,t;return e<100&&e>=0?((t=Array.prototype.slice.call(arguments))[0]=e+400,g=new Date(Date.UTC.apply(null,t)),isFinite(g.getUTCFullYear())&&g.setUTCFullYear(e)):g=new Date(Date.UTC.apply(null,arguments)),g}function pg(e,g,t){var n=7+g-t;return-(7+Zg(e,0,n).getUTCDay()-g)%7+n-1}function yg(e,g,t,n,I){var r,C,l=1+7*(g-1)+(7+t-n)%7+pg(e,n,I);return l<=0?C=dg(r=e-1)+l:l>dg(e)?(r=e+1,C=l-dg(e)):(r=e,C=l),{year:r,dayOfYear:C}}function Gg(e,g,t){var n,I,r=pg(e.year(),g,t),C=Math.floor((e.dayOfYear()-r-1)/7)+1;return C<1?n=C+fg(I=e.year()-1,g,t):C>fg(e.year(),g,t)?(n=C-fg(e.year(),g,t),I=e.year()+1):(I=e.year(),n=C),{week:n,year:I}}function fg(e,g,t){var n=pg(e,g,t),I=pg(e+1,g,t);return(dg(e)-n+I)/7}function Bg(e){return Gg(e,this._week.dow,this._week.doy).week}E("w",["ww",2],"wo","week"),E("W",["WW",2],"Wo","isoWeek"),te("week","w"),te("isoWeek","W"),Ce("week",5),Ce("isoWeek",5),we("w",Ge),we("ww",Ge,be),we("W",Ge),we("WW",Ge,be),Ee(["w","ww","W","WW"],(function(e,g,t,n){g[n.substr(0,1)]=ie(e)}));var vg={dow:0,doy:6};function Sg(){return this._week.dow}function Wg(){return this._week.doy}function Vg(e){var g=this.localeData().week(this);return null==e?g:this.add(7*(e-g),"d")}function kg(e){var g=Gg(this,1,4).week;return null==e?g:this.add(7*(e-g),"d")}function Rg(e,g){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=g.weekdaysParse(e))?e:null:parseInt(e,10)}function Xg(e,g){return"string"===typeof e?g.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Jg(e,g){return e.slice(g,7).concat(e.slice(0,g))}E("d",0,"do","day"),E("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),E("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),E("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),E("e",0,0,"weekday"),E("E",0,0,"isoWeekday"),te("day","d"),te("weekday","e"),te("isoWeekday","E"),Ce("day",11),Ce("weekday",11),Ce("isoWeekday",11),we("d",Ge),we("e",Ge),we("E",Ge),we("dd",(function(e,g){return g.weekdaysMinRegex(e)})),we("ddd",(function(e,g){return g.weekdaysShortRegex(e)})),we("dddd",(function(e,g){return g.weekdaysRegex(e)})),Ee(["dd","ddd","dddd"],(function(e,g,t,n){var I=t._locale.weekdaysParse(e,n,t._strict);null!=I?g.d=I:m(t).invalidWeekday=e})),Ee(["d","e","E"],(function(e,g,t,n){g[n]=ie(e)}));var Yg="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),wg="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Hg="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ng=Ye,Fg=Ye,Kg=Ye;function xg(e,g){var t=r(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(g)?"format":"standalone"];return!0===e?Jg(t,this._week.dow):e?t[e.day()]:t}function Eg(e){return!0===e?Jg(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Mg(e){return!0===e?Jg(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function zg(e,g,t){var n,I,r,C=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)r=A([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(r,"").toLocaleLowerCase();return t?"dddd"===g?-1!==(I=ze.call(this._weekdaysParse,C))?I:null:"ddd"===g?-1!==(I=ze.call(this._shortWeekdaysParse,C))?I:null:-1!==(I=ze.call(this._minWeekdaysParse,C))?I:null:"dddd"===g?-1!==(I=ze.call(this._weekdaysParse,C))||-1!==(I=ze.call(this._shortWeekdaysParse,C))||-1!==(I=ze.call(this._minWeekdaysParse,C))?I:null:"ddd"===g?-1!==(I=ze.call(this._shortWeekdaysParse,C))||-1!==(I=ze.call(this._weekdaysParse,C))||-1!==(I=ze.call(this._minWeekdaysParse,C))?I:null:-1!==(I=ze.call(this._minWeekdaysParse,C))||-1!==(I=ze.call(this._weekdaysParse,C))||-1!==(I=ze.call(this._shortWeekdaysParse,C))?I:null}function Ug(e,g,t){var n,I,r;if(this._weekdaysParseExact)return zg.call(this,e,g,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(I=A([2e3,1]).day(n),t&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(I,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(I,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(I,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(r="^"+this.weekdays(I,"")+"|^"+this.weekdaysShort(I,"")+"|^"+this.weekdaysMin(I,""),this._weekdaysParse[n]=new RegExp(r.replace(".",""),"i")),t&&"dddd"===g&&this._fullWeekdaysParse[n].test(e))return n;if(t&&"ddd"===g&&this._shortWeekdaysParse[n].test(e))return n;if(t&&"dd"===g&&this._minWeekdaysParse[n].test(e))return n;if(!t&&this._weekdaysParse[n].test(e))return n}}function Qg(e){if(!this.isValid())return null!=e?this:NaN;var g=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Rg(e,this.localeData()),this.add(e-g,"d")):g}function Lg(e){if(!this.isValid())return null!=e?this:NaN;var g=(this.day()+7-this.localeData()._week.dow)%7;return null==e?g:this.add(e-g,"d")}function Tg(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var g=Xg(e,this.localeData());return this.day(this.day()%7?g:g-7)}return this.day()||7}function Dg(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Og.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=Ng),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function jg(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Og.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Fg),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Pg(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||Og.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Kg),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Og(){function e(e,g){return g.length-e.length}var g,t,n,I,r,C=[],l=[],a=[],o=[];for(g=0;g<7;g++)t=A([2e3,1]).day(g),n=Fe(this.weekdaysMin(t,"")),I=Fe(this.weekdaysShort(t,"")),r=Fe(this.weekdays(t,"")),C.push(n),l.push(I),a.push(r),o.push(n),o.push(I),o.push(r);C.sort(e),l.sort(e),a.sort(e),o.sort(e),this._weekdaysRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+C.join("|")+")","i")}function _g(){return this.hours()%12||12}function qg(){return this.hours()||24}function $g(e,g){E(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),g)}))}function et(e,g){return g._meridiemParse}function gt(e){return"p"===(e+"").toLowerCase().charAt(0)}E("H",["HH",2],0,"hour"),E("h",["hh",2],0,_g),E("k",["kk",2],0,qg),E("hmm",0,0,(function(){return""+_g.apply(this)+H(this.minutes(),2)})),E("hmmss",0,0,(function(){return""+_g.apply(this)+H(this.minutes(),2)+H(this.seconds(),2)})),E("Hmm",0,0,(function(){return""+this.hours()+H(this.minutes(),2)})),E("Hmmss",0,0,(function(){return""+this.hours()+H(this.minutes(),2)+H(this.seconds(),2)})),$g("a",!0),$g("A",!1),te("hour","h"),Ce("hour",13),we("a",et),we("A",et),we("H",Ge),we("h",Ge),we("k",Ge),we("HH",Ge,be),we("hh",Ge,be),we("kk",Ge,be),we("hmm",fe),we("hmmss",Be),we("Hmm",fe),we("Hmmss",Be),xe(["H","HH"],Te),xe(["k","kk"],(function(e,g,t){var n=ie(e);g[Te]=24===n?0:n})),xe(["a","A"],(function(e,g,t){t._isPm=t._locale.isPM(e),t._meridiem=e})),xe(["h","hh"],(function(e,g,t){g[Te]=ie(e),m(t).bigHour=!0})),xe("hmm",(function(e,g,t){var n=e.length-2;g[Te]=ie(e.substr(0,n)),g[De]=ie(e.substr(n)),m(t).bigHour=!0})),xe("hmmss",(function(e,g,t){var n=e.length-4,I=e.length-2;g[Te]=ie(e.substr(0,n)),g[De]=ie(e.substr(n,2)),g[je]=ie(e.substr(I)),m(t).bigHour=!0})),xe("Hmm",(function(e,g,t){var n=e.length-2;g[Te]=ie(e.substr(0,n)),g[De]=ie(e.substr(n))})),xe("Hmmss",(function(e,g,t){var n=e.length-4,I=e.length-2;g[Te]=ie(e.substr(0,n)),g[De]=ie(e.substr(n,2)),g[je]=ie(e.substr(I))}));var tt=/[ap]\.?m?\.?/i,nt=ce("Hours",!0);function It(e,g,t){return e>11?t?"pm":"PM":t?"am":"AM"}var rt,Ct={calendar:Y,longDateFormat:L,invalidDate:D,ordinal:P,dayOfMonthOrdinalParse:O,relativeTime:q,months:eg,monthsShort:gg,week:vg,weekdays:Yg,weekdaysMin:Hg,weekdaysShort:wg,meridiemParse:tt},lt={},at={};function ot(e,g){var t,n=Math.min(e.length,g.length);for(t=0;t<n;t+=1)if(e[t]!==g[t])return t;return n}function it(e){return e?e.toLowerCase().replace("_","-"):e}function ct(e){for(var g,t,n,I,r=0;r<e.length;){for(g=(I=it(e[r]).split("-")).length,t=(t=it(e[r+1]))?t.split("-"):null;g>0;){if(n=st(I.slice(0,g).join("-")))return n;if(t&&t.length>=g&&ot(I,t)>=g-1)break;g--}r++}return rt}function ut(e){return null!=e.match("^[^/\\\\]*$")}function st(g){var t=null;if(void 0===lt[g]&&e&&e.exports&&ut(g))try{t=rt._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),At(t)}catch(n){lt[g]=null}return lt[g]}function At(e,g){var t;return e&&((t=o(g)?ht(e):dt(e,g))?rt=t:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),rt._abbr}function dt(e,g){if(null!==g){var t,n=Ct;if(g.abbr=e,null!=lt[e])V("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=lt[e]._config;else if(null!=g.parentLocale)if(null!=lt[g.parentLocale])n=lt[g.parentLocale]._config;else{if(null==(t=st(g.parentLocale)))return at[g.parentLocale]||(at[g.parentLocale]=[]),at[g.parentLocale].push({name:e,config:g}),null;n=t._config}return lt[e]=new J(X(n,g)),at[e]&&at[e].forEach((function(e){dt(e.name,e.config)})),At(e),lt[e]}return delete lt[e],null}function mt(e,g){if(null!=g){var t,n,I=Ct;null!=lt[e]&&null!=lt[e].parentLocale?lt[e].set(X(lt[e]._config,g)):(null!=(n=st(e))&&(I=n._config),g=X(I,g),null==n&&(g.abbr=e),(t=new J(g)).parentLocale=lt[e],lt[e]=t),At(e)}else null!=lt[e]&&(null!=lt[e].parentLocale?(lt[e]=lt[e].parentLocale,e===At()&&At(e)):null!=lt[e]&&delete lt[e]);return lt[e]}function ht(e){var g;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return rt;if(!r(e)){if(g=st(e))return g;e=[e]}return ct(e)}function bt(){return S(lt)}function Zt(e){var g,t=e._a;return t&&-2===m(e).overflow&&(g=t[Qe]<0||t[Qe]>11?Qe:t[Le]<1||t[Le]>$e(t[Ue],t[Qe])?Le:t[Te]<0||t[Te]>24||24===t[Te]&&(0!==t[De]||0!==t[je]||0!==t[Pe])?Te:t[De]<0||t[De]>59?De:t[je]<0||t[je]>59?je:t[Pe]<0||t[Pe]>999?Pe:-1,m(e)._overflowDayOfYear&&(g<Ue||g>Le)&&(g=Le),m(e)._overflowWeeks&&-1===g&&(g=Oe),m(e)._overflowWeekday&&-1===g&&(g=_e),m(e).overflow=g),e}var pt=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,yt=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Gt=/Z|[+-]\d\d(?::?\d\d)?/,ft=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Bt=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],vt=/^\/?Date\((-?\d+)/i,St=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,Wt={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Vt(e){var g,t,n,I,r,C,l=e._i,a=pt.exec(l)||yt.exec(l),o=ft.length,i=Bt.length;if(a){for(m(e).iso=!0,g=0,t=o;g<t;g++)if(ft[g][1].exec(a[1])){I=ft[g][0],n=!1!==ft[g][2];break}if(null==I)return void(e._isValid=!1);if(a[3]){for(g=0,t=i;g<t;g++)if(Bt[g][1].exec(a[3])){r=(a[2]||" ")+Bt[g][0];break}if(null==r)return void(e._isValid=!1)}if(!n&&null!=r)return void(e._isValid=!1);if(a[4]){if(!Gt.exec(a[4]))return void(e._isValid=!1);C="Z"}e._f=I+(r||"")+(C||""),Et(e)}else e._isValid=!1}function kt(e,g,t,n,I,r){var C=[Rt(e),gg.indexOf(g),parseInt(t,10),parseInt(n,10),parseInt(I,10)];return r&&C.push(parseInt(r,10)),C}function Rt(e){var g=parseInt(e,10);return g<=49?2e3+g:g<=999?1900+g:g}function Xt(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Jt(e,g,t){return!e||wg.indexOf(e)===new Date(g[0],g[1],g[2]).getDay()||(m(t).weekdayMismatch=!0,t._isValid=!1,!1)}function Yt(e,g,t){if(e)return Wt[e];if(g)return 0;var n=parseInt(t,10),I=n%100;return(n-I)/100*60+I}function wt(e){var g,t=St.exec(Xt(e._i));if(t){if(g=kt(t[4],t[3],t[2],t[5],t[6],t[7]),!Jt(t[1],g,e))return;e._a=g,e._tzm=Yt(t[8],t[9],t[10]),e._d=Zg.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Ht(e){var g=vt.exec(e._i);null===g?(Vt(e),!1===e._isValid&&(delete e._isValid,wt(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:n.createFromInputFallback(e)))):e._d=new Date(+g[1])}function Nt(e,g,t){return null!=e?e:null!=g?g:t}function Ft(e){var g=new Date(n.now());return e._useUTC?[g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate()]:[g.getFullYear(),g.getMonth(),g.getDate()]}function Kt(e){var g,t,n,I,r,C=[];if(!e._d){for(n=Ft(e),e._w&&null==e._a[Le]&&null==e._a[Qe]&&xt(e),null!=e._dayOfYear&&(r=Nt(e._a[Ue],n[Ue]),(e._dayOfYear>dg(r)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),t=Zg(r,0,e._dayOfYear),e._a[Qe]=t.getUTCMonth(),e._a[Le]=t.getUTCDate()),g=0;g<3&&null==e._a[g];++g)e._a[g]=C[g]=n[g];for(;g<7;g++)e._a[g]=C[g]=null==e._a[g]?2===g?1:0:e._a[g];24===e._a[Te]&&0===e._a[De]&&0===e._a[je]&&0===e._a[Pe]&&(e._nextDay=!0,e._a[Te]=0),e._d=(e._useUTC?Zg:bg).apply(null,C),I=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Te]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==I&&(m(e).weekdayMismatch=!0)}}function xt(e){var g,t,n,I,r,C,l,a,o;null!=(g=e._w).GG||null!=g.W||null!=g.E?(r=1,C=4,t=Nt(g.GG,e._a[Ue],Gg(jt(),1,4).year),n=Nt(g.W,1),((I=Nt(g.E,1))<1||I>7)&&(a=!0)):(r=e._locale._week.dow,C=e._locale._week.doy,o=Gg(jt(),r,C),t=Nt(g.gg,e._a[Ue],o.year),n=Nt(g.w,o.week),null!=g.d?((I=g.d)<0||I>6)&&(a=!0):null!=g.e?(I=g.e+r,(g.e<0||g.e>6)&&(a=!0)):I=r),n<1||n>fg(t,r,C)?m(e)._overflowWeeks=!0:null!=a?m(e)._overflowWeekday=!0:(l=yg(t,n,I,r,C),e._a[Ue]=l.year,e._dayOfYear=l.dayOfYear)}function Et(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],m(e).empty=!0;var g,t,I,r,C,l,a,o=""+e._i,i=o.length,c=0;for(a=(I=Q(e._f,e._locale).match(N)||[]).length,g=0;g<a;g++)r=I[g],(t=(o.match(He(r,e))||[])[0])&&((C=o.substr(0,o.indexOf(t))).length>0&&m(e).unusedInput.push(C),o=o.slice(o.indexOf(t)+t.length),c+=t.length),x[r]?(t?m(e).empty=!1:m(e).unusedTokens.push(r),Me(r,t,e)):e._strict&&!t&&m(e).unusedTokens.push(r);m(e).charsLeftOver=i-c,o.length>0&&m(e).unusedInput.push(o),e._a[Te]<=12&&!0===m(e).bigHour&&e._a[Te]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[Te]=Mt(e._locale,e._a[Te],e._meridiem),null!==(l=m(e).era)&&(e._a[Ue]=e._locale.erasConvertYear(l,e._a[Ue])),Kt(e),Zt(e)}else wt(e);else Vt(e)}function Mt(e,g,t){var n;return null==t?g:null!=e.meridiemHour?e.meridiemHour(g,t):null!=e.isPM?((n=e.isPM(t))&&g<12&&(g+=12),n||12!==g||(g=0),g):g}function zt(e){var g,t,n,I,r,C,l=!1,a=e._f.length;if(0===a)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(I=0;I<a;I++)r=0,C=!1,g=y({},e),null!=e._useUTC&&(g._useUTC=e._useUTC),g._f=e._f[I],Et(g),h(g)&&(C=!0),r+=m(g).charsLeftOver,r+=10*m(g).unusedTokens.length,m(g).score=r,l?r<n&&(n=r,t=g):(null==n||r<n||C)&&(n=r,t=g,C&&(l=!0));s(e,t||g)}function Ut(e){if(!e._d){var g=Ie(e._i),t=void 0===g.day?g.date:g.day;e._a=u([g.year,g.month,t,g.hour,g.minute,g.second,g.millisecond],(function(e){return e&&parseInt(e,10)})),Kt(e)}}function Qt(e){var g=new G(Zt(Lt(e)));return g._nextDay&&(g.add(1,"d"),g._nextDay=void 0),g}function Lt(e){var g=e._i,t=e._f;return e._locale=e._locale||ht(e._l),null===g||void 0===t&&""===g?b({nullInput:!0}):("string"===typeof g&&(e._i=g=e._locale.preparse(g)),f(g)?new G(Zt(g)):(c(g)?e._d=g:r(t)?zt(e):t?Et(e):Tt(e),h(e)||(e._d=null),e))}function Tt(e){var g=e._i;o(g)?e._d=new Date(n.now()):c(g)?e._d=new Date(g.valueOf()):"string"===typeof g?Ht(e):r(g)?(e._a=u(g.slice(0),(function(e){return parseInt(e,10)})),Kt(e)):C(g)?Ut(e):i(g)?e._d=new Date(g):n.createFromInputFallback(e)}function Dt(e,g,t,n,I){var l={};return!0!==g&&!1!==g||(n=g,g=void 0),!0!==t&&!1!==t||(n=t,t=void 0),(C(e)&&a(e)||r(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=I,l._l=t,l._i=e,l._f=g,l._strict=n,Qt(l)}function jt(e,g,t,n){return Dt(e,g,t,n,!1)}n.createFromInputFallback=v("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var Pt=v("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=jt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:b()})),Ot=v("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=jt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:b()}));function _t(e,g){var t,n;if(1===g.length&&r(g[0])&&(g=g[0]),!g.length)return jt();for(t=g[0],n=1;n<g.length;++n)g[n].isValid()&&!g[n][e](t)||(t=g[n]);return t}function qt(){return _t("isBefore",[].slice.call(arguments,0))}function $t(){return _t("isAfter",[].slice.call(arguments,0))}var en=function(){return Date.now?Date.now():+new Date},gn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function tn(e){var g,t,n=!1,I=gn.length;for(g in e)if(l(e,g)&&(-1===ze.call(gn,g)||null!=e[g]&&isNaN(e[g])))return!1;for(t=0;t<I;++t)if(e[gn[t]]){if(n)return!1;parseFloat(e[gn[t]])!==ie(e[gn[t]])&&(n=!0)}return!0}function nn(){return this._isValid}function In(){return Vn(NaN)}function rn(e){var g=Ie(e),t=g.year||0,n=g.quarter||0,I=g.month||0,r=g.week||g.isoWeek||0,C=g.day||0,l=g.hour||0,a=g.minute||0,o=g.second||0,i=g.millisecond||0;this._isValid=tn(g),this._milliseconds=+i+1e3*o+6e4*a+1e3*l*60*60,this._days=+C+7*r,this._months=+I+3*n+12*t,this._data={},this._locale=ht(),this._bubble()}function Cn(e){return e instanceof rn}function ln(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function an(e,g,t){var n,I=Math.min(e.length,g.length),r=Math.abs(e.length-g.length),C=0;for(n=0;n<I;n++)(t&&e[n]!==g[n]||!t&&ie(e[n])!==ie(g[n]))&&C++;return C+r}function on(e,g){E(e,0,0,(function(){var e=this.utcOffset(),t="+";return e<0&&(e=-e,t="-"),t+H(~~(e/60),2)+g+H(~~e%60,2)}))}on("Z",":"),on("ZZ",""),we("Z",Xe),we("ZZ",Xe),xe(["Z","ZZ"],(function(e,g,t){t._useUTC=!0,t._tzm=un(Xe,e)}));var cn=/([\+\-]|\d\d)/gi;function un(e,g){var t,n,I=(g||"").match(e);return null===I?null:0===(n=60*(t=((I[I.length-1]||[])+"").match(cn)||["-",0,0])[1]+ie(t[2]))?0:"+"===t[0]?n:-n}function sn(e,g){var t,I;return g._isUTC?(t=g.clone(),I=(f(e)||c(e)?e.valueOf():jt(e).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+I),n.updateOffset(t,!1),t):jt(e).local()}function An(e){return-Math.round(e._d.getTimezoneOffset())}function dn(e,g,t){var I,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=un(Xe,e)))return this}else Math.abs(e)<16&&!t&&(e*=60);return!this._isUTC&&g&&(I=An(this)),this._offset=e,this._isUTC=!0,null!=I&&this.add(I,"m"),r!==e&&(!g||this._changeInProgress?Yn(this,Vn(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:An(this)}function mn(e,g){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,g),this):-this.utcOffset()}function hn(e){return this.utcOffset(0,e)}function bn(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(An(this),"m")),this}function Zn(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=un(Re,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function pn(e){return!!this.isValid()&&(e=e?jt(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function yn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Gn(){if(!o(this._isDSTShifted))return this._isDSTShifted;var e,g={};return y(g,this),(g=Lt(g))._a?(e=g._isUTC?A(g._a):jt(g._a),this._isDSTShifted=this.isValid()&&an(g._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function fn(){return!!this.isValid()&&!this._isUTC}function Bn(){return!!this.isValid()&&this._isUTC}function vn(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var Sn=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Wn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Vn(e,g){var t,n,I,r=e,C=null;return Cn(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:i(e)||!isNaN(+e)?(r={},g?r[g]=+e:r.milliseconds=+e):(C=Sn.exec(e))?(t="-"===C[1]?-1:1,r={y:0,d:ie(C[Le])*t,h:ie(C[Te])*t,m:ie(C[De])*t,s:ie(C[je])*t,ms:ie(ln(1e3*C[Pe]))*t}):(C=Wn.exec(e))?(t="-"===C[1]?-1:1,r={y:kn(C[2],t),M:kn(C[3],t),w:kn(C[4],t),d:kn(C[5],t),h:kn(C[6],t),m:kn(C[7],t),s:kn(C[8],t)}):null==r?r={}:"object"===typeof r&&("from"in r||"to"in r)&&(I=Xn(jt(r.from),jt(r.to)),(r={}).ms=I.milliseconds,r.M=I.months),n=new rn(r),Cn(e)&&l(e,"_locale")&&(n._locale=e._locale),Cn(e)&&l(e,"_isValid")&&(n._isValid=e._isValid),n}function kn(e,g){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*g}function Rn(e,g){var t={};return t.months=g.month()-e.month()+12*(g.year()-e.year()),e.clone().add(t.months,"M").isAfter(g)&&--t.months,t.milliseconds=+g-+e.clone().add(t.months,"M"),t}function Xn(e,g){var t;return e.isValid()&&g.isValid()?(g=sn(g,e),e.isBefore(g)?t=Rn(e,g):((t=Rn(g,e)).milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function Jn(e,g){return function(t,n){var I;return null===n||isNaN(+n)||(V(g,"moment()."+g+"(period, number) is deprecated. Please use moment()."+g+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),I=t,t=n,n=I),Yn(this,Vn(t,n),e),this}}function Yn(e,g,t,I){var r=g._milliseconds,C=ln(g._days),l=ln(g._months);e.isValid()&&(I=null==I||I,l&&og(e,ue(e,"Month")+l*t),C&&se(e,"Date",ue(e,"Date")+C*t),r&&e._d.setTime(e._d.valueOf()+r*t),I&&n.updateOffset(e,C||l))}Vn.fn=rn.prototype,Vn.invalid=In;var wn=Jn(1,"add"),Hn=Jn(-1,"subtract");function Nn(e){return"string"===typeof e||e instanceof String}function Fn(e){return f(e)||c(e)||Nn(e)||i(e)||xn(e)||Kn(e)||null===e||void 0===e}function Kn(e){var g,t,n=C(e)&&!a(e),I=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],o=r.length;for(g=0;g<o;g+=1)t=r[g],I=I||l(e,t);return n&&I}function xn(e){var g=r(e),t=!1;return g&&(t=0===e.filter((function(g){return!i(g)&&Nn(e)})).length),g&&t}function En(e){var g,t,n=C(e)&&!a(e),I=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(g=0;g<r.length;g+=1)t=r[g],I=I||l(e,t);return n&&I}function Mn(e,g){var t=e.diff(g,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function zn(e,g){1===arguments.length&&(arguments[0]?Fn(arguments[0])?(e=arguments[0],g=void 0):En(arguments[0])&&(g=arguments[0],e=void 0):(e=void 0,g=void 0));var t=e||jt(),I=sn(t,this).startOf("day"),r=n.calendarFormat(this,I)||"sameElse",C=g&&(k(g[r])?g[r].call(this,t):g[r]);return this.format(C||this.localeData().calendar(r,this,jt(t)))}function Un(){return new G(this)}function Qn(e,g){var t=f(e)?e:jt(e);return!(!this.isValid()||!t.isValid())&&("millisecond"===(g=ne(g)||"millisecond")?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(g).valueOf())}function Ln(e,g){var t=f(e)?e:jt(e);return!(!this.isValid()||!t.isValid())&&("millisecond"===(g=ne(g)||"millisecond")?this.valueOf()<t.valueOf():this.clone().endOf(g).valueOf()<t.valueOf())}function Tn(e,g,t,n){var I=f(e)?e:jt(e),r=f(g)?g:jt(g);return!!(this.isValid()&&I.isValid()&&r.isValid())&&("("===(n=n||"()")[0]?this.isAfter(I,t):!this.isBefore(I,t))&&(")"===n[1]?this.isBefore(r,t):!this.isAfter(r,t))}function Dn(e,g){var t,n=f(e)?e:jt(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(g=ne(g)||"millisecond")?this.valueOf()===n.valueOf():(t=n.valueOf(),this.clone().startOf(g).valueOf()<=t&&t<=this.clone().endOf(g).valueOf()))}function jn(e,g){return this.isSame(e,g)||this.isAfter(e,g)}function Pn(e,g){return this.isSame(e,g)||this.isBefore(e,g)}function On(e,g,t){var n,I,r;if(!this.isValid())return NaN;if(!(n=sn(e,this)).isValid())return NaN;switch(I=6e4*(n.utcOffset()-this.utcOffset()),g=ne(g)){case"year":r=_n(this,n)/12;break;case"month":r=_n(this,n);break;case"quarter":r=_n(this,n)/3;break;case"second":r=(this-n)/1e3;break;case"minute":r=(this-n)/6e4;break;case"hour":r=(this-n)/36e5;break;case"day":r=(this-n-I)/864e5;break;case"week":r=(this-n-I)/6048e5;break;default:r=this-n}return t?r:oe(r)}function _n(e,g){if(e.date()<g.date())return-_n(g,e);var t=12*(g.year()-e.year())+(g.month()-e.month()),n=e.clone().add(t,"months");return-(t+(g-n<0?(g-n)/(n-e.clone().add(t-1,"months")):(g-n)/(e.clone().add(t+1,"months")-n)))||0}function qn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function $n(e){if(!this.isValid())return null;var g=!0!==e,t=g?this.clone().utc():this;return t.year()<0||t.year()>9999?U(t,g?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):k(Date.prototype.toISOString)?g?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",U(t,"Z")):U(t,g?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function eI(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,g,t,n,I="moment",r="";return this.isLocal()||(I=0===this.utcOffset()?"moment.utc":"moment.parseZone",r="Z"),e="["+I+'("]',g=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",t="-MM-DD[T]HH:mm:ss.SSS",n=r+'[")]',this.format(e+g+t+n)}function gI(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var g=U(this,e);return this.localeData().postformat(g)}function tI(e,g){return this.isValid()&&(f(e)&&e.isValid()||jt(e).isValid())?Vn({to:this,from:e}).locale(this.locale()).humanize(!g):this.localeData().invalidDate()}function nI(e){return this.from(jt(),e)}function II(e,g){return this.isValid()&&(f(e)&&e.isValid()||jt(e).isValid())?Vn({from:this,to:e}).locale(this.locale()).humanize(!g):this.localeData().invalidDate()}function rI(e){return this.to(jt(),e)}function CI(e){var g;return void 0===e?this._locale._abbr:(null!=(g=ht(e))&&(this._locale=g),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var lI=v("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function aI(){return this._locale}var oI=1e3,iI=60*oI,cI=60*iI,uI=3506328*cI;function sI(e,g){return(e%g+g)%g}function AI(e,g,t){return e<100&&e>=0?new Date(e+400,g,t)-uI:new Date(e,g,t).valueOf()}function dI(e,g,t){return e<100&&e>=0?Date.UTC(e+400,g,t)-uI:Date.UTC(e,g,t)}function mI(e){var g,t;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(t=this._isUTC?dI:AI,e){case"year":g=t(this.year(),0,1);break;case"quarter":g=t(this.year(),this.month()-this.month()%3,1);break;case"month":g=t(this.year(),this.month(),1);break;case"week":g=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":g=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":g=t(this.year(),this.month(),this.date());break;case"hour":g=this._d.valueOf(),g-=sI(g+(this._isUTC?0:this.utcOffset()*iI),cI);break;case"minute":g=this._d.valueOf(),g-=sI(g,iI);break;case"second":g=this._d.valueOf(),g-=sI(g,oI)}return this._d.setTime(g),n.updateOffset(this,!0),this}function hI(e){var g,t;if(void 0===(e=ne(e))||"millisecond"===e||!this.isValid())return this;switch(t=this._isUTC?dI:AI,e){case"year":g=t(this.year()+1,0,1)-1;break;case"quarter":g=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":g=t(this.year(),this.month()+1,1)-1;break;case"week":g=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":g=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":g=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":g=this._d.valueOf(),g+=cI-sI(g+(this._isUTC?0:this.utcOffset()*iI),cI)-1;break;case"minute":g=this._d.valueOf(),g+=iI-sI(g,iI)-1;break;case"second":g=this._d.valueOf(),g+=oI-sI(g,oI)-1}return this._d.setTime(g),n.updateOffset(this,!0),this}function bI(){return this._d.valueOf()-6e4*(this._offset||0)}function ZI(){return Math.floor(this.valueOf()/1e3)}function pI(){return new Date(this.valueOf())}function yI(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function GI(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function fI(){return this.isValid()?this.toISOString():null}function BI(){return h(this)}function vI(){return s({},m(this))}function SI(){return m(this).overflow}function WI(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function VI(e,g){var t,I,r,C=this._eras||ht("en")._eras;for(t=0,I=C.length;t<I;++t)switch("string"===typeof C[t].since&&(r=n(C[t].since).startOf("day"),C[t].since=r.valueOf()),typeof C[t].until){case"undefined":C[t].until=1/0;break;case"string":r=n(C[t].until).startOf("day").valueOf(),C[t].until=r.valueOf()}return C}function kI(e,g,t){var n,I,r,C,l,a=this.eras();for(e=e.toUpperCase(),n=0,I=a.length;n<I;++n)if(r=a[n].name.toUpperCase(),C=a[n].abbr.toUpperCase(),l=a[n].narrow.toUpperCase(),t)switch(g){case"N":case"NN":case"NNN":if(C===e)return a[n];break;case"NNNN":if(r===e)return a[n];break;case"NNNNN":if(l===e)return a[n]}else if([r,C,l].indexOf(e)>=0)return a[n]}function RI(e,g){var t=e.since<=e.until?1:-1;return void 0===g?n(e.since).year():n(e.since).year()+(g-e.offset)*t}function XI(){var e,g,t,n=this.localeData().eras();for(e=0,g=n.length;e<g;++e){if(t=this.clone().startOf("day").valueOf(),n[e].since<=t&&t<=n[e].until)return n[e].name;if(n[e].until<=t&&t<=n[e].since)return n[e].name}return""}function JI(){var e,g,t,n=this.localeData().eras();for(e=0,g=n.length;e<g;++e){if(t=this.clone().startOf("day").valueOf(),n[e].since<=t&&t<=n[e].until)return n[e].narrow;if(n[e].until<=t&&t<=n[e].since)return n[e].narrow}return""}function YI(){var e,g,t,n=this.localeData().eras();for(e=0,g=n.length;e<g;++e){if(t=this.clone().startOf("day").valueOf(),n[e].since<=t&&t<=n[e].until)return n[e].abbr;if(n[e].until<=t&&t<=n[e].since)return n[e].abbr}return""}function wI(){var e,g,t,I,r=this.localeData().eras();for(e=0,g=r.length;e<g;++e)if(t=r[e].since<=r[e].until?1:-1,I=this.clone().startOf("day").valueOf(),r[e].since<=I&&I<=r[e].until||r[e].until<=I&&I<=r[e].since)return(this.year()-n(r[e].since).year())*t+r[e].offset;return this.year()}function HI(e){return l(this,"_erasNameRegex")||zI.call(this),e?this._erasNameRegex:this._erasRegex}function NI(e){return l(this,"_erasAbbrRegex")||zI.call(this),e?this._erasAbbrRegex:this._erasRegex}function FI(e){return l(this,"_erasNarrowRegex")||zI.call(this),e?this._erasNarrowRegex:this._erasRegex}function KI(e,g){return g.erasAbbrRegex(e)}function xI(e,g){return g.erasNameRegex(e)}function EI(e,g){return g.erasNarrowRegex(e)}function MI(e,g){return g._eraYearOrdinalRegex||Ve}function zI(){var e,g,t=[],n=[],I=[],r=[],C=this.eras();for(e=0,g=C.length;e<g;++e)n.push(Fe(C[e].name)),t.push(Fe(C[e].abbr)),I.push(Fe(C[e].narrow)),r.push(Fe(C[e].name)),r.push(Fe(C[e].abbr)),r.push(Fe(C[e].narrow));this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+n.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+I.join("|")+")","i")}function UI(e,g){E(0,[e,e.length],0,g)}function QI(e){return OI.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function LI(e){return OI.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function TI(){return fg(this.year(),1,4)}function DI(){return fg(this.isoWeekYear(),1,4)}function jI(){var e=this.localeData()._week;return fg(this.year(),e.dow,e.doy)}function PI(){var e=this.localeData()._week;return fg(this.weekYear(),e.dow,e.doy)}function OI(e,g,t,n,I){var r;return null==e?Gg(this,n,I).year:(g>(r=fg(e,n,I))&&(g=r),_I.call(this,e,g,t,n,I))}function _I(e,g,t,n,I){var r=yg(e,g,t,n,I),C=Zg(r.year,0,r.dayOfYear);return this.year(C.getUTCFullYear()),this.month(C.getUTCMonth()),this.date(C.getUTCDate()),this}function qI(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}E("N",0,0,"eraAbbr"),E("NN",0,0,"eraAbbr"),E("NNN",0,0,"eraAbbr"),E("NNNN",0,0,"eraName"),E("NNNNN",0,0,"eraNarrow"),E("y",["y",1],"yo","eraYear"),E("y",["yy",2],0,"eraYear"),E("y",["yyy",3],0,"eraYear"),E("y",["yyyy",4],0,"eraYear"),we("N",KI),we("NN",KI),we("NNN",KI),we("NNNN",xI),we("NNNNN",EI),xe(["N","NN","NNN","NNNN","NNNNN"],(function(e,g,t,n){var I=t._locale.erasParse(e,n,t._strict);I?m(t).era=I:m(t).invalidEra=e})),we("y",Ve),we("yy",Ve),we("yyy",Ve),we("yyyy",Ve),we("yo",MI),xe(["y","yy","yyy","yyyy"],Ue),xe(["yo"],(function(e,g,t,n){var I;t._locale._eraYearOrdinalRegex&&(I=e.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?g[Ue]=t._locale.eraYearOrdinalParse(e,I):g[Ue]=parseInt(e,10)})),E(0,["gg",2],0,(function(){return this.weekYear()%100})),E(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),UI("gggg","weekYear"),UI("ggggg","weekYear"),UI("GGGG","isoWeekYear"),UI("GGGGG","isoWeekYear"),te("weekYear","gg"),te("isoWeekYear","GG"),Ce("weekYear",1),Ce("isoWeekYear",1),we("G",ke),we("g",ke),we("GG",Ge,be),we("gg",Ge,be),we("GGGG",Se,pe),we("gggg",Se,pe),we("GGGGG",We,ye),we("ggggg",We,ye),Ee(["gggg","ggggg","GGGG","GGGGG"],(function(e,g,t,n){g[n.substr(0,2)]=ie(e)})),Ee(["gg","GG"],(function(e,g,t,I){g[I]=n.parseTwoDigitYear(e)})),E("Q",0,"Qo","quarter"),te("quarter","Q"),Ce("quarter",7),we("Q",he),xe("Q",(function(e,g){g[Qe]=3*(ie(e)-1)})),E("D",["DD",2],"Do","date"),te("date","D"),Ce("date",9),we("D",Ge),we("DD",Ge,be),we("Do",(function(e,g){return e?g._dayOfMonthOrdinalParse||g._ordinalParse:g._dayOfMonthOrdinalParseLenient})),xe(["D","DD"],Le),xe("Do",(function(e,g){g[Le]=ie(e.match(Ge)[0])}));var $I=ce("Date",!0);function er(e){var g=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?g:this.add(e-g,"d")}E("DDD",["DDDD",3],"DDDo","dayOfYear"),te("dayOfYear","DDD"),Ce("dayOfYear",4),we("DDD",ve),we("DDDD",Ze),xe(["DDD","DDDD"],(function(e,g,t){t._dayOfYear=ie(e)})),E("m",["mm",2],0,"minute"),te("minute","m"),Ce("minute",14),we("m",Ge),we("mm",Ge,be),xe(["m","mm"],De);var gr=ce("Minutes",!1);E("s",["ss",2],0,"second"),te("second","s"),Ce("second",15),we("s",Ge),we("ss",Ge,be),xe(["s","ss"],je);var tr,nr,Ir=ce("Seconds",!1);for(E("S",0,0,(function(){return~~(this.millisecond()/100)})),E(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),E(0,["SSS",3],0,"millisecond"),E(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),E(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),E(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),E(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),E(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),E(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),te("millisecond","ms"),Ce("millisecond",16),we("S",ve,he),we("SS",ve,be),we("SSS",ve,Ze),tr="SSSS";tr.length<=9;tr+="S")we(tr,Ve);function rr(e,g){g[Pe]=ie(1e3*("0."+e))}for(tr="S";tr.length<=9;tr+="S")xe(tr,rr);function Cr(){return this._isUTC?"UTC":""}function lr(){return this._isUTC?"Coordinated Universal Time":""}nr=ce("Milliseconds",!1),E("z",0,0,"zoneAbbr"),E("zz",0,0,"zoneName");var ar=G.prototype;function or(e){return jt(1e3*e)}function ir(){return jt.apply(null,arguments).parseZone()}function cr(e){return e}ar.add=wn,ar.calendar=zn,ar.clone=Un,ar.diff=On,ar.endOf=hI,ar.format=gI,ar.from=tI,ar.fromNow=nI,ar.to=II,ar.toNow=rI,ar.get=Ae,ar.invalidAt=SI,ar.isAfter=Qn,ar.isBefore=Ln,ar.isBetween=Tn,ar.isSame=Dn,ar.isSameOrAfter=jn,ar.isSameOrBefore=Pn,ar.isValid=BI,ar.lang=lI,ar.locale=CI,ar.localeData=aI,ar.max=Ot,ar.min=Pt,ar.parsingFlags=vI,ar.set=de,ar.startOf=mI,ar.subtract=Hn,ar.toArray=yI,ar.toObject=GI,ar.toDate=pI,ar.toISOString=$n,ar.inspect=eI,"undefined"!==typeof Symbol&&null!=Symbol.for&&(ar[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),ar.toJSON=fI,ar.toString=qn,ar.unix=ZI,ar.valueOf=bI,ar.creationData=WI,ar.eraName=XI,ar.eraNarrow=JI,ar.eraAbbr=YI,ar.eraYear=wI,ar.year=mg,ar.isLeapYear=hg,ar.weekYear=QI,ar.isoWeekYear=LI,ar.quarter=ar.quarters=qI,ar.month=ig,ar.daysInMonth=cg,ar.week=ar.weeks=Vg,ar.isoWeek=ar.isoWeeks=kg,ar.weeksInYear=jI,ar.weeksInWeekYear=PI,ar.isoWeeksInYear=TI,ar.isoWeeksInISOWeekYear=DI,ar.date=$I,ar.day=ar.days=Qg,ar.weekday=Lg,ar.isoWeekday=Tg,ar.dayOfYear=er,ar.hour=ar.hours=nt,ar.minute=ar.minutes=gr,ar.second=ar.seconds=Ir,ar.millisecond=ar.milliseconds=nr,ar.utcOffset=dn,ar.utc=hn,ar.local=bn,ar.parseZone=Zn,ar.hasAlignedHourOffset=pn,ar.isDST=yn,ar.isLocal=fn,ar.isUtcOffset=Bn,ar.isUtc=vn,ar.isUTC=vn,ar.zoneAbbr=Cr,ar.zoneName=lr,ar.dates=v("dates accessor is deprecated. Use date instead.",$I),ar.months=v("months accessor is deprecated. Use month instead",ig),ar.years=v("years accessor is deprecated. Use year instead",mg),ar.zone=v("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mn),ar.isDSTShifted=v("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Gn);var ur=J.prototype;function sr(e,g,t,n){var I=ht(),r=A().set(n,g);return I[t](r,e)}function Ar(e,g,t){if(i(e)&&(g=e,e=void 0),e=e||"",null!=g)return sr(e,g,t,"month");var n,I=[];for(n=0;n<12;n++)I[n]=sr(e,n,t,"month");return I}function dr(e,g,t,n){"boolean"===typeof e?(i(g)&&(t=g,g=void 0),g=g||""):(t=g=e,e=!1,i(g)&&(t=g,g=void 0),g=g||"");var I,r=ht(),C=e?r._week.dow:0,l=[];if(null!=t)return sr(g,(t+C)%7,n,"day");for(I=0;I<7;I++)l[I]=sr(g,(I+C)%7,n,"day");return l}function mr(e,g){return Ar(e,g,"months")}function hr(e,g){return Ar(e,g,"monthsShort")}function br(e,g,t){return dr(e,g,t,"weekdays")}function Zr(e,g,t){return dr(e,g,t,"weekdaysShort")}function pr(e,g,t){return dr(e,g,t,"weekdaysMin")}ur.calendar=w,ur.longDateFormat=T,ur.invalidDate=j,ur.ordinal=_,ur.preparse=cr,ur.postformat=cr,ur.relativeTime=$,ur.pastFuture=ee,ur.set=R,ur.eras=VI,ur.erasParse=kI,ur.erasConvertYear=RI,ur.erasAbbrRegex=NI,ur.erasNameRegex=HI,ur.erasNarrowRegex=FI,ur.months=rg,ur.monthsShort=Cg,ur.monthsParse=ag,ur.monthsRegex=sg,ur.monthsShortRegex=ug,ur.week=Bg,ur.firstDayOfYear=Wg,ur.firstDayOfWeek=Sg,ur.weekdays=xg,ur.weekdaysMin=Mg,ur.weekdaysShort=Eg,ur.weekdaysParse=Ug,ur.weekdaysRegex=Dg,ur.weekdaysShortRegex=jg,ur.weekdaysMinRegex=Pg,ur.isPM=gt,ur.meridiem=It,At("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var g=e%10;return e+(1===ie(e%100/10)?"th":1===g?"st":2===g?"nd":3===g?"rd":"th")}}),n.lang=v("moment.lang is deprecated. Use moment.locale instead.",At),n.langData=v("moment.langData is deprecated. Use moment.localeData instead.",ht);var yr=Math.abs;function Gr(){var e=this._data;return this._milliseconds=yr(this._milliseconds),this._days=yr(this._days),this._months=yr(this._months),e.milliseconds=yr(e.milliseconds),e.seconds=yr(e.seconds),e.minutes=yr(e.minutes),e.hours=yr(e.hours),e.months=yr(e.months),e.years=yr(e.years),this}function fr(e,g,t,n){var I=Vn(g,t);return e._milliseconds+=n*I._milliseconds,e._days+=n*I._days,e._months+=n*I._months,e._bubble()}function Br(e,g){return fr(this,e,g,1)}function vr(e,g){return fr(this,e,g,-1)}function Sr(e){return e<0?Math.floor(e):Math.ceil(e)}function Wr(){var e,g,t,n,I,r=this._milliseconds,C=this._days,l=this._months,a=this._data;return r>=0&&C>=0&&l>=0||r<=0&&C<=0&&l<=0||(r+=864e5*Sr(kr(l)+C),C=0,l=0),a.milliseconds=r%1e3,e=oe(r/1e3),a.seconds=e%60,g=oe(e/60),a.minutes=g%60,t=oe(g/60),a.hours=t%24,C+=oe(t/24),l+=I=oe(Vr(C)),C-=Sr(kr(I)),n=oe(l/12),l%=12,a.days=C,a.months=l,a.years=n,this}function Vr(e){return 4800*e/146097}function kr(e){return 146097*e/4800}function Rr(e){if(!this.isValid())return NaN;var g,t,n=this._milliseconds;if("month"===(e=ne(e))||"quarter"===e||"year"===e)switch(g=this._days+n/864e5,t=this._months+Vr(g),e){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(g=this._days+Math.round(kr(this._months)),e){case"week":return g/7+n/6048e5;case"day":return g+n/864e5;case"hour":return 24*g+n/36e5;case"minute":return 1440*g+n/6e4;case"second":return 86400*g+n/1e3;case"millisecond":return Math.floor(864e5*g)+n;default:throw new Error("Unknown unit "+e)}}function Xr(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*ie(this._months/12):NaN}function Jr(e){return function(){return this.as(e)}}var Yr=Jr("ms"),wr=Jr("s"),Hr=Jr("m"),Nr=Jr("h"),Fr=Jr("d"),Kr=Jr("w"),xr=Jr("M"),Er=Jr("Q"),Mr=Jr("y");function zr(){return Vn(this)}function Ur(e){return e=ne(e),this.isValid()?this[e+"s"]():NaN}function Qr(e){return function(){return this.isValid()?this._data[e]:NaN}}var Lr=Qr("milliseconds"),Tr=Qr("seconds"),Dr=Qr("minutes"),jr=Qr("hours"),Pr=Qr("days"),Or=Qr("months"),_r=Qr("years");function qr(){return oe(this.days()/7)}var $r=Math.round,eC={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function gC(e,g,t,n,I){return I.relativeTime(g||1,!!t,e,n)}function tC(e,g,t,n){var I=Vn(e).abs(),r=$r(I.as("s")),C=$r(I.as("m")),l=$r(I.as("h")),a=$r(I.as("d")),o=$r(I.as("M")),i=$r(I.as("w")),c=$r(I.as("y")),u=r<=t.ss&&["s",r]||r<t.s&&["ss",r]||C<=1&&["m"]||C<t.m&&["mm",C]||l<=1&&["h"]||l<t.h&&["hh",l]||a<=1&&["d"]||a<t.d&&["dd",a];return null!=t.w&&(u=u||i<=1&&["w"]||i<t.w&&["ww",i]),(u=u||o<=1&&["M"]||o<t.M&&["MM",o]||c<=1&&["y"]||["yy",c])[2]=g,u[3]=+e>0,u[4]=n,gC.apply(null,u)}function nC(e){return void 0===e?$r:"function"===typeof e&&($r=e,!0)}function IC(e,g){return void 0!==eC[e]&&(void 0===g?eC[e]:(eC[e]=g,"s"===e&&(eC.ss=g-1),!0))}function rC(e,g){if(!this.isValid())return this.localeData().invalidDate();var t,n,I=!1,r=eC;return"object"===typeof e&&(g=e,e=!1),"boolean"===typeof e&&(I=e),"object"===typeof g&&(r=Object.assign({},eC,g),null!=g.s&&null==g.ss&&(r.ss=g.s-1)),n=tC(this,!I,r,t=this.localeData()),I&&(n=t.pastFuture(+this,n)),t.postformat(n)}var CC=Math.abs;function lC(e){return(e>0)-(e<0)||+e}function aC(){if(!this.isValid())return this.localeData().invalidDate();var e,g,t,n,I,r,C,l,a=CC(this._milliseconds)/1e3,o=CC(this._days),i=CC(this._months),c=this.asSeconds();return c?(e=oe(a/60),g=oe(e/60),a%=60,e%=60,t=oe(i/12),i%=12,n=a?a.toFixed(3).replace(/\.?0+$/,""):"",I=c<0?"-":"",r=lC(this._months)!==lC(c)?"-":"",C=lC(this._days)!==lC(c)?"-":"",l=lC(this._milliseconds)!==lC(c)?"-":"",I+"P"+(t?r+t+"Y":"")+(i?r+i+"M":"")+(o?C+o+"D":"")+(g||e||a?"T":"")+(g?l+g+"H":"")+(e?l+e+"M":"")+(a?l+n+"S":"")):"P0D"}var oC=rn.prototype;return oC.isValid=nn,oC.abs=Gr,oC.add=Br,oC.subtract=vr,oC.as=Rr,oC.asMilliseconds=Yr,oC.asSeconds=wr,oC.asMinutes=Hr,oC.asHours=Nr,oC.asDays=Fr,oC.asWeeks=Kr,oC.asMonths=xr,oC.asQuarters=Er,oC.asYears=Mr,oC.valueOf=Xr,oC._bubble=Wr,oC.clone=zr,oC.get=Ur,oC.milliseconds=Lr,oC.seconds=Tr,oC.minutes=Dr,oC.hours=jr,oC.days=Pr,oC.weeks=qr,oC.months=Or,oC.years=_r,oC.humanize=rC,oC.toISOString=aC,oC.toString=aC,oC.toJSON=aC,oC.locale=CI,oC.localeData=aI,oC.toIsoString=v("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",aC),oC.lang=lI,E("X",0,0,"unix"),E("x",0,0,"valueOf"),we("x",ke),we("X",Je),xe("X",(function(e,g,t){t._d=new Date(1e3*parseFloat(e))})),xe("x",(function(e,g,t){t._d=new Date(ie(e))})),n.version="2.29.4",I(jt),n.fn=ar,n.min=qt,n.max=$t,n.now=en,n.utc=A,n.unix=or,n.months=mr,n.isDate=c,n.locale=At,n.invalid=b,n.duration=Vn,n.isMoment=f,n.weekdays=br,n.parseZone=ir,n.localeData=ht,n.isDuration=Cn,n.monthsShort=hr,n.weekdaysMin=pr,n.defineLocale=dt,n.updateLocale=mt,n.locales=bt,n.weekdaysShort=Zr,n.normalizeUnits=ne,n.relativeTimeRounding=nC,n.relativeTimeThreshold=IC,n.calendarFormat=Mn,n.prototype=ar,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}()},3573:function(e,g,t){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(){for(var e=arguments.length,g=Array(e),t=0;t<e;t++)g[t]=arguments[t];return(0,r.default)((function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var I=null;return g.forEach((function(e){if(null==I){var g=e.apply(void 0,t);null!=g&&(I=g)}})),I}))};var n,I=t(6054),r=(n=I)&&n.__esModule?n:{default:n};e.exports=g.default},6054:function(e,g){"use strict";Object.defineProperty(g,"__esModule",{value:!0}),g.default=function(e){function g(g,t,n,I,r,C){var l=I||"<<anonymous>>",a=C||n;if(null==t[n])return g?new Error("Required "+r+" `"+a+"` was not specified in `"+l+"`."):null;for(var o=arguments.length,i=Array(o>6?o-6:0),c=6;c<o;c++)i[c-6]=arguments[c];return e.apply(void 0,[t,n,l,r,a].concat(i))}var t=g.bind(null,!1);return t.isRequired=g.bind(null,!0),t},e.exports=g.default},888:function(e,g,t){"use strict";var n=t(9047);function I(){}function r(){}r.resetWarningCache=I,e.exports=function(){function e(e,g,t,I,r,C){if(C!==n){var l=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function g(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:g,element:e,elementType:e,instanceOf:g,node:e,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:r,resetWarningCache:I};return t.PropTypes=t,t}},2007:function(e,g,t){e.exports=t(888)()},9047:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2758:function(e){"use strict";function g(e){this._maxSize=e,this.clear()}g.prototype.clear=function(){this._size=0,this._values=Object.create(null)},g.prototype.get=function(e){return this._values[e]},g.prototype.set=function(e,g){return this._size>=this._maxSize&&this.clear(),e in this._values||this._size++,this._values[e]=g};var t=/[^.^\]^[]+|(?=\[\]|\.\.)/g,n=/^\d+$/,I=/^\d/,r=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,C=/^\s*(['"]?)(.*?)(\1)\s*$/,l=new g(512),a=new g(512),o=new g(512);function i(e){return l.get(e)||l.set(e,c(e).map((function(e){return e.replace(C,"$2")})))}function c(e){return e.match(t)||[""]}function u(e){return"string"===typeof e&&e&&-1!==["'",'"'].indexOf(e.charAt(0))}function s(e){return!u(e)&&(function(e){return e.match(I)&&!e.match(n)}(e)||function(e){return r.test(e)}(e))}e.exports={Cache:g,split:c,normalizePath:i,setter:function(e){var g=i(e);return a.get(e)||a.set(e,(function(e,t){for(var n=0,I=g.length,r=e;n<I-1;){var C=g[n];if("__proto__"===C||"constructor"===C||"prototype"===C)return e;r=r[g[n++]]}r[g[n]]=t}))},getter:function(e,g){var t=i(e);return o.get(e)||o.set(e,(function(e){for(var n=0,I=t.length;n<I;){if(null==e&&g)return;e=e[t[n++]]}return e}))},join:function(e){return e.reduce((function(e,g){return e+(u(g)||n.test(g)?"["+g+"]":(e?".":"")+g)}),"")},forEach:function(e,g,t){!function(e,g,t){var n,I,r,C,l=e.length;for(I=0;I<l;I++)(n=e[I])&&(s(n)&&(n='"'+n+'"'),r=!(C=u(n))&&/^\d+$/.test(n),g.call(t,n,C,r,I,e))}(Array.isArray(e)?e:c(e),g,t)}}},741:function(e,g,t){var n=t(6887),I=t(5054),r=t(416),C=t(9413);function l(e,g,t,r,C){var l=[].slice.call(arguments,1),a=l.length,o="function"===typeof l[a-1];if(!o&&!n())throw new Error("Callback required as last argument");if(!o){if(a<1)throw new Error("Too few arguments provided");return 1===a?(t=g,g=r=void 0):2!==a||g.getContext||(r=t,t=g,g=void 0),new Promise((function(n,C){try{var l=I.create(t,r);n(e(l,g,r))}catch(a){C(a)}}))}if(a<2)throw new Error("Too few arguments provided");2===a?(C=t,t=g,g=r=void 0):3===a&&(g.getContext&&"undefined"===typeof C?(C=r,r=void 0):(C=r,r=t,t=g,g=void 0));try{var i=I.create(t,r);C(null,e(i,g,r))}catch(c){C(c)}}g.create=I.create,g.toCanvas=l.bind(null,r.render),g.toDataURL=l.bind(null,r.renderToDataURL),g.toString=l.bind(null,(function(e,g,t){return C.render(e,t)}))},6887:function(e){e.exports=function(){return"function"===typeof Promise&&Promise.prototype&&Promise.prototype.then}},3234:function(e,g,t){var n=t(2338).getSymbolSize;g.getRowColCoords=function(e){if(1===e)return[];for(var g=Math.floor(e/7)+2,t=n(e),I=145===t?26:2*Math.ceil((t-13)/(2*g-2)),r=[t-7],C=1;C<g-1;C++)r[C]=r[C-1]-I;return r.push(6),r.reverse()},g.getPositions=function(e){for(var t=[],n=g.getRowColCoords(e),I=n.length,r=0;r<I;r++)for(var C=0;C<I;C++)0===r&&0===C||0===r&&C===I-1||r===I-1&&0===C||t.push([n[r],n[C]]);return t}},8295:function(e,g,t){var n=t(1337),I=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(e){this.mode=n.ALPHANUMERIC,this.data=e}r.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(e){var g;for(g=0;g+2<=this.data.length;g+=2){var t=45*I.indexOf(this.data[g]);t+=I.indexOf(this.data[g+1]),e.put(t,11)}this.data.length%2&&e.put(I.indexOf(this.data[g]),6)},e.exports=r},5673:function(e){function g(){this.buffer=[],this.length=0}g.prototype={get:function(e){var g=Math.floor(e/8);return 1===(this.buffer[g]>>>7-e%8&1)},put:function(e,g){for(var t=0;t<g;t++)this.putBit(1===(e>>>g-t-1&1))},getLengthInBits:function(){return this.length},putBit:function(e){var g=Math.floor(this.length/8);this.buffer.length<=g&&this.buffer.push(0),e&&(this.buffer[g]|=128>>>this.length%8),this.length++}},e.exports=g},2988:function(e){function g(e){if(!e||e<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}g.prototype.set=function(e,g,t,n){var I=e*this.size+g;this.data[I]=t,n&&(this.reservedBit[I]=!0)},g.prototype.get=function(e,g){return this.data[e*this.size+g]},g.prototype.xor=function(e,g,t){this.data[e*this.size+g]^=t},g.prototype.isReserved=function(e,g){return this.reservedBit[e*this.size+g]},e.exports=g},639:function(e,g,t){var n=t(153),I=t(1337);function r(e){this.mode=I.BYTE,"string"===typeof e&&(e=n(e)),this.data=new Uint8Array(e)}r.getBitsLength=function(e){return 8*e},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(e){for(var g=0,t=this.data.length;g<t;g++)e.put(this.data[g],8)},e.exports=r},3180:function(e,g,t){var n=t(8955),I=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];g.getBlocksCount=function(e,g){switch(g){case n.L:return I[4*(e-1)+0];case n.M:return I[4*(e-1)+1];case n.Q:return I[4*(e-1)+2];case n.H:return I[4*(e-1)+3];default:return}},g.getTotalCodewordsCount=function(e,g){switch(g){case n.L:return r[4*(e-1)+0];case n.M:return r[4*(e-1)+1];case n.Q:return r[4*(e-1)+2];case n.H:return r[4*(e-1)+3];default:return}}},8955:function(e,g){g.L={bit:1},g.M={bit:0},g.Q={bit:3},g.H={bit:2},g.isValid=function(e){return e&&"undefined"!==typeof e.bit&&e.bit>=0&&e.bit<4},g.from=function(e,t){if(g.isValid(e))return e;try{return function(e){if("string"!==typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return g.L;case"m":case"medium":return g.M;case"q":case"quartile":return g.Q;case"h":case"high":return g.H;default:throw new Error("Unknown EC Level: "+e)}}(e)}catch(n){return t}}},8947:function(e,g,t){var n=t(2338).getSymbolSize;g.getPositions=function(e){var g=n(e);return[[0,0],[g-7,0],[0,g-7]]}},7435:function(e,g,t){var n=t(2338),I=n.getBCHDigit(1335);g.getEncodedBits=function(e,g){for(var t=e.bit<<3|g,r=t<<10;n.getBCHDigit(r)-I>=0;)r^=1335<<n.getBCHDigit(r)-I;return 21522^(t<<10|r)}},1239:function(e,g){var t=new Uint8Array(512),n=new Uint8Array(256);!function(){for(var e=1,g=0;g<255;g++)t[g]=e,n[e]=g,256&(e<<=1)&&(e^=285);for(var I=255;I<512;I++)t[I]=t[I-255]}(),g.log=function(e){if(e<1)throw new Error("log("+e+")");return n[e]},g.exp=function(e){return t[e]},g.mul=function(e,g){return 0===e||0===g?0:t[n[e]+n[g]]}},8588:function(e,g,t){var n=t(1337),I=t(2338);function r(e){this.mode=n.KANJI,this.data=e}r.getBitsLength=function(e){return 13*e},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(e){var g;for(g=0;g<this.data.length;g++){var t=I.toSJIS(this.data[g]);if(t>=33088&&t<=40956)t-=33088;else{if(!(t>=57408&&t<=60351))throw new Error("Invalid SJIS character: "+this.data[g]+"\nMake sure your charset is UTF-8");t-=49472}t=192*(t>>>8&255)+(255&t),e.put(t,13)}},e.exports=r},6823:function(e,g){g.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var t=3,n=3,I=40,r=10;function C(e,t,n){switch(e){case g.Patterns.PATTERN000:return(t+n)%2===0;case g.Patterns.PATTERN001:return t%2===0;case g.Patterns.PATTERN010:return n%3===0;case g.Patterns.PATTERN011:return(t+n)%3===0;case g.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2===0;case g.Patterns.PATTERN101:return t*n%2+t*n%3===0;case g.Patterns.PATTERN110:return(t*n%2+t*n%3)%2===0;case g.Patterns.PATTERN111:return(t*n%3+(t+n)%2)%2===0;default:throw new Error("bad maskPattern:"+e)}}g.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},g.from=function(e){return g.isValid(e)?parseInt(e,10):void 0},g.getPenaltyN1=function(e){for(var g=e.size,n=0,I=0,r=0,C=null,l=null,a=0;a<g;a++){I=r=0,C=l=null;for(var o=0;o<g;o++){var i=e.get(a,o);i===C?I++:(I>=5&&(n+=t+(I-5)),C=i,I=1),(i=e.get(o,a))===l?r++:(r>=5&&(n+=t+(r-5)),l=i,r=1)}I>=5&&(n+=t+(I-5)),r>=5&&(n+=t+(r-5))}return n},g.getPenaltyN2=function(e){for(var g=e.size,t=0,I=0;I<g-1;I++)for(var r=0;r<g-1;r++){var C=e.get(I,r)+e.get(I,r+1)+e.get(I+1,r)+e.get(I+1,r+1);4!==C&&0!==C||t++}return t*n},g.getPenaltyN3=function(e){for(var g=e.size,t=0,n=0,r=0,C=0;C<g;C++){n=r=0;for(var l=0;l<g;l++)n=n<<1&2047|e.get(C,l),l>=10&&(1488===n||93===n)&&t++,r=r<<1&2047|e.get(l,C),l>=10&&(1488===r||93===r)&&t++}return t*I},g.getPenaltyN4=function(e){for(var g=0,t=e.data.length,n=0;n<t;n++)g+=e.data[n];return Math.abs(Math.ceil(100*g/t/5)-10)*r},g.applyMask=function(e,g){for(var t=g.size,n=0;n<t;n++)for(var I=0;I<t;I++)g.isReserved(I,n)||g.xor(I,n,C(e,I,n))},g.getBestMask=function(e,t){for(var n=Object.keys(g.Patterns).length,I=0,r=1/0,C=0;C<n;C++){t(C),g.applyMask(C,e);var l=g.getPenaltyN1(e)+g.getPenaltyN2(e)+g.getPenaltyN3(e)+g.getPenaltyN4(e);g.applyMask(C,e),l<r&&(r=l,I=C)}return I}},1337:function(e,g,t){var n=t(8402),I=t(8650);g.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},g.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},g.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},g.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},g.MIXED={bit:-1},g.getCharCountIndicator=function(e,g){if(!e.ccBits)throw new Error("Invalid mode: "+e);if(!n.isValid(g))throw new Error("Invalid version: "+g);return g>=1&&g<10?e.ccBits[0]:g<27?e.ccBits[1]:e.ccBits[2]},g.getBestModeForData=function(e){return I.testNumeric(e)?g.NUMERIC:I.testAlphanumeric(e)?g.ALPHANUMERIC:I.testKanji(e)?g.KANJI:g.BYTE},g.toString=function(e){if(e&&e.id)return e.id;throw new Error("Invalid mode")},g.isValid=function(e){return e&&e.bit&&e.ccBits},g.from=function(e,t){if(g.isValid(e))return e;try{return function(e){if("string"!==typeof e)throw new Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return g.NUMERIC;case"alphanumeric":return g.ALPHANUMERIC;case"kanji":return g.KANJI;case"byte":return g.BYTE;default:throw new Error("Unknown mode: "+e)}}(e)}catch(n){return t}}},320:function(e,g,t){var n=t(1337);function I(e){this.mode=n.NUMERIC,this.data=e.toString()}I.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},I.prototype.getLength=function(){return this.data.length},I.prototype.getBitsLength=function(){return I.getBitsLength(this.data.length)},I.prototype.write=function(e){var g,t,n;for(g=0;g+3<=this.data.length;g+=3)t=this.data.substr(g,3),n=parseInt(t,10),e.put(n,10);var I=this.data.length-g;I>0&&(t=this.data.substr(g),n=parseInt(t,10),e.put(n,3*I+1))},e.exports=I},9203:function(e,g,t){var n=t(1239);g.mul=function(e,g){for(var t=new Uint8Array(e.length+g.length-1),I=0;I<e.length;I++)for(var r=0;r<g.length;r++)t[I+r]^=n.mul(e[I],g[r]);return t},g.mod=function(e,g){for(var t=new Uint8Array(e);t.length-g.length>=0;){for(var I=t[0],r=0;r<g.length;r++)t[r]^=n.mul(g[r],I);for(var C=0;C<t.length&&0===t[C];)C++;t=t.slice(C)}return t},g.generateECPolynomial=function(e){for(var t=new Uint8Array([1]),I=0;I<e;I++)t=g.mul(t,new Uint8Array([1,n.exp(I)]));return t}},5054:function(e,g,t){var n=t(2338),I=t(8955),r=t(5673),C=t(2988),l=t(3234),a=t(8947),o=t(6823),i=t(3180),c=t(220),u=t(1265),s=t(7435),A=t(1337),d=t(2179);function m(e,g,t){var n,I,r=e.size,C=s.getEncodedBits(g,t);for(n=0;n<15;n++)I=1===(C>>n&1),n<6?e.set(n,8,I,!0):n<8?e.set(n+1,8,I,!0):e.set(r-15+n,8,I,!0),n<8?e.set(8,r-n-1,I,!0):n<9?e.set(8,15-n-1+1,I,!0):e.set(8,15-n-1,I,!0);e.set(r-8,8,1,!0)}function h(e,g,t){var I=new r;t.forEach((function(g){I.put(g.mode.bit,4),I.put(g.getLength(),A.getCharCountIndicator(g.mode,e)),g.write(I)}));var C=8*(n.getSymbolTotalCodewords(e)-i.getTotalCodewordsCount(e,g));for(I.getLengthInBits()+4<=C&&I.put(0,4);I.getLengthInBits()%8!==0;)I.putBit(0);for(var l=(C-I.getLengthInBits())/8,a=0;a<l;a++)I.put(a%2?17:236,8);return function(e,g,t){for(var I=n.getSymbolTotalCodewords(g),r=i.getTotalCodewordsCount(g,t),C=I-r,l=i.getBlocksCount(g,t),a=l-I%l,o=Math.floor(I/l),u=Math.floor(C/l),s=u+1,A=o-u,d=new c(A),m=0,h=new Array(l),b=new Array(l),Z=0,p=new Uint8Array(e.buffer),y=0;y<l;y++){var G=y<a?u:s;h[y]=p.slice(m,m+G),b[y]=d.encode(h[y]),m+=G,Z=Math.max(Z,G)}var f,B,v=new Uint8Array(I),S=0;for(f=0;f<Z;f++)for(B=0;B<l;B++)f<h[B].length&&(v[S++]=h[B][f]);for(f=0;f<A;f++)for(B=0;B<l;B++)v[S++]=b[B][f];return v}(I,e,g)}function b(e,g,t,I){var r;if(Array.isArray(e))r=d.fromArray(e);else{if("string"!==typeof e)throw new Error("Invalid data");var i=g;if(!i){var c=d.rawSplit(e);i=u.getBestVersionForData(c,t)}r=d.fromString(e,i||40)}var s=u.getBestVersionForData(r,t);if(!s)throw new Error("The amount of data is too big to be stored in a QR Code");if(g){if(g<s)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+s+".\n")}else g=s;var A=h(g,t,r),b=n.getSymbolSize(g),Z=new C(b);return function(e,g){for(var t=e.size,n=a.getPositions(g),I=0;I<n.length;I++)for(var r=n[I][0],C=n[I][1],l=-1;l<=7;l++)if(!(r+l<=-1||t<=r+l))for(var o=-1;o<=7;o++)C+o<=-1||t<=C+o||(l>=0&&l<=6&&(0===o||6===o)||o>=0&&o<=6&&(0===l||6===l)||l>=2&&l<=4&&o>=2&&o<=4?e.set(r+l,C+o,!0,!0):e.set(r+l,C+o,!1,!0))}(Z,g),function(e){for(var g=e.size,t=8;t<g-8;t++){var n=t%2===0;e.set(t,6,n,!0),e.set(6,t,n,!0)}}(Z),function(e,g){for(var t=l.getPositions(g),n=0;n<t.length;n++)for(var I=t[n][0],r=t[n][1],C=-2;C<=2;C++)for(var a=-2;a<=2;a++)-2===C||2===C||-2===a||2===a||0===C&&0===a?e.set(I+C,r+a,!0,!0):e.set(I+C,r+a,!1,!0)}(Z,g),m(Z,t,0),g>=7&&function(e,g){for(var t,n,I,r=e.size,C=u.getEncodedBits(g),l=0;l<18;l++)t=Math.floor(l/3),n=l%3+r-8-3,I=1===(C>>l&1),e.set(t,n,I,!0),e.set(n,t,I,!0)}(Z,g),function(e,g){for(var t=e.size,n=-1,I=t-1,r=7,C=0,l=t-1;l>0;l-=2)for(6===l&&l--;;){for(var a=0;a<2;a++)if(!e.isReserved(I,l-a)){var o=!1;C<g.length&&(o=1===(g[C]>>>r&1)),e.set(I,l-a,o),-1===--r&&(C++,r=7)}if((I+=n)<0||t<=I){I-=n,n=-n;break}}}(Z,A),isNaN(I)&&(I=o.getBestMask(Z,m.bind(null,Z,t))),o.applyMask(I,Z),m(Z,t,I),{modules:Z,version:g,errorCorrectionLevel:t,maskPattern:I,segments:r}}g.create=function(e,g){if("undefined"===typeof e||""===e)throw new Error("No input text");var t,r,C=I.M;return"undefined"!==typeof g&&(C=I.from(g.errorCorrectionLevel,I.M),t=u.from(g.version),r=o.from(g.maskPattern),g.toSJISFunc&&n.setToSJISFunction(g.toSJISFunc)),b(e,t,C,r)}},220:function(e,g,t){var n=t(9203);function I(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}I.prototype.initialize=function(e){this.degree=e,this.genPoly=n.generateECPolynomial(this.degree)},I.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var g=new Uint8Array(e.length+this.degree);g.set(e);var t=n.mod(g,this.genPoly),I=this.degree-t.length;if(I>0){var r=new Uint8Array(this.degree);return r.set(t,I),r}return t},e.exports=I},8650:function(e,g){var t="[0-9]+",n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",I="(?:(?![A-Z0-9 $%*+\\-./:]|"+(n=n.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";g.KANJI=new RegExp(n,"g"),g.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),g.BYTE=new RegExp(I,"g"),g.NUMERIC=new RegExp(t,"g"),g.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var r=new RegExp("^"+n+"$"),C=new RegExp("^"+t+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");g.testKanji=function(e){return r.test(e)},g.testNumeric=function(e){return C.test(e)},g.testAlphanumeric=function(e){return l.test(e)}},2179:function(e,g,t){var n=t(1337),I=t(320),r=t(8295),C=t(639),l=t(8588),a=t(8650),o=t(2338),i=t(951);function c(e){return unescape(encodeURIComponent(e)).length}function u(e,g,t){for(var n,I=[];null!==(n=e.exec(t));)I.push({data:n[0],index:n.index,mode:g,length:n[0].length});return I}function s(e){var g,t,I=u(a.NUMERIC,n.NUMERIC,e),r=u(a.ALPHANUMERIC,n.ALPHANUMERIC,e);return o.isKanjiModeEnabled()?(g=u(a.BYTE,n.BYTE,e),t=u(a.KANJI,n.KANJI,e)):(g=u(a.BYTE_KANJI,n.BYTE,e),t=[]),I.concat(r,g,t).sort((function(e,g){return e.index-g.index})).map((function(e){return{data:e.data,mode:e.mode,length:e.length}}))}function A(e,g){switch(g){case n.NUMERIC:return I.getBitsLength(e);case n.ALPHANUMERIC:return r.getBitsLength(e);case n.KANJI:return l.getBitsLength(e);case n.BYTE:return C.getBitsLength(e)}}function d(e,g){var t,a=n.getBestModeForData(e);if((t=n.from(g,a))!==n.BYTE&&t.bit<a.bit)throw new Error('"'+e+'" cannot be encoded with mode '+n.toString(t)+".\n Suggested mode is: "+n.toString(a));switch(t!==n.KANJI||o.isKanjiModeEnabled()||(t=n.BYTE),t){case n.NUMERIC:return new I(e);case n.ALPHANUMERIC:return new r(e);case n.KANJI:return new l(e);case n.BYTE:return new C(e)}}g.fromArray=function(e){return e.reduce((function(e,g){return"string"===typeof g?e.push(d(g,null)):g.data&&e.push(d(g.data,g.mode)),e}),[])},g.fromString=function(e,t){for(var I=function(e){for(var g=[],t=0;t<e.length;t++){var I=e[t];switch(I.mode){case n.NUMERIC:g.push([I,{data:I.data,mode:n.ALPHANUMERIC,length:I.length},{data:I.data,mode:n.BYTE,length:I.length}]);break;case n.ALPHANUMERIC:g.push([I,{data:I.data,mode:n.BYTE,length:I.length}]);break;case n.KANJI:g.push([I,{data:I.data,mode:n.BYTE,length:c(I.data)}]);break;case n.BYTE:g.push([{data:I.data,mode:n.BYTE,length:c(I.data)}])}}return g}(s(e,o.isKanjiModeEnabled())),r=function(e,g){for(var t={},I={start:{}},r=["start"],C=0;C<e.length;C++){for(var l=e[C],a=[],o=0;o<l.length;o++){var i=l[o],c=""+C+o;a.push(c),t[c]={node:i,lastCount:0},I[c]={};for(var u=0;u<r.length;u++){var s=r[u];t[s]&&t[s].node.mode===i.mode?(I[s][c]=A(t[s].lastCount+i.length,i.mode)-A(t[s].lastCount,i.mode),t[s].lastCount+=i.length):(t[s]&&(t[s].lastCount=i.length),I[s][c]=A(i.length,i.mode)+4+n.getCharCountIndicator(i.mode,g))}}r=a}for(var d=0;d<r.length;d++)I[r[d]].end=0;return{map:I,table:t}}(I,t),C=i.find_path(r.map,"start","end"),l=[],a=1;a<C.length-1;a++)l.push(r.table[C[a]].node);return g.fromArray(function(e){return e.reduce((function(e,g){var t=e.length-1>=0?e[e.length-1]:null;return t&&t.mode===g.mode?(e[e.length-1].data+=g.data,e):(e.push(g),e)}),[])}(l))},g.rawSplit=function(e){return g.fromArray(s(e,o.isKanjiModeEnabled()))}},2338:function(e,g){var t,n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];g.getSymbolSize=function(e){if(!e)throw new Error('"version" cannot be null or undefined');if(e<1||e>40)throw new Error('"version" should be in range from 1 to 40');return 4*e+17},g.getSymbolTotalCodewords=function(e){return n[e]},g.getBCHDigit=function(e){for(var g=0;0!==e;)g++,e>>>=1;return g},g.setToSJISFunction=function(e){if("function"!==typeof e)throw new Error('"toSJISFunc" is not a valid function.');t=e},g.isKanjiModeEnabled=function(){return"undefined"!==typeof t},g.toSJIS=function(e){return t(e)}},8402:function(e,g){g.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},1265:function(e,g,t){var n=t(2338),I=t(3180),r=t(8955),C=t(1337),l=t(8402),a=n.getBCHDigit(7973);function o(e,g){return C.getCharCountIndicator(e,g)+4}function i(e,g){var t=0;return e.forEach((function(e){var n=o(e.mode,g);t+=n+e.getBitsLength()})),t}g.from=function(e,g){return l.isValid(e)?parseInt(e,10):g},g.getCapacity=function(e,g,t){if(!l.isValid(e))throw new Error("Invalid QR Code version");"undefined"===typeof t&&(t=C.BYTE);var r=8*(n.getSymbolTotalCodewords(e)-I.getTotalCodewordsCount(e,g));if(t===C.MIXED)return r;var a=r-o(t,e);switch(t){case C.NUMERIC:return Math.floor(a/10*3);case C.ALPHANUMERIC:return Math.floor(a/11*2);case C.KANJI:return Math.floor(a/13);case C.BYTE:default:return Math.floor(a/8)}},g.getBestVersionForData=function(e,t){var n,I=r.from(t,r.M);if(Array.isArray(e)){if(e.length>1)return function(e,t){for(var n=1;n<=40;n++)if(i(e,n)<=g.getCapacity(n,t,C.MIXED))return n}(e,I);if(0===e.length)return 1;n=e[0]}else n=e;return function(e,t,n){for(var I=1;I<=40;I++)if(t<=g.getCapacity(I,n,e))return I}(n.mode,n.getLength(),I)},g.getEncodedBits=function(e){if(!l.isValid(e)||e<7)throw new Error("Invalid QR Code version");for(var g=e<<12;n.getBCHDigit(g)-a>=0;)g^=7973<<n.getBCHDigit(g)-a;return e<<12|g}},416:function(e,g,t){var n=t(3605);g.render=function(e,g,t){var I=t,r=g;"undefined"!==typeof I||g&&g.getContext||(I=g,g=void 0),g||(r=function(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}()),I=n.getOptions(I);var C=n.getImageWidth(e.modules.size,I),l=r.getContext("2d"),a=l.createImageData(C,C);return n.qrToImageData(a.data,e,I),function(e,g,t){e.clearRect(0,0,g.width,g.height),g.style||(g.style={}),g.height=t,g.width=t,g.style.height=t+"px",g.style.width=t+"px"}(l,r,C),l.putImageData(a,0,0),r},g.renderToDataURL=function(e,t,n){var I=n;"undefined"!==typeof I||t&&t.getContext||(I=t,t=void 0),I||(I={});var r=g.render(e,t,I),C=I.type||"image/png",l=I.rendererOpts||{};return r.toDataURL(C,l.quality)}},9413:function(e,g,t){var n=t(3605);function I(e,g){var t=e.a/255,n=g+'="'+e.hex+'"';return t<1?n+" "+g+'-opacity="'+t.toFixed(2).slice(1)+'"':n}function r(e,g,t){var n=e+g;return"undefined"!==typeof t&&(n+=" "+t),n}g.render=function(e,g,t){var C=n.getOptions(g),l=e.modules.size,a=e.modules.data,o=l+2*C.margin,i=C.color.light.a?"<path "+I(C.color.light,"fill")+' d="M0 0h'+o+"v"+o+'H0z"/>':"",c="<path "+I(C.color.dark,"stroke")+' d="'+function(e,g,t){for(var n="",I=0,C=!1,l=0,a=0;a<e.length;a++){var o=Math.floor(a%g),i=Math.floor(a/g);o||C||(C=!0),e[a]?(l++,a>0&&o>0&&e[a-1]||(n+=C?r("M",o+t,.5+i+t):r("m",I,0),I=0,C=!1),o+1<g&&e[a+1]||(n+=r("h",l),l=0)):I++}return n}(a,l,C.margin)+'"/>',u='viewBox="0 0 '+o+" "+o+'"',s='<svg xmlns="http://www.w3.org/2000/svg" '+(C.width?'width="'+C.width+'" height="'+C.width+'" ':"")+u+' shape-rendering="crispEdges">'+i+c+"</svg>\n";return"function"===typeof t&&t(null,s),s}},3605:function(e,g){function t(e){if("number"===typeof e&&(e=e.toString()),"string"!==typeof e)throw new Error("Color should be defined as hex string");var g=e.slice().replace("#","").split("");if(g.length<3||5===g.length||g.length>8)throw new Error("Invalid hex color: "+e);3!==g.length&&4!==g.length||(g=Array.prototype.concat.apply([],g.map((function(e){return[e,e]})))),6===g.length&&g.push("F","F");var t=parseInt(g.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:255&t,hex:"#"+g.slice(0,6).join("")}}g.getOptions=function(e){e||(e={}),e.color||(e.color={});var g="undefined"===typeof e.margin||null===e.margin||e.margin<0?4:e.margin,n=e.width&&e.width>=21?e.width:void 0,I=e.scale||4;return{width:n,scale:n?4:I,margin:g,color:{dark:t(e.color.dark||"#000000ff"),light:t(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},g.getScale=function(e,g){return g.width&&g.width>=e+2*g.margin?g.width/(e+2*g.margin):g.scale},g.getImageWidth=function(e,t){var n=g.getScale(e,t);return Math.floor((e+2*t.margin)*n)},g.qrToImageData=function(e,t,n){for(var I=t.modules.size,r=t.modules.data,C=g.getScale(I,n),l=Math.floor((I+2*n.margin)*C),a=n.margin*C,o=[n.color.light,n.color.dark],i=0;i<l;i++)for(var c=0;c<l;c++){var u=4*(i*l+c),s=n.color.light;if(i>=a&&c>=a&&i<l-a&&c<l-a)s=o[r[Math.floor((i-a)/C)*I+Math.floor((c-a)/C)]?1:0];e[u++]=s.r,e[u++]=s.g,e[u++]=s.b,e[u]=s.a}}},4463:function(e,g,t){"use strict";var n=t(2791),I=t(5296);function r(e){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+e,t=1;t<arguments.length;t++)g+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+e+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var C=new Set,l={};function a(e,g){o(e,g),o(e+"Capture",g)}function o(e,g){for(l[e]=g,e=0;e<g.length;e++)C.add(g[e])}var i=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,s={},A={};function d(e,g,t,n,I,r,C){this.acceptsBooleans=2===g||3===g||4===g,this.attributeName=n,this.attributeNamespace=I,this.mustUseProperty=t,this.propertyName=e,this.type=g,this.sanitizeURL=r,this.removeEmptyString=C}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new d(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var g=e[0];m[g]=new d(g,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new d(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new d(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new d(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new d(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new d(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new d(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new d(e,5,!1,e.toLowerCase(),null,!1,!1)}));var h=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function Z(e,g,t,n){var I=m.hasOwnProperty(g)?m[g]:null;(null!==I?0!==I.type:n||!(2<g.length)||"o"!==g[0]&&"O"!==g[0]||"n"!==g[1]&&"N"!==g[1])&&(function(e,g,t,n){if(null===g||"undefined"===typeof g||function(e,g,t,n){if(null!==t&&0===t.type)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==t?!t.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,g,t,n))return!0;if(n)return!1;if(null!==t)switch(t.type){case 3:return!g;case 4:return!1===g;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}(g,t,I,n)&&(t=null),n||null===I?function(e){return!!c.call(A,e)||!c.call(s,e)&&(u.test(e)?A[e]=!0:(s[e]=!0,!1))}(g)&&(null===t?e.removeAttribute(g):e.setAttribute(g,""+t)):I.mustUseProperty?e[I.propertyName]=null===t?3!==I.type&&"":t:(g=I.attributeName,n=I.attributeNamespace,null===t?e.removeAttribute(g):(t=3===(I=I.type)||4===I&&!0===t?"":""+t,n?e.setAttributeNS(n,g,t):e.setAttribute(g,t))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var g=e.replace(h,b);m[g]=new d(g,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var g=e.replace(h,b);m[g]=new d(g,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var g=e.replace(h,b);m[g]=new d(g,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new d(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new d("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new d(e,1,!1,e.toLowerCase(),null,!0,!0)}));var p=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,y=Symbol.for("react.element"),G=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),W=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),J=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var Y=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var w=Symbol.iterator;function H(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=w&&e[w]||e["@@iterator"])?e:null}var N,F=Object.assign;function K(e){if(void 0===N)try{throw Error()}catch(t){var g=t.stack.trim().match(/\n( *(at )?)/);N=g&&g[1]||""}return"\n"+N+e}var x=!1;function E(e,g){if(!e||x)return"";x=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(g,[])}catch(o){var n=o}Reflect.construct(e,[],g)}else{try{g.call()}catch(o){n=o}e.call(g.prototype)}else{try{throw Error()}catch(o){n=o}e()}}catch(o){if(o&&n&&"string"===typeof o.stack){for(var I=o.stack.split("\n"),r=n.stack.split("\n"),C=I.length-1,l=r.length-1;1<=C&&0<=l&&I[C]!==r[l];)l--;for(;1<=C&&0<=l;C--,l--)if(I[C]!==r[l]){if(1!==C||1!==l)do{if(C--,0>--l||I[C]!==r[l]){var a="\n"+I[C].replace(" at new "," at ");return e.displayName&&a.includes("<anonymous>")&&(a=a.replace("<anonymous>",e.displayName)),a}}while(1<=C&&0<=l);break}}}finally{x=!1,Error.prepareStackTrace=t}return(e=e?e.displayName||e.name:"")?K(e):""}function M(e){switch(e.tag){case 5:return K(e.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return e=E(e.type,!1);case 11:return e=E(e.type.render,!1);case 1:return e=E(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case f:return"Fragment";case G:return"Portal";case v:return"Profiler";case B:return"StrictMode";case k:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case W:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case V:var g=e.render;return(e=e.displayName)||(e=""!==(e=g.displayName||g.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case X:return null!==(g=e.displayName||null)?g:z(e.type)||"Memo";case J:g=e._payload,e=e._init;try{return z(e(g))}catch(t){}}return null}function U(e){var g=e.type;switch(e.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=g.render).displayName||e.name||"",g.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z(g);case 8:return g===B?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof g)return g.displayName||g.name||null;if("string"===typeof g)return g}return null}function Q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function L(e){var g=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===g||"radio"===g)}function T(e){e._valueTracker||(e._valueTracker=function(e){var g=L(e)?"checked":"value",t=Object.getOwnPropertyDescriptor(e.constructor.prototype,g),n=""+e[g];if(!e.hasOwnProperty(g)&&"undefined"!==typeof t&&"function"===typeof t.get&&"function"===typeof t.set){var I=t.get,r=t.set;return Object.defineProperty(e,g,{configurable:!0,get:function(){return I.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,g,{enumerable:t.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[g]}}}}(e))}function D(e){if(!e)return!1;var g=e._valueTracker;if(!g)return!0;var t=g.getValue(),n="";return e&&(n=L(e)?e.checked?"true":"false":e.value),(e=n)!==t&&(g.setValue(e),!0)}function j(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(g){return e.body}}function P(e,g){var t=g.checked;return F({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=t?t:e._wrapperState.initialChecked})}function O(e,g){var t=null==g.defaultValue?"":g.defaultValue,n=null!=g.checked?g.checked:g.defaultChecked;t=Q(null!=g.value?g.value:t),e._wrapperState={initialChecked:n,initialValue:t,controlled:"checkbox"===g.type||"radio"===g.type?null!=g.checked:null!=g.value}}function _(e,g){null!=(g=g.checked)&&Z(e,"checked",g,!1)}function q(e,g){_(e,g);var t=Q(g.value),n=g.type;if(null!=t)"number"===n?(0===t&&""===e.value||e.value!=t)&&(e.value=""+t):e.value!==""+t&&(e.value=""+t);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");g.hasOwnProperty("value")?ee(e,g.type,t):g.hasOwnProperty("defaultValue")&&ee(e,g.type,Q(g.defaultValue)),null==g.checked&&null!=g.defaultChecked&&(e.defaultChecked=!!g.defaultChecked)}function $(e,g,t){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var n=g.type;if(!("submit"!==n&&"reset"!==n||void 0!==g.value&&null!==g.value))return;g=""+e._wrapperState.initialValue,t||g===e.value||(e.value=g),e.defaultValue=g}""!==(t=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==t&&(e.name=t)}function ee(e,g,t){"number"===g&&j(e.ownerDocument)===e||(null==t?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+t&&(e.defaultValue=""+t))}var ge=Array.isArray;function te(e,g,t,n){if(e=e.options,g){g={};for(var I=0;I<t.length;I++)g["$"+t[I]]=!0;for(t=0;t<e.length;t++)I=g.hasOwnProperty("$"+e[t].value),e[t].selected!==I&&(e[t].selected=I),I&&n&&(e[t].defaultSelected=!0)}else{for(t=""+Q(t),g=null,I=0;I<e.length;I++){if(e[I].value===t)return e[I].selected=!0,void(n&&(e[I].defaultSelected=!0));null!==g||e[I].disabled||(g=e[I])}null!==g&&(g.selected=!0)}}function ne(e,g){if(null!=g.dangerouslySetInnerHTML)throw Error(r(91));return F({},g,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ie(e,g){var t=g.value;if(null==t){if(t=g.children,g=g.defaultValue,null!=t){if(null!=g)throw Error(r(92));if(ge(t)){if(1<t.length)throw Error(r(93));t=t[0]}g=t}null==g&&(g=""),t=g}e._wrapperState={initialValue:Q(t)}}function re(e,g){var t=Q(g.value),n=Q(g.defaultValue);null!=t&&((t=""+t)!==e.value&&(e.value=t),null==g.defaultValue&&e.defaultValue!==t&&(e.defaultValue=t)),null!=n&&(e.defaultValue=""+n)}function Ce(e){var g=e.textContent;g===e._wrapperState.initialValue&&""!==g&&null!==g&&(e.value=g)}function le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ae(e,g){return null==e||"http://www.w3.org/1999/xhtml"===e?le(g):"http://www.w3.org/2000/svg"===e&&"foreignObject"===g?"http://www.w3.org/1999/xhtml":e}var oe,ie,ce=(ie=function(e,g){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=g;else{for((oe=oe||document.createElement("div")).innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=oe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;g.firstChild;)e.appendChild(g.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,g,t,n){MSApp.execUnsafeLocalFunction((function(){return ie(e,g)}))}:ie);function ue(e,g){if(g){var t=e.firstChild;if(t&&t===e.lastChild&&3===t.nodeType)return void(t.nodeValue=g)}e.textContent=g}var se={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ae=["Webkit","ms","Moz","O"];function de(e,g,t){return null==g||"boolean"===typeof g||""===g?"":t||"number"!==typeof g||0===g||se.hasOwnProperty(e)&&se[e]?(""+g).trim():g+"px"}function me(e,g){for(var t in e=e.style,g)if(g.hasOwnProperty(t)){var n=0===t.indexOf("--"),I=de(t,g[t],n);"float"===t&&(t="cssFloat"),n?e.setProperty(t,I):e[t]=I}}Object.keys(se).forEach((function(e){Ae.forEach((function(g){g=g+e.charAt(0).toUpperCase()+e.substring(1),se[g]=se[e]}))}));var he=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,g){if(g){if(he[e]&&(null!=g.children||null!=g.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=g.dangerouslySetInnerHTML){if(null!=g.children)throw Error(r(60));if("object"!==typeof g.dangerouslySetInnerHTML||!("__html"in g.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=g.style&&"object"!==typeof g.style)throw Error(r(62))}}function Ze(e,g){if(-1===e.indexOf("-"))return"string"===typeof g.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pe=null;function ye(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ge=null,fe=null,Be=null;function ve(e){if(e=ZI(e)){if("function"!==typeof Ge)throw Error(r(280));var g=e.stateNode;g&&(g=yI(g),Ge(e.stateNode,e.type,g))}}function Se(e){fe?Be?Be.push(e):Be=[e]:fe=e}function We(){if(fe){var e=fe,g=Be;if(Be=fe=null,ve(e),g)for(e=0;e<g.length;e++)ve(g[e])}}function Ve(e,g){return e(g)}function ke(){}var Re=!1;function Xe(e,g,t){if(Re)return e(g,t);Re=!0;try{return Ve(e,g,t)}finally{Re=!1,(null!==fe||null!==Be)&&(ke(),We())}}function Je(e,g){var t=e.stateNode;if(null===t)return null;var n=yI(t);if(null===n)return null;t=n[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(t&&"function"!==typeof t)throw Error(r(231,g,typeof t));return t}var Ye=!1;if(i)try{var we={};Object.defineProperty(we,"passive",{get:function(){Ye=!0}}),window.addEventListener("test",we,we),window.removeEventListener("test",we,we)}catch(ie){Ye=!1}function He(e,g,t,n,I,r,C,l,a){var o=Array.prototype.slice.call(arguments,3);try{g.apply(t,o)}catch(i){this.onError(i)}}var Ne=!1,Fe=null,Ke=!1,xe=null,Ee={onError:function(e){Ne=!0,Fe=e}};function Me(e,g,t,n,I,r,C,l,a){Ne=!1,Fe=null,He.apply(Ee,arguments)}function ze(e){var g=e,t=e;if(e.alternate)for(;g.return;)g=g.return;else{e=g;do{0!==(4098&(g=e).flags)&&(t=g.return),e=g.return}while(e)}return 3===g.tag?t:null}function Ue(e){if(13===e.tag){var g=e.memoizedState;if(null===g&&(null!==(e=e.alternate)&&(g=e.memoizedState)),null!==g)return g.dehydrated}return null}function Qe(e){if(ze(e)!==e)throw Error(r(188))}function Le(e){return null!==(e=function(e){var g=e.alternate;if(!g){if(null===(g=ze(e)))throw Error(r(188));return g!==e?null:e}for(var t=e,n=g;;){var I=t.return;if(null===I)break;var C=I.alternate;if(null===C){if(null!==(n=I.return)){t=n;continue}break}if(I.child===C.child){for(C=I.child;C;){if(C===t)return Qe(I),e;if(C===n)return Qe(I),g;C=C.sibling}throw Error(r(188))}if(t.return!==n.return)t=I,n=C;else{for(var l=!1,a=I.child;a;){if(a===t){l=!0,t=I,n=C;break}if(a===n){l=!0,n=I,t=C;break}a=a.sibling}if(!l){for(a=C.child;a;){if(a===t){l=!0,t=C,n=I;break}if(a===n){l=!0,n=C,t=I;break}a=a.sibling}if(!l)throw Error(r(189))}}if(t.alternate!==n)throw Error(r(190))}if(3!==t.tag)throw Error(r(188));return t.stateNode.current===t?e:g}(e))?Te(e):null}function Te(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var g=Te(e);if(null!==g)return g;e=e.sibling}return null}var De=I.unstable_scheduleCallback,je=I.unstable_cancelCallback,Pe=I.unstable_shouldYield,Oe=I.unstable_requestPaint,_e=I.unstable_now,qe=I.unstable_getCurrentPriorityLevel,$e=I.unstable_ImmediatePriority,eg=I.unstable_UserBlockingPriority,gg=I.unstable_NormalPriority,tg=I.unstable_LowPriority,ng=I.unstable_IdlePriority,Ig=null,rg=null;var Cg=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(lg(e)/ag|0)|0},lg=Math.log,ag=Math.LN2;var og=64,ig=4194304;function cg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ug(e,g){var t=e.pendingLanes;if(0===t)return 0;var n=0,I=e.suspendedLanes,r=e.pingedLanes,C=268435455&t;if(0!==C){var l=C&~I;0!==l?n=cg(l):0!==(r&=C)&&(n=cg(r))}else 0!==(C=t&~I)?n=cg(C):0!==r&&(n=cg(r));if(0===n)return 0;if(0!==g&&g!==n&&0===(g&I)&&((I=n&-n)>=(r=g&-g)||16===I&&0!==(4194240&r)))return g;if(0!==(4&n)&&(n|=16&t),0!==(g=e.entangledLanes))for(e=e.entanglements,g&=n;0<g;)I=1<<(t=31-Cg(g)),n|=e[t],g&=~I;return n}function sg(e,g){switch(e){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;default:return-1}}function Ag(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function dg(){var e=og;return 0===(4194240&(og<<=1))&&(og=64),e}function mg(e){for(var g=[],t=0;31>t;t++)g.push(e);return g}function hg(e,g,t){e.pendingLanes|=g,536870912!==g&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[g=31-Cg(g)]=t}function bg(e,g){var t=e.entangledLanes|=g;for(e=e.entanglements;t;){var n=31-Cg(t),I=1<<n;I&g|e[n]&g&&(e[n]|=g),t&=~I}}var Zg=0;function pg(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var yg,Gg,fg,Bg,vg,Sg=!1,Wg=[],Vg=null,kg=null,Rg=null,Xg=new Map,Jg=new Map,Yg=[],wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hg(e,g){switch(e){case"focusin":case"focusout":Vg=null;break;case"dragenter":case"dragleave":kg=null;break;case"mouseover":case"mouseout":Rg=null;break;case"pointerover":case"pointerout":Xg.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jg.delete(g.pointerId)}}function Ng(e,g,t,n,I,r){return null===e||e.nativeEvent!==r?(e={blockedOn:g,domEventName:t,eventSystemFlags:n,nativeEvent:r,targetContainers:[I]},null!==g&&(null!==(g=ZI(g))&&Gg(g)),e):(e.eventSystemFlags|=n,g=e.targetContainers,null!==I&&-1===g.indexOf(I)&&g.push(I),e)}function Fg(e){var g=bI(e.target);if(null!==g){var t=ze(g);if(null!==t)if(13===(g=t.tag)){if(null!==(g=Ue(t)))return e.blockedOn=g,void vg(e.priority,(function(){fg(t)}))}else if(3===g&&t.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===t.tag?t.stateNode.containerInfo:null)}e.blockedOn=null}function Kg(e){if(null!==e.blockedOn)return!1;for(var g=e.targetContainers;0<g.length;){var t=Pg(e.domEventName,e.eventSystemFlags,g[0],e.nativeEvent);if(null!==t)return null!==(g=ZI(t))&&Gg(g),e.blockedOn=t,!1;var n=new(t=e.nativeEvent).constructor(t.type,t);pe=n,t.target.dispatchEvent(n),pe=null,g.shift()}return!0}function xg(e,g,t){Kg(e)&&t.delete(g)}function Eg(){Sg=!1,null!==Vg&&Kg(Vg)&&(Vg=null),null!==kg&&Kg(kg)&&(kg=null),null!==Rg&&Kg(Rg)&&(Rg=null),Xg.forEach(xg),Jg.forEach(xg)}function Mg(e,g){e.blockedOn===g&&(e.blockedOn=null,Sg||(Sg=!0,I.unstable_scheduleCallback(I.unstable_NormalPriority,Eg)))}function zg(e){function g(g){return Mg(g,e)}if(0<Wg.length){Mg(Wg[0],e);for(var t=1;t<Wg.length;t++){var n=Wg[t];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Vg&&Mg(Vg,e),null!==kg&&Mg(kg,e),null!==Rg&&Mg(Rg,e),Xg.forEach(g),Jg.forEach(g),t=0;t<Yg.length;t++)(n=Yg[t]).blockedOn===e&&(n.blockedOn=null);for(;0<Yg.length&&null===(t=Yg[0]).blockedOn;)Fg(t),null===t.blockedOn&&Yg.shift()}var Ug=p.ReactCurrentBatchConfig,Qg=!0;function Lg(e,g,t,n){var I=Zg,r=Ug.transition;Ug.transition=null;try{Zg=1,Dg(e,g,t,n)}finally{Zg=I,Ug.transition=r}}function Tg(e,g,t,n){var I=Zg,r=Ug.transition;Ug.transition=null;try{Zg=4,Dg(e,g,t,n)}finally{Zg=I,Ug.transition=r}}function Dg(e,g,t,n){if(Qg){var I=Pg(e,g,t,n);if(null===I)Qn(e,g,n,jg,t),Hg(e,n);else if(function(e,g,t,n,I){switch(g){case"focusin":return Vg=Ng(Vg,e,g,t,n,I),!0;case"dragenter":return kg=Ng(kg,e,g,t,n,I),!0;case"mouseover":return Rg=Ng(Rg,e,g,t,n,I),!0;case"pointerover":var r=I.pointerId;return Xg.set(r,Ng(Xg.get(r)||null,e,g,t,n,I)),!0;case"gotpointercapture":return r=I.pointerId,Jg.set(r,Ng(Jg.get(r)||null,e,g,t,n,I)),!0}return!1}(I,e,g,t,n))n.stopPropagation();else if(Hg(e,n),4&g&&-1<wg.indexOf(e)){for(;null!==I;){var r=ZI(I);if(null!==r&&yg(r),null===(r=Pg(e,g,t,n))&&Qn(e,g,n,jg,t),r===I)break;I=r}null!==I&&n.stopPropagation()}else Qn(e,g,n,null,t)}}var jg=null;function Pg(e,g,t,n){if(jg=null,null!==(e=bI(e=ye(n))))if(null===(g=ze(e)))e=null;else if(13===(t=g.tag)){if(null!==(e=Ue(g)))return e;e=null}else if(3===t){if(g.stateNode.current.memoizedState.isDehydrated)return 3===g.tag?g.stateNode.containerInfo:null;e=null}else g!==e&&(e=null);return jg=e,null}function Og(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case $e:return 1;case eg:return 4;case gg:case tg:return 16;case ng:return 536870912;default:return 16}default:return 16}}var _g=null,qg=null,$g=null;function et(){if($g)return $g;var e,g,t=qg,n=t.length,I="value"in _g?_g.value:_g.textContent,r=I.length;for(e=0;e<n&&t[e]===I[e];e++);var C=n-e;for(g=1;g<=C&&t[n-g]===I[r-g];g++);return $g=I.slice(e,1<g?1-g:void 0)}function gt(e){var g=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===g&&(e=13):e=g,10===e&&(e=13),32<=e||13===e?e:0}function tt(){return!0}function nt(){return!1}function It(e){function g(g,t,n,I,r){for(var C in this._reactName=g,this._targetInst=n,this.type=t,this.nativeEvent=I,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(C)&&(g=e[C],this[C]=g?g(I):I[C]);return this.isDefaultPrevented=(null!=I.defaultPrevented?I.defaultPrevented:!1===I.returnValue)?tt:nt,this.isPropagationStopped=nt,this}return F(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=tt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=tt)},persist:function(){},isPersistent:tt}),g}var rt,Ct,lt,at={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ot=It(at),it=F({},at,{view:0,detail:0}),ct=It(it),ut=F({},it,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bt,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==lt&&(lt&&"mousemove"===e.type?(rt=e.screenX-lt.screenX,Ct=e.screenY-lt.screenY):Ct=rt=0,lt=e),rt)},movementY:function(e){return"movementY"in e?e.movementY:Ct}}),st=It(ut),At=It(F({},ut,{dataTransfer:0})),dt=It(F({},it,{relatedTarget:0})),mt=It(F({},at,{animationName:0,elapsedTime:0,pseudoElement:0})),ht=F({},at,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bt=It(ht),Zt=It(F({},at,{data:0})),pt={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gt={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ft(e){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(e):!!(e=Gt[e])&&!!g[e]}function Bt(){return ft}var vt=F({},it,{key:function(e){if(e.key){var g=pt[e.key]||e.key;if("Unidentified"!==g)return g}return"keypress"===e.type?13===(e=gt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?yt[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bt,charCode:function(e){return"keypress"===e.type?gt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?gt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),St=It(vt),Wt=It(F({},ut,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Vt=It(F({},it,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bt})),kt=It(F({},at,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rt=F({},ut,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Xt=It(Rt),Jt=[9,13,27,32],Yt=i&&"CompositionEvent"in window,wt=null;i&&"documentMode"in document&&(wt=document.documentMode);var Ht=i&&"TextEvent"in window&&!wt,Nt=i&&(!Yt||wt&&8<wt&&11>=wt),Ft=String.fromCharCode(32),Kt=!1;function xt(e,g){switch(e){case"keyup":return-1!==Jt.indexOf(g.keyCode);case"keydown":return 229!==g.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Et(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Mt=!1;var zt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ut(e){var g=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===g?!!zt[e.type]:"textarea"===g}function Qt(e,g,t,n){Se(n),0<(g=Tn(g,"onChange")).length&&(t=new ot("onChange","change",null,t,n),e.push({event:t,listeners:g}))}var Lt=null,Tt=null;function Dt(e){Kn(e,0)}function jt(e){if(D(pI(e)))return e}function Pt(e,g){if("change"===e)return g}var Ot=!1;if(i){var _t;if(i){var qt="oninput"in document;if(!qt){var $t=document.createElement("div");$t.setAttribute("oninput","return;"),qt="function"===typeof $t.oninput}_t=qt}else _t=!1;Ot=_t&&(!document.documentMode||9<document.documentMode)}function en(){Lt&&(Lt.detachEvent("onpropertychange",gn),Tt=Lt=null)}function gn(e){if("value"===e.propertyName&&jt(Tt)){var g=[];Qt(g,Tt,e,ye(e)),Xe(Dt,g)}}function tn(e,g,t){"focusin"===e?(en(),Tt=t,(Lt=g).attachEvent("onpropertychange",gn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return jt(Tt)}function In(e,g){if("click"===e)return jt(g)}function rn(e,g){if("input"===e||"change"===e)return jt(g)}var Cn="function"===typeof Object.is?Object.is:function(e,g){return e===g&&(0!==e||1/e===1/g)||e!==e&&g!==g};function ln(e,g){if(Cn(e,g))return!0;if("object"!==typeof e||null===e||"object"!==typeof g||null===g)return!1;var t=Object.keys(e),n=Object.keys(g);if(t.length!==n.length)return!1;for(n=0;n<t.length;n++){var I=t[n];if(!c.call(g,I)||!Cn(e[I],g[I]))return!1}return!0}function an(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function on(e,g){var t,n=an(e);for(e=0;n;){if(3===n.nodeType){if(t=e+n.textContent.length,e<=g&&t>=g)return{node:n,offset:g-e};e=t}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=an(n)}}function cn(e,g){return!(!e||!g)&&(e===g||(!e||3!==e.nodeType)&&(g&&3===g.nodeType?cn(e,g.parentNode):"contains"in e?e.contains(g):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(g))))}function un(){for(var e=window,g=j();g instanceof e.HTMLIFrameElement;){try{var t="string"===typeof g.contentWindow.location.href}catch(n){t=!1}if(!t)break;g=j((e=g.contentWindow).document)}return g}function sn(e){var g=e&&e.nodeName&&e.nodeName.toLowerCase();return g&&("input"===g&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===g||"true"===e.contentEditable)}function An(e){var g=un(),t=e.focusedElem,n=e.selectionRange;if(g!==t&&t&&t.ownerDocument&&cn(t.ownerDocument.documentElement,t)){if(null!==n&&sn(t))if(g=n.start,void 0===(e=n.end)&&(e=g),"selectionStart"in t)t.selectionStart=g,t.selectionEnd=Math.min(e,t.value.length);else if((e=(g=t.ownerDocument||document)&&g.defaultView||window).getSelection){e=e.getSelection();var I=t.textContent.length,r=Math.min(n.start,I);n=void 0===n.end?r:Math.min(n.end,I),!e.extend&&r>n&&(I=n,n=r,r=I),I=on(t,r);var C=on(t,n);I&&C&&(1!==e.rangeCount||e.anchorNode!==I.node||e.anchorOffset!==I.offset||e.focusNode!==C.node||e.focusOffset!==C.offset)&&((g=g.createRange()).setStart(I.node,I.offset),e.removeAllRanges(),r>n?(e.addRange(g),e.extend(C.node,C.offset)):(g.setEnd(C.node,C.offset),e.addRange(g)))}for(g=[],e=t;e=e.parentNode;)1===e.nodeType&&g.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof t.focus&&t.focus(),t=0;t<g.length;t++)(e=g[t]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var dn=i&&"documentMode"in document&&11>=document.documentMode,mn=null,hn=null,bn=null,Zn=!1;function pn(e,g,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;Zn||null==mn||mn!==j(n)||("selectionStart"in(n=mn)&&sn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=Tn(hn,"onSelect")).length&&(g=new ot("onSelect","select",null,g,t),e.push({event:g,listeners:n}),g.target=mn)))}function yn(e,g){var t={};return t[e.toLowerCase()]=g.toLowerCase(),t["Webkit"+e]="webkit"+g,t["Moz"+e]="moz"+g,t}var Gn={animationend:yn("Animation","AnimationEnd"),animationiteration:yn("Animation","AnimationIteration"),animationstart:yn("Animation","AnimationStart"),transitionend:yn("Transition","TransitionEnd")},fn={},Bn={};function vn(e){if(fn[e])return fn[e];if(!Gn[e])return e;var g,t=Gn[e];for(g in t)if(t.hasOwnProperty(g)&&g in Bn)return fn[e]=t[g];return e}i&&(Bn=document.createElement("div").style,"AnimationEvent"in window||(delete Gn.animationend.animation,delete Gn.animationiteration.animation,delete Gn.animationstart.animation),"TransitionEvent"in window||delete Gn.transitionend.transition);var Sn=vn("animationend"),Wn=vn("animationiteration"),Vn=vn("animationstart"),kn=vn("transitionend"),Rn=new Map,Xn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jn(e,g){Rn.set(e,g),a(g,[e])}for(var Yn=0;Yn<Xn.length;Yn++){var wn=Xn[Yn];Jn(wn.toLowerCase(),"on"+(wn[0].toUpperCase()+wn.slice(1)))}Jn(Sn,"onAnimationEnd"),Jn(Wn,"onAnimationIteration"),Jn(Vn,"onAnimationStart"),Jn("dblclick","onDoubleClick"),Jn("focusin","onFocus"),Jn("focusout","onBlur"),Jn(kn,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Hn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Hn));function Fn(e,g,t){var n=e.type||"unknown-event";e.currentTarget=t,function(e,g,t,n,I,C,l,a,o){if(Me.apply(this,arguments),Ne){if(!Ne)throw Error(r(198));var i=Fe;Ne=!1,Fe=null,Ke||(Ke=!0,xe=i)}}(n,g,void 0,e),e.currentTarget=null}function Kn(e,g){g=0!==(4&g);for(var t=0;t<e.length;t++){var n=e[t],I=n.event;n=n.listeners;e:{var r=void 0;if(g)for(var C=n.length-1;0<=C;C--){var l=n[C],a=l.instance,o=l.currentTarget;if(l=l.listener,a!==r&&I.isPropagationStopped())break e;Fn(I,l,o),r=a}else for(C=0;C<n.length;C++){if(a=(l=n[C]).instance,o=l.currentTarget,l=l.listener,a!==r&&I.isPropagationStopped())break e;Fn(I,l,o),r=a}}}if(Ke)throw e=xe,Ke=!1,xe=null,e}function xn(e,g){var t=g[dI];void 0===t&&(t=g[dI]=new Set);var n=e+"__bubble";t.has(n)||(Un(g,e,2,!1),t.add(n))}function En(e,g,t){var n=0;g&&(n|=4),Un(t,e,n,g)}var Mn="_reactListening"+Math.random().toString(36).slice(2);function zn(e){if(!e[Mn]){e[Mn]=!0,C.forEach((function(g){"selectionchange"!==g&&(Nn.has(g)||En(g,!1,e),En(g,!0,e))}));var g=9===e.nodeType?e:e.ownerDocument;null===g||g[Mn]||(g[Mn]=!0,En("selectionchange",!1,g))}}function Un(e,g,t,n){switch(Og(g)){case 1:var I=Lg;break;case 4:I=Tg;break;default:I=Dg}t=I.bind(null,g,t,e),I=void 0,!Ye||"touchstart"!==g&&"touchmove"!==g&&"wheel"!==g||(I=!0),n?void 0!==I?e.addEventListener(g,t,{capture:!0,passive:I}):e.addEventListener(g,t,!0):void 0!==I?e.addEventListener(g,t,{passive:I}):e.addEventListener(g,t,!1)}function Qn(e,g,t,n,I){var r=n;if(0===(1&g)&&0===(2&g)&&null!==n)e:for(;;){if(null===n)return;var C=n.tag;if(3===C||4===C){var l=n.stateNode.containerInfo;if(l===I||8===l.nodeType&&l.parentNode===I)break;if(4===C)for(C=n.return;null!==C;){var a=C.tag;if((3===a||4===a)&&((a=C.stateNode.containerInfo)===I||8===a.nodeType&&a.parentNode===I))return;C=C.return}for(;null!==l;){if(null===(C=bI(l)))return;if(5===(a=C.tag)||6===a){n=r=C;continue e}l=l.parentNode}}n=n.return}Xe((function(){var n=r,I=ye(t),C=[];e:{var l=Rn.get(e);if(void 0!==l){var a=ot,o=e;switch(e){case"keypress":if(0===gt(t))break e;case"keydown":case"keyup":a=St;break;case"focusin":o="focus",a=dt;break;case"focusout":o="blur",a=dt;break;case"beforeblur":case"afterblur":a=dt;break;case"click":if(2===t.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=st;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=At;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=Vt;break;case Sn:case Wn:case Vn:a=mt;break;case kn:a=kt;break;case"scroll":a=ct;break;case"wheel":a=Xt;break;case"copy":case"cut":case"paste":a=bt;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=Wt}var i=0!==(4&g),c=!i&&"scroll"===e,u=i?null!==l?l+"Capture":null:l;i=[];for(var s,A=n;null!==A;){var d=(s=A).stateNode;if(5===s.tag&&null!==d&&(s=d,null!==u&&(null!=(d=Je(A,u))&&i.push(Ln(A,d,s)))),c)break;A=A.return}0<i.length&&(l=new a(l,o,null,t,I),C.push({event:l,listeners:i}))}}if(0===(7&g)){if(a="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||t===pe||!(o=t.relatedTarget||t.fromElement)||!bI(o)&&!o[AI])&&(a||l)&&(l=I.window===I?I:(l=I.ownerDocument)?l.defaultView||l.parentWindow:window,a?(a=n,null!==(o=(o=t.relatedTarget||t.toElement)?bI(o):null)&&(o!==(c=ze(o))||5!==o.tag&&6!==o.tag)&&(o=null)):(a=null,o=n),a!==o)){if(i=st,d="onMouseLeave",u="onMouseEnter",A="mouse","pointerout"!==e&&"pointerover"!==e||(i=Wt,d="onPointerLeave",u="onPointerEnter",A="pointer"),c=null==a?l:pI(a),s=null==o?l:pI(o),(l=new i(d,A+"leave",a,t,I)).target=c,l.relatedTarget=s,d=null,bI(I)===n&&((i=new i(u,A+"enter",o,t,I)).target=s,i.relatedTarget=c,d=i),c=d,a&&o)e:{for(u=o,A=0,s=i=a;s;s=Dn(s))A++;for(s=0,d=u;d;d=Dn(d))s++;for(;0<A-s;)i=Dn(i),A--;for(;0<s-A;)u=Dn(u),s--;for(;A--;){if(i===u||null!==u&&i===u.alternate)break e;i=Dn(i),u=Dn(u)}i=null}else i=null;null!==a&&jn(C,l,a,i,!1),null!==o&&null!==c&&jn(C,c,o,i,!0)}if("select"===(a=(l=n?pI(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===a&&"file"===l.type)var m=Pt;else if(Ut(l))if(Ot)m=rn;else{m=nn;var h=tn}else(a=l.nodeName)&&"input"===a.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(m=In);switch(m&&(m=m(e,n))?Qt(C,m,t,I):(h&&h(e,l,n),"focusout"===e&&(h=l._wrapperState)&&h.controlled&&"number"===l.type&&ee(l,"number",l.value)),h=n?pI(n):window,e){case"focusin":(Ut(h)||"true"===h.contentEditable)&&(mn=h,hn=n,bn=null);break;case"focusout":bn=hn=mn=null;break;case"mousedown":Zn=!0;break;case"contextmenu":case"mouseup":case"dragend":Zn=!1,pn(C,t,I);break;case"selectionchange":if(dn)break;case"keydown":case"keyup":pn(C,t,I)}var b;if(Yt)e:{switch(e){case"compositionstart":var Z="onCompositionStart";break e;case"compositionend":Z="onCompositionEnd";break e;case"compositionupdate":Z="onCompositionUpdate";break e}Z=void 0}else Mt?xt(e,t)&&(Z="onCompositionEnd"):"keydown"===e&&229===t.keyCode&&(Z="onCompositionStart");Z&&(Nt&&"ko"!==t.locale&&(Mt||"onCompositionStart"!==Z?"onCompositionEnd"===Z&&Mt&&(b=et()):(qg="value"in(_g=I)?_g.value:_g.textContent,Mt=!0)),0<(h=Tn(n,Z)).length&&(Z=new Zt(Z,e,null,t,I),C.push({event:Z,listeners:h}),b?Z.data=b:null!==(b=Et(t))&&(Z.data=b))),(b=Ht?function(e,g){switch(e){case"compositionend":return Et(g);case"keypress":return 32!==g.which?null:(Kt=!0,Ft);case"textInput":return(e=g.data)===Ft&&Kt?null:e;default:return null}}(e,t):function(e,g){if(Mt)return"compositionend"===e||!Yt&&xt(e,g)?(e=et(),$g=qg=_g=null,Mt=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Nt&&"ko"!==g.locale?null:g.data}}(e,t))&&(0<(n=Tn(n,"onBeforeInput")).length&&(I=new Zt("onBeforeInput","beforeinput",null,t,I),C.push({event:I,listeners:n}),I.data=b))}Kn(C,g)}))}function Ln(e,g,t){return{instance:e,listener:g,currentTarget:t}}function Tn(e,g){for(var t=g+"Capture",n=[];null!==e;){var I=e,r=I.stateNode;5===I.tag&&null!==r&&(I=r,null!=(r=Je(e,t))&&n.unshift(Ln(e,r,I)),null!=(r=Je(e,g))&&n.push(Ln(e,r,I))),e=e.return}return n}function Dn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function jn(e,g,t,n,I){for(var r=g._reactName,C=[];null!==t&&t!==n;){var l=t,a=l.alternate,o=l.stateNode;if(null!==a&&a===n)break;5===l.tag&&null!==o&&(l=o,I?null!=(a=Je(t,r))&&C.unshift(Ln(t,a,l)):I||null!=(a=Je(t,r))&&C.push(Ln(t,a,l))),t=t.return}0!==C.length&&e.push({event:g,listeners:C})}var Pn=/\r\n?/g,On=/\u0000|\uFFFD/g;function _n(e){return("string"===typeof e?e:""+e).replace(Pn,"\n").replace(On,"")}function qn(e,g,t){if(g=_n(g),_n(e)!==g&&t)throw Error(r(425))}function $n(){}var eI=null,gI=null;function tI(e,g){return"textarea"===e||"noscript"===e||"string"===typeof g.children||"number"===typeof g.children||"object"===typeof g.dangerouslySetInnerHTML&&null!==g.dangerouslySetInnerHTML&&null!=g.dangerouslySetInnerHTML.__html}var nI="function"===typeof setTimeout?setTimeout:void 0,II="function"===typeof clearTimeout?clearTimeout:void 0,rI="function"===typeof Promise?Promise:void 0,CI="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof rI?function(e){return rI.resolve(null).then(e).catch(lI)}:nI;function lI(e){setTimeout((function(){throw e}))}function aI(e,g){var t=g,n=0;do{var I=t.nextSibling;if(e.removeChild(t),I&&8===I.nodeType)if("/$"===(t=I.data)){if(0===n)return e.removeChild(I),void zg(g);n--}else"$"!==t&&"$?"!==t&&"$!"!==t||n++;t=I}while(t);zg(g)}function oI(e){for(;null!=e;e=e.nextSibling){var g=e.nodeType;if(1===g||3===g)break;if(8===g){if("$"===(g=e.data)||"$!"===g||"$?"===g)break;if("/$"===g)return null}}return e}function iI(e){e=e.previousSibling;for(var g=0;e;){if(8===e.nodeType){var t=e.data;if("$"===t||"$!"===t||"$?"===t){if(0===g)return e;g--}else"/$"===t&&g++}e=e.previousSibling}return null}var cI=Math.random().toString(36).slice(2),uI="__reactFiber$"+cI,sI="__reactProps$"+cI,AI="__reactContainer$"+cI,dI="__reactEvents$"+cI,mI="__reactListeners$"+cI,hI="__reactHandles$"+cI;function bI(e){var g=e[uI];if(g)return g;for(var t=e.parentNode;t;){if(g=t[AI]||t[uI]){if(t=g.alternate,null!==g.child||null!==t&&null!==t.child)for(e=iI(e);null!==e;){if(t=e[uI])return t;e=iI(e)}return g}t=(e=t).parentNode}return null}function ZI(e){return!(e=e[uI]||e[AI])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function pI(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function yI(e){return e[sI]||null}var GI=[],fI=-1;function BI(e){return{current:e}}function vI(e){0>fI||(e.current=GI[fI],GI[fI]=null,fI--)}function SI(e,g){fI++,GI[fI]=e.current,e.current=g}var WI={},VI=BI(WI),kI=BI(!1),RI=WI;function XI(e,g){var t=e.type.contextTypes;if(!t)return WI;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===g)return n.__reactInternalMemoizedMaskedChildContext;var I,r={};for(I in t)r[I]=g[I];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=g,e.__reactInternalMemoizedMaskedChildContext=r),r}function JI(e){return null!==(e=e.childContextTypes)&&void 0!==e}function YI(){vI(kI),vI(VI)}function wI(e,g,t){if(VI.current!==WI)throw Error(r(168));SI(VI,g),SI(kI,t)}function HI(e,g,t){var n=e.stateNode;if(g=g.childContextTypes,"function"!==typeof n.getChildContext)return t;for(var I in n=n.getChildContext())if(!(I in g))throw Error(r(108,U(e)||"Unknown",I));return F({},t,n)}function NI(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||WI,RI=VI.current,SI(VI,e),SI(kI,kI.current),!0}function FI(e,g,t){var n=e.stateNode;if(!n)throw Error(r(169));t?(e=HI(e,g,RI),n.__reactInternalMemoizedMergedChildContext=e,vI(kI),vI(VI),SI(VI,e)):vI(kI),SI(kI,t)}var KI=null,xI=!1,EI=!1;function MI(e){null===KI?KI=[e]:KI.push(e)}function zI(){if(!EI&&null!==KI){EI=!0;var e=0,g=Zg;try{var t=KI;for(Zg=1;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}KI=null,xI=!1}catch(I){throw null!==KI&&(KI=KI.slice(e+1)),De($e,zI),I}finally{Zg=g,EI=!1}}return null}var UI=[],QI=0,LI=null,TI=0,DI=[],jI=0,PI=null,OI=1,_I="";function qI(e,g){UI[QI++]=TI,UI[QI++]=LI,LI=e,TI=g}function $I(e,g,t){DI[jI++]=OI,DI[jI++]=_I,DI[jI++]=PI,PI=e;var n=OI;e=_I;var I=32-Cg(n)-1;n&=~(1<<I),t+=1;var r=32-Cg(g)+I;if(30<r){var C=I-I%5;r=(n&(1<<C)-1).toString(32),n>>=C,I-=C,OI=1<<32-Cg(g)+I|t<<I|n,_I=r+e}else OI=1<<r|t<<I|n,_I=e}function er(e){null!==e.return&&(qI(e,1),$I(e,1,0))}function gr(e){for(;e===LI;)LI=UI[--QI],UI[QI]=null,TI=UI[--QI],UI[QI]=null;for(;e===PI;)PI=DI[--jI],DI[jI]=null,_I=DI[--jI],DI[jI]=null,OI=DI[--jI],DI[jI]=null}var tr=null,nr=null,Ir=!1,rr=null;function Cr(e,g){var t=Jo(5,null,null,0);t.elementType="DELETED",t.stateNode=g,t.return=e,null===(g=e.deletions)?(e.deletions=[t],e.flags|=16):g.push(t)}function lr(e,g){switch(e.tag){case 5:var t=e.type;return null!==(g=1!==g.nodeType||t.toLowerCase()!==g.nodeName.toLowerCase()?null:g)&&(e.stateNode=g,tr=e,nr=oI(g.firstChild),!0);case 6:return null!==(g=""===e.pendingProps||3!==g.nodeType?null:g)&&(e.stateNode=g,tr=e,nr=null,!0);case 13:return null!==(g=8!==g.nodeType?null:g)&&(t=null!==PI?{id:OI,overflow:_I}:null,e.memoizedState={dehydrated:g,treeContext:t,retryLane:1073741824},(t=Jo(18,null,null,0)).stateNode=g,t.return=e,e.child=t,tr=e,nr=null,!0);default:return!1}}function ar(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function or(e){if(Ir){var g=nr;if(g){var t=g;if(!lr(e,g)){if(ar(e))throw Error(r(418));g=oI(t.nextSibling);var n=tr;g&&lr(e,g)?Cr(n,t):(e.flags=-4097&e.flags|2,Ir=!1,tr=e)}}else{if(ar(e))throw Error(r(418));e.flags=-4097&e.flags|2,Ir=!1,tr=e}}}function ir(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;tr=e}function cr(e){if(e!==tr)return!1;if(!Ir)return ir(e),Ir=!0,!1;var g;if((g=3!==e.tag)&&!(g=5!==e.tag)&&(g="head"!==(g=e.type)&&"body"!==g&&!tI(e.type,e.memoizedProps)),g&&(g=nr)){if(ar(e))throw ur(),Error(r(418));for(;g;)Cr(e,g),g=oI(g.nextSibling)}if(ir(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,g=0;e;){if(8===e.nodeType){var t=e.data;if("/$"===t){if(0===g){nr=oI(e.nextSibling);break e}g--}else"$"!==t&&"$!"!==t&&"$?"!==t||g++}e=e.nextSibling}nr=null}}else nr=tr?oI(e.stateNode.nextSibling):null;return!0}function ur(){for(var e=nr;e;)e=oI(e.nextSibling)}function sr(){nr=tr=null,Ir=!1}function Ar(e){null===rr?rr=[e]:rr.push(e)}var dr=p.ReactCurrentBatchConfig;function mr(e,g){if(e&&e.defaultProps){for(var t in g=F({},g),e=e.defaultProps)void 0===g[t]&&(g[t]=e[t]);return g}return g}var hr=BI(null),br=null,Zr=null,pr=null;function yr(){pr=Zr=br=null}function Gr(e){var g=hr.current;vI(hr),e._currentValue=g}function fr(e,g,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&g)!==g?(e.childLanes|=g,null!==n&&(n.childLanes|=g)):null!==n&&(n.childLanes&g)!==g&&(n.childLanes|=g),e===t)break;e=e.return}}function Br(e,g){br=e,pr=Zr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&g)&&(Zl=!0),e.firstContext=null)}function vr(e){var g=e._currentValue;if(pr!==e)if(e={context:e,memoizedValue:g,next:null},null===Zr){if(null===br)throw Error(r(308));Zr=e,br.dependencies={lanes:0,firstContext:e}}else Zr=Zr.next=e;return g}var Sr=null;function Wr(e){null===Sr?Sr=[e]:Sr.push(e)}function Vr(e,g,t,n){var I=g.interleaved;return null===I?(t.next=t,Wr(g)):(t.next=I.next,I.next=t),g.interleaved=t,kr(e,n)}function kr(e,g){e.lanes|=g;var t=e.alternate;for(null!==t&&(t.lanes|=g),t=e,e=e.return;null!==e;)e.childLanes|=g,null!==(t=e.alternate)&&(t.childLanes|=g),t=e,e=e.return;return 3===t.tag?t.stateNode:null}var Rr=!1;function Xr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jr(e,g){e=e.updateQueue,g.updateQueue===e&&(g.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Yr(e,g){return{eventTime:e,lane:g,tag:0,payload:null,callback:null,next:null}}function wr(e,g,t){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Va)){var I=n.pending;return null===I?g.next=g:(g.next=I.next,I.next=g),n.pending=g,kr(e,t)}return null===(I=n.interleaved)?(g.next=g,Wr(n)):(g.next=I.next,I.next=g),n.interleaved=g,kr(e,t)}function Hr(e,g,t){if(null!==(g=g.updateQueue)&&(g=g.shared,0!==(4194240&t))){var n=g.lanes;t|=n&=e.pendingLanes,g.lanes=t,bg(e,t)}}function Nr(e,g){var t=e.updateQueue,n=e.alternate;if(null!==n&&t===(n=n.updateQueue)){var I=null,r=null;if(null!==(t=t.firstBaseUpdate)){do{var C={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};null===r?I=r=C:r=r.next=C,t=t.next}while(null!==t);null===r?I=r=g:r=r.next=g}else I=r=g;return t={baseState:n.baseState,firstBaseUpdate:I,lastBaseUpdate:r,shared:n.shared,effects:n.effects},void(e.updateQueue=t)}null===(e=t.lastBaseUpdate)?t.firstBaseUpdate=g:e.next=g,t.lastBaseUpdate=g}function Fr(e,g,t,n){var I=e.updateQueue;Rr=!1;var r=I.firstBaseUpdate,C=I.lastBaseUpdate,l=I.shared.pending;if(null!==l){I.shared.pending=null;var a=l,o=a.next;a.next=null,null===C?r=o:C.next=o,C=a;var i=e.alternate;null!==i&&((l=(i=i.updateQueue).lastBaseUpdate)!==C&&(null===l?i.firstBaseUpdate=o:l.next=o,i.lastBaseUpdate=a))}if(null!==r){var c=I.baseState;for(C=0,i=o=a=null,l=r;;){var u=l.lane,s=l.eventTime;if((n&u)===u){null!==i&&(i=i.next={eventTime:s,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var A=e,d=l;switch(u=g,s=t,d.tag){case 1:if("function"===typeof(A=d.payload)){c=A.call(s,c,u);break e}c=A;break e;case 3:A.flags=-65537&A.flags|128;case 0:if(null===(u="function"===typeof(A=d.payload)?A.call(s,c,u):A)||void 0===u)break e;c=F({},c,u);break e;case 2:Rr=!0}}null!==l.callback&&0!==l.lane&&(e.flags|=64,null===(u=I.effects)?I.effects=[l]:u.push(l))}else s={eventTime:s,lane:u,tag:l.tag,payload:l.payload,callback:l.callback,next:null},null===i?(o=i=s,a=c):i=i.next=s,C|=u;if(null===(l=l.next)){if(null===(l=I.shared.pending))break;l=(u=l).next,u.next=null,I.lastBaseUpdate=u,I.shared.pending=null}}if(null===i&&(a=c),I.baseState=a,I.firstBaseUpdate=o,I.lastBaseUpdate=i,null!==(g=I.shared.interleaved)){I=g;do{C|=I.lane,I=I.next}while(I!==g)}else null===r&&(I.shared.lanes=0);Na|=C,e.lanes=C,e.memoizedState=c}}function Kr(e,g,t){if(e=g.effects,g.effects=null,null!==e)for(g=0;g<e.length;g++){var n=e[g],I=n.callback;if(null!==I){if(n.callback=null,n=t,"function"!==typeof I)throw Error(r(191,I));I.call(n)}}}var xr=(new n.Component).refs;function Er(e,g,t,n){t=null===(t=t(n,g=e.memoizedState))||void 0===t?g:F({},g,t),e.memoizedState=t,0===e.lanes&&(e.updateQueue.baseState=t)}var Mr={isMounted:function(e){return!!(e=e._reactInternals)&&ze(e)===e},enqueueSetState:function(e,g,t){e=e._reactInternals;var n=eo(),I=go(e),r=Yr(n,I);r.payload=g,void 0!==t&&null!==t&&(r.callback=t),null!==(g=wr(e,r,I))&&(to(g,e,I,n),Hr(g,e,I))},enqueueReplaceState:function(e,g,t){e=e._reactInternals;var n=eo(),I=go(e),r=Yr(n,I);r.tag=1,r.payload=g,void 0!==t&&null!==t&&(r.callback=t),null!==(g=wr(e,r,I))&&(to(g,e,I,n),Hr(g,e,I))},enqueueForceUpdate:function(e,g){e=e._reactInternals;var t=eo(),n=go(e),I=Yr(t,n);I.tag=2,void 0!==g&&null!==g&&(I.callback=g),null!==(g=wr(e,I,n))&&(to(g,e,n,t),Hr(g,e,n))}};function zr(e,g,t,n,I,r,C){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,C):!g.prototype||!g.prototype.isPureReactComponent||(!ln(t,n)||!ln(I,r))}function Ur(e,g,t){var n=!1,I=WI,r=g.contextType;return"object"===typeof r&&null!==r?r=vr(r):(I=JI(g)?RI:VI.current,r=(n=null!==(n=g.contextTypes)&&void 0!==n)?XI(e,I):WI),g=new g(t,r),e.memoizedState=null!==g.state&&void 0!==g.state?g.state:null,g.updater=Mr,e.stateNode=g,g._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=I,e.__reactInternalMemoizedMaskedChildContext=r),g}function Qr(e,g,t,n){e=g.state,"function"===typeof g.componentWillReceiveProps&&g.componentWillReceiveProps(t,n),"function"===typeof g.UNSAFE_componentWillReceiveProps&&g.UNSAFE_componentWillReceiveProps(t,n),g.state!==e&&Mr.enqueueReplaceState(g,g.state,null)}function Lr(e,g,t,n){var I=e.stateNode;I.props=t,I.state=e.memoizedState,I.refs=xr,Xr(e);var r=g.contextType;"object"===typeof r&&null!==r?I.context=vr(r):(r=JI(g)?RI:VI.current,I.context=XI(e,r)),I.state=e.memoizedState,"function"===typeof(r=g.getDerivedStateFromProps)&&(Er(e,g,r,t),I.state=e.memoizedState),"function"===typeof g.getDerivedStateFromProps||"function"===typeof I.getSnapshotBeforeUpdate||"function"!==typeof I.UNSAFE_componentWillMount&&"function"!==typeof I.componentWillMount||(g=I.state,"function"===typeof I.componentWillMount&&I.componentWillMount(),"function"===typeof I.UNSAFE_componentWillMount&&I.UNSAFE_componentWillMount(),g!==I.state&&Mr.enqueueReplaceState(I,I.state,null),Fr(e,t,I,n),I.state=e.memoizedState),"function"===typeof I.componentDidMount&&(e.flags|=4194308)}function Tr(e,g,t){if(null!==(e=t.ref)&&"function"!==typeof e&&"object"!==typeof e){if(t._owner){if(t=t._owner){if(1!==t.tag)throw Error(r(309));var n=t.stateNode}if(!n)throw Error(r(147,e));var I=n,C=""+e;return null!==g&&null!==g.ref&&"function"===typeof g.ref&&g.ref._stringRef===C?g.ref:(g=function(e){var g=I.refs;g===xr&&(g=I.refs={}),null===e?delete g[C]:g[C]=e},g._stringRef=C,g)}if("string"!==typeof e)throw Error(r(284));if(!t._owner)throw Error(r(290,e))}return e}function Dr(e,g){throw e=Object.prototype.toString.call(g),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(g).join(", ")+"}":e))}function jr(e){return(0,e._init)(e._payload)}function Pr(e){function g(g,t){if(e){var n=g.deletions;null===n?(g.deletions=[t],g.flags|=16):n.push(t)}}function t(t,n){if(!e)return null;for(;null!==n;)g(t,n),n=n.sibling;return null}function n(e,g){for(e=new Map;null!==g;)null!==g.key?e.set(g.key,g):e.set(g.index,g),g=g.sibling;return e}function I(e,g){return(e=wo(e,g)).index=0,e.sibling=null,e}function C(g,t,n){return g.index=n,e?null!==(n=g.alternate)?(n=n.index)<t?(g.flags|=2,t):n:(g.flags|=2,t):(g.flags|=1048576,t)}function l(g){return e&&null===g.alternate&&(g.flags|=2),g}function a(e,g,t,n){return null===g||6!==g.tag?((g=Ko(t,e.mode,n)).return=e,g):((g=I(g,t)).return=e,g)}function o(e,g,t,n){var r=t.type;return r===f?c(e,g,t.props.children,n,t.key):null!==g&&(g.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===J&&jr(r)===g.type)?((n=I(g,t.props)).ref=Tr(e,g,t),n.return=e,n):((n=Ho(t.type,t.key,t.props,null,e.mode,n)).ref=Tr(e,g,t),n.return=e,n)}function i(e,g,t,n){return null===g||4!==g.tag||g.stateNode.containerInfo!==t.containerInfo||g.stateNode.implementation!==t.implementation?((g=xo(t,e.mode,n)).return=e,g):((g=I(g,t.children||[])).return=e,g)}function c(e,g,t,n,r){return null===g||7!==g.tag?((g=No(t,e.mode,n,r)).return=e,g):((g=I(g,t)).return=e,g)}function u(e,g,t){if("string"===typeof g&&""!==g||"number"===typeof g)return(g=Ko(""+g,e.mode,t)).return=e,g;if("object"===typeof g&&null!==g){switch(g.$$typeof){case y:return(t=Ho(g.type,g.key,g.props,null,e.mode,t)).ref=Tr(e,null,g),t.return=e,t;case G:return(g=xo(g,e.mode,t)).return=e,g;case J:return u(e,(0,g._init)(g._payload),t)}if(ge(g)||H(g))return(g=No(g,e.mode,t,null)).return=e,g;Dr(e,g)}return null}function s(e,g,t,n){var I=null!==g?g.key:null;if("string"===typeof t&&""!==t||"number"===typeof t)return null!==I?null:a(e,g,""+t,n);if("object"===typeof t&&null!==t){switch(t.$$typeof){case y:return t.key===I?o(e,g,t,n):null;case G:return t.key===I?i(e,g,t,n):null;case J:return s(e,g,(I=t._init)(t._payload),n)}if(ge(t)||H(t))return null!==I?null:c(e,g,t,n,null);Dr(e,t)}return null}function A(e,g,t,n,I){if("string"===typeof n&&""!==n||"number"===typeof n)return a(g,e=e.get(t)||null,""+n,I);if("object"===typeof n&&null!==n){switch(n.$$typeof){case y:return o(g,e=e.get(null===n.key?t:n.key)||null,n,I);case G:return i(g,e=e.get(null===n.key?t:n.key)||null,n,I);case J:return A(e,g,t,(0,n._init)(n._payload),I)}if(ge(n)||H(n))return c(g,e=e.get(t)||null,n,I,null);Dr(g,n)}return null}function d(I,r,l,a){for(var o=null,i=null,c=r,d=r=0,m=null;null!==c&&d<l.length;d++){c.index>d?(m=c,c=null):m=c.sibling;var h=s(I,c,l[d],a);if(null===h){null===c&&(c=m);break}e&&c&&null===h.alternate&&g(I,c),r=C(h,r,d),null===i?o=h:i.sibling=h,i=h,c=m}if(d===l.length)return t(I,c),Ir&&qI(I,d),o;if(null===c){for(;d<l.length;d++)null!==(c=u(I,l[d],a))&&(r=C(c,r,d),null===i?o=c:i.sibling=c,i=c);return Ir&&qI(I,d),o}for(c=n(I,c);d<l.length;d++)null!==(m=A(c,I,d,l[d],a))&&(e&&null!==m.alternate&&c.delete(null===m.key?d:m.key),r=C(m,r,d),null===i?o=m:i.sibling=m,i=m);return e&&c.forEach((function(e){return g(I,e)})),Ir&&qI(I,d),o}function m(I,l,a,o){var i=H(a);if("function"!==typeof i)throw Error(r(150));if(null==(a=i.call(a)))throw Error(r(151));for(var c=i=null,d=l,m=l=0,h=null,b=a.next();null!==d&&!b.done;m++,b=a.next()){d.index>m?(h=d,d=null):h=d.sibling;var Z=s(I,d,b.value,o);if(null===Z){null===d&&(d=h);break}e&&d&&null===Z.alternate&&g(I,d),l=C(Z,l,m),null===c?i=Z:c.sibling=Z,c=Z,d=h}if(b.done)return t(I,d),Ir&&qI(I,m),i;if(null===d){for(;!b.done;m++,b=a.next())null!==(b=u(I,b.value,o))&&(l=C(b,l,m),null===c?i=b:c.sibling=b,c=b);return Ir&&qI(I,m),i}for(d=n(I,d);!b.done;m++,b=a.next())null!==(b=A(d,I,m,b.value,o))&&(e&&null!==b.alternate&&d.delete(null===b.key?m:b.key),l=C(b,l,m),null===c?i=b:c.sibling=b,c=b);return e&&d.forEach((function(e){return g(I,e)})),Ir&&qI(I,m),i}return function e(n,r,C,a){if("object"===typeof C&&null!==C&&C.type===f&&null===C.key&&(C=C.props.children),"object"===typeof C&&null!==C){switch(C.$$typeof){case y:e:{for(var o=C.key,i=r;null!==i;){if(i.key===o){if((o=C.type)===f){if(7===i.tag){t(n,i.sibling),(r=I(i,C.props.children)).return=n,n=r;break e}}else if(i.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===J&&jr(o)===i.type){t(n,i.sibling),(r=I(i,C.props)).ref=Tr(n,i,C),r.return=n,n=r;break e}t(n,i);break}g(n,i),i=i.sibling}C.type===f?((r=No(C.props.children,n.mode,a,C.key)).return=n,n=r):((a=Ho(C.type,C.key,C.props,null,n.mode,a)).ref=Tr(n,r,C),a.return=n,n=a)}return l(n);case G:e:{for(i=C.key;null!==r;){if(r.key===i){if(4===r.tag&&r.stateNode.containerInfo===C.containerInfo&&r.stateNode.implementation===C.implementation){t(n,r.sibling),(r=I(r,C.children||[])).return=n,n=r;break e}t(n,r);break}g(n,r),r=r.sibling}(r=xo(C,n.mode,a)).return=n,n=r}return l(n);case J:return e(n,r,(i=C._init)(C._payload),a)}if(ge(C))return d(n,r,C,a);if(H(C))return m(n,r,C,a);Dr(n,C)}return"string"===typeof C&&""!==C||"number"===typeof C?(C=""+C,null!==r&&6===r.tag?(t(n,r.sibling),(r=I(r,C)).return=n,n=r):(t(n,r),(r=Ko(C,n.mode,a)).return=n,n=r),l(n)):t(n,r)}}var Or=Pr(!0),_r=Pr(!1),qr={},$r=BI(qr),eC=BI(qr),gC=BI(qr);function tC(e){if(e===qr)throw Error(r(174));return e}function nC(e,g){switch(SI(gC,g),SI(eC,e),SI($r,qr),e=g.nodeType){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:ae(null,"");break;default:g=ae(g=(e=8===e?g.parentNode:g).namespaceURI||null,e=e.tagName)}vI($r),SI($r,g)}function IC(){vI($r),vI(eC),vI(gC)}function rC(e){tC(gC.current);var g=tC($r.current),t=ae(g,e.type);g!==t&&(SI(eC,e),SI($r,t))}function CC(e){eC.current===e&&(vI($r),vI(eC))}var lC=BI(0);function aC(e){for(var g=e;null!==g;){if(13===g.tag){var t=g.memoizedState;if(null!==t&&(null===(t=t.dehydrated)||"$?"===t.data||"$!"===t.data))return g}else if(19===g.tag&&void 0!==g.memoizedProps.revealOrder){if(0!==(128&g.flags))return g}else if(null!==g.child){g.child.return=g,g=g.child;continue}if(g===e)break;for(;null===g.sibling;){if(null===g.return||g.return===e)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var oC=[];function iC(){for(var e=0;e<oC.length;e++)oC[e]._workInProgressVersionPrimary=null;oC.length=0}var cC=p.ReactCurrentDispatcher,uC=p.ReactCurrentBatchConfig,sC=0,AC=null,dC=null,mC=null,hC=!1,bC=!1,ZC=0,pC=0;function yC(){throw Error(r(321))}function GC(e,g){if(null===g)return!1;for(var t=0;t<g.length&&t<e.length;t++)if(!Cn(e[t],g[t]))return!1;return!0}function fC(e,g,t,n,I,C){if(sC=C,AC=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,cC.current=null===e||null===e.memoizedState?Cl:ll,e=t(n,I),bC){C=0;do{if(bC=!1,ZC=0,25<=C)throw Error(r(301));C+=1,mC=dC=null,g.updateQueue=null,cC.current=al,e=t(n,I)}while(bC)}if(cC.current=rl,g=null!==dC&&null!==dC.next,sC=0,mC=dC=AC=null,hC=!1,g)throw Error(r(300));return e}function BC(){var e=0!==ZC;return ZC=0,e}function vC(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mC?AC.memoizedState=mC=e:mC=mC.next=e,mC}function SC(){if(null===dC){var e=AC.alternate;e=null!==e?e.memoizedState:null}else e=dC.next;var g=null===mC?AC.memoizedState:mC.next;if(null!==g)mC=g,dC=e;else{if(null===e)throw Error(r(310));e={memoizedState:(dC=e).memoizedState,baseState:dC.baseState,baseQueue:dC.baseQueue,queue:dC.queue,next:null},null===mC?AC.memoizedState=mC=e:mC=mC.next=e}return mC}function WC(e,g){return"function"===typeof g?g(e):g}function VC(e){var g=SC(),t=g.queue;if(null===t)throw Error(r(311));t.lastRenderedReducer=e;var n=dC,I=n.baseQueue,C=t.pending;if(null!==C){if(null!==I){var l=I.next;I.next=C.next,C.next=l}n.baseQueue=I=C,t.pending=null}if(null!==I){C=I.next,n=n.baseState;var a=l=null,o=null,i=C;do{var c=i.lane;if((sC&c)===c)null!==o&&(o=o.next={lane:0,action:i.action,hasEagerState:i.hasEagerState,eagerState:i.eagerState,next:null}),n=i.hasEagerState?i.eagerState:e(n,i.action);else{var u={lane:c,action:i.action,hasEagerState:i.hasEagerState,eagerState:i.eagerState,next:null};null===o?(a=o=u,l=n):o=o.next=u,AC.lanes|=c,Na|=c}i=i.next}while(null!==i&&i!==C);null===o?l=n:o.next=a,Cn(n,g.memoizedState)||(Zl=!0),g.memoizedState=n,g.baseState=l,g.baseQueue=o,t.lastRenderedState=n}if(null!==(e=t.interleaved)){I=e;do{C=I.lane,AC.lanes|=C,Na|=C,I=I.next}while(I!==e)}else null===I&&(t.lanes=0);return[g.memoizedState,t.dispatch]}function kC(e){var g=SC(),t=g.queue;if(null===t)throw Error(r(311));t.lastRenderedReducer=e;var n=t.dispatch,I=t.pending,C=g.memoizedState;if(null!==I){t.pending=null;var l=I=I.next;do{C=e(C,l.action),l=l.next}while(l!==I);Cn(C,g.memoizedState)||(Zl=!0),g.memoizedState=C,null===g.baseQueue&&(g.baseState=C),t.lastRenderedState=C}return[C,n]}function RC(){}function XC(e,g){var t=AC,n=SC(),I=g(),C=!Cn(n.memoizedState,I);if(C&&(n.memoizedState=I,Zl=!0),n=n.queue,UC(wC.bind(null,t,n,e),[e]),n.getSnapshot!==g||C||null!==mC&&1&mC.memoizedState.tag){if(t.flags|=2048,KC(9,YC.bind(null,t,n,I,g),void 0,null),null===ka)throw Error(r(349));0!==(30&sC)||JC(t,g,I)}return I}function JC(e,g,t){e.flags|=16384,e={getSnapshot:g,value:t},null===(g=AC.updateQueue)?(g={lastEffect:null,stores:null},AC.updateQueue=g,g.stores=[e]):null===(t=g.stores)?g.stores=[e]:t.push(e)}function YC(e,g,t,n){g.value=t,g.getSnapshot=n,HC(g)&&NC(e)}function wC(e,g,t){return t((function(){HC(g)&&NC(e)}))}function HC(e){var g=e.getSnapshot;e=e.value;try{var t=g();return!Cn(e,t)}catch(n){return!0}}function NC(e){var g=kr(e,1);null!==g&&to(g,e,1,-1)}function FC(e){var g=vC();return"function"===typeof e&&(e=e()),g.memoizedState=g.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:WC,lastRenderedState:e},g.queue=e,e=e.dispatch=gl.bind(null,AC,e),[g.memoizedState,e]}function KC(e,g,t,n){return e={tag:e,create:g,destroy:t,deps:n,next:null},null===(g=AC.updateQueue)?(g={lastEffect:null,stores:null},AC.updateQueue=g,g.lastEffect=e.next=e):null===(t=g.lastEffect)?g.lastEffect=e.next=e:(n=t.next,t.next=e,e.next=n,g.lastEffect=e),e}function xC(){return SC().memoizedState}function EC(e,g,t,n){var I=vC();AC.flags|=e,I.memoizedState=KC(1|g,t,void 0,void 0===n?null:n)}function MC(e,g,t,n){var I=SC();n=void 0===n?null:n;var r=void 0;if(null!==dC){var C=dC.memoizedState;if(r=C.destroy,null!==n&&GC(n,C.deps))return void(I.memoizedState=KC(g,t,r,n))}AC.flags|=e,I.memoizedState=KC(1|g,t,r,n)}function zC(e,g){return EC(8390656,8,e,g)}function UC(e,g){return MC(2048,8,e,g)}function QC(e,g){return MC(4,2,e,g)}function LC(e,g){return MC(4,4,e,g)}function TC(e,g){return"function"===typeof g?(e=e(),g(e),function(){g(null)}):null!==g&&void 0!==g?(e=e(),g.current=e,function(){g.current=null}):void 0}function DC(e,g,t){return t=null!==t&&void 0!==t?t.concat([e]):null,MC(4,4,TC.bind(null,g,e),t)}function jC(){}function PC(e,g){var t=SC();g=void 0===g?null:g;var n=t.memoizedState;return null!==n&&null!==g&&GC(g,n[1])?n[0]:(t.memoizedState=[e,g],e)}function OC(e,g){var t=SC();g=void 0===g?null:g;var n=t.memoizedState;return null!==n&&null!==g&&GC(g,n[1])?n[0]:(e=e(),t.memoizedState=[e,g],e)}function _C(e,g,t){return 0===(21&sC)?(e.baseState&&(e.baseState=!1,Zl=!0),e.memoizedState=t):(Cn(t,g)||(t=dg(),AC.lanes|=t,Na|=t,e.baseState=!0),g)}function qC(e,g){var t=Zg;Zg=0!==t&&4>t?t:4,e(!0);var n=uC.transition;uC.transition={};try{e(!1),g()}finally{Zg=t,uC.transition=n}}function $C(){return SC().memoizedState}function el(e,g,t){var n=go(e);if(t={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null},tl(e))nl(g,t);else if(null!==(t=Vr(e,g,t,n))){to(t,e,n,eo()),Il(t,g,n)}}function gl(e,g,t){var n=go(e),I={lane:n,action:t,hasEagerState:!1,eagerState:null,next:null};if(tl(e))nl(g,I);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=g.lastRenderedReducer))try{var C=g.lastRenderedState,l=r(C,t);if(I.hasEagerState=!0,I.eagerState=l,Cn(l,C)){var a=g.interleaved;return null===a?(I.next=I,Wr(g)):(I.next=a.next,a.next=I),void(g.interleaved=I)}}catch(o){}null!==(t=Vr(e,g,I,n))&&(to(t,e,n,I=eo()),Il(t,g,n))}}function tl(e){var g=e.alternate;return e===AC||null!==g&&g===AC}function nl(e,g){bC=hC=!0;var t=e.pending;null===t?g.next=g:(g.next=t.next,t.next=g),e.pending=g}function Il(e,g,t){if(0!==(4194240&t)){var n=g.lanes;t|=n&=e.pendingLanes,g.lanes=t,bg(e,t)}}var rl={readContext:vr,useCallback:yC,useContext:yC,useEffect:yC,useImperativeHandle:yC,useInsertionEffect:yC,useLayoutEffect:yC,useMemo:yC,useReducer:yC,useRef:yC,useState:yC,useDebugValue:yC,useDeferredValue:yC,useTransition:yC,useMutableSource:yC,useSyncExternalStore:yC,useId:yC,unstable_isNewReconciler:!1},Cl={readContext:vr,useCallback:function(e,g){return vC().memoizedState=[e,void 0===g?null:g],e},useContext:vr,useEffect:zC,useImperativeHandle:function(e,g,t){return t=null!==t&&void 0!==t?t.concat([e]):null,EC(4194308,4,TC.bind(null,g,e),t)},useLayoutEffect:function(e,g){return EC(4194308,4,e,g)},useInsertionEffect:function(e,g){return EC(4,2,e,g)},useMemo:function(e,g){var t=vC();return g=void 0===g?null:g,e=e(),t.memoizedState=[e,g],e},useReducer:function(e,g,t){var n=vC();return g=void 0!==t?t(g):g,n.memoizedState=n.baseState=g,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:g},n.queue=e,e=e.dispatch=el.bind(null,AC,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},vC().memoizedState=e},useState:FC,useDebugValue:jC,useDeferredValue:function(e){return vC().memoizedState=e},useTransition:function(){var e=FC(!1),g=e[0];return e=qC.bind(null,e[1]),vC().memoizedState=e,[g,e]},useMutableSource:function(){},useSyncExternalStore:function(e,g,t){var n=AC,I=vC();if(Ir){if(void 0===t)throw Error(r(407));t=t()}else{if(t=g(),null===ka)throw Error(r(349));0!==(30&sC)||JC(n,g,t)}I.memoizedState=t;var C={value:t,getSnapshot:g};return I.queue=C,zC(wC.bind(null,n,C,e),[e]),n.flags|=2048,KC(9,YC.bind(null,n,C,t,g),void 0,null),t},useId:function(){var e=vC(),g=ka.identifierPrefix;if(Ir){var t=_I;g=":"+g+"R"+(t=(OI&~(1<<32-Cg(OI)-1)).toString(32)+t),0<(t=ZC++)&&(g+="H"+t.toString(32)),g+=":"}else g=":"+g+"r"+(t=pC++).toString(32)+":";return e.memoizedState=g},unstable_isNewReconciler:!1},ll={readContext:vr,useCallback:PC,useContext:vr,useEffect:UC,useImperativeHandle:DC,useInsertionEffect:QC,useLayoutEffect:LC,useMemo:OC,useReducer:VC,useRef:xC,useState:function(){return VC(WC)},useDebugValue:jC,useDeferredValue:function(e){return _C(SC(),dC.memoizedState,e)},useTransition:function(){return[VC(WC)[0],SC().memoizedState]},useMutableSource:RC,useSyncExternalStore:XC,useId:$C,unstable_isNewReconciler:!1},al={readContext:vr,useCallback:PC,useContext:vr,useEffect:UC,useImperativeHandle:DC,useInsertionEffect:QC,useLayoutEffect:LC,useMemo:OC,useReducer:kC,useRef:xC,useState:function(){return kC(WC)},useDebugValue:jC,useDeferredValue:function(e){var g=SC();return null===dC?g.memoizedState=e:_C(g,dC.memoizedState,e)},useTransition:function(){return[kC(WC)[0],SC().memoizedState]},useMutableSource:RC,useSyncExternalStore:XC,useId:$C,unstable_isNewReconciler:!1};function ol(e,g){try{var t="",n=g;do{t+=M(n),n=n.return}while(n);var I=t}catch(r){I="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:g,stack:I,digest:null}}function il(e,g,t){return{value:e,source:null,stack:null!=t?t:null,digest:null!=g?g:null}}function cl(e,g){try{console.error(g.value)}catch(t){setTimeout((function(){throw t}))}}var ul="function"===typeof WeakMap?WeakMap:Map;function sl(e,g,t){(t=Yr(-1,t)).tag=3,t.payload={element:null};var n=g.value;return t.callback=function(){Qa||(Qa=!0,La=n),cl(0,g)},t}function Al(e,g,t){(t=Yr(-1,t)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var I=g.value;t.payload=function(){return n(I)},t.callback=function(){cl(0,g)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(t.callback=function(){cl(0,g),"function"!==typeof n&&(null===Ta?Ta=new Set([this]):Ta.add(this));var e=g.stack;this.componentDidCatch(g.value,{componentStack:null!==e?e:""})}),t}function dl(e,g,t){var n=e.pingCache;if(null===n){n=e.pingCache=new ul;var I=new Set;n.set(g,I)}else void 0===(I=n.get(g))&&(I=new Set,n.set(g,I));I.has(t)||(I.add(t),e=So.bind(null,e,g,t),g.then(e,e))}function ml(e){do{var g;if((g=13===e.tag)&&(g=null===(g=e.memoizedState)||null!==g.dehydrated),g)return e;e=e.return}while(null!==e);return null}function hl(e,g,t,n,I){return 0===(1&e.mode)?(e===g?e.flags|=65536:(e.flags|=128,t.flags|=131072,t.flags&=-52805,1===t.tag&&(null===t.alternate?t.tag=17:((g=Yr(-1,1)).tag=2,wr(t,g,1))),t.lanes|=1),e):(e.flags|=65536,e.lanes=I,e)}var bl=p.ReactCurrentOwner,Zl=!1;function pl(e,g,t,n){g.child=null===e?_r(g,null,t,n):Or(g,e.child,t,n)}function yl(e,g,t,n,I){t=t.render;var r=g.ref;return Br(g,I),n=fC(e,g,t,n,r,I),t=BC(),null===e||Zl?(Ir&&t&&er(g),g.flags|=1,pl(e,g,n,I),g.child):(g.updateQueue=e.updateQueue,g.flags&=-2053,e.lanes&=~I,Ql(e,g,I))}function Gl(e,g,t,n,I){if(null===e){var r=t.type;return"function"!==typeof r||Yo(r)||void 0!==r.defaultProps||null!==t.compare||void 0!==t.defaultProps?((e=Ho(t.type,null,n,g,g.mode,I)).ref=g.ref,e.return=g,g.child=e):(g.tag=15,g.type=r,fl(e,g,r,n,I))}if(r=e.child,0===(e.lanes&I)){var C=r.memoizedProps;if((t=null!==(t=t.compare)?t:ln)(C,n)&&e.ref===g.ref)return Ql(e,g,I)}return g.flags|=1,(e=wo(r,n)).ref=g.ref,e.return=g,g.child=e}function fl(e,g,t,n,I){if(null!==e){var r=e.memoizedProps;if(ln(r,n)&&e.ref===g.ref){if(Zl=!1,g.pendingProps=n=r,0===(e.lanes&I))return g.lanes=e.lanes,Ql(e,g,I);0!==(131072&e.flags)&&(Zl=!0)}}return Sl(e,g,t,n,I)}function Bl(e,g,t){var n=g.pendingProps,I=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&g.mode))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},SI(Ya,Ja),Ja|=t;else{if(0===(1073741824&t))return e=null!==r?r.baseLanes|t:t,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:e,cachePool:null,transitions:null},g.updateQueue=null,SI(Ya,Ja),Ja|=e,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==r?r.baseLanes:t,SI(Ya,Ja),Ja|=n}else null!==r?(n=r.baseLanes|t,g.memoizedState=null):n=t,SI(Ya,Ja),Ja|=n;return pl(e,g,I,t),g.child}function vl(e,g){var t=g.ref;(null===e&&null!==t||null!==e&&e.ref!==t)&&(g.flags|=512,g.flags|=2097152)}function Sl(e,g,t,n,I){var r=JI(t)?RI:VI.current;return r=XI(g,r),Br(g,I),t=fC(e,g,t,n,r,I),n=BC(),null===e||Zl?(Ir&&n&&er(g),g.flags|=1,pl(e,g,t,I),g.child):(g.updateQueue=e.updateQueue,g.flags&=-2053,e.lanes&=~I,Ql(e,g,I))}function Wl(e,g,t,n,I){if(JI(t)){var r=!0;NI(g)}else r=!1;if(Br(g,I),null===g.stateNode)Ul(e,g),Ur(g,t,n),Lr(g,t,n,I),n=!0;else if(null===e){var C=g.stateNode,l=g.memoizedProps;C.props=l;var a=C.context,o=t.contextType;"object"===typeof o&&null!==o?o=vr(o):o=XI(g,o=JI(t)?RI:VI.current);var i=t.getDerivedStateFromProps,c="function"===typeof i||"function"===typeof C.getSnapshotBeforeUpdate;c||"function"!==typeof C.UNSAFE_componentWillReceiveProps&&"function"!==typeof C.componentWillReceiveProps||(l!==n||a!==o)&&Qr(g,C,n,o),Rr=!1;var u=g.memoizedState;C.state=u,Fr(g,n,C,I),a=g.memoizedState,l!==n||u!==a||kI.current||Rr?("function"===typeof i&&(Er(g,t,i,n),a=g.memoizedState),(l=Rr||zr(g,t,l,n,u,a,o))?(c||"function"!==typeof C.UNSAFE_componentWillMount&&"function"!==typeof C.componentWillMount||("function"===typeof C.componentWillMount&&C.componentWillMount(),"function"===typeof C.UNSAFE_componentWillMount&&C.UNSAFE_componentWillMount()),"function"===typeof C.componentDidMount&&(g.flags|=4194308)):("function"===typeof C.componentDidMount&&(g.flags|=4194308),g.memoizedProps=n,g.memoizedState=a),C.props=n,C.state=a,C.context=o,n=l):("function"===typeof C.componentDidMount&&(g.flags|=4194308),n=!1)}else{C=g.stateNode,Jr(e,g),l=g.memoizedProps,o=g.type===g.elementType?l:mr(g.type,l),C.props=o,c=g.pendingProps,u=C.context,"object"===typeof(a=t.contextType)&&null!==a?a=vr(a):a=XI(g,a=JI(t)?RI:VI.current);var s=t.getDerivedStateFromProps;(i="function"===typeof s||"function"===typeof C.getSnapshotBeforeUpdate)||"function"!==typeof C.UNSAFE_componentWillReceiveProps&&"function"!==typeof C.componentWillReceiveProps||(l!==c||u!==a)&&Qr(g,C,n,a),Rr=!1,u=g.memoizedState,C.state=u,Fr(g,n,C,I);var A=g.memoizedState;l!==c||u!==A||kI.current||Rr?("function"===typeof s&&(Er(g,t,s,n),A=g.memoizedState),(o=Rr||zr(g,t,o,n,u,A,a)||!1)?(i||"function"!==typeof C.UNSAFE_componentWillUpdate&&"function"!==typeof C.componentWillUpdate||("function"===typeof C.componentWillUpdate&&C.componentWillUpdate(n,A,a),"function"===typeof C.UNSAFE_componentWillUpdate&&C.UNSAFE_componentWillUpdate(n,A,a)),"function"===typeof C.componentDidUpdate&&(g.flags|=4),"function"===typeof C.getSnapshotBeforeUpdate&&(g.flags|=1024)):("function"!==typeof C.componentDidUpdate||l===e.memoizedProps&&u===e.memoizedState||(g.flags|=4),"function"!==typeof C.getSnapshotBeforeUpdate||l===e.memoizedProps&&u===e.memoizedState||(g.flags|=1024),g.memoizedProps=n,g.memoizedState=A),C.props=n,C.state=A,C.context=a,n=o):("function"!==typeof C.componentDidUpdate||l===e.memoizedProps&&u===e.memoizedState||(g.flags|=4),"function"!==typeof C.getSnapshotBeforeUpdate||l===e.memoizedProps&&u===e.memoizedState||(g.flags|=1024),n=!1)}return Vl(e,g,t,n,r,I)}function Vl(e,g,t,n,I,r){vl(e,g);var C=0!==(128&g.flags);if(!n&&!C)return I&&FI(g,t,!1),Ql(e,g,r);n=g.stateNode,bl.current=g;var l=C&&"function"!==typeof t.getDerivedStateFromError?null:n.render();return g.flags|=1,null!==e&&C?(g.child=Or(g,e.child,null,r),g.child=Or(g,null,l,r)):pl(e,g,l,r),g.memoizedState=n.state,I&&FI(g,t,!0),g.child}function kl(e){var g=e.stateNode;g.pendingContext?wI(0,g.pendingContext,g.pendingContext!==g.context):g.context&&wI(0,g.context,!1),nC(e,g.containerInfo)}function Rl(e,g,t,n,I){return sr(),Ar(I),g.flags|=256,pl(e,g,t,n),g.child}var Xl,Jl,Yl,wl,Hl={dehydrated:null,treeContext:null,retryLane:0};function Nl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Fl(e,g,t){var n,I=g.pendingProps,C=lC.current,l=!1,a=0!==(128&g.flags);if((n=a)||(n=(null===e||null!==e.memoizedState)&&0!==(2&C)),n?(l=!0,g.flags&=-129):null!==e&&null===e.memoizedState||(C|=1),SI(lC,1&C),null===e)return or(g),null!==(e=g.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&g.mode)?g.lanes=1:"$!"===e.data?g.lanes=8:g.lanes=1073741824,null):(a=I.children,e=I.fallback,l?(I=g.mode,l=g.child,a={mode:"hidden",children:a},0===(1&I)&&null!==l?(l.childLanes=0,l.pendingProps=a):l=Fo(a,I,0,null),e=No(e,I,t,null),l.return=g,e.return=g,l.sibling=e,g.child=l,g.child.memoizedState=Nl(t),g.memoizedState=Hl,e):Kl(g,a));if(null!==(C=e.memoizedState)&&null!==(n=C.dehydrated))return function(e,g,t,n,I,C,l){if(t)return 256&g.flags?(g.flags&=-257,xl(e,g,l,n=il(Error(r(422))))):null!==g.memoizedState?(g.child=e.child,g.flags|=128,null):(C=n.fallback,I=g.mode,n=Fo({mode:"visible",children:n.children},I,0,null),(C=No(C,I,l,null)).flags|=2,n.return=g,C.return=g,n.sibling=C,g.child=n,0!==(1&g.mode)&&Or(g,e.child,null,l),g.child.memoizedState=Nl(l),g.memoizedState=Hl,C);if(0===(1&g.mode))return xl(e,g,l,null);if("$!"===I.data){if(n=I.nextSibling&&I.nextSibling.dataset)var a=n.dgst;return n=a,xl(e,g,l,n=il(C=Error(r(419)),n,void 0))}if(a=0!==(l&e.childLanes),Zl||a){if(null!==(n=ka)){switch(l&-l){case 4:I=2;break;case 16:I=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:I=32;break;case 536870912:I=268435456;break;default:I=0}0!==(I=0!==(I&(n.suspendedLanes|l))?0:I)&&I!==C.retryLane&&(C.retryLane=I,kr(e,I),to(n,e,I,-1))}return mo(),xl(e,g,l,n=il(Error(r(421))))}return"$?"===I.data?(g.flags|=128,g.child=e.child,g=Vo.bind(null,e),I._reactRetry=g,null):(e=C.treeContext,nr=oI(I.nextSibling),tr=g,Ir=!0,rr=null,null!==e&&(DI[jI++]=OI,DI[jI++]=_I,DI[jI++]=PI,OI=e.id,_I=e.overflow,PI=g),g=Kl(g,n.children),g.flags|=4096,g)}(e,g,a,I,n,C,t);if(l){l=I.fallback,a=g.mode,n=(C=e.child).sibling;var o={mode:"hidden",children:I.children};return 0===(1&a)&&g.child!==C?((I=g.child).childLanes=0,I.pendingProps=o,g.deletions=null):(I=wo(C,o)).subtreeFlags=14680064&C.subtreeFlags,null!==n?l=wo(n,l):(l=No(l,a,t,null)).flags|=2,l.return=g,I.return=g,I.sibling=l,g.child=I,I=l,l=g.child,a=null===(a=e.child.memoizedState)?Nl(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},l.memoizedState=a,l.childLanes=e.childLanes&~t,g.memoizedState=Hl,I}return e=(l=e.child).sibling,I=wo(l,{mode:"visible",children:I.children}),0===(1&g.mode)&&(I.lanes=t),I.return=g,I.sibling=null,null!==e&&(null===(t=g.deletions)?(g.deletions=[e],g.flags|=16):t.push(e)),g.child=I,g.memoizedState=null,I}function Kl(e,g){return(g=Fo({mode:"visible",children:g},e.mode,0,null)).return=e,e.child=g}function xl(e,g,t,n){return null!==n&&Ar(n),Or(g,e.child,null,t),(e=Kl(g,g.pendingProps.children)).flags|=2,g.memoizedState=null,e}function El(e,g,t){e.lanes|=g;var n=e.alternate;null!==n&&(n.lanes|=g),fr(e.return,g,t)}function Ml(e,g,t,n,I){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:n,tail:t,tailMode:I}:(r.isBackwards=g,r.rendering=null,r.renderingStartTime=0,r.last=n,r.tail=t,r.tailMode=I)}function zl(e,g,t){var n=g.pendingProps,I=n.revealOrder,r=n.tail;if(pl(e,g,n.children,t),0!==(2&(n=lC.current)))n=1&n|2,g.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=g.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&El(e,t,g);else if(19===e.tag)El(e,t,g);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===g)break e;for(;null===e.sibling;){if(null===e.return||e.return===g)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(SI(lC,n),0===(1&g.mode))g.memoizedState=null;else switch(I){case"forwards":for(t=g.child,I=null;null!==t;)null!==(e=t.alternate)&&null===aC(e)&&(I=t),t=t.sibling;null===(t=I)?(I=g.child,g.child=null):(I=t.sibling,t.sibling=null),Ml(g,!1,I,t,r);break;case"backwards":for(t=null,I=g.child,g.child=null;null!==I;){if(null!==(e=I.alternate)&&null===aC(e)){g.child=I;break}e=I.sibling,I.sibling=t,t=I,I=e}Ml(g,!0,t,null,r);break;case"together":Ml(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function Ul(e,g){0===(1&g.mode)&&null!==e&&(e.alternate=null,g.alternate=null,g.flags|=2)}function Ql(e,g,t){if(null!==e&&(g.dependencies=e.dependencies),Na|=g.lanes,0===(t&g.childLanes))return null;if(null!==e&&g.child!==e.child)throw Error(r(153));if(null!==g.child){for(t=wo(e=g.child,e.pendingProps),g.child=t,t.return=g;null!==e.sibling;)e=e.sibling,(t=t.sibling=wo(e,e.pendingProps)).return=g;t.sibling=null}return g.child}function Ll(e,g){if(!Ir)switch(e.tailMode){case"hidden":g=e.tail;for(var t=null;null!==g;)null!==g.alternate&&(t=g),g=g.sibling;null===t?e.tail=null:t.sibling=null;break;case"collapsed":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?g||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Tl(e){var g=null!==e.alternate&&e.alternate.child===e.child,t=0,n=0;if(g)for(var I=e.child;null!==I;)t|=I.lanes|I.childLanes,n|=14680064&I.subtreeFlags,n|=14680064&I.flags,I.return=e,I=I.sibling;else for(I=e.child;null!==I;)t|=I.lanes|I.childLanes,n|=I.subtreeFlags,n|=I.flags,I.return=e,I=I.sibling;return e.subtreeFlags|=n,e.childLanes=t,g}function Dl(e,g,t){var n=g.pendingProps;switch(gr(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tl(g),null;case 1:case 17:return JI(g.type)&&YI(),Tl(g),null;case 3:return n=g.stateNode,IC(),vI(kI),vI(VI),iC(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(cr(g)?g.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&g.flags)||(g.flags|=1024,null!==rr&&(Co(rr),rr=null))),Jl(e,g),Tl(g),null;case 5:CC(g);var I=tC(gC.current);if(t=g.type,null!==e&&null!=g.stateNode)Yl(e,g,t,n,I),e.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!n){if(null===g.stateNode)throw Error(r(166));return Tl(g),null}if(e=tC($r.current),cr(g)){n=g.stateNode,t=g.type;var C=g.memoizedProps;switch(n[uI]=g,n[sI]=C,e=0!==(1&g.mode),t){case"dialog":xn("cancel",n),xn("close",n);break;case"iframe":case"object":case"embed":xn("load",n);break;case"video":case"audio":for(I=0;I<Hn.length;I++)xn(Hn[I],n);break;case"source":xn("error",n);break;case"img":case"image":case"link":xn("error",n),xn("load",n);break;case"details":xn("toggle",n);break;case"input":O(n,C),xn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!C.multiple},xn("invalid",n);break;case"textarea":Ie(n,C),xn("invalid",n)}for(var a in be(t,C),I=null,C)if(C.hasOwnProperty(a)){var o=C[a];"children"===a?"string"===typeof o?n.textContent!==o&&(!0!==C.suppressHydrationWarning&&qn(n.textContent,o,e),I=["children",o]):"number"===typeof o&&n.textContent!==""+o&&(!0!==C.suppressHydrationWarning&&qn(n.textContent,o,e),I=["children",""+o]):l.hasOwnProperty(a)&&null!=o&&"onScroll"===a&&xn("scroll",n)}switch(t){case"input":T(n),$(n,C,!0);break;case"textarea":T(n),Ce(n);break;case"select":case"option":break;default:"function"===typeof C.onClick&&(n.onclick=$n)}n=I,g.updateQueue=n,null!==n&&(g.flags|=4)}else{a=9===I.nodeType?I:I.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=le(t)),"http://www.w3.org/1999/xhtml"===e?"script"===t?((e=a.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=a.createElement(t,{is:n.is}):(e=a.createElement(t),"select"===t&&(a=e,n.multiple?a.multiple=!0:n.size&&(a.size=n.size))):e=a.createElementNS(e,t),e[uI]=g,e[sI]=n,Xl(e,g,!1,!1),g.stateNode=e;e:{switch(a=Ze(t,n),t){case"dialog":xn("cancel",e),xn("close",e),I=n;break;case"iframe":case"object":case"embed":xn("load",e),I=n;break;case"video":case"audio":for(I=0;I<Hn.length;I++)xn(Hn[I],e);I=n;break;case"source":xn("error",e),I=n;break;case"img":case"image":case"link":xn("error",e),xn("load",e),I=n;break;case"details":xn("toggle",e),I=n;break;case"input":O(e,n),I=P(e,n),xn("invalid",e);break;case"option":default:I=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},I=F({},n,{value:void 0}),xn("invalid",e);break;case"textarea":Ie(e,n),I=ne(e,n),xn("invalid",e)}for(C in be(t,I),o=I)if(o.hasOwnProperty(C)){var i=o[C];"style"===C?me(e,i):"dangerouslySetInnerHTML"===C?null!=(i=i?i.__html:void 0)&&ce(e,i):"children"===C?"string"===typeof i?("textarea"!==t||""!==i)&&ue(e,i):"number"===typeof i&&ue(e,""+i):"suppressContentEditableWarning"!==C&&"suppressHydrationWarning"!==C&&"autoFocus"!==C&&(l.hasOwnProperty(C)?null!=i&&"onScroll"===C&&xn("scroll",e):null!=i&&Z(e,C,i,a))}switch(t){case"input":T(e),$(e,n,!1);break;case"textarea":T(e),Ce(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Q(n.value));break;case"select":e.multiple=!!n.multiple,null!=(C=n.value)?te(e,!!n.multiple,C,!1):null!=n.defaultValue&&te(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof I.onClick&&(e.onclick=$n)}switch(t){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(g.flags|=4)}null!==g.ref&&(g.flags|=512,g.flags|=2097152)}return Tl(g),null;case 6:if(e&&null!=g.stateNode)wl(e,g,e.memoizedProps,n);else{if("string"!==typeof n&&null===g.stateNode)throw Error(r(166));if(t=tC(gC.current),tC($r.current),cr(g)){if(n=g.stateNode,t=g.memoizedProps,n[uI]=g,(C=n.nodeValue!==t)&&null!==(e=tr))switch(e.tag){case 3:qn(n.nodeValue,t,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&qn(n.nodeValue,t,0!==(1&e.mode))}C&&(g.flags|=4)}else(n=(9===t.nodeType?t:t.ownerDocument).createTextNode(n))[uI]=g,g.stateNode=n}return Tl(g),null;case 13:if(vI(lC),n=g.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(Ir&&null!==nr&&0!==(1&g.mode)&&0===(128&g.flags))ur(),sr(),g.flags|=98560,C=!1;else if(C=cr(g),null!==n&&null!==n.dehydrated){if(null===e){if(!C)throw Error(r(318));if(!(C=null!==(C=g.memoizedState)?C.dehydrated:null))throw Error(r(317));C[uI]=g}else sr(),0===(128&g.flags)&&(g.memoizedState=null),g.flags|=4;Tl(g),C=!1}else null!==rr&&(Co(rr),rr=null),C=!0;if(!C)return 65536&g.flags?g:null}return 0!==(128&g.flags)?(g.lanes=t,g):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(g.child.flags|=8192,0!==(1&g.mode)&&(null===e||0!==(1&lC.current)?0===wa&&(wa=3):mo())),null!==g.updateQueue&&(g.flags|=4),Tl(g),null);case 4:return IC(),Jl(e,g),null===e&&zn(g.stateNode.containerInfo),Tl(g),null;case 10:return Gr(g.type._context),Tl(g),null;case 19:if(vI(lC),null===(C=g.memoizedState))return Tl(g),null;if(n=0!==(128&g.flags),null===(a=C.rendering))if(n)Ll(C,!1);else{if(0!==wa||null!==e&&0!==(128&e.flags))for(e=g.child;null!==e;){if(null!==(a=aC(e))){for(g.flags|=128,Ll(C,!1),null!==(n=a.updateQueue)&&(g.updateQueue=n,g.flags|=4),g.subtreeFlags=0,n=t,t=g.child;null!==t;)e=n,(C=t).flags&=14680066,null===(a=C.alternate)?(C.childLanes=0,C.lanes=e,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=a.childLanes,C.lanes=a.lanes,C.child=a.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=a.memoizedProps,C.memoizedState=a.memoizedState,C.updateQueue=a.updateQueue,C.type=a.type,e=a.dependencies,C.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),t=t.sibling;return SI(lC,1&lC.current|2),g.child}e=e.sibling}null!==C.tail&&_e()>za&&(g.flags|=128,n=!0,Ll(C,!1),g.lanes=4194304)}else{if(!n)if(null!==(e=aC(a))){if(g.flags|=128,n=!0,null!==(t=e.updateQueue)&&(g.updateQueue=t,g.flags|=4),Ll(C,!0),null===C.tail&&"hidden"===C.tailMode&&!a.alternate&&!Ir)return Tl(g),null}else 2*_e()-C.renderingStartTime>za&&1073741824!==t&&(g.flags|=128,n=!0,Ll(C,!1),g.lanes=4194304);C.isBackwards?(a.sibling=g.child,g.child=a):(null!==(t=C.last)?t.sibling=a:g.child=a,C.last=a)}return null!==C.tail?(g=C.tail,C.rendering=g,C.tail=g.sibling,C.renderingStartTime=_e(),g.sibling=null,t=lC.current,SI(lC,n?1&t|2:1&t),g):(Tl(g),null);case 22:case 23:return co(),n=null!==g.memoizedState,null!==e&&null!==e.memoizedState!==n&&(g.flags|=8192),n&&0!==(1&g.mode)?0!==(1073741824&Ja)&&(Tl(g),6&g.subtreeFlags&&(g.flags|=8192)):Tl(g),null;case 24:case 25:return null}throw Error(r(156,g.tag))}function jl(e,g){switch(gr(g),g.tag){case 1:return JI(g.type)&&YI(),65536&(e=g.flags)?(g.flags=-65537&e|128,g):null;case 3:return IC(),vI(kI),vI(VI),iC(),0!==(65536&(e=g.flags))&&0===(128&e)?(g.flags=-65537&e|128,g):null;case 5:return CC(g),null;case 13:if(vI(lC),null!==(e=g.memoizedState)&&null!==e.dehydrated){if(null===g.alternate)throw Error(r(340));sr()}return 65536&(e=g.flags)?(g.flags=-65537&e|128,g):null;case 19:return vI(lC),null;case 4:return IC(),null;case 10:return Gr(g.type._context),null;case 22:case 23:return co(),null;default:return null}}Xl=function(e,g){for(var t=g.child;null!==t;){if(5===t.tag||6===t.tag)e.appendChild(t.stateNode);else if(4!==t.tag&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===g)break;for(;null===t.sibling;){if(null===t.return||t.return===g)return;t=t.return}t.sibling.return=t.return,t=t.sibling}},Jl=function(){},Yl=function(e,g,t,n){var I=e.memoizedProps;if(I!==n){e=g.stateNode,tC($r.current);var r,C=null;switch(t){case"input":I=P(e,I),n=P(e,n),C=[];break;case"select":I=F({},I,{value:void 0}),n=F({},n,{value:void 0}),C=[];break;case"textarea":I=ne(e,I),n=ne(e,n),C=[];break;default:"function"!==typeof I.onClick&&"function"===typeof n.onClick&&(e.onclick=$n)}for(i in be(t,n),t=null,I)if(!n.hasOwnProperty(i)&&I.hasOwnProperty(i)&&null!=I[i])if("style"===i){var a=I[i];for(r in a)a.hasOwnProperty(r)&&(t||(t={}),t[r]="")}else"dangerouslySetInnerHTML"!==i&&"children"!==i&&"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(l.hasOwnProperty(i)?C||(C=[]):(C=C||[]).push(i,null));for(i in n){var o=n[i];if(a=null!=I?I[i]:void 0,n.hasOwnProperty(i)&&o!==a&&(null!=o||null!=a))if("style"===i)if(a){for(r in a)!a.hasOwnProperty(r)||o&&o.hasOwnProperty(r)||(t||(t={}),t[r]="");for(r in o)o.hasOwnProperty(r)&&a[r]!==o[r]&&(t||(t={}),t[r]=o[r])}else t||(C||(C=[]),C.push(i,t)),t=o;else"dangerouslySetInnerHTML"===i?(o=o?o.__html:void 0,a=a?a.__html:void 0,null!=o&&a!==o&&(C=C||[]).push(i,o)):"children"===i?"string"!==typeof o&&"number"!==typeof o||(C=C||[]).push(i,""+o):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&(l.hasOwnProperty(i)?(null!=o&&"onScroll"===i&&xn("scroll",e),C||a===o||(C=[])):(C=C||[]).push(i,o))}t&&(C=C||[]).push("style",t);var i=C;(g.updateQueue=i)&&(g.flags|=4)}},wl=function(e,g,t,n){t!==n&&(g.flags|=4)};var Pl=!1,Ol=!1,_l="function"===typeof WeakSet?WeakSet:Set,ql=null;function $l(e,g){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){vo(e,g,n)}else t.current=null}function ea(e,g,t){try{t()}catch(n){vo(e,g,n)}}var ga=!1;function ta(e,g,t){var n=g.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var I=n=n.next;do{if((I.tag&e)===e){var r=I.destroy;I.destroy=void 0,void 0!==r&&ea(g,t,r)}I=I.next}while(I!==n)}}function na(e,g){if(null!==(g=null!==(g=g.updateQueue)?g.lastEffect:null)){var t=g=g.next;do{if((t.tag&e)===e){var n=t.create;t.destroy=n()}t=t.next}while(t!==g)}}function Ia(e){var g=e.ref;if(null!==g){var t=e.stateNode;e.tag,e=t,"function"===typeof g?g(e):g.current=e}}function ra(e){var g=e.alternate;null!==g&&(e.alternate=null,ra(g)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(g=e.stateNode)&&(delete g[uI],delete g[sI],delete g[dI],delete g[mI],delete g[hI])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ca(e){return 5===e.tag||3===e.tag||4===e.tag}function la(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Ca(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function aa(e,g,t){var n=e.tag;if(5===n||6===n)e=e.stateNode,g?8===t.nodeType?t.parentNode.insertBefore(e,g):t.insertBefore(e,g):(8===t.nodeType?(g=t.parentNode).insertBefore(e,t):(g=t).appendChild(e),null!==(t=t._reactRootContainer)&&void 0!==t||null!==g.onclick||(g.onclick=$n));else if(4!==n&&null!==(e=e.child))for(aa(e,g,t),e=e.sibling;null!==e;)aa(e,g,t),e=e.sibling}function oa(e,g,t){var n=e.tag;if(5===n||6===n)e=e.stateNode,g?t.insertBefore(e,g):t.appendChild(e);else if(4!==n&&null!==(e=e.child))for(oa(e,g,t),e=e.sibling;null!==e;)oa(e,g,t),e=e.sibling}var ia=null,ca=!1;function ua(e,g,t){for(t=t.child;null!==t;)sa(e,g,t),t=t.sibling}function sa(e,g,t){if(rg&&"function"===typeof rg.onCommitFiberUnmount)try{rg.onCommitFiberUnmount(Ig,t)}catch(l){}switch(t.tag){case 5:Ol||$l(t,g);case 6:var n=ia,I=ca;ia=null,ua(e,g,t),ca=I,null!==(ia=n)&&(ca?(e=ia,t=t.stateNode,8===e.nodeType?e.parentNode.removeChild(t):e.removeChild(t)):ia.removeChild(t.stateNode));break;case 18:null!==ia&&(ca?(e=ia,t=t.stateNode,8===e.nodeType?aI(e.parentNode,t):1===e.nodeType&&aI(e,t),zg(e)):aI(ia,t.stateNode));break;case 4:n=ia,I=ca,ia=t.stateNode.containerInfo,ca=!0,ua(e,g,t),ia=n,ca=I;break;case 0:case 11:case 14:case 15:if(!Ol&&(null!==(n=t.updateQueue)&&null!==(n=n.lastEffect))){I=n=n.next;do{var r=I,C=r.destroy;r=r.tag,void 0!==C&&(0!==(2&r)||0!==(4&r))&&ea(t,g,C),I=I.next}while(I!==n)}ua(e,g,t);break;case 1:if(!Ol&&($l(t,g),"function"===typeof(n=t.stateNode).componentWillUnmount))try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(l){vo(t,g,l)}ua(e,g,t);break;case 21:ua(e,g,t);break;case 22:1&t.mode?(Ol=(n=Ol)||null!==t.memoizedState,ua(e,g,t),Ol=n):ua(e,g,t);break;default:ua(e,g,t)}}function Aa(e){var g=e.updateQueue;if(null!==g){e.updateQueue=null;var t=e.stateNode;null===t&&(t=e.stateNode=new _l),g.forEach((function(g){var n=ko.bind(null,e,g);t.has(g)||(t.add(g),g.then(n,n))}))}}function da(e,g){var t=g.deletions;if(null!==t)for(var n=0;n<t.length;n++){var I=t[n];try{var C=e,l=g,a=l;e:for(;null!==a;){switch(a.tag){case 5:ia=a.stateNode,ca=!1;break e;case 3:case 4:ia=a.stateNode.containerInfo,ca=!0;break e}a=a.return}if(null===ia)throw Error(r(160));sa(C,l,I),ia=null,ca=!1;var o=I.alternate;null!==o&&(o.return=null),I.return=null}catch(i){vo(I,g,i)}}if(12854&g.subtreeFlags)for(g=g.child;null!==g;)ma(g,e),g=g.sibling}function ma(e,g){var t=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(da(g,e),ha(e),4&n){try{ta(3,e,e.return),na(3,e)}catch(m){vo(e,e.return,m)}try{ta(5,e,e.return)}catch(m){vo(e,e.return,m)}}break;case 1:da(g,e),ha(e),512&n&&null!==t&&$l(t,t.return);break;case 5:if(da(g,e),ha(e),512&n&&null!==t&&$l(t,t.return),32&e.flags){var I=e.stateNode;try{ue(I,"")}catch(m){vo(e,e.return,m)}}if(4&n&&null!=(I=e.stateNode)){var C=e.memoizedProps,l=null!==t?t.memoizedProps:C,a=e.type,o=e.updateQueue;if(e.updateQueue=null,null!==o)try{"input"===a&&"radio"===C.type&&null!=C.name&&_(I,C),Ze(a,l);var i=Ze(a,C);for(l=0;l<o.length;l+=2){var c=o[l],u=o[l+1];"style"===c?me(I,u):"dangerouslySetInnerHTML"===c?ce(I,u):"children"===c?ue(I,u):Z(I,c,u,i)}switch(a){case"input":q(I,C);break;case"textarea":re(I,C);break;case"select":var s=I._wrapperState.wasMultiple;I._wrapperState.wasMultiple=!!C.multiple;var A=C.value;null!=A?te(I,!!C.multiple,A,!1):s!==!!C.multiple&&(null!=C.defaultValue?te(I,!!C.multiple,C.defaultValue,!0):te(I,!!C.multiple,C.multiple?[]:"",!1))}I[sI]=C}catch(m){vo(e,e.return,m)}}break;case 6:if(da(g,e),ha(e),4&n){if(null===e.stateNode)throw Error(r(162));I=e.stateNode,C=e.memoizedProps;try{I.nodeValue=C}catch(m){vo(e,e.return,m)}}break;case 3:if(da(g,e),ha(e),4&n&&null!==t&&t.memoizedState.isDehydrated)try{zg(g.containerInfo)}catch(m){vo(e,e.return,m)}break;case 4:default:da(g,e),ha(e);break;case 13:da(g,e),ha(e),8192&(I=e.child).flags&&(C=null!==I.memoizedState,I.stateNode.isHidden=C,!C||null!==I.alternate&&null!==I.alternate.memoizedState||(Ma=_e())),4&n&&Aa(e);break;case 22:if(c=null!==t&&null!==t.memoizedState,1&e.mode?(Ol=(i=Ol)||c,da(g,e),Ol=i):da(g,e),ha(e),8192&n){if(i=null!==e.memoizedState,(e.stateNode.isHidden=i)&&!c&&0!==(1&e.mode))for(ql=e,c=e.child;null!==c;){for(u=ql=c;null!==ql;){switch(A=(s=ql).child,s.tag){case 0:case 11:case 14:case 15:ta(4,s,s.return);break;case 1:$l(s,s.return);var d=s.stateNode;if("function"===typeof d.componentWillUnmount){n=s,t=s.return;try{g=n,d.props=g.memoizedProps,d.state=g.memoizedState,d.componentWillUnmount()}catch(m){vo(n,t,m)}}break;case 5:$l(s,s.return);break;case 22:if(null!==s.memoizedState){ya(u);continue}}null!==A?(A.return=s,ql=A):ya(u)}c=c.sibling}e:for(c=null,u=e;;){if(5===u.tag){if(null===c){c=u;try{I=u.stateNode,i?"function"===typeof(C=I.style).setProperty?C.setProperty("display","none","important"):C.display="none":(a=u.stateNode,l=void 0!==(o=u.memoizedProps.style)&&null!==o&&o.hasOwnProperty("display")?o.display:null,a.style.display=de("display",l))}catch(m){vo(e,e.return,m)}}}else if(6===u.tag){if(null===c)try{u.stateNode.nodeValue=i?"":u.memoizedProps}catch(m){vo(e,e.return,m)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;c===u&&(c=null),u=u.return}c===u&&(c=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:da(g,e),ha(e),4&n&&Aa(e);case 21:}}function ha(e){var g=e.flags;if(2&g){try{e:{for(var t=e.return;null!==t;){if(Ca(t)){var n=t;break e}t=t.return}throw Error(r(160))}switch(n.tag){case 5:var I=n.stateNode;32&n.flags&&(ue(I,""),n.flags&=-33),oa(e,la(e),I);break;case 3:case 4:var C=n.stateNode.containerInfo;aa(e,la(e),C);break;default:throw Error(r(161))}}catch(l){vo(e,e.return,l)}e.flags&=-3}4096&g&&(e.flags&=-4097)}function ba(e,g,t){ql=e,Za(e,g,t)}function Za(e,g,t){for(var n=0!==(1&e.mode);null!==ql;){var I=ql,r=I.child;if(22===I.tag&&n){var C=null!==I.memoizedState||Pl;if(!C){var l=I.alternate,a=null!==l&&null!==l.memoizedState||Ol;l=Pl;var o=Ol;if(Pl=C,(Ol=a)&&!o)for(ql=I;null!==ql;)a=(C=ql).child,22===C.tag&&null!==C.memoizedState?Ga(I):null!==a?(a.return=C,ql=a):Ga(I);for(;null!==r;)ql=r,Za(r,g,t),r=r.sibling;ql=I,Pl=l,Ol=o}pa(e)}else 0!==(8772&I.subtreeFlags)&&null!==r?(r.return=I,ql=r):pa(e)}}function pa(e){for(;null!==ql;){var g=ql;if(0!==(8772&g.flags)){var t=g.alternate;try{if(0!==(8772&g.flags))switch(g.tag){case 0:case 11:case 15:Ol||na(5,g);break;case 1:var n=g.stateNode;if(4&g.flags&&!Ol)if(null===t)n.componentDidMount();else{var I=g.elementType===g.type?t.memoizedProps:mr(g.type,t.memoizedProps);n.componentDidUpdate(I,t.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var C=g.updateQueue;null!==C&&Kr(g,C,n);break;case 3:var l=g.updateQueue;if(null!==l){if(t=null,null!==g.child)switch(g.child.tag){case 5:case 1:t=g.child.stateNode}Kr(g,l,t)}break;case 5:var a=g.stateNode;if(null===t&&4&g.flags){t=a;var o=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":o.autoFocus&&t.focus();break;case"img":o.src&&(t.src=o.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===g.memoizedState){var i=g.alternate;if(null!==i){var c=i.memoizedState;if(null!==c){var u=c.dehydrated;null!==u&&zg(u)}}}break;default:throw Error(r(163))}Ol||512&g.flags&&Ia(g)}catch(s){vo(g,g.return,s)}}if(g===e){ql=null;break}if(null!==(t=g.sibling)){t.return=g.return,ql=t;break}ql=g.return}}function ya(e){for(;null!==ql;){var g=ql;if(g===e){ql=null;break}var t=g.sibling;if(null!==t){t.return=g.return,ql=t;break}ql=g.return}}function Ga(e){for(;null!==ql;){var g=ql;try{switch(g.tag){case 0:case 11:case 15:var t=g.return;try{na(4,g)}catch(a){vo(g,t,a)}break;case 1:var n=g.stateNode;if("function"===typeof n.componentDidMount){var I=g.return;try{n.componentDidMount()}catch(a){vo(g,I,a)}}var r=g.return;try{Ia(g)}catch(a){vo(g,r,a)}break;case 5:var C=g.return;try{Ia(g)}catch(a){vo(g,C,a)}}}catch(a){vo(g,g.return,a)}if(g===e){ql=null;break}var l=g.sibling;if(null!==l){l.return=g.return,ql=l;break}ql=g.return}}var fa,Ba=Math.ceil,va=p.ReactCurrentDispatcher,Sa=p.ReactCurrentOwner,Wa=p.ReactCurrentBatchConfig,Va=0,ka=null,Ra=null,Xa=0,Ja=0,Ya=BI(0),wa=0,Ha=null,Na=0,Fa=0,Ka=0,xa=null,Ea=null,Ma=0,za=1/0,Ua=null,Qa=!1,La=null,Ta=null,Da=!1,ja=null,Pa=0,Oa=0,_a=null,qa=-1,$a=0;function eo(){return 0!==(6&Va)?_e():-1!==qa?qa:qa=_e()}function go(e){return 0===(1&e.mode)?1:0!==(2&Va)&&0!==Xa?Xa&-Xa:null!==dr.transition?(0===$a&&($a=dg()),$a):0!==(e=Zg)?e:e=void 0===(e=window.event)?16:Og(e.type)}function to(e,g,t,n){if(50<Oa)throw Oa=0,_a=null,Error(r(185));hg(e,t,n),0!==(2&Va)&&e===ka||(e===ka&&(0===(2&Va)&&(Fa|=t),4===wa&&lo(e,Xa)),no(e,n),1===t&&0===Va&&0===(1&g.mode)&&(za=_e()+500,xI&&zI()))}function no(e,g){var t=e.callbackNode;!function(e,g){for(var t=e.suspendedLanes,n=e.pingedLanes,I=e.expirationTimes,r=e.pendingLanes;0<r;){var C=31-Cg(r),l=1<<C,a=I[C];-1===a?0!==(l&t)&&0===(l&n)||(I[C]=sg(l,g)):a<=g&&(e.expiredLanes|=l),r&=~l}}(e,g);var n=ug(e,e===ka?Xa:0);if(0===n)null!==t&&je(t),e.callbackNode=null,e.callbackPriority=0;else if(g=n&-n,e.callbackPriority!==g){if(null!=t&&je(t),1===g)0===e.tag?function(e){xI=!0,MI(e)}(ao.bind(null,e)):MI(ao.bind(null,e)),CI((function(){0===(6&Va)&&zI()})),t=null;else{switch(pg(n)){case 1:t=$e;break;case 4:t=eg;break;case 16:default:t=gg;break;case 536870912:t=ng}t=Ro(t,Io.bind(null,e))}e.callbackPriority=g,e.callbackNode=t}}function Io(e,g){if(qa=-1,$a=0,0!==(6&Va))throw Error(r(327));var t=e.callbackNode;if(fo()&&e.callbackNode!==t)return null;var n=ug(e,e===ka?Xa:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||g)g=ho(e,n);else{g=n;var I=Va;Va|=2;var C=Ao();for(ka===e&&Xa===g||(Ua=null,za=_e()+500,uo(e,g));;)try{Zo();break}catch(a){so(e,a)}yr(),va.current=C,Va=I,null!==Ra?g=0:(ka=null,Xa=0,g=wa)}if(0!==g){if(2===g&&(0!==(I=Ag(e))&&(n=I,g=ro(e,I))),1===g)throw t=Ha,uo(e,0),lo(e,n),no(e,_e()),t;if(6===g)lo(e,n);else{if(I=e.current.alternate,0===(30&n)&&!function(e){for(var g=e;;){if(16384&g.flags){var t=g.updateQueue;if(null!==t&&null!==(t=t.stores))for(var n=0;n<t.length;n++){var I=t[n],r=I.getSnapshot;I=I.value;try{if(!Cn(r(),I))return!1}catch(l){return!1}}}if(t=g.child,16384&g.subtreeFlags&&null!==t)t.return=g,g=t;else{if(g===e)break;for(;null===g.sibling;){if(null===g.return||g.return===e)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}(I)&&(2===(g=ho(e,n))&&(0!==(C=Ag(e))&&(n=C,g=ro(e,C))),1===g))throw t=Ha,uo(e,0),lo(e,n),no(e,_e()),t;switch(e.finishedWork=I,e.finishedLanes=n,g){case 0:case 1:throw Error(r(345));case 2:case 5:Go(e,Ea,Ua);break;case 3:if(lo(e,n),(130023424&n)===n&&10<(g=Ma+500-_e())){if(0!==ug(e,0))break;if(((I=e.suspendedLanes)&n)!==n){eo(),e.pingedLanes|=e.suspendedLanes&I;break}e.timeoutHandle=nI(Go.bind(null,e,Ea,Ua),g);break}Go(e,Ea,Ua);break;case 4:if(lo(e,n),(4194240&n)===n)break;for(g=e.eventTimes,I=-1;0<n;){var l=31-Cg(n);C=1<<l,(l=g[l])>I&&(I=l),n&=~C}if(n=I,10<(n=(120>(n=_e()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ba(n/1960))-n)){e.timeoutHandle=nI(Go.bind(null,e,Ea,Ua),n);break}Go(e,Ea,Ua);break;default:throw Error(r(329))}}}return no(e,_e()),e.callbackNode===t?Io.bind(null,e):null}function ro(e,g){var t=xa;return e.current.memoizedState.isDehydrated&&(uo(e,g).flags|=256),2!==(e=ho(e,g))&&(g=Ea,Ea=t,null!==g&&Co(g)),e}function Co(e){null===Ea?Ea=e:Ea.push.apply(Ea,e)}function lo(e,g){for(g&=~Ka,g&=~Fa,e.suspendedLanes|=g,e.pingedLanes&=~g,e=e.expirationTimes;0<g;){var t=31-Cg(g),n=1<<t;e[t]=-1,g&=~n}}function ao(e){if(0!==(6&Va))throw Error(r(327));fo();var g=ug(e,0);if(0===(1&g))return no(e,_e()),null;var t=ho(e,g);if(0!==e.tag&&2===t){var n=Ag(e);0!==n&&(g=n,t=ro(e,n))}if(1===t)throw t=Ha,uo(e,0),lo(e,g),no(e,_e()),t;if(6===t)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=g,Go(e,Ea,Ua),no(e,_e()),null}function oo(e,g){var t=Va;Va|=1;try{return e(g)}finally{0===(Va=t)&&(za=_e()+500,xI&&zI())}}function io(e){null!==ja&&0===ja.tag&&0===(6&Va)&&fo();var g=Va;Va|=1;var t=Wa.transition,n=Zg;try{if(Wa.transition=null,Zg=1,e)return e()}finally{Zg=n,Wa.transition=t,0===(6&(Va=g))&&zI()}}function co(){Ja=Ya.current,vI(Ya)}function uo(e,g){e.finishedWork=null,e.finishedLanes=0;var t=e.timeoutHandle;if(-1!==t&&(e.timeoutHandle=-1,II(t)),null!==Ra)for(t=Ra.return;null!==t;){var n=t;switch(gr(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&YI();break;case 3:IC(),vI(kI),vI(VI),iC();break;case 5:CC(n);break;case 4:IC();break;case 13:case 19:vI(lC);break;case 10:Gr(n.type._context);break;case 22:case 23:co()}t=t.return}if(ka=e,Ra=e=wo(e.current,null),Xa=Ja=g,wa=0,Ha=null,Ka=Fa=Na=0,Ea=xa=null,null!==Sr){for(g=0;g<Sr.length;g++)if(null!==(n=(t=Sr[g]).interleaved)){t.interleaved=null;var I=n.next,r=t.pending;if(null!==r){var C=r.next;r.next=I,n.next=C}t.pending=n}Sr=null}return e}function so(e,g){for(;;){var t=Ra;try{if(yr(),cC.current=rl,hC){for(var n=AC.memoizedState;null!==n;){var I=n.queue;null!==I&&(I.pending=null),n=n.next}hC=!1}if(sC=0,mC=dC=AC=null,bC=!1,ZC=0,Sa.current=null,null===t||null===t.return){wa=1,Ha=g,Ra=null;break}e:{var C=e,l=t.return,a=t,o=g;if(g=Xa,a.flags|=32768,null!==o&&"object"===typeof o&&"function"===typeof o.then){var i=o,c=a,u=c.tag;if(0===(1&c.mode)&&(0===u||11===u||15===u)){var s=c.alternate;s?(c.updateQueue=s.updateQueue,c.memoizedState=s.memoizedState,c.lanes=s.lanes):(c.updateQueue=null,c.memoizedState=null)}var A=ml(l);if(null!==A){A.flags&=-257,hl(A,l,a,0,g),1&A.mode&&dl(C,i,g),o=i;var d=(g=A).updateQueue;if(null===d){var m=new Set;m.add(o),g.updateQueue=m}else d.add(o);break e}if(0===(1&g)){dl(C,i,g),mo();break e}o=Error(r(426))}else if(Ir&&1&a.mode){var h=ml(l);if(null!==h){0===(65536&h.flags)&&(h.flags|=256),hl(h,l,a,0,g),Ar(ol(o,a));break e}}C=o=ol(o,a),4!==wa&&(wa=2),null===xa?xa=[C]:xa.push(C),C=l;do{switch(C.tag){case 3:C.flags|=65536,g&=-g,C.lanes|=g,Nr(C,sl(0,o,g));break e;case 1:a=o;var b=C.type,Z=C.stateNode;if(0===(128&C.flags)&&("function"===typeof b.getDerivedStateFromError||null!==Z&&"function"===typeof Z.componentDidCatch&&(null===Ta||!Ta.has(Z)))){C.flags|=65536,g&=-g,C.lanes|=g,Nr(C,Al(C,a,g));break e}}C=C.return}while(null!==C)}yo(t)}catch(p){g=p,Ra===t&&null!==t&&(Ra=t=t.return);continue}break}}function Ao(){var e=va.current;return va.current=rl,null===e?rl:e}function mo(){0!==wa&&3!==wa&&2!==wa||(wa=4),null===ka||0===(268435455&Na)&&0===(268435455&Fa)||lo(ka,Xa)}function ho(e,g){var t=Va;Va|=2;var n=Ao();for(ka===e&&Xa===g||(Ua=null,uo(e,g));;)try{bo();break}catch(I){so(e,I)}if(yr(),Va=t,va.current=n,null!==Ra)throw Error(r(261));return ka=null,Xa=0,wa}function bo(){for(;null!==Ra;)po(Ra)}function Zo(){for(;null!==Ra&&!Pe();)po(Ra)}function po(e){var g=fa(e.alternate,e,Ja);e.memoizedProps=e.pendingProps,null===g?yo(e):Ra=g,Sa.current=null}function yo(e){var g=e;do{var t=g.alternate;if(e=g.return,0===(32768&g.flags)){if(null!==(t=Dl(t,g,Ja)))return void(Ra=t)}else{if(null!==(t=jl(t,g)))return t.flags&=32767,void(Ra=t);if(null===e)return wa=6,void(Ra=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(g=g.sibling))return void(Ra=g);Ra=g=e}while(null!==g);0===wa&&(wa=5)}function Go(e,g,t){var n=Zg,I=Wa.transition;try{Wa.transition=null,Zg=1,function(e,g,t,n){do{fo()}while(null!==ja);if(0!==(6&Va))throw Error(r(327));t=e.finishedWork;var I=e.finishedLanes;if(null===t)return null;if(e.finishedWork=null,e.finishedLanes=0,t===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var C=t.lanes|t.childLanes;if(function(e,g){var t=e.pendingLanes&~g;e.pendingLanes=g,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=g,e.mutableReadLanes&=g,e.entangledLanes&=g,g=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<t;){var I=31-Cg(t),r=1<<I;g[I]=0,n[I]=-1,e[I]=-1,t&=~r}}(e,C),e===ka&&(Ra=ka=null,Xa=0),0===(2064&t.subtreeFlags)&&0===(2064&t.flags)||Da||(Da=!0,Ro(gg,(function(){return fo(),null}))),C=0!==(15990&t.flags),0!==(15990&t.subtreeFlags)||C){C=Wa.transition,Wa.transition=null;var l=Zg;Zg=1;var a=Va;Va|=4,Sa.current=null,function(e,g){if(eI=Qg,sn(e=un())){if("selectionStart"in e)var t={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(t=(t=e.ownerDocument)&&t.defaultView||window).getSelection&&t.getSelection();if(n&&0!==n.rangeCount){t=n.anchorNode;var I=n.anchorOffset,C=n.focusNode;n=n.focusOffset;try{t.nodeType,C.nodeType}catch(y){t=null;break e}var l=0,a=-1,o=-1,i=0,c=0,u=e,s=null;g:for(;;){for(var A;u!==t||0!==I&&3!==u.nodeType||(a=l+I),u!==C||0!==n&&3!==u.nodeType||(o=l+n),3===u.nodeType&&(l+=u.nodeValue.length),null!==(A=u.firstChild);)s=u,u=A;for(;;){if(u===e)break g;if(s===t&&++i===I&&(a=l),s===C&&++c===n&&(o=l),null!==(A=u.nextSibling))break;s=(u=s).parentNode}u=A}t=-1===a||-1===o?null:{start:a,end:o}}else t=null}t=t||{start:0,end:0}}else t=null;for(gI={focusedElem:e,selectionRange:t},Qg=!1,ql=g;null!==ql;)if(e=(g=ql).child,0!==(1028&g.subtreeFlags)&&null!==e)e.return=g,ql=e;else for(;null!==ql;){g=ql;try{var d=g.alternate;if(0!==(1024&g.flags))switch(g.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==d){var m=d.memoizedProps,h=d.memoizedState,b=g.stateNode,Z=b.getSnapshotBeforeUpdate(g.elementType===g.type?m:mr(g.type,m),h);b.__reactInternalSnapshotBeforeUpdate=Z}break;case 3:var p=g.stateNode.containerInfo;1===p.nodeType?p.textContent="":9===p.nodeType&&p.documentElement&&p.removeChild(p.documentElement);break;default:throw Error(r(163))}}catch(y){vo(g,g.return,y)}if(null!==(e=g.sibling)){e.return=g.return,ql=e;break}ql=g.return}d=ga,ga=!1}(e,t),ma(t,e),An(gI),Qg=!!eI,gI=eI=null,e.current=t,ba(t,e,I),Oe(),Va=a,Zg=l,Wa.transition=C}else e.current=t;if(Da&&(Da=!1,ja=e,Pa=I),C=e.pendingLanes,0===C&&(Ta=null),function(e){if(rg&&"function"===typeof rg.onCommitFiberRoot)try{rg.onCommitFiberRoot(Ig,e,void 0,128===(128&e.current.flags))}catch(g){}}(t.stateNode),no(e,_e()),null!==g)for(n=e.onRecoverableError,t=0;t<g.length;t++)I=g[t],n(I.value,{componentStack:I.stack,digest:I.digest});if(Qa)throw Qa=!1,e=La,La=null,e;0!==(1&Pa)&&0!==e.tag&&fo(),C=e.pendingLanes,0!==(1&C)?e===_a?Oa++:(Oa=0,_a=e):Oa=0,zI()}(e,g,t,n)}finally{Wa.transition=I,Zg=n}return null}function fo(){if(null!==ja){var e=pg(Pa),g=Wa.transition,t=Zg;try{if(Wa.transition=null,Zg=16>e?16:e,null===ja)var n=!1;else{if(e=ja,ja=null,Pa=0,0!==(6&Va))throw Error(r(331));var I=Va;for(Va|=4,ql=e.current;null!==ql;){var C=ql,l=C.child;if(0!==(16&ql.flags)){var a=C.deletions;if(null!==a){for(var o=0;o<a.length;o++){var i=a[o];for(ql=i;null!==ql;){var c=ql;switch(c.tag){case 0:case 11:case 15:ta(8,c,C)}var u=c.child;if(null!==u)u.return=c,ql=u;else for(;null!==ql;){var s=(c=ql).sibling,A=c.return;if(ra(c),c===i){ql=null;break}if(null!==s){s.return=A,ql=s;break}ql=A}}}var d=C.alternate;if(null!==d){var m=d.child;if(null!==m){d.child=null;do{var h=m.sibling;m.sibling=null,m=h}while(null!==m)}}ql=C}}if(0!==(2064&C.subtreeFlags)&&null!==l)l.return=C,ql=l;else e:for(;null!==ql;){if(0!==(2048&(C=ql).flags))switch(C.tag){case 0:case 11:case 15:ta(9,C,C.return)}var b=C.sibling;if(null!==b){b.return=C.return,ql=b;break e}ql=C.return}}var Z=e.current;for(ql=Z;null!==ql;){var p=(l=ql).child;if(0!==(2064&l.subtreeFlags)&&null!==p)p.return=l,ql=p;else e:for(l=Z;null!==ql;){if(0!==(2048&(a=ql).flags))try{switch(a.tag){case 0:case 11:case 15:na(9,a)}}catch(G){vo(a,a.return,G)}if(a===l){ql=null;break e}var y=a.sibling;if(null!==y){y.return=a.return,ql=y;break e}ql=a.return}}if(Va=I,zI(),rg&&"function"===typeof rg.onPostCommitFiberRoot)try{rg.onPostCommitFiberRoot(Ig,e)}catch(G){}n=!0}return n}finally{Zg=t,Wa.transition=g}}return!1}function Bo(e,g,t){e=wr(e,g=sl(0,g=ol(t,g),1),1),g=eo(),null!==e&&(hg(e,1,g),no(e,g))}function vo(e,g,t){if(3===e.tag)Bo(e,e,t);else for(;null!==g;){if(3===g.tag){Bo(g,e,t);break}if(1===g.tag){var n=g.stateNode;if("function"===typeof g.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Ta||!Ta.has(n))){g=wr(g,e=Al(g,e=ol(t,e),1),1),e=eo(),null!==g&&(hg(g,1,e),no(g,e));break}}g=g.return}}function So(e,g,t){var n=e.pingCache;null!==n&&n.delete(g),g=eo(),e.pingedLanes|=e.suspendedLanes&t,ka===e&&(Xa&t)===t&&(4===wa||3===wa&&(130023424&Xa)===Xa&&500>_e()-Ma?uo(e,0):Ka|=t),no(e,g)}function Wo(e,g){0===g&&(0===(1&e.mode)?g=1:(g=ig,0===(130023424&(ig<<=1))&&(ig=4194304)));var t=eo();null!==(e=kr(e,g))&&(hg(e,g,t),no(e,t))}function Vo(e){var g=e.memoizedState,t=0;null!==g&&(t=g.retryLane),Wo(e,t)}function ko(e,g){var t=0;switch(e.tag){case 13:var n=e.stateNode,I=e.memoizedState;null!==I&&(t=I.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(r(314))}null!==n&&n.delete(g),Wo(e,t)}function Ro(e,g){return De(e,g)}function Xo(e,g,t,n){this.tag=e,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jo(e,g,t,n){return new Xo(e,g,t,n)}function Yo(e){return!(!(e=e.prototype)||!e.isReactComponent)}function wo(e,g){var t=e.alternate;return null===t?((t=Jo(e.tag,g,e.key,e.mode)).elementType=e.elementType,t.type=e.type,t.stateNode=e.stateNode,t.alternate=e,e.alternate=t):(t.pendingProps=g,t.type=e.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=14680064&e.flags,t.childLanes=e.childLanes,t.lanes=e.lanes,t.child=e.child,t.memoizedProps=e.memoizedProps,t.memoizedState=e.memoizedState,t.updateQueue=e.updateQueue,g=e.dependencies,t.dependencies=null===g?null:{lanes:g.lanes,firstContext:g.firstContext},t.sibling=e.sibling,t.index=e.index,t.ref=e.ref,t}function Ho(e,g,t,n,I,C){var l=2;if(n=e,"function"===typeof e)Yo(e)&&(l=1);else if("string"===typeof e)l=5;else e:switch(e){case f:return No(t.children,I,C,g);case B:l=8,I|=8;break;case v:return(e=Jo(12,t,g,2|I)).elementType=v,e.lanes=C,e;case k:return(e=Jo(13,t,g,I)).elementType=k,e.lanes=C,e;case R:return(e=Jo(19,t,g,I)).elementType=R,e.lanes=C,e;case Y:return Fo(t,I,C,g);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:l=10;break e;case W:l=9;break e;case V:l=11;break e;case X:l=14;break e;case J:l=16,n=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(g=Jo(l,t,g,I)).elementType=e,g.type=n,g.lanes=C,g}function No(e,g,t,n){return(e=Jo(7,e,n,g)).lanes=t,e}function Fo(e,g,t,n){return(e=Jo(22,e,n,g)).elementType=Y,e.lanes=t,e.stateNode={isHidden:!1},e}function Ko(e,g,t){return(e=Jo(6,e,null,g)).lanes=t,e}function xo(e,g,t){return(g=Jo(4,null!==e.children?e.children:[],e.key,g)).lanes=t,g.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},g}function Eo(e,g,t,n,I){this.tag=g,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mg(0),this.expirationTimes=mg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mg(0),this.identifierPrefix=n,this.onRecoverableError=I,this.mutableSourceEagerHydrationData=null}function Mo(e,g,t,n,I,r,C,l,a){return e=new Eo(e,g,t,l,a),1===g?(g=1,!0===r&&(g|=8)):g=0,r=Jo(3,null,null,g),e.current=r,r.stateNode=e,r.memoizedState={element:n,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xr(r),e}function zo(e){if(!e)return WI;e:{if(ze(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var g=e;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(JI(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(null!==g);throw Error(r(171))}if(1===e.tag){var t=e.type;if(JI(t))return HI(e,t,g)}return g}function Uo(e,g,t,n,I,r,C,l,a){return(e=Mo(t,n,!0,e,0,r,0,l,a)).context=zo(null),t=e.current,(r=Yr(n=eo(),I=go(t))).callback=void 0!==g&&null!==g?g:null,wr(t,r,I),e.current.lanes=I,hg(e,I,n),no(e,n),e}function Qo(e,g,t,n){var I=g.current,r=eo(),C=go(I);return t=zo(t),null===g.context?g.context=t:g.pendingContext=t,(g=Yr(r,C)).payload={element:e},null!==(n=void 0===n?null:n)&&(g.callback=n),null!==(e=wr(I,g,C))&&(to(e,I,C,r),Hr(e,I,C)),C}function Lo(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function To(e,g){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var t=e.retryLane;e.retryLane=0!==t&&t<g?t:g}}function Do(e,g){To(e,g),(e=e.alternate)&&To(e,g)}fa=function(e,g,t){if(null!==e)if(e.memoizedProps!==g.pendingProps||kI.current)Zl=!0;else{if(0===(e.lanes&t)&&0===(128&g.flags))return Zl=!1,function(e,g,t){switch(g.tag){case 3:kl(g),sr();break;case 5:rC(g);break;case 1:JI(g.type)&&NI(g);break;case 4:nC(g,g.stateNode.containerInfo);break;case 10:var n=g.type._context,I=g.memoizedProps.value;SI(hr,n._currentValue),n._currentValue=I;break;case 13:if(null!==(n=g.memoizedState))return null!==n.dehydrated?(SI(lC,1&lC.current),g.flags|=128,null):0!==(t&g.child.childLanes)?Fl(e,g,t):(SI(lC,1&lC.current),null!==(e=Ql(e,g,t))?e.sibling:null);SI(lC,1&lC.current);break;case 19:if(n=0!==(t&g.childLanes),0!==(128&e.flags)){if(n)return zl(e,g,t);g.flags|=128}if(null!==(I=g.memoizedState)&&(I.rendering=null,I.tail=null,I.lastEffect=null),SI(lC,lC.current),n)break;return null;case 22:case 23:return g.lanes=0,Bl(e,g,t)}return Ql(e,g,t)}(e,g,t);Zl=0!==(131072&e.flags)}else Zl=!1,Ir&&0!==(1048576&g.flags)&&$I(g,TI,g.index);switch(g.lanes=0,g.tag){case 2:var n=g.type;Ul(e,g),e=g.pendingProps;var I=XI(g,VI.current);Br(g,t),I=fC(null,g,n,e,I,t);var C=BC();return g.flags|=1,"object"===typeof I&&null!==I&&"function"===typeof I.render&&void 0===I.$$typeof?(g.tag=1,g.memoizedState=null,g.updateQueue=null,JI(n)?(C=!0,NI(g)):C=!1,g.memoizedState=null!==I.state&&void 0!==I.state?I.state:null,Xr(g),I.updater=Mr,g.stateNode=I,I._reactInternals=g,Lr(g,n,e,t),g=Vl(null,g,n,!0,C,t)):(g.tag=0,Ir&&C&&er(g),pl(null,g,I,t),g=g.child),g;case 16:n=g.elementType;e:{switch(Ul(e,g),e=g.pendingProps,n=(I=n._init)(n._payload),g.type=n,I=g.tag=function(e){if("function"===typeof e)return Yo(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===V)return 11;if(e===X)return 14}return 2}(n),e=mr(n,e),I){case 0:g=Sl(null,g,n,e,t);break e;case 1:g=Wl(null,g,n,e,t);break e;case 11:g=yl(null,g,n,e,t);break e;case 14:g=Gl(null,g,n,mr(n.type,e),t);break e}throw Error(r(306,n,""))}return g;case 0:return n=g.type,I=g.pendingProps,Sl(e,g,n,I=g.elementType===n?I:mr(n,I),t);case 1:return n=g.type,I=g.pendingProps,Wl(e,g,n,I=g.elementType===n?I:mr(n,I),t);case 3:e:{if(kl(g),null===e)throw Error(r(387));n=g.pendingProps,I=(C=g.memoizedState).element,Jr(e,g),Fr(g,n,null,t);var l=g.memoizedState;if(n=l.element,C.isDehydrated){if(C={element:n,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},g.updateQueue.baseState=C,g.memoizedState=C,256&g.flags){g=Rl(e,g,n,t,I=ol(Error(r(423)),g));break e}if(n!==I){g=Rl(e,g,n,t,I=ol(Error(r(424)),g));break e}for(nr=oI(g.stateNode.containerInfo.firstChild),tr=g,Ir=!0,rr=null,t=_r(g,null,n,t),g.child=t;t;)t.flags=-3&t.flags|4096,t=t.sibling}else{if(sr(),n===I){g=Ql(e,g,t);break e}pl(e,g,n,t)}g=g.child}return g;case 5:return rC(g),null===e&&or(g),n=g.type,I=g.pendingProps,C=null!==e?e.memoizedProps:null,l=I.children,tI(n,I)?l=null:null!==C&&tI(n,C)&&(g.flags|=32),vl(e,g),pl(e,g,l,t),g.child;case 6:return null===e&&or(g),null;case 13:return Fl(e,g,t);case 4:return nC(g,g.stateNode.containerInfo),n=g.pendingProps,null===e?g.child=Or(g,null,n,t):pl(e,g,n,t),g.child;case 11:return n=g.type,I=g.pendingProps,yl(e,g,n,I=g.elementType===n?I:mr(n,I),t);case 7:return pl(e,g,g.pendingProps,t),g.child;case 8:case 12:return pl(e,g,g.pendingProps.children,t),g.child;case 10:e:{if(n=g.type._context,I=g.pendingProps,C=g.memoizedProps,l=I.value,SI(hr,n._currentValue),n._currentValue=l,null!==C)if(Cn(C.value,l)){if(C.children===I.children&&!kI.current){g=Ql(e,g,t);break e}}else for(null!==(C=g.child)&&(C.return=g);null!==C;){var a=C.dependencies;if(null!==a){l=C.child;for(var o=a.firstContext;null!==o;){if(o.context===n){if(1===C.tag){(o=Yr(-1,t&-t)).tag=2;var i=C.updateQueue;if(null!==i){var c=(i=i.shared).pending;null===c?o.next=o:(o.next=c.next,c.next=o),i.pending=o}}C.lanes|=t,null!==(o=C.alternate)&&(o.lanes|=t),fr(C.return,t,g),a.lanes|=t;break}o=o.next}}else if(10===C.tag)l=C.type===g.type?null:C.child;else if(18===C.tag){if(null===(l=C.return))throw Error(r(341));l.lanes|=t,null!==(a=l.alternate)&&(a.lanes|=t),fr(l,t,g),l=C.sibling}else l=C.child;if(null!==l)l.return=C;else for(l=C;null!==l;){if(l===g){l=null;break}if(null!==(C=l.sibling)){C.return=l.return,l=C;break}l=l.return}C=l}pl(e,g,I.children,t),g=g.child}return g;case 9:return I=g.type,n=g.pendingProps.children,Br(g,t),n=n(I=vr(I)),g.flags|=1,pl(e,g,n,t),g.child;case 14:return I=mr(n=g.type,g.pendingProps),Gl(e,g,n,I=mr(n.type,I),t);case 15:return fl(e,g,g.type,g.pendingProps,t);case 17:return n=g.type,I=g.pendingProps,I=g.elementType===n?I:mr(n,I),Ul(e,g),g.tag=1,JI(n)?(e=!0,NI(g)):e=!1,Br(g,t),Ur(g,n,I),Lr(g,n,I,t),Vl(null,g,n,!0,e,t);case 19:return zl(e,g,t);case 22:return Bl(e,g,t)}throw Error(r(156,g.tag))};var jo="function"===typeof reportError?reportError:function(e){console.error(e)};function Po(e){this._internalRoot=e}function Oo(e){this._internalRoot=e}function _o(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function qo(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function $o(){}function ei(e,g,t,n,I){var r=t._reactRootContainer;if(r){var C=r;if("function"===typeof I){var l=I;I=function(){var e=Lo(C);l.call(e)}}Qo(g,C,e,I)}else C=function(e,g,t,n,I){if(I){if("function"===typeof n){var r=n;n=function(){var e=Lo(C);r.call(e)}}var C=Uo(g,n,e,0,null,!1,0,"",$o);return e._reactRootContainer=C,e[AI]=C.current,zn(8===e.nodeType?e.parentNode:e),io(),C}for(;I=e.lastChild;)e.removeChild(I);if("function"===typeof n){var l=n;n=function(){var e=Lo(a);l.call(e)}}var a=Mo(e,0,!1,null,0,!1,0,"",$o);return e._reactRootContainer=a,e[AI]=a.current,zn(8===e.nodeType?e.parentNode:e),io((function(){Qo(g,a,t,n)})),a}(t,g,e,I,n);return Lo(C)}Oo.prototype.render=Po.prototype.render=function(e){var g=this._internalRoot;if(null===g)throw Error(r(409));Qo(e,g,null,null)},Oo.prototype.unmount=Po.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var g=e.containerInfo;io((function(){Qo(null,e,null,null)})),g[AI]=null}},Oo.prototype.unstable_scheduleHydration=function(e){if(e){var g=Bg();e={blockedOn:null,target:e,priority:g};for(var t=0;t<Yg.length&&0!==g&&g<Yg[t].priority;t++);Yg.splice(t,0,e),0===t&&Fg(e)}},yg=function(e){switch(e.tag){case 3:var g=e.stateNode;if(g.current.memoizedState.isDehydrated){var t=cg(g.pendingLanes);0!==t&&(bg(g,1|t),no(g,_e()),0===(6&Va)&&(za=_e()+500,zI()))}break;case 13:io((function(){var g=kr(e,1);if(null!==g){var t=eo();to(g,e,1,t)}})),Do(e,1)}},Gg=function(e){if(13===e.tag){var g=kr(e,134217728);if(null!==g)to(g,e,134217728,eo());Do(e,134217728)}},fg=function(e){if(13===e.tag){var g=go(e),t=kr(e,g);if(null!==t)to(t,e,g,eo());Do(e,g)}},Bg=function(){return Zg},vg=function(e,g){var t=Zg;try{return Zg=e,g()}finally{Zg=t}},Ge=function(e,g,t){switch(g){case"input":if(q(e,t),g=t.name,"radio"===t.type&&null!=g){for(t=e;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<t.length;g++){var n=t[g];if(n!==e&&n.form===e.form){var I=yI(n);if(!I)throw Error(r(90));D(n),q(n,I)}}}break;case"textarea":re(e,t);break;case"select":null!=(g=t.value)&&te(e,!!t.multiple,g,!1)}},Ve=oo,ke=io;var gi={usingClientEntryPoint:!1,Events:[ZI,pI,yI,Se,We,oo]},ti={findFiberByHostInstance:bI,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ni={bundleType:ti.bundleType,version:ti.version,rendererPackageName:ti.rendererPackageName,rendererConfig:ti.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:p.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Le(e))?null:e.stateNode},findFiberByHostInstance:ti.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Ii=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ii.isDisabled&&Ii.supportsFiber)try{Ig=Ii.inject(ni),rg=Ii}catch(ie){}}g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gi,g.createPortal=function(e,g){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!_o(g))throw Error(r(200));return function(e,g,t){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:G,key:null==n?null:""+n,children:e,containerInfo:g,implementation:t}}(e,g,null,t)},g.createRoot=function(e,g){if(!_o(e))throw Error(r(299));var t=!1,n="",I=jo;return null!==g&&void 0!==g&&(!0===g.unstable_strictMode&&(t=!0),void 0!==g.identifierPrefix&&(n=g.identifierPrefix),void 0!==g.onRecoverableError&&(I=g.onRecoverableError)),g=Mo(e,1,!1,null,0,t,0,n,I),e[AI]=g.current,zn(8===e.nodeType?e.parentNode:e),new Po(g)},g.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var g=e._reactInternals;if(void 0===g){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Le(g))?null:e.stateNode},g.flushSync=function(e){return io(e)},g.hydrate=function(e,g,t){if(!qo(g))throw Error(r(200));return ei(null,e,g,!0,t)},g.hydrateRoot=function(e,g,t){if(!_o(e))throw Error(r(405));var n=null!=t&&t.hydratedSources||null,I=!1,C="",l=jo;if(null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(I=!0),void 0!==t.identifierPrefix&&(C=t.identifierPrefix),void 0!==t.onRecoverableError&&(l=t.onRecoverableError)),g=Uo(g,null,e,1,null!=t?t:null,I,0,C,l),e[AI]=g.current,zn(e),n)for(e=0;e<n.length;e++)I=(I=(t=n[e])._getVersion)(t._source),null==g.mutableSourceEagerHydrationData?g.mutableSourceEagerHydrationData=[t,I]:g.mutableSourceEagerHydrationData.push(t,I);return new Oo(g)},g.render=function(e,g,t){if(!qo(g))throw Error(r(200));return ei(null,e,g,!1,t)},g.unmountComponentAtNode=function(e){if(!qo(e))throw Error(r(40));return!!e._reactRootContainer&&(io((function(){ei(null,null,e,!1,(function(){e._reactRootContainer=null,e[AI]=null}))})),!0)},g.unstable_batchedUpdates=oo,g.unstable_renderSubtreeIntoContainer=function(e,g,t,n){if(!qo(t))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return ei(e,g,t,!1,n)},g.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,g,t){"use strict";var n=t(4164);g.createRoot=n.createRoot,g.hydrateRoot=n.hydrateRoot},4164:function(e,g,t){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(g){console.error(g)}}(),e.exports=t(4463)},77:function(e){"use strict";var g=Array.isArray,t=Object.keys,n=Object.prototype.hasOwnProperty,I="undefined"!==typeof Element;function r(e,C){if(e===C)return!0;if(e&&C&&"object"==typeof e&&"object"==typeof C){var l,a,o,i=g(e),c=g(C);if(i&&c){if((a=e.length)!=C.length)return!1;for(l=a;0!==l--;)if(!r(e[l],C[l]))return!1;return!0}if(i!=c)return!1;var u=e instanceof Date,s=C instanceof Date;if(u!=s)return!1;if(u&&s)return e.getTime()==C.getTime();var A=e instanceof RegExp,d=C instanceof RegExp;if(A!=d)return!1;if(A&&d)return e.toString()==C.toString();var m=t(e);if((a=m.length)!==t(C).length)return!1;for(l=a;0!==l--;)if(!n.call(C,m[l]))return!1;if(I&&e instanceof Element&&C instanceof Element)return e===C;for(l=a;0!==l--;)if(("_owner"!==(o=m[l])||!e.$$typeof)&&!r(e[o],C[o]))return!1;return!0}return e!==e&&C!==C}e.exports=function(e,g){try{return r(e,g)}catch(t){if(t.message&&t.message.match(/stack|recursion/i)||-2146828260===t.number)return console.warn("Warning: react-fast-compare does not handle circular references.",t.name,t.message),!1;throw t}}},1372:function(e,g){"use strict";var t="function"===typeof Symbol&&Symbol.for,n=t?Symbol.for("react.element"):60103,I=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,C=t?Symbol.for("react.strict_mode"):60108,l=t?Symbol.for("react.profiler"):60114,a=t?Symbol.for("react.provider"):60109,o=t?Symbol.for("react.context"):60110,i=t?Symbol.for("react.async_mode"):60111,c=t?Symbol.for("react.concurrent_mode"):60111,u=t?Symbol.for("react.forward_ref"):60112,s=t?Symbol.for("react.suspense"):60113,A=t?Symbol.for("react.suspense_list"):60120,d=t?Symbol.for("react.memo"):60115,m=t?Symbol.for("react.lazy"):60116,h=t?Symbol.for("react.block"):60121,b=t?Symbol.for("react.fundamental"):60117,Z=t?Symbol.for("react.responder"):60118,p=t?Symbol.for("react.scope"):60119;function y(e){if("object"===typeof e&&null!==e){var g=e.$$typeof;switch(g){case n:switch(e=e.type){case i:case c:case r:case l:case C:case s:return e;default:switch(e=e&&e.$$typeof){case o:case u:case m:case d:case a:return e;default:return g}}case I:return g}}}function G(e){return y(e)===c}g.AsyncMode=i,g.ConcurrentMode=c,g.ContextConsumer=o,g.ContextProvider=a,g.Element=n,g.ForwardRef=u,g.Fragment=r,g.Lazy=m,g.Memo=d,g.Portal=I,g.Profiler=l,g.StrictMode=C,g.Suspense=s,g.isAsyncMode=function(e){return G(e)||y(e)===i},g.isConcurrentMode=G,g.isContextConsumer=function(e){return y(e)===o},g.isContextProvider=function(e){return y(e)===a},g.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===n},g.isForwardRef=function(e){return y(e)===u},g.isFragment=function(e){return y(e)===r},g.isLazy=function(e){return y(e)===m},g.isMemo=function(e){return y(e)===d},g.isPortal=function(e){return y(e)===I},g.isProfiler=function(e){return y(e)===l},g.isStrictMode=function(e){return y(e)===C},g.isSuspense=function(e){return y(e)===s},g.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===r||e===c||e===l||e===C||e===s||e===A||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===d||e.$$typeof===a||e.$$typeof===o||e.$$typeof===u||e.$$typeof===b||e.$$typeof===Z||e.$$typeof===p||e.$$typeof===h)},g.typeOf=y},7441:function(e,g,t){"use strict";e.exports=t(1372)},9008:function(e,g,t){e.exports=function(e){"use strict";function g(e){if(e&&e.__esModule)return e;var g=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(g,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),g.default=e,Object.freeze(g)}var t=g(e);function n(){return n=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n.apply(this,arguments)}function I(e,g,t){return g in e?Object.defineProperty(e,g,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[g]=t,e}function r(e){if(Array.isArray(e))return e}function C(e,g){var t=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,I,r=[],C=!0,l=!1;try{for(t=t.call(e);!(C=(n=t.next()).done)&&(r.push(n.value),!g||r.length!==g);C=!0);}catch(a){l=!0,I=a}finally{try{C||null==t.return||t.return()}finally{if(l)throw I}}return r}}function l(e,g){(null==g||g>e.length)&&(g=e.length);for(var t=0,n=new Array(g);t<g;t++)n[t]=e[t];return n}function a(e,g){if(e){if("string"===typeof e)return l(e,g);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,g):void 0}}function o(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,g){return r(e)||C(e,g)||a(e,g)||o()}function c(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}function u(e,g){if(null==e)return{};var t,n,I=c(e,g);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(I[t]=e[t])}return I}var s={exports:{}},A={exports:{}},d={},m="function"===typeof Symbol&&Symbol.for,h=m?Symbol.for("react.element"):60103,b=m?Symbol.for("react.portal"):60106,Z=m?Symbol.for("react.fragment"):60107,p=m?Symbol.for("react.strict_mode"):60108,y=m?Symbol.for("react.profiler"):60114,G=m?Symbol.for("react.provider"):60109,f=m?Symbol.for("react.context"):60110,B=m?Symbol.for("react.async_mode"):60111,v=m?Symbol.for("react.concurrent_mode"):60111,S=m?Symbol.for("react.forward_ref"):60112,W=m?Symbol.for("react.suspense"):60113,V=m?Symbol.for("react.suspense_list"):60120,k=m?Symbol.for("react.memo"):60115,R=m?Symbol.for("react.lazy"):60116,X=m?Symbol.for("react.block"):60121,J=m?Symbol.for("react.fundamental"):60117,Y=m?Symbol.for("react.responder"):60118,w=m?Symbol.for("react.scope"):60119;function H(e){if("object"===typeof e&&null!==e){var g=e.$$typeof;switch(g){case h:switch(e=e.type){case B:case v:case Z:case y:case p:case W:return e;default:switch(e=e&&e.$$typeof){case f:case S:case R:case k:case G:return e;default:return g}}case b:return g}}}function N(e){return H(e)===v}d.AsyncMode=B,d.ConcurrentMode=v,d.ContextConsumer=f,d.ContextProvider=G,d.Element=h,d.ForwardRef=S,d.Fragment=Z,d.Lazy=R,d.Memo=k,d.Portal=b,d.Profiler=y,d.StrictMode=p,d.Suspense=W,d.isAsyncMode=function(e){return N(e)||H(e)===B},d.isConcurrentMode=N,d.isContextConsumer=function(e){return H(e)===f},d.isContextProvider=function(e){return H(e)===G},d.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===h},d.isForwardRef=function(e){return H(e)===S},d.isFragment=function(e){return H(e)===Z},d.isLazy=function(e){return H(e)===R},d.isMemo=function(e){return H(e)===k},d.isPortal=function(e){return H(e)===b},d.isProfiler=function(e){return H(e)===y},d.isStrictMode=function(e){return H(e)===p},d.isSuspense=function(e){return H(e)===W},d.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===Z||e===v||e===y||e===p||e===W||e===V||"object"===typeof e&&null!==e&&(e.$$typeof===R||e.$$typeof===k||e.$$typeof===G||e.$$typeof===f||e.$$typeof===S||e.$$typeof===J||e.$$typeof===Y||e.$$typeof===w||e.$$typeof===X)},d.typeOf=H,A.exports=d;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;function F(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var g={},t=0;t<10;t++)g["_"+String.fromCharCode(t)]=t;var n=Object.getOwnPropertyNames(g).map((function(e){return g[e]}));if("0123456789"!==n.join(""))return!1;var I={};return"abcdefghijklmnopqrst".split("").forEach((function(e){I[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},I)).join("")}catch(r){return!1}}F()&&Object.assign;var K="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function x(e,g,t,n,I){}Function.call.bind(Object.prototype.hasOwnProperty),x.resetWarningCache=function(){},A.exports;var E=K;function M(){}function z(){}z.resetWarningCache=M;var U=function(){function e(e,g,t,n,I,r){if(r!==E){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}function g(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:g,element:e,elementType:e,instanceOf:g,node:e,objectOf:g,oneOf:g,oneOfType:g,shape:g,exact:g,checkPropTypes:z,resetWarningCache:M};return t.PropTypes=t,t};s.exports=U();var Q=s.exports;function L(e,g){var t=atob(e);if(g){for(var n=new Uint8Array(t.length),I=0,r=t.length;I<r;++I)n[I]=t.charCodeAt(I);return String.fromCharCode.apply(null,new Uint16Array(n.buffer))}return t}function T(e,g,t){var n=void 0===g?null:g,I=L(e,void 0!==t&&t),r=I.indexOf("\n",10)+1,C=I.substring(r)+(n?"//# sourceMappingURL="+n:""),l=new Blob([C],{type:"application/javascript"});return URL.createObjectURL(l)}function D(e,g,t){var n;return function(I){return n=n||T(e,g,t),new Worker(n,I)}}var j=D("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewoJJ3VzZSBzdHJpY3QnOwoKCXZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9OwoKCWZ1bmN0aW9uIGdldEF1Z21lbnRlZE5hbWVzcGFjZShuKSB7CgkJaWYgKG4uX19lc01vZHVsZSkgcmV0dXJuIG47CgkJdmFyIGEgPSBPYmplY3QuZGVmaW5lUHJvcGVydHkoe30sICdfX2VzTW9kdWxlJywge3ZhbHVlOiB0cnVlfSk7CgkJT2JqZWN0LmtleXMobikuZm9yRWFjaChmdW5jdGlvbiAoaykgewoJCQl2YXIgZCA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iobiwgayk7CgkJCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShhLCBrLCBkLmdldCA/IGQgOiB7CgkJCQllbnVtZXJhYmxlOiB0cnVlLAoJCQkJZ2V0OiBmdW5jdGlvbiAoKSB7CgkJCQkJcmV0dXJuIG5ba107CgkJCQl9CgkJCX0pOwoJCX0pOwoJCXJldHVybiBhOwoJfQoKCXZhciBCaW5hcnlCaXRtYXAkMSA9IHt9OwoKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBFeGNlcHRpb24kMSA9IHt9OwoKCWZ1bmN0aW9uIGZpeFByb3RvKHRhcmdldCwgcHJvdG90eXBlKSB7CgkgIHZhciBzZXRQcm90b3R5cGVPZiA9IE9iamVjdC5zZXRQcm90b3R5cGVPZjsKCSAgc2V0UHJvdG90eXBlT2YgPyBzZXRQcm90b3R5cGVPZih0YXJnZXQsIHByb3RvdHlwZSkgOiB0YXJnZXQuX19wcm90b19fID0gcHJvdG90eXBlOwoJfQoJZnVuY3Rpb24gZml4U3RhY2sodGFyZ2V0LCBmbikgewoJICBpZiAoZm4gPT09IHZvaWQgMCkgewoJICAgIGZuID0gdGFyZ2V0LmNvbnN0cnVjdG9yOwoJICB9CgoJICB2YXIgY2FwdHVyZVN0YWNrVHJhY2UgPSBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZTsKCSAgY2FwdHVyZVN0YWNrVHJhY2UgJiYgY2FwdHVyZVN0YWNrVHJhY2UodGFyZ2V0LCBmbik7Cgl9CgoJdmFyIF9fZXh0ZW5kcyRrID0gZnVuY3Rpb24gKCkgewoJICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fCB7CgkgICAgICBfX3Byb3RvX186IFtdCgkgICAgfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICBkLl9fcHJvdG9fXyA9IGI7CgkgICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgZm9yICh2YXIgcCBpbiBiKSB7IGlmIChiLmhhc093blByb3BlcnR5KHApKSB7IGRbcF0gPSBiW3BdOyB9IH0KCSAgICB9OwoKCSAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgfTsKCgkgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgoJICAgIGZ1bmN0aW9uIF9fKCkgewoJICAgICAgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7CgkgICAgfQoKCSAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgIH07Cgl9KCk7CgoJdmFyIEN1c3RvbUVycm9yID0gZnVuY3Rpb24gKF9zdXBlcikgewoJICBfX2V4dGVuZHMkayhDdXN0b21FcnJvciwgX3N1cGVyKTsKCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKG1lc3NhZ2UpIHsKCSAgICB2YXIgX25ld1RhcmdldCA9IHRoaXMuY29uc3RydWN0b3I7CgoJICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIG1lc3NhZ2UpIHx8IHRoaXM7CgoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShfdGhpcywgJ25hbWUnLCB7CgkgICAgICB2YWx1ZTogX25ld1RhcmdldC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmaXhQcm90byhfdGhpcywgX25ld1RhcmdldC5wcm90b3R5cGUpOwoJICAgIGZpeFN0YWNrKF90aGlzKTsKCSAgICByZXR1cm4gX3RoaXM7CgkgIH0KCgkgIHJldHVybiBDdXN0b21FcnJvcjsKCX0oRXJyb3IpOwoKCXZhciBfX3NwcmVhZEFycmF5cyA9IGZ1bmN0aW9uICgpIHsKCSAgdmFyIGFyZ3VtZW50cyQxID0gYXJndW1lbnRzOwoKCSAgZm9yICh2YXIgcyA9IDAsIGkgPSAwLCBpbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBpbDsgaSsrKSB7IHMgKz0gYXJndW1lbnRzJDFbaV0ubGVuZ3RoOyB9CgoJICBmb3IgKHZhciByID0gQXJyYXkocyksIGsgPSAwLCBpID0gMDsgaSA8IGlsOyBpKyspIHsgZm9yICh2YXIgYSA9IGFyZ3VtZW50c1tpXSwgaiA9IDAsIGpsID0gYS5sZW5ndGg7IGogPCBqbDsgaisrLCBrKyspIHsgcltrXSA9IGFbal07IH0gfQoKCSAgcmV0dXJuIHI7Cgl9OwoJZnVuY3Rpb24gY3VzdG9tRXJyb3JGYWN0b3J5KGZuLCBwYXJlbnQpIHsKCSAgaWYgKHBhcmVudCA9PT0gdm9pZCAwKSB7CgkgICAgcGFyZW50ID0gRXJyb3I7CgkgIH0KCgkgIGZ1bmN0aW9uIEN1c3RvbUVycm9yKCkgewoJICAgIHZhciBhcmd1bWVudHMkMSA9IGFyZ3VtZW50czsKCgkgICAgdmFyIGFyZ3MgPSBbXTsKCgkgICAgZm9yICh2YXIgX2kgPSAwOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgIGFyZ3NbX2ldID0gYXJndW1lbnRzJDFbX2ldOwoJICAgIH0KCgkgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIEN1c3RvbUVycm9yKSkgeyByZXR1cm4gbmV3IChDdXN0b21FcnJvci5iaW5kLmFwcGx5KEN1c3RvbUVycm9yLCBfX3NwcmVhZEFycmF5cyhbdm9pZCAwXSwgYXJncykpKSgpOyB9CgkgICAgcGFyZW50LmFwcGx5KHRoaXMsIGFyZ3MpOwoJICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAnbmFtZScsIHsKCSAgICAgIHZhbHVlOiBmbi5uYW1lIHx8IHBhcmVudC5uYW1lLAoJICAgICAgZW51bWVyYWJsZTogZmFsc2UsCgkgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICB9KTsKCSAgICBmbi5hcHBseSh0aGlzLCBhcmdzKTsKCSAgICBmaXhTdGFjayh0aGlzLCBDdXN0b21FcnJvcik7CgkgIH0KCgkgIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhDdXN0b21FcnJvciwgewoJICAgIHByb3RvdHlwZTogewoJICAgICAgdmFsdWU6IE9iamVjdC5jcmVhdGUocGFyZW50LnByb3RvdHlwZSwgewoJICAgICAgICBjb25zdHJ1Y3RvcjogewoJICAgICAgICAgIHZhbHVlOiBDdXN0b21FcnJvciwKCSAgICAgICAgICB3cml0YWJsZTogdHJ1ZSwKCSAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUKCSAgICAgICAgfQoJICAgICAgfSkKCSAgICB9CgkgIH0pOwoJfQoKCXZhciBjdXN0b21FcnJvciA9IC8qI19fUFVSRV9fKi9PYmplY3QuZnJlZXplKHsKCQlfX3Byb3RvX186IG51bGwsCgkJQ3VzdG9tRXJyb3I6IEN1c3RvbUVycm9yLAoJCWN1c3RvbUVycm9yRmFjdG9yeTogY3VzdG9tRXJyb3JGYWN0b3J5Cgl9KTsKCgl2YXIgcmVxdWlyZSQkMCA9IC8qQF9fUFVSRV9fKi9nZXRBdWdtZW50ZWROYW1lc3BhY2UoY3VzdG9tRXJyb3IpOwoKCXZhciBfX2V4dGVuZHMkaiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIHRzX2N1c3RvbV9lcnJvcl8xID0gcmVxdWlyZSQkMDsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRqKEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICAvKioKCSAgICAgKiBBbGxvd3MgRXhjZXB0aW9uIHRvIGJlIGNvbnN0cnVjdGVkIGRpcmVjdGx5CgkgICAgICogd2l0aCBzb21lIG1lc3NhZ2UgYW5kIHByb3RvdHlwZSBkZWZpbml0aW9uLgoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEV4Y2VwdGlvbihtZXNzYWdlKSB7CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBFeGNlcHRpb24ucHJvdG90eXBlLmdldEtpbmQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBleCA9IHRoaXMuY29uc3RydWN0b3I7CgkgICAgICAgIHJldHVybiBleC5raW5kOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSXQncyB0eXBlZCBhcyBzdHJpbmcgc28gaXQgY2FuIGJlIGV4dGVuZGVkIGFuZCBvdmVycmlkZW4uCgkgICAgICovCgkgICAgRXhjZXB0aW9uLmtpbmQgPSAnRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRXhjZXB0aW9uOwoJfSh0c19jdXN0b21fZXJyb3JfMS5DdXN0b21FcnJvcikpOwoJRXhjZXB0aW9uJDEuZGVmYXVsdCA9IEV4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSQ5ID0gRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaShJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCkgewoJICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7CgkgICAgfQoJICAgIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0lsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbjsKCX0oRXhjZXB0aW9uXzEkOS5kZWZhdWx0KSk7CglJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMS5kZWZhdWx0ID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJ5Qml0bWFwJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgQmluYXJ5Qml0bWFwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEJpbmFyeUJpdG1hcChiaW5hcml6ZXIpIHsKCSAgICAgICAgdGhpcy5iaW5hcml6ZXIgPSBiaW5hcml6ZXI7CgkgICAgICAgIGlmIChiaW5hcml6ZXIgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSRhLmRlZmF1bHQoJ0JpbmFyaXplciBtdXN0IGJlIG5vbi1udWxsLicpOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gVGhlIHdpZHRoIG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIGJpdG1hcC4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29udmVydHMgb25lIHJvdyBvZiBsdW1pbmFuY2UgZGF0YSB0byAxIGJpdCBkYXRhLiBNYXkgYWN0dWFsbHkgZG8gdGhlIGNvbnZlcnNpb24sIG9yIHJldHVybgoJICAgICAqIGNhY2hlZCBkYXRhLiBDYWxsZXJzIHNob3VsZCBhc3N1bWUgdGhpcyBtZXRob2QgaXMgZXhwZW5zaXZlIGFuZCBjYWxsIGl0IGFzIHNlbGRvbSBhcyBwb3NzaWJsZS4KCSAgICAgKiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMUQgYmFyY29kZXMgYW5kIG1heSBjaG9vc2UgdG8gYXBwbHkgc2hhcnBlbmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB5IFRoZSByb3cgdG8gZmV0Y2gsIHdoaWNoIG11c3QgYmUgaW4gWzAsIGJpdG1hcCBoZWlnaHQpCgkgICAgICogQHBhcmFtIHJvdyBBbiBvcHRpb25hbCBwcmVhbGxvY2F0ZWQgYXJyYXkuIElmIG51bGwgb3IgdG9vIHNtYWxsLCBpdCB3aWxsIGJlIGlnbm9yZWQuCgkgICAgICogICAgICAgICAgICBJZiB1c2VkLCB0aGUgQmluYXJpemVyIHdpbGwgY2FsbCBCaXRBcnJheS5jbGVhcigpLiBBbHdheXMgdXNlIHRoZSByZXR1cm5lZCBvYmplY3QuCgkgICAgICogQHJldHVybiBUaGUgYXJyYXkgb2YgYml0cyBmb3IgdGhpcyByb3cgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgcm93IGNhbid0IGJlIGJpbmFyaXplZAoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUuZ2V0QmxhY2tSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYmluYXJpemVyLmdldEJsYWNrUm93KHksIHJvdyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBhIDJEIGFycmF5IG9mIGx1bWluYW5jZSBkYXRhIHRvIDEgYml0LiBBcyBhYm92ZSwgYXNzdW1lIHRoaXMgbWV0aG9kIGlzIGV4cGVuc2l2ZQoJICAgICAqIGFuZCBkbyBub3QgY2FsbCBpdCByZXBlYXRlZGx5LiBUaGlzIG1ldGhvZCBpcyBpbnRlbmRlZCBmb3IgZGVjb2RpbmcgMkQgYmFyY29kZXMgYW5kIG1heSBvcgoJICAgICAqIG1heSBub3QgYXBwbHkgc2hhcnBlbmluZy4gVGhlcmVmb3JlLCBhIHJvdyBmcm9tIHRoaXMgbWF0cml4IG1heSBub3QgYmUgaWRlbnRpY2FsIHRvIG9uZQoJICAgICAqIGZldGNoZWQgdXNpbmcgZ2V0QmxhY2tSb3coKSwgc28gZG9uJ3QgbWl4IGFuZCBtYXRjaCBiZXR3ZWVuIHRoZW0uCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIFRoZSAyRCBhcnJheSBvZiBiaXRzIGZvciB0aGUgaW1hZ2UgKHRydWUgbWVhbnMgYmxhY2spLgoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgaW1hZ2UgY2FuJ3QgYmUgYmluYXJpemVkIHRvIG1ha2UgYSBtYXRyaXgKCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmdldEJsYWNrTWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBUaGUgbWF0cml4IGlzIGNyZWF0ZWQgb24gZGVtYW5kIHRoZSBmaXJzdCB0aW1lIGl0IGlzIHJlcXVlc3RlZCwgdGhlbiBjYWNoZWQuIFRoZXJlIGFyZSB0d28KCSAgICAgICAgLy8gcmVhc29ucyBmb3IgdGhpczoKCSAgICAgICAgLy8gMS4gVGhpcyB3b3JrIHdpbGwgbmV2ZXIgYmUgZG9uZSBpZiB0aGUgY2FsbGVyIG9ubHkgaW5zdGFsbHMgMUQgUmVhZGVyIG9iamVjdHMsIG9yIGlmIGEKCSAgICAgICAgLy8gICAgMUQgUmVhZGVyIGZpbmRzIGEgYmFyY29kZSBiZWZvcmUgdGhlIDJEIFJlYWRlcnMgcnVuLgoJICAgICAgICAvLyAyLiBUaGlzIHdvcmsgd2lsbCBvbmx5IGJlIGRvbmUgb25jZSBldmVuIGlmIHRoZSBjYWxsZXIgaW5zdGFsbHMgbXVsdGlwbGUgMkQgUmVhZGVycy4KCSAgICAgICAgaWYgKHRoaXMubWF0cml4ID09PSBudWxsIHx8IHRoaXMubWF0cml4ID09PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gdGhpcy5iaW5hcml6ZXIuZ2V0QmxhY2tNYXRyaXgoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5tYXRyaXg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFdoZXRoZXIgdGhpcyBiaXRtYXAgY2FuIGJlIGNyb3BwZWQuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5pc0Nyb3BTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggY3JvcHBlZCBpbWFnZSBkYXRhLiBJbXBsZW1lbnRhdGlvbnMgbWF5IGtlZXAgYSByZWZlcmVuY2UgdG8gdGhlCgkgICAgICogb3JpZ2luYWwgZGF0YSByYXRoZXIgdGhhbiBhIGNvcHkuIE9ubHkgY2FsbGFibGUgaWYgaXNDcm9wU3VwcG9ydGVkKCkgaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBsZWZ0IFRoZSBsZWZ0IGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0V2lkdGgoKSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB0b3AgY29vcmRpbmF0ZSwgd2hpY2ggbXVzdCBiZSBpbiBbMCxnZXRIZWlnaHQoKSkKCSAgICAgKiBAcGFyYW0gd2lkdGggVGhlIHdpZHRoIG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBoZWlnaHQgb2YgdGhlIHJlY3RhbmdsZSB0byBjcm9wLgoJICAgICAqIEByZXR1cm4gQSBjcm9wcGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBuZXdTb3VyY2UgPSB0aGlzLmJpbmFyaXplci5nZXRMdW1pbmFuY2VTb3VyY2UoKS5jcm9wKGxlZnQsIHRvcCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIGJpdG1hcCBzdXBwb3J0cyBjb3VudGVyLWNsb2Nrd2lzZSByb3RhdGlvbi4KCSAgICAgKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLmlzUm90YXRlU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkuaXNSb3RhdGVTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgQmluYXJ5Qml0bWFwLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpOwoJICAgICAgICByZXR1cm4gbmV3IEJpbmFyeUJpdG1hcCh0aGlzLmJpbmFyaXplci5jcmVhdGVCaW5hcml6ZXIobmV3U291cmNlKSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIHJvdGF0ZWQgaW1hZ2UgZGF0YSBieSA0NSBkZWdyZWVzIGNvdW50ZXJjbG9ja3dpc2UuCgkgICAgICogT25seSBjYWxsYWJsZSBpZiB7QGxpbmsgI2lzUm90YXRlU3VwcG9ydGVkKCl9IGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIEEgcm90YXRlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEJpbmFyeUJpdG1hcC5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3U291cmNlID0gdGhpcy5iaW5hcml6ZXIuZ2V0THVtaW5hbmNlU291cmNlKCkucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCk7CgkgICAgICAgIHJldHVybiBuZXcgQmluYXJ5Qml0bWFwKHRoaXMuYmluYXJpemVyLmNyZWF0ZUJpbmFyaXplcihuZXdTb3VyY2UpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaW5hcnlCaXRtYXAucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0QmxhY2tNYXRyaXgoKS50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlIC8qOiBOb3RGb3VuZEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICByZXR1cm4gJyc7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaW5hcnlCaXRtYXA7Cgl9KCkpOwoJdmFyIF9kZWZhdWx0JDMgPSBCaW5hcnlCaXRtYXAkMS5kZWZhdWx0ID0gQmluYXJ5Qml0bWFwOwoKCXZhciBIeWJyaWRCaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSA9IHt9OwoKCXZhciBCaW5hcml6ZXIkMSA9IHt9OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmluYXJpemVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogVGhpcyBjbGFzcyBoaWVyYXJjaHkgcHJvdmlkZXMgYSBzZXQgb2YgbWV0aG9kcyB0byBjb252ZXJ0IGx1bWluYW5jZSBkYXRhIHRvIDEgYml0IGRhdGEuCgkgKiBJdCBhbGxvd3MgdGhlIGFsZ29yaXRobSB0byB2YXJ5IHBvbHltb3JwaGljYWxseSwgZm9yIGV4YW1wbGUgYWxsb3dpbmcgYSB2ZXJ5IGV4cGVuc2l2ZQoJICogdGhyZXNob2xkaW5nIHRlY2huaXF1ZSBmb3Igc2VydmVycyBhbmQgYSBmYXN0IG9uZSBmb3IgbW9iaWxlLiBJdCBhbHNvIHBlcm1pdHMgdGhlIGltcGxlbWVudGF0aW9uCgkgKiB0byB2YXJ5LCBlLmcuIGEgSk5JIHZlcnNpb24gZm9yIEFuZHJvaWQgYW5kIGEgSmF2YSBmYWxsYmFjayB2ZXJzaW9uIGZvciBvdGhlciBwbGF0Zm9ybXMuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpbmFyaXplciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBCaW5hcml6ZXIoc291cmNlKSB7CgkgICAgICAgIHRoaXMuc291cmNlID0gc291cmNlOwoJICAgIH0KCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEx1bWluYW5jZVNvdXJjZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlOwoJICAgIH07CgkgICAgQmluYXJpemVyLnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldFdpZHRoKCk7CgkgICAgfTsKCSAgICBCaW5hcml6ZXIucHJvdG90eXBlLmdldEhlaWdodCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc291cmNlLmdldEhlaWdodCgpOwoJICAgIH07CgkgICAgcmV0dXJuIEJpbmFyaXplcjsKCX0oKSk7CglCaW5hcml6ZXIkMS5kZWZhdWx0ID0gQmluYXJpemVyOwoKCXZhciBCaXRBcnJheSQxID0ge307CgoJdmFyIEFycmF5cyQxID0ge307CgoJdmFyIFN5c3RlbSQxID0ge307CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN5c3RlbSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIFN5c3RlbSgpIHsKCSAgICB9CgkgICAgLy8gcHVibGljIHN0YXRpYyB2b2lkIGFycmF5Y29weShPYmplY3Qgc3JjLCBpbnQgc3JjUG9zLCBPYmplY3QgZGVzdCwgaW50IGRlc3RQb3MsIGludCBsZW5ndGgpCgkgICAgLyoqCgkgICAgICogTWFrZXMgYSBjb3B5IG9mIGEgYXJyYXkuCgkgICAgICovCgkgICAgU3lzdGVtLmFycmF5Y29weSA9IGZ1bmN0aW9uIChzcmMsIHNyY1BvcywgZGVzdCwgZGVzdFBvcywgbGVuZ3RoKSB7CgkgICAgICAgIC8vIFRPRE86IGJldHRlciB1c2Ugc3BsaXQgb3Igc2V0PwoJICAgICAgICB3aGlsZSAobGVuZ3RoLS0pIHsKCSAgICAgICAgICAgIGRlc3RbZGVzdFBvcysrXSA9IHNyY1tzcmNQb3MrK107CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIGN1cnJlbnQgdGltZSBpbiBtaWxsaXNlY29uZHMuCgkgICAgICovCgkgICAgU3lzdGVtLmN1cnJlbnRUaW1lTWlsbGlzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gRGF0ZS5ub3coKTsKCSAgICB9OwoJICAgIHJldHVybiBTeXN0ZW07Cgl9KCkpOwoJU3lzdGVtJDEuZGVmYXVsdCA9IFN5c3RlbTsKCgl2YXIgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyRoID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDggPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkaChJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbi5raW5kID0gJ0luZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ4LmRlZmF1bHQpKTsKCUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gSW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbjsKCgl2YXIgX19leHRlbmRzJGcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uXzEgPSBJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uJDE7CgkvKioKCSAqIEN1c3RvbSBFcnJvciBjbGFzcyBvZiB0eXBlIEV4Y2VwdGlvbi4KCSAqLwoJdmFyIEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZyhBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uKGluZGV4LCBtZXNzYWdlKSB7CgkgICAgICAgIGlmIChpbmRleCA9PT0gdm9pZCAwKSB7IGluZGV4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIGlmIChtZXNzYWdlID09PSB2b2lkIDApIHsgbWVzc2FnZSA9IHVuZGVmaW5lZDsgfQoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBtZXNzYWdlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5pbmRleCA9IGluZGV4OwoJICAgICAgICBfdGhpcy5tZXNzYWdlID0gbWVzc2FnZTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24ua2luZCA9ICdBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24nOwoJICAgIHJldHVybiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb247Cgl9KEluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KSk7CglBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24kMS5kZWZhdWx0ID0gQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uOwoKCXZhciBfX3ZhbHVlcyQ3ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFycmF5cyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3lzdGVtXzEkNSA9IFN5c3RlbSQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDkgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMSA9IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbiQxOwoJdmFyIEFycmF5cyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBcnJheXMoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQgYXJyYXkKCSAgICAgKiBvZiBpbnRzLgoJICAgICAqCgkgICAgICogQHBhcmFtIGEgdGhlIGFycmF5IHRvIGJlIGZpbGxlZAoJICAgICAqIEBwYXJhbSB2YWwgdGhlIHZhbHVlIHRvIGJlIHN0b3JlZCBpbiBhbGwgZWxlbWVudHMgb2YgdGhlIGFycmF5CgkgICAgICovCgkgICAgQXJyYXlzLmZpbGwgPSBmdW5jdGlvbiAoYSwgdmFsKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBhLmxlbmd0aDsgaSA8IGxlbjsgaSsrKQoJICAgICAgICAgICAgYVtpXSA9IHZhbDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFzc2lnbnMgdGhlIHNwZWNpZmllZCBpbnQgdmFsdWUgdG8gZWFjaCBlbGVtZW50IG9mIHRoZSBzcGVjaWZpZWQKCSAgICAgKiByYW5nZSBvZiB0aGUgc3BlY2lmaWVkIGFycmF5IG9mIGludHMuICBUaGUgcmFuZ2UgdG8gYmUgZmlsbGVkCgkgICAgICogZXh0ZW5kcyBmcm9tIGluZGV4IHtAY29kZSBmcm9tSW5kZXh9LCBpbmNsdXNpdmUsIHRvIGluZGV4CgkgICAgICoge0Bjb2RlIHRvSW5kZXh9LCBleGNsdXNpdmUuICAoSWYge0Bjb2RlIGZyb21JbmRleD09dG9JbmRleH0sIHRoZQoJICAgICAqIHJhbmdlIHRvIGJlIGZpbGxlZCBpcyBlbXB0eS4pCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYSB0aGUgYXJyYXkgdG8gYmUgZmlsbGVkCgkgICAgICogQHBhcmFtIGZyb21JbmRleCB0aGUgaW5kZXggb2YgdGhlIGZpcnN0IGVsZW1lbnQgKGluY2x1c2l2ZSkgdG8gYmUKCSAgICAgKiAgICAgICAgZmlsbGVkIHdpdGggdGhlIHNwZWNpZmllZCB2YWx1ZQoJICAgICAqIEBwYXJhbSB0b0luZGV4IHRoZSBpbmRleCBvZiB0aGUgbGFzdCBlbGVtZW50IChleGNsdXNpdmUpIHRvIGJlCgkgICAgICogICAgICAgIGZpbGxlZCB3aXRoIHRoZSBzcGVjaWZpZWQgdmFsdWUKCSAgICAgKiBAcGFyYW0gdmFsIHRoZSB2YWx1ZSB0byBiZSBzdG9yZWQgaW4gYWxsIGVsZW1lbnRzIG9mIHRoZSBhcnJheQoJICAgICAqIEB0aHJvd3MgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPiB0b0luZGV4fQoJICAgICAqIEB0aHJvd3MgQXJyYXlJbmRleE91dE9mQm91bmRzRXhjZXB0aW9uIGlmIHtAY29kZSBmcm9tSW5kZXggPCAwfSBvcgoJICAgICAqICAgICAgICAge0Bjb2RlIHRvSW5kZXggPiBhLmxlbmd0aH0KCSAgICAgKi8KCSAgICBBcnJheXMuZmlsbFdpdGhpbiA9IGZ1bmN0aW9uIChhLCBmcm9tSW5kZXgsIHRvSW5kZXgsIHZhbCkgewoJICAgICAgICBBcnJheXMucmFuZ2VDaGVjayhhLmxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZyb21JbmRleDsgaSA8IHRvSW5kZXg7IGkrKykKCSAgICAgICAgICAgIGFbaV0gPSB2YWw7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDaGVja3MgdGhhdCB7QGNvZGUgZnJvbUluZGV4fSBhbmQge0Bjb2RlIHRvSW5kZXh9IGFyZSBpbgoJICAgICAqIHRoZSByYW5nZSBhbmQgdGhyb3dzIGFuIGV4Y2VwdGlvbiBpZiB0aGV5IGFyZW4ndC4KCSAgICAgKi8KCSAgICBBcnJheXMucmFuZ2VDaGVjayA9IGZ1bmN0aW9uIChhcnJheUxlbmd0aCwgZnJvbUluZGV4LCB0b0luZGV4KSB7CgkgICAgICAgIGlmIChmcm9tSW5kZXggPiB0b0luZGV4KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOS5kZWZhdWx0KCdmcm9tSW5kZXgoJyArIGZyb21JbmRleCArICcpID4gdG9JbmRleCgnICsgdG9JbmRleCArICcpJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGZyb21JbmRleCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb25fMS5kZWZhdWx0KGZyb21JbmRleCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvSW5kZXggPiBhcnJheUxlbmd0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEFycmF5SW5kZXhPdXRPZkJvdW5kc0V4Y2VwdGlvbl8xLmRlZmF1bHQodG9JbmRleCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEFycmF5cy5hc0xpc3QgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBhcmdzID0gW107CgkgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CgkgICAgICAgICAgICBhcmdzW19pXSA9IGFyZ3VtZW50c1tfaV07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGFyZ3M7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlID0gZnVuY3Rpb24gKHJvd3MsIGNvbHMsIHZhbHVlKSB7CgkgICAgICAgIHZhciBhcnIgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiByb3dzIH0pOwoJICAgICAgICByZXR1cm4gYXJyLm1hcChmdW5jdGlvbiAoeCkgeyByZXR1cm4gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuY3JlYXRlSW50MzJBcnJheSA9IGZ1bmN0aW9uIChyb3dzLCBjb2xzLCB2YWx1ZSkgewoJICAgICAgICB2YXIgYXJyID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogcm93cyB9KTsKCSAgICAgICAgcmV0dXJuIGFyci5tYXAoZnVuY3Rpb24gKHgpIHsgcmV0dXJuIEludDMyQXJyYXkuZnJvbSh7IGxlbmd0aDogY29scyB9KS5maWxsKHZhbHVlKTsgfSk7CgkgICAgfTsKCSAgICBBcnJheXMuZXF1YWxzID0gZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKCSAgICAgICAgaWYgKCFmaXJzdCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIGlmICghc2Vjb25kKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKCFmaXJzdC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoIXNlY29uZC5sZW5ndGgpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZmlyc3QubGVuZ3RoICE9PSBzZWNvbmQubGVuZ3RoKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gZmlyc3QubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgaWYgKGZpcnN0W2ldICE9PSBzZWNvbmRbaV0pIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICBBcnJheXMuaGFzaENvZGUgPSBmdW5jdGlvbiAoYSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgaWYgKGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSAxOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgYV8xID0gX192YWx1ZXMkNyhhKSwgYV8xXzEgPSBhXzEubmV4dCgpOyAhYV8xXzEuZG9uZTsgYV8xXzEgPSBhXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBhXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAzMSAqIHJlc3VsdCArIGVsZW1lbnQ7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChhXzFfMSAmJiAhYV8xXzEuZG9uZSAmJiAoX2EgPSBhXzEucmV0dXJuKSkgX2EuY2FsbChhXzEpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzEpIHRocm93IGVfMS5lcnJvcjsgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBBcnJheXMuZmlsbFVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAoYSwgdmFsdWUpIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgIT09IGEubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIGFbaV0gPSB2YWx1ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZiA9IGZ1bmN0aW9uIChvcmlnaW5hbCwgbmV3TGVuZ3RoKSB7CgkgICAgICAgIHJldHVybiBvcmlnaW5hbC5zbGljZSgwLCBuZXdMZW5ndGgpOwoJICAgIH07CgkgICAgQXJyYXlzLmNvcHlPZlVpbnQ4QXJyYXkgPSBmdW5jdGlvbiAob3JpZ2luYWwsIG5ld0xlbmd0aCkgewoJICAgICAgICBpZiAob3JpZ2luYWwubGVuZ3RoIDw9IG5ld0xlbmd0aCkgewoJICAgICAgICAgICAgdmFyIG5ld0FycmF5ID0gbmV3IFVpbnQ4QXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgICAgIG5ld0FycmF5LnNldChvcmlnaW5hbCk7CgkgICAgICAgICAgICByZXR1cm4gbmV3QXJyYXk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG9yaWdpbmFsLnNsaWNlKDAsIG5ld0xlbmd0aCk7CgkgICAgfTsKCSAgICBBcnJheXMuY29weU9mUmFuZ2UgPSBmdW5jdGlvbiAob3JpZ2luYWwsIGZyb20sIHRvKSB7CgkgICAgICAgIHZhciBuZXdMZW5ndGggPSB0byAtIGZyb207CgkgICAgICAgIHZhciBjb3B5ID0gbmV3IEludDMyQXJyYXkobmV3TGVuZ3RoKTsKCSAgICAgICAgU3lzdGVtXzEkNS5kZWZhdWx0LmFycmF5Y29weShvcmlnaW5hbCwgZnJvbSwgY29weSwgMCwgbmV3TGVuZ3RoKTsKCSAgICAgICAgcmV0dXJuIGNvcHk7CgkgICAgfTsKCSAgICAvKgoJICAgICogUmV0dXJucyB0aGUgaW5kZXggb2Ygb2YgdGhlIGVsZW1lbnQgaW4gYSBzb3J0ZWQgYXJyYXkgb3IgKC1uLTEpIHdoZXJlIG4gaXMgdGhlIGluc2VydGlvbiBwb2ludAoJICAgICogZm9yIHRoZSBuZXcgZWxlbWVudC4KCSAgICAqIFBhcmFtZXRlcnM6CgkgICAgKiAgICAgYXIgLSBBIHNvcnRlZCBhcnJheQoJICAgICogICAgIGVsIC0gQW4gZWxlbWVudCB0byBzZWFyY2ggZm9yCgkgICAgKiAgICAgY29tcGFyYXRvciAtIEEgY29tcGFyYXRvciBmdW5jdGlvbi4gVGhlIGZ1bmN0aW9uIHRha2VzIHR3byBhcmd1bWVudHM6IChhLCBiKSBhbmQgcmV0dXJuczoKCSAgICAqICAgICAgICBhIG5lZ2F0aXZlIG51bWJlciAgaWYgYSBpcyBsZXNzIHRoYW4gYjsKCSAgICAqICAgICAgICAwIGlmIGEgaXMgZXF1YWwgdG8gYjsKCSAgICAqICAgICAgICBhIHBvc2l0aXZlIG51bWJlciBvZiBhIGlzIGdyZWF0ZXIgdGhhbiBiLgoJICAgICogVGhlIGFycmF5IG1heSBjb250YWluIGR1cGxpY2F0ZSBlbGVtZW50cy4gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiBvbmUgZXF1YWwgZWxlbWVudHMgaW4gdGhlIGFycmF5LAoJICAgICogdGhlIHJldHVybmVkIHZhbHVlIGNhbiBiZSB0aGUgaW5kZXggb2YgYW55IG9uZSBvZiB0aGUgZXF1YWwgZWxlbWVudHMuCgkgICAgKgoJICAgICogaHR0cDovL2pzZmlkZGxlLm5ldC9hcnl6aG92L3BrZnN0NTUwLwoJICAgICovCgkgICAgQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGZ1bmN0aW9uIChhciwgZWwsIGNvbXBhcmF0b3IpIHsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY29tcGFyYXRvcikgewoJICAgICAgICAgICAgY29tcGFyYXRvciA9IEFycmF5cy5udW1iZXJDb21wYXJhdG9yOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtID0gMDsKCSAgICAgICAgdmFyIG4gPSBhci5sZW5ndGggLSAxOwoJICAgICAgICB3aGlsZSAobSA8PSBuKSB7CgkgICAgICAgICAgICB2YXIgayA9IChuICsgbSkgPj4gMTsKCSAgICAgICAgICAgIHZhciBjbXAgPSBjb21wYXJhdG9yKGVsLCBhcltrXSk7CgkgICAgICAgICAgICBpZiAoY21wID4gMCkgewoJICAgICAgICAgICAgICAgIG0gPSBrICsgMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKGNtcCA8IDApIHsKCSAgICAgICAgICAgICAgICBuID0gayAtIDE7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gLW0gLSAxOwoJICAgIH07CgkgICAgQXJyYXlzLm51bWJlckNvbXBhcmF0b3IgPSBmdW5jdGlvbiAoYSwgYikgewoJICAgICAgICByZXR1cm4gYSAtIGI7CgkgICAgfTsKCSAgICByZXR1cm4gQXJyYXlzOwoJfSgpKTsKCUFycmF5cyQxLmRlZmF1bHQgPSBBcnJheXM7CgoJdmFyIEludGVnZXIkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlZ2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogUG9ueWZpbGwgZm9yIEphdmEncyBJbnRlZ2VyIGNsYXNzLgoJICovCgl2YXIgSW50ZWdlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBJbnRlZ2VyKCkgewoJICAgIH0KCSAgICBJbnRlZ2VyLm51bWJlck9mVHJhaWxpbmdaZXJvcyA9IGZ1bmN0aW9uIChpKSB7CgkgICAgICAgIHZhciB5OwoJICAgICAgICBpZiAoaSA9PT0gMCkKCSAgICAgICAgICAgIHJldHVybiAzMjsKCSAgICAgICAgdmFyIG4gPSAzMTsKCSAgICAgICAgeSA9IGkgPDwgMTY7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDE2OwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgeSA9IGkgPDwgODsKCSAgICAgICAgaWYgKHkgIT09IDApIHsKCSAgICAgICAgICAgIG4gLT0gODsKCSAgICAgICAgICAgIGkgPSB5OwoJICAgICAgICB9CgkgICAgICAgIHkgPSBpIDw8IDQ7CgkgICAgICAgIGlmICh5ICE9PSAwKSB7CgkgICAgICAgICAgICBuIC09IDQ7CgkgICAgICAgICAgICBpID0geTsKCSAgICAgICAgfQoJICAgICAgICB5ID0gaSA8PCAyOwoJICAgICAgICBpZiAoeSAhPT0gMCkgewoJICAgICAgICAgICAgbiAtPSAyOwoJICAgICAgICAgICAgaSA9IHk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG4gLSAoKGkgPDwgMSkgPj4+IDMxKTsKCSAgICB9OwoJICAgIEludGVnZXIubnVtYmVyT2ZMZWFkaW5nWmVyb3MgPSBmdW5jdGlvbiAoaSkgewoJICAgICAgICAvLyBIRCwgRmlndXJlIDUtNgoJICAgICAgICBpZiAoaSA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDMyOwoJICAgICAgICB9CgkgICAgICAgIHZhciBuID0gMTsKCSAgICAgICAgaWYgKGkgPj4+IDE2ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDE2OwoJICAgICAgICAgICAgaSA8PD0gMTY7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGkgPj4+IDI0ID09PSAwKSB7CgkgICAgICAgICAgICBuICs9IDg7CgkgICAgICAgICAgICBpIDw8PSA4OwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID4+PiAyOCA9PT0gMCkgewoJICAgICAgICAgICAgbiArPSA0OwoJICAgICAgICAgICAgaSA8PD0gNDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaSA+Pj4gMzAgPT09IDApIHsKCSAgICAgICAgICAgIG4gKz0gMjsKCSAgICAgICAgICAgIGkgPDw9IDI7CgkgICAgICAgIH0KCSAgICAgICAgbiAtPSBpID4+PiAzMTsKCSAgICAgICAgcmV0dXJuIG47CgkgICAgfTsKCSAgICBJbnRlZ2VyLnRvSGV4U3RyaW5nID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgcmV0dXJuIGkudG9TdHJpbmcoMTYpOwoJICAgIH07CgkgICAgSW50ZWdlci50b0JpbmFyeVN0cmluZyA9IGZ1bmN0aW9uIChpbnROdW1iZXIpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZyhwYXJzZUludChTdHJpbmcoaW50TnVtYmVyKSwgMikpOwoJICAgIH07CgkgICAgLy8gUmV0dXJucyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4gVGhpcyBmdW5jdGlvbiBpcyBzb21ldGltZXMgcmVmZXJyZWQgdG8gYXMgdGhlIHBvcHVsYXRpb24gY291bnQuCgkgICAgLy8gUmV0dXJuczoKCSAgICAvLyB0aGUgbnVtYmVyIG9mIG9uZS1iaXRzIGluIHRoZSB0d28ncyBjb21wbGVtZW50IGJpbmFyeSByZXByZXNlbnRhdGlvbiBvZiB0aGUgc3BlY2lmaWVkIGludCB2YWx1ZS4KCSAgICBJbnRlZ2VyLmJpdENvdW50ID0gZnVuY3Rpb24gKGkpIHsKCSAgICAgICAgLy8gSEQsIEZpZ3VyZSA1LTIKCSAgICAgICAgaSA9IGkgLSAoKGkgPj4+IDEpICYgMHg1NTU1NTU1NSk7CgkgICAgICAgIGkgPSAoaSAmIDB4MzMzMzMzMzMpICsgKChpID4+PiAyKSAmIDB4MzMzMzMzMzMpOwoJICAgICAgICBpID0gKGkgKyAoaSA+Pj4gNCkpICYgMHgwZjBmMGYwZjsKCSAgICAgICAgaSA9IGkgKyAoaSA+Pj4gOCk7CgkgICAgICAgIGkgPSBpICsgKGkgPj4+IDE2KTsKCSAgICAgICAgcmV0dXJuIGkgJiAweDNmOwoJICAgIH07CgkgICAgSW50ZWdlci50cnVuY0RpdmlzaW9uID0gZnVuY3Rpb24gKGRpdmlkZW5kLCBkaXZpc29yKSB7CgkgICAgICAgIHJldHVybiBNYXRoLnRydW5jKGRpdmlkZW5kIC8gZGl2aXNvcik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDb252ZXJ0cyBBIHN0cmluZyB0byBhbiBpbnRlZ2VyLgoJICAgICAqIEBwYXJhbSBzIEEgc3RyaW5nIHRvIGNvbnZlcnQgaW50byBhIG51bWJlci4KCSAgICAgKiBAcGFyYW0gcmFkaXggQSB2YWx1ZSBiZXR3ZWVuIDIgYW5kIDM2IHRoYXQgc3BlY2lmaWVzIHRoZSBiYXNlIG9mIHRoZSBudW1iZXIgaW4gbnVtU3RyaW5nLiBJZiB0aGlzIGFyZ3VtZW50IGlzIG5vdCBzdXBwbGllZCwgc3RyaW5ncyB3aXRoIGEgcHJlZml4IG9mICcweCcgYXJlIGNvbnNpZGVyZWQgaGV4YWRlY2ltYWwuIEFsbCBvdGhlciBzdHJpbmdzIGFyZSBjb25zaWRlcmVkIGRlY2ltYWwuCgkgICAgICovCgkgICAgSW50ZWdlci5wYXJzZUludCA9IGZ1bmN0aW9uIChudW0sIHJhZGl4KSB7CgkgICAgICAgIGlmIChyYWRpeCA9PT0gdm9pZCAwKSB7IHJhZGl4ID0gdW5kZWZpbmVkOyB9CgkgICAgICAgIHJldHVybiBwYXJzZUludChudW0sIHJhZGl4KTsKCSAgICB9OwoJICAgIEludGVnZXIuTUlOX1ZBTFVFXzMyX0JJVFMgPSAtMjE0NzQ4MzY0ODsKCSAgICBJbnRlZ2VyLk1BWF9WQUxVRSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgIHJldHVybiBJbnRlZ2VyOwoJfSgpKTsKCUludGVnZXIkMS5kZWZhdWx0ID0gSW50ZWdlcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdEFycmF5JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDggPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcnJheXNfMSQxID0gQXJyYXlzJDE7Cgl2YXIgSW50ZWdlcl8xJDIgPSBJbnRlZ2VyJDE7Cgl2YXIgU3lzdGVtXzEkNCA9IFN5c3RlbSQxOwoJLyoqCgkgKiA8cD5BIHNpbXBsZSwgZmFzdCBhcnJheSBvZiBiaXRzLCByZXByZXNlbnRlZCBjb21wYWN0bHkgYnkgYW4gYXJyYXkgb2YgaW50cyBpbnRlcm5hbGx5LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgQml0QXJyYXkgLyppbXBsZW1lbnRzIENsb25lYWJsZSovID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHsKCSAgICAvLyAgIHRoaXMuc2l6ZSA9IDAKCSAgICAvLyAgIHRoaXMuYml0cyA9IG5ldyBJbnQzMkFycmF5KDEpCgkgICAgLy8gfQoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3RvcihzaXplPzogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh1bmRlZmluZWQgPT09IHNpemUpIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gMAoJICAgIC8vICAgfSBlbHNlIHsKCSAgICAvLyAgICAgdGhpcy5zaXplID0gc2l6ZQoJICAgIC8vICAgfQoJICAgIC8vICAgdGhpcy5iaXRzID0gdGhpcy5tYWtlQXJyYXkoc2l6ZSkKCSAgICAvLyB9CgkgICAgLy8gRm9yIHRlc3Rpbmcgb25seQoJICAgIGZ1bmN0aW9uIEJpdEFycmF5KHNpemUgLyppbnQqLywgYml0cykgewoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBzaXplKSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSAwOwoJICAgICAgICAgICAgdGhpcy5iaXRzID0gbmV3IEludDMyQXJyYXkoMSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnNpemUgPSBzaXplOwoJICAgICAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gQml0QXJyYXkubWFrZUFycmF5KHNpemUpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH0KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0U2l6ZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc2l6ZTsKCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXRTaXplSW5CeXRlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKHRoaXMuc2l6ZSArIDcpIC8gOCk7CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZW5zdXJlQ2FwYWNpdHkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmIChzaXplID4gdGhpcy5iaXRzLmxlbmd0aCAqIDMyKSB7CgkgICAgICAgICAgICB2YXIgbmV3Qml0cyA9IEJpdEFycmF5Lm1ha2VBcnJheShzaXplKTsKCSAgICAgICAgICAgIFN5c3RlbV8xJDQuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5iaXRzLCAwLCBuZXdCaXRzLCAwLCB0aGlzLmJpdHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBpIGJpdCB0byBnZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGJpdCBpIGlzIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiAodGhpcy5iaXRzW01hdGguZmxvb3IoaSAvIDMyKV0gJiAoMSA8PCAoaSAmIDB4MUYpKSkgIT09IDA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoaSAvKmludCovKSB7CgkgICAgICAgIHRoaXMuYml0c1tNYXRoLmZsb29yKGkgLyAzMildIHw9IDEgPDwgKGkgJiAweDFGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEZsaXBzIGJpdCBpLgoJICAgICAqCgkgICAgICogQHBhcmFtIGkgYml0IHRvIHNldAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5mbGlwID0gZnVuY3Rpb24gKGkgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSBePSAxIDw8IChpICYgMHgxRik7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBmaXJzdCBiaXQgdG8gY2hlY2sKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIGZpcnN0IGJpdCB0aGF0IGlzIHNldCwgc3RhcnRpbmcgZnJvbSB0aGUgZ2l2ZW4gaW5kZXgsIG9yIHNpemUgaWYgbm9uZSBhcmUgc2V0CgkgICAgICogIGF0IG9yIGJleW9uZCB0aGlzIGdpdmVuIGluZGV4CgkgICAgICogQHNlZSAjZ2V0TmV4dFVuc2V0KGludCkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZ2V0TmV4dFNldCA9IGZ1bmN0aW9uIChmcm9tIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLnNpemU7CgkgICAgICAgIGlmIChmcm9tID49IHNpemUpIHsKCSAgICAgICAgICAgIHJldHVybiBzaXplOwoJICAgICAgICB9CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IE1hdGguZmxvb3IoZnJvbSAvIDMyKTsKCSAgICAgICAgdmFyIGN1cnJlbnRCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgLy8gbWFzayBvZmYgbGVzc2VyIGJpdHMgZmlyc3QKCSAgICAgICAgY3VycmVudEJpdHMgJj0gfigoMSA8PCAoZnJvbSAmIDB4MUYpKSAtIDEpOwoJICAgICAgICB2YXIgbGVuZ3RoID0gYml0cy5sZW5ndGg7CgkgICAgICAgIHdoaWxlIChjdXJyZW50Qml0cyA9PT0gMCkgewoJICAgICAgICAgICAgaWYgKCsrYml0c09mZnNldCA9PT0gbGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIHNpemU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjdXJyZW50Qml0cyA9IGJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gZnJvbSBpbmRleCB0byBzdGFydCBsb29raW5nIGZvciB1bnNldCBiaXQKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgdW5zZXQgYml0LCBvciB7QGNvZGUgc2l6ZX0gaWYgbm9uZSBhcmUgdW5zZXQgdW50aWwgdGhlIGVuZAoJICAgICAqIEBzZWUgI2dldE5leHRTZXQoaW50KQoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5nZXROZXh0VW5zZXQgPSBmdW5jdGlvbiAoZnJvbSAvKmludCovKSB7CgkgICAgICAgIHZhciBzaXplID0gdGhpcy5zaXplOwoJICAgICAgICBpZiAoZnJvbSA+PSBzaXplKSB7CgkgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIGJpdHNPZmZzZXQgPSBNYXRoLmZsb29yKGZyb20gLyAzMik7CgkgICAgICAgIHZhciBjdXJyZW50Qml0cyA9IH5iaXRzW2JpdHNPZmZzZXRdOwoJICAgICAgICAvLyBtYXNrIG9mZiBsZXNzZXIgYml0cyBmaXJzdAoJICAgICAgICBjdXJyZW50Qml0cyAmPSB+KCgxIDw8IChmcm9tICYgMHgxRikpIC0gMSk7CgkgICAgICAgIHZhciBsZW5ndGggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgd2hpbGUgKGN1cnJlbnRCaXRzID09PSAwKSB7CgkgICAgICAgICAgICBpZiAoKytiaXRzT2Zmc2V0ID09PSBsZW5ndGgpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gc2l6ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGN1cnJlbnRCaXRzID0gfmJpdHNbYml0c09mZnNldF07CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdCA9IChiaXRzT2Zmc2V0ICogMzIpICsgSW50ZWdlcl8xJDIuZGVmYXVsdC5udW1iZXJPZlRyYWlsaW5nWmVyb3MoY3VycmVudEJpdHMpOwoJICAgICAgICByZXR1cm4gcmVzdWx0ID4gc2l6ZSA/IHNpemUgOiByZXN1bHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgYmxvY2sgb2YgMzIgYml0cywgc3RhcnRpbmcgYXQgYml0IGkuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gaSBmaXJzdCBiaXQgdG8gc2V0CgkgICAgICogQHBhcmFtIG5ld0JpdHMgdGhlIG5ldyB2YWx1ZSBvZiB0aGUgbmV4dCAzMiBiaXRzLiBOb3RlIGFnYWluIHRoYXQgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdAoJICAgICAqIGNvcnJlc3BvbmRzIHRvIGJpdCBpLCB0aGUgbmV4dC1sZWFzdC1zaWduaWZpY2FudCB0byBpKzEsIGFuZCBzbyBvbi4KCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0QnVsayA9IGZ1bmN0aW9uIChpIC8qaW50Ki8sIG5ld0JpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLmJpdHNbTWF0aC5mbG9vcihpIC8gMzIpXSA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZXRzIGEgcmFuZ2Ugb2YgYml0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydCBzdGFydCBvZiByYW5nZSwgaW5jbHVzaXZlLgoJICAgICAqIEBwYXJhbSBlbmQgZW5kIG9mIHJhbmdlLCBleGNsdXNpdmUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuc2V0UmFuZ2UgPSBmdW5jdGlvbiAoc3RhcnQgLyppbnQqLywgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIGVuZC0tOyAvLyB3aWxsIGJlIGVhc2llciB0byB0cmVhdCB0aGlzIGFzIHRoZSBsYXN0IGFjdHVhbGx5IHNldCBiaXQgLS0gaW5jbHVzaXZlCgkgICAgICAgIHZhciBmaXJzdEludCA9IE1hdGguZmxvb3Ioc3RhcnQgLyAzMik7CgkgICAgICAgIHZhciBsYXN0SW50ID0gTWF0aC5mbG9vcihlbmQgLyAzMik7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICBmb3IgKHZhciBpID0gZmlyc3RJbnQ7IGkgPD0gbGFzdEludDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgZmlyc3RCaXQgPSBpID4gZmlyc3RJbnQgPyAwIDogc3RhcnQgJiAweDFGOwoJICAgICAgICAgICAgdmFyIGxhc3RCaXQgPSBpIDwgbGFzdEludCA/IDMxIDogZW5kICYgMHgxRjsKCSAgICAgICAgICAgIC8vIE9uZXMgZnJvbSBmaXJzdEJpdCB0byBsYXN0Qml0LCBpbmNsdXNpdmUKCSAgICAgICAgICAgIHZhciBtYXNrID0gKDIgPDwgbGFzdEJpdCkgLSAoMSA8PCBmaXJzdEJpdCk7CgkgICAgICAgICAgICBiaXRzW2ldIHw9IG1hc2s7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbWF4ID0gdGhpcy5iaXRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGJpdHNbaV0gPSAwOwoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBFZmZpY2llbnQgbWV0aG9kIHRvIGNoZWNrIGlmIGEgcmFuZ2Ugb2YgYml0cyBpcyBzZXQsIG9yIG5vdCBzZXQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnQgc3RhcnQgb2YgcmFuZ2UsIGluY2x1c2l2ZS4KCSAgICAgKiBAcGFyYW0gZW5kIGVuZCBvZiByYW5nZSwgZXhjbHVzaXZlCgkgICAgICogQHBhcmFtIHZhbHVlIGlmIHRydWUsIGNoZWNrcyB0aGF0IGJpdHMgaW4gcmFuZ2UgYXJlIHNldCwgb3RoZXJ3aXNlIGNoZWNrcyB0aGF0IHRoZXkgYXJlIG5vdCBzZXQKCSAgICAgKiBAcmV0dXJuIHRydWUgaWZmIGFsbCBiaXRzIGFyZSBzZXQgb3Igbm90IHNldCBpbiByYW5nZSwgYWNjb3JkaW5nIHRvIHZhbHVlIGFyZ3VtZW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgZW5kIGlzIGxlc3MgdGhhbiBzdGFydCBvciB0aGUgcmFuZ2UgaXMgbm90IGNvbnRhaW5lZCBpbiB0aGUgYXJyYXkKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuaXNSYW5nZSA9IGZ1bmN0aW9uIChzdGFydCAvKmludCovLCBlbmQgLyppbnQqLywgdmFsdWUpIHsKCSAgICAgICAgaWYgKGVuZCA8IHN0YXJ0IHx8IHN0YXJ0IDwgMCB8fCBlbmQgPiB0aGlzLnNpemUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ4LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoZW5kID09PSBzdGFydCkgewoJICAgICAgICAgICAgcmV0dXJuIHRydWU7IC8vIGVtcHR5IHJhbmdlIG1hdGNoZXMKCSAgICAgICAgfQoJICAgICAgICBlbmQtLTsgLy8gd2lsbCBiZSBlYXNpZXIgdG8gdHJlYXQgdGhpcyBhcyB0aGUgbGFzdCBhY3R1YWxseSBzZXQgYml0IC0tIGluY2x1c2l2ZQoJICAgICAgICB2YXIgZmlyc3RJbnQgPSBNYXRoLmZsb29yKHN0YXJ0IC8gMzIpOwoJICAgICAgICB2YXIgbGFzdEludCA9IE1hdGguZmxvb3IoZW5kIC8gMzIpOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgaSA9IGZpcnN0SW50OyBpIDw9IGxhc3RJbnQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGZpcnN0Qml0ID0gaSA+IGZpcnN0SW50ID8gMCA6IHN0YXJ0ICYgMHgxRjsKCSAgICAgICAgICAgIHZhciBsYXN0Qml0ID0gaSA8IGxhc3RJbnQgPyAzMSA6IGVuZCAmIDB4MUY7CgkgICAgICAgICAgICAvLyBPbmVzIGZyb20gZmlyc3RCaXQgdG8gbGFzdEJpdCwgaW5jbHVzaXZlCgkgICAgICAgICAgICB2YXIgbWFzayA9ICgyIDw8IGxhc3RCaXQpIC0gKDEgPDwgZmlyc3RCaXQpICYgMHhGRkZGRkZGRjsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiAmIDB4RkZGRkZGRkYgYWRkZWQgdG8gZGlzY2FyZCBhbnl0aGluZyBhZnRlciAzMiBiaXRzLCBhcyBFUyBoYXMgNTMgYml0cwoJICAgICAgICAgICAgLy8gUmV0dXJuIGZhbHNlIGlmIHdlJ3JlIGxvb2tpbmcgZm9yIDFzIGFuZCB0aGUgbWFza2VkIGJpdHNbaV0gaXNuJ3QgYWxsIDFzIChpczogdGhhdCwKCSAgICAgICAgICAgIC8vIGVxdWFscyB0aGUgbWFzaywgb3Igd2UncmUgbG9va2luZyBmb3IgMHMgYW5kIHRoZSBtYXNrZWQgcG9ydGlvbiBpcyBub3QgYWxsIDBzCgkgICAgICAgICAgICBpZiAoKGJpdHNbaV0gJiBtYXNrKSAhPT0gKHZhbHVlID8gbWFzayA6IDApKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0cnVlOwoJICAgIH07CgkgICAgQml0QXJyYXkucHJvdG90eXBlLmFwcGVuZEJpdCA9IGZ1bmN0aW9uIChiaXQpIHsKCSAgICAgICAgdGhpcy5lbnN1cmVDYXBhY2l0eSh0aGlzLnNpemUgKyAxKTsKCSAgICAgICAgaWYgKGJpdCkgewoJICAgICAgICAgICAgdGhpcy5iaXRzW01hdGguZmxvb3IodGhpcy5zaXplIC8gMzIpXSB8PSAxIDw8ICh0aGlzLnNpemUgJiAweDFGKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLnNpemUrKzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEFwcGVuZHMgdGhlIGxlYXN0LXNpZ25pZmljYW50IGJpdHMsIGZyb20gdmFsdWUsIGluIG9yZGVyIGZyb20gbW9zdC1zaWduaWZpY2FudCB0bwoJICAgICAqIGxlYXN0LXNpZ25pZmljYW50LiBGb3IgZXhhbXBsZSwgYXBwZW5kaW5nIDYgYml0cyBmcm9tIDB4MDAwMDAxRSB3aWxsIGFwcGVuZCB0aGUgYml0cwoJICAgICAqIDAsIDEsIDEsIDEsIDEsIDAgaW4gdGhhdCBvcmRlci4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB2YWx1ZSB7QGNvZGUgaW50fSBjb250YWluaW5nIGJpdHMgdG8gYXBwZW5kCgkgICAgICogQHBhcmFtIG51bUJpdHMgYml0cyBmcm9tIHZhbHVlIHRvIGFwcGVuZAoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5hcHBlbmRCaXRzID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICBpZiAobnVtQml0cyA8IDAgfHwgbnVtQml0cyA+IDMyKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkOC5kZWZhdWx0KCdOdW0gYml0cyBtdXN0IGJlIGJldHdlZW4gMCBhbmQgMzInKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmVuc3VyZUNhcGFjaXR5KHRoaXMuc2l6ZSArIG51bUJpdHMpOwoJICAgICAgICAvLyBjb25zdCBhcHBlbmRCaXQgPSB0aGlzLmFwcGVuZEJpdDsKCSAgICAgICAgZm9yICh2YXIgbnVtQml0c0xlZnQgPSBudW1CaXRzOyBudW1CaXRzTGVmdCA+IDA7IG51bUJpdHNMZWZ0LS0pIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KCgodmFsdWUgPj4gKG51bUJpdHNMZWZ0IC0gMSkpICYgMHgwMSkgPT09IDEpOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBCaXRBcnJheS5wcm90b3R5cGUuYXBwZW5kQml0QXJyYXkgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdmFyIG90aGVyU2l6ZSA9IG90aGVyLnNpemU7CgkgICAgICAgIHRoaXMuZW5zdXJlQ2FwYWNpdHkodGhpcy5zaXplICsgb3RoZXJTaXplKTsKCSAgICAgICAgLy8gY29uc3QgYXBwZW5kQml0ID0gdGhpcy5hcHBlbmRCaXQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3RoZXJTaXplOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kQml0KG90aGVyLmdldChpKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKHRoaXMuc2l6ZSAhPT0gb3RoZXIuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDguZGVmYXVsdCgnU2l6ZXMgZG9uXCd0IG1hdGNoJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGJpdHMubGVuZ3RoOyBpIDwgbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgLy8gVGhlIGxhc3QgaW50IGNvdWxkIGJlIGluY29tcGxldGUgKGkuZS4gbm90IGhhdmUgMzIgYml0cyBpbgoJICAgICAgICAgICAgLy8gaXQpIGJ1dCB0aGVyZSBpcyBubyBwcm9ibGVtIHNpbmNlIDAgWE9SIDAgPT0gMC4KCSAgICAgICAgICAgIGJpdHNbaV0gXj0gb3RoZXIuYml0c1tpXTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0T2Zmc2V0IGZpcnN0IGJpdCB0byBzdGFydCB3cml0aW5nCgkgICAgICogQHBhcmFtIGFycmF5IGFycmF5IHRvIHdyaXRlIGludG8uIEJ5dGVzIGFyZSB3cml0dGVuIG1vc3Qtc2lnbmlmaWNhbnQgYnl0ZSBmaXJzdC4gVGhpcyBpcyB0aGUgb3Bwb3NpdGUKCSAgICAgKiAgb2YgdGhlIGludGVybmFsIHJlcHJlc2VudGF0aW9uLCB3aGljaCBpcyBleHBvc2VkIGJ5IHtAbGluayAjZ2V0Qml0QXJyYXkoKX0KCSAgICAgKiBAcGFyYW0gb2Zmc2V0IHBvc2l0aW9uIGluIGFycmF5IHRvIHN0YXJ0IHdyaXRpbmcKCSAgICAgKiBAcGFyYW0gbnVtQnl0ZXMgaG93IG1hbnkgYnl0ZXMgdG8gd3JpdGUKCSAgICAgKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUudG9CeXRlcyA9IGZ1bmN0aW9uIChiaXRPZmZzZXQgLyppbnQqLywgYXJyYXksIG9mZnNldCAvKmludCovLCBudW1CeXRlcyAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbnVtQnl0ZXM7IGkrKykgewoJICAgICAgICAgICAgdmFyIHRoZUJ5dGUgPSAwOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCA4OyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5nZXQoYml0T2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICB0aGVCeXRlIHw9IDEgPDwgKDcgLSBqKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhcnJheVtvZmZzZXQgKyBpXSA9IC8qKGJ5dGUpKi8gdGhlQnl0ZTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB1bmRlcmx5aW5nIGFycmF5IG9mIGludHMuIFRoZSBmaXJzdCBlbGVtZW50IGhvbGRzIHRoZSBmaXJzdCAzMiBiaXRzLCBhbmQgdGhlIGxlYXN0CgkgICAgICogICAgICAgICBzaWduaWZpY2FudCBiaXQgaXMgYml0IDAuCgkgICAgICovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLmdldEJpdEFycmF5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV2ZXJzZXMgYWxsIGJpdHMgaW4gdGhlIGFycmF5LgoJICAgICAqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5yZXZlcnNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgbmV3Qml0cyA9IG5ldyBJbnQzMkFycmF5KHRoaXMuYml0cy5sZW5ndGgpOwoJICAgICAgICAvLyByZXZlcnNlIGFsbCBpbnQncyBmaXJzdAoJICAgICAgICB2YXIgbGVuID0gTWF0aC5mbG9vcigodGhpcy5zaXplIC0gMSkgLyAzMik7CgkgICAgICAgIHZhciBvbGRCaXRzTGVuID0gbGVuICsgMTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb2xkQml0c0xlbjsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeCA9IGJpdHNbaV07CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDEpICYgMHg1NTU1NTU1NSkgfCAoKHggJiAweDU1NTU1NTU1KSA8PCAxKTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMikgJiAweDMzMzMzMzMzKSB8ICgoeCAmIDB4MzMzMzMzMzMpIDw8IDIpOwoJICAgICAgICAgICAgeCA9ICgoeCA+PiA0KSAmIDB4MGYwZjBmMGYpIHwgKCh4ICYgMHgwZjBmMGYwZikgPDwgNCk7CgkgICAgICAgICAgICB4ID0gKCh4ID4+IDgpICYgMHgwMGZmMDBmZikgfCAoKHggJiAweDAwZmYwMGZmKSA8PCA4KTsKCSAgICAgICAgICAgIHggPSAoKHggPj4gMTYpICYgMHgwMDAwZmZmZikgfCAoKHggJiAweDAwMDBmZmZmKSA8PCAxNik7CgkgICAgICAgICAgICBuZXdCaXRzW2xlbiAtIGldID0gLyooaW50KSovIHg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm93IGNvcnJlY3QgdGhlIGludCdzIGlmIHRoZSBiaXQgc2l6ZSBpc24ndCBhIG11bHRpcGxlIG9mIDMyCgkgICAgICAgIGlmICh0aGlzLnNpemUgIT09IG9sZEJpdHNMZW4gKiAzMikgewoJICAgICAgICAgICAgdmFyIGxlZnRPZmZzZXQgPSBvbGRCaXRzTGVuICogMzIgLSB0aGlzLnNpemU7CgkgICAgICAgICAgICB2YXIgY3VycmVudEludCA9IG5ld0JpdHNbMF0gPj4+IGxlZnRPZmZzZXQ7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IG9sZEJpdHNMZW47IGkrKykgewoJICAgICAgICAgICAgICAgIHZhciBuZXh0SW50ID0gbmV3Qml0c1tpXTsKCSAgICAgICAgICAgICAgICBjdXJyZW50SW50IHw9IG5leHRJbnQgPDwgKDMyIC0gbGVmdE9mZnNldCk7CgkgICAgICAgICAgICAgICAgbmV3Qml0c1tpIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICAgICAgICAgIGN1cnJlbnRJbnQgPSBuZXh0SW50ID4+PiBsZWZ0T2Zmc2V0OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgbmV3Qml0c1tvbGRCaXRzTGVuIC0gMV0gPSBjdXJyZW50SW50OwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0cyA9IG5ld0JpdHM7CgkgICAgfTsKCSAgICBCaXRBcnJheS5tYWtlQXJyYXkgPSBmdW5jdGlvbiAoc2l6ZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW50MzJBcnJheShNYXRoLmZsb29yKChzaXplICsgMzEpIC8gMzIpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdEFycmF5KSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnNpemUgPT09IG90aGVyLnNpemUgJiYgQXJyYXlzXzEkMS5kZWZhdWx0LmVxdWFscyh0aGlzLmJpdHMsIG90aGVyLmJpdHMpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdEFycmF5LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogdGhpcy5zaXplICsgQXJyYXlzXzEkMS5kZWZhdWx0Lmhhc2hDb2RlKHRoaXMuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0QXJyYXkucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcmVzdWx0ID0gJyc7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBzaXplID0gdGhpcy5zaXplOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICBpZiAoKGkgJiAweDA3KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnICc7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQgKz0gdGhpcy5nZXQoaSkgPyAnWCcgOiAnLic7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBCaXRBcnJheS5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0QXJyYXkodGhpcy5zaXplLCB0aGlzLmJpdHMuc2xpY2UoKSk7CgkgICAgfTsKCSAgICByZXR1cm4gQml0QXJyYXk7Cgl9KCkpOwoJQml0QXJyYXkkMS5kZWZhdWx0ID0gQml0QXJyYXk7CgoJdmFyIEJpdE1hdHJpeCQxID0ge307CgoJdmFyIFN0cmluZ0J1aWxkZXIkMSA9IHt9OwoKCXZhciBTdHJpbmdVdGlscyQxID0ge307CgoJdmFyIERlY29kZUhpbnRUeXBlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERlY29kZUhpbnRUeXBlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIHR5cGUgb2YgaGludCB0aGF0IGEgY2FsbGVyIG1heSBwYXNzIHRvIGEgYmFyY29kZSByZWFkZXIgdG8gaGVscCBpdAoJICogbW9yZSBxdWlja2x5IG9yIGFjY3VyYXRlbHkgZGVjb2RlIGl0LiBJdCBpcyB1cCB0byBpbXBsZW1lbnRhdGlvbnMgdG8gZGVjaWRlIHdoYXQsCgkgKiBpZiBhbnl0aGluZywgdG8gZG8gd2l0aCB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBzdXBwbGllZC4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBzZWUgUmVhZGVyI2RlY29kZShCaW5hcnlCaXRtYXAsamF2YS51dGlsLk1hcCkKCSAqLwoJdmFyIERlY29kZUhpbnRUeXBlOwoJKGZ1bmN0aW9uIChEZWNvZGVIaW50VHlwZSkgewoJICAgIC8qKgoJICAgICAqIFVuc3BlY2lmaWVkLCBhcHBsaWNhdGlvbi1zcGVjaWZpYyBoaW50LiBNYXBzIHRvIGFuIHVuc3BlY2lmaWVkIHtAbGluayBPYmplY3R9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJPVEhFUiJdID0gMF0gPSAiT1RIRVIiOyAvKihPYmplY3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJbWFnZSBpcyBhIHB1cmUgbW9ub2Nocm9tZSBpbWFnZSBvZiBhIGJhcmNvZGUuIERvZXNuJ3QgbWF0dGVyIHdoYXQgaXQgbWFwcyB0bzsKCSAgICAgKiB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlBVUkVfQkFSQ09ERSJdID0gMV0gPSAiUFVSRV9CQVJDT0RFIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEltYWdlIGlzIGtub3duIHRvIGJlIG9mIG9uZSBvZiBhIGZldyBwb3NzaWJsZSBmb3JtYXRzLgoJICAgICAqIE1hcHMgdG8gYSB7QGxpbmsgTGlzdH0gb2Yge0BsaW5rIEJhcmNvZGVGb3JtYXR9cy4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiUE9TU0lCTEVfRk9STUFUUyJdID0gMl0gPSAiUE9TU0lCTEVfRk9STUFUUyI7IC8qKExpc3QuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVuZCBtb3JlIHRpbWUgdG8gdHJ5IHRvIGZpbmQgYSBiYXJjb2RlOyBvcHRpbWl6ZSBmb3IgYWNjdXJhY3ksIG5vdCBzcGVlZC4KCSAgICAgKiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87IHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiVFJZX0hBUkRFUiJdID0gM10gPSAiVFJZX0hBUkRFUiI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBTcGVjaWZpZXMgd2hhdCBjaGFyYWN0ZXIgZW5jb2RpbmcgdG8gdXNlIHdoZW4gZGVjb2RpbmcsIHdoZXJlIGFwcGxpY2FibGUgKHR5cGUgU3RyaW5nKQoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJDSEFSQUNURVJfU0VUIl0gPSA0XSA9ICJDSEFSQUNURVJfU0VUIjsgLyooU3RyaW5nLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQWxsb3dlZCBsZW5ndGhzIG9mIGVuY29kZWQgZGF0YSAtLSByZWplY3QgYW55dGhpbmcgZWxzZS4gTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfTEVOR1RIUyJdID0gNV0gPSAiQUxMT1dFRF9MRU5HVEhTIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIEFzc3VtZSBDb2RlIDM5IGNvZGVzIGVtcGxveSBhIGNoZWNrIGRpZ2l0LiBEb2Vzbid0IG1hdHRlciB3aGF0IGl0IG1hcHMgdG87CgkgICAgICogdXNlIHtAbGluayBCb29sZWFuI1RSVUV9LgoJICAgICAqLwoJICAgIERlY29kZUhpbnRUeXBlW0RlY29kZUhpbnRUeXBlWyJBU1NVTUVfQ09ERV8zOV9DSEVDS19ESUdJVCJdID0gNl0gPSAiQVNTVU1FX0NPREVfMzlfQ0hFQ0tfRElHSVQiOyAvKihWb2lkLmNsYXNzKSovCgkgICAgLyoqCgkgICAgICogQXNzdW1lIHRoZSBiYXJjb2RlIGlzIGJlaW5nIHByb2Nlc3NlZCBhcyBhIEdTMSBiYXJjb2RlLCBhbmQgbW9kaWZ5IGJlaGF2aW9yIGFzIG5lZWRlZC4KCSAgICAgKiBGb3IgZXhhbXBsZSB0aGlzIGFmZmVjdHMgRk5DMSBoYW5kbGluZyBmb3IgQ29kZSAxMjggKGFrYSBHUzEtMTI4KS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOwoJICAgICAqIHVzZSB7QGxpbmsgQm9vbGVhbiNUUlVFfS4KCSAgICAgKi8KCSAgICBEZWNvZGVIaW50VHlwZVtEZWNvZGVIaW50VHlwZVsiQVNTVU1FX0dTMSJdID0gN10gPSAiQVNTVU1FX0dTMSI7IC8qKFZvaWQuY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBJZiB0cnVlLCByZXR1cm4gdGhlIHN0YXJ0IGFuZCBlbmQgZGlnaXRzIGluIGEgQ29kYWJhciBiYXJjb2RlIGluc3RlYWQgb2Ygc3RyaXBwaW5nIHRoZW0uIFRoZXkKCSAgICAgKiBhcmUgYWxwaGEsIHdoZXJlYXMgdGhlIHJlc3QgYXJlIG51bWVyaWMuIEJ5IGRlZmF1bHQsIHRoZXkgYXJlIHN0cmlwcGVkLCBidXQgdGhpcyBjYXVzZXMgdGhlbQoJICAgICAqIHRvIG5vdCBiZS4gRG9lc24ndCBtYXR0ZXIgd2hhdCBpdCBtYXBzIHRvOyB1c2Uge0BsaW5rIEJvb2xlYW4jVFJVRX0uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIlJFVFVSTl9DT0RBQkFSX1NUQVJUX0VORCJdID0gOF0gPSAiUkVUVVJOX0NPREFCQVJfU1RBUlRfRU5EIjsgLyooVm9pZC5jbGFzcykqLwoJICAgIC8qKgoJICAgICAqIFRoZSBjYWxsZXIgbmVlZHMgdG8gYmUgbm90aWZpZWQgdmlhIGNhbGxiYWNrIHdoZW4gYSBwb3NzaWJsZSB7QGxpbmsgUmVzdWx0UG9pbnR9CgkgICAgICogaXMgZm91bmQuIE1hcHMgdG8gYSB7QGxpbmsgUmVzdWx0UG9pbnRDYWxsYmFja30uCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIk5FRURfUkVTVUxUX1BPSU5UX0NBTExCQUNLIl0gPSA5XSA9ICJORUVEX1JFU1VMVF9QT0lOVF9DQUxMQkFDSyI7IC8qKFJlc3VsdFBvaW50Q2FsbGJhY2suY2xhc3MpKi8KCSAgICAvKioKCSAgICAgKiBBbGxvd2VkIGV4dGVuc2lvbiBsZW5ndGhzIGZvciBFQU4gb3IgVVBDIGJhcmNvZGVzLiBPdGhlciBmb3JtYXRzIHdpbGwgaWdub3JlIHRoaXMuCgkgICAgICogTWFwcyB0byBhbiB7QGNvZGUgSW50MzJBcnJheX0gb2YgdGhlIGFsbG93ZWQgZXh0ZW5zaW9uIGxlbmd0aHMsIGZvciBleGFtcGxlIFsyXSwgWzVdLCBvciBbMiwgNV0uCgkgICAgICogSWYgaXQgaXMgb3B0aW9uYWwgdG8gaGF2ZSBhbiBleHRlbnNpb24sIGRvIG5vdCBzZXQgdGhpcyBoaW50LiBJZiB0aGlzIGlzIHNldCwKCSAgICAgKiBhbmQgYSBVUEMgb3IgRUFOIGJhcmNvZGUgaXMgZm91bmQgYnV0IGFuIGV4dGVuc2lvbiBpcyBub3QsIHRoZW4gbm8gcmVzdWx0IHdpbGwgYmUgcmV0dXJuZWQKCSAgICAgKiBhdCBhbGwuCgkgICAgICovCgkgICAgRGVjb2RlSGludFR5cGVbRGVjb2RlSGludFR5cGVbIkFMTE9XRURfRUFOX0VYVEVOU0lPTlMiXSA9IDEwXSA9ICJBTExPV0VEX0VBTl9FWFRFTlNJT05TIjsgLyooSW50MzJBcnJheS5jbGFzcykqLwoJICAgIC8vIEVuZCBvZiBlbnVtZXJhdGlvbiB2YWx1ZXMuCgkgICAgLyoqCgkgICAgICogRGF0YSB0eXBlIHRoZSBoaW50IGlzIGV4cGVjdGluZy4KCSAgICAgKiBBbW9uZyB0aGUgcG9zc2libGUgdmFsdWVzIHRoZSB7QGxpbmsgVm9pZH0gc3RhbmRzIG91dCBhcyBiZWluZyB1c2VkIGZvcgoJICAgICAqIGhpbnRzIHRoYXQgZG8gbm90IGV4cGVjdCBhIHZhbHVlIHRvIGJlIHN1cHBsaWVkIChmbGFnIGhpbnRzKS4gU3VjaCBoaW50cwoJICAgICAqIHdpbGwgcG9zc2libHkgaGF2ZSB0aGVpciB2YWx1ZSBpZ25vcmVkLCBvciByZXBsYWNlZCBieSBhCgkgICAgICoge0BsaW5rIEJvb2xlYW4jVFJVRX0uIEhpbnQgc3VwcGxpZXJzIHNob3VsZCBwcm9iYWJseSB1c2UKCSAgICAgKiB7QGxpbmsgQm9vbGVhbiNUUlVFfSBhcyBkaXJlY3RlZCBieSB0aGUgYWN0dWFsIGhpbnQgZG9jdW1lbnRhdGlvbi4KCSAgICAgKi8KCSAgICAvLyBwcml2YXRlIHZhbHVlVHlwZTogQ2xhc3M8Pz4KCSAgICAvLyBEZWNvZGVIaW50VHlwZSh2YWx1ZVR5cGU6IENsYXNzPD8+KSB7CgkgICAgLy8gICB0aGlzLnZhbHVlVHlwZSA9IHZhbHVlVHlwZQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgZ2V0VmFsdWVUeXBlKCk6IENsYXNzPD8+IHsKCSAgICAvLyAgIHJldHVybiB2YWx1ZVR5cGUKCSAgICAvLyB9Cgl9KShEZWNvZGVIaW50VHlwZSB8fCAoRGVjb2RlSGludFR5cGUgPSB7fSkpOwoJRGVjb2RlSGludFR5cGUkMS5kZWZhdWx0ID0gRGVjb2RlSGludFR5cGU7CgoJdmFyIENoYXJhY3RlclNldEVDSSA9IHt9OwoKCXZhciBGb3JtYXRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZiA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGb3JtYXRFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDcgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgRm9ybWF0RXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyRmKEZvcm1hdEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBGb3JtYXRFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgRm9ybWF0RXhjZXB0aW9uLmdldEZvcm1hdEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEV4Y2VwdGlvbigpOwoJICAgIH07CgkgICAgRm9ybWF0RXhjZXB0aW9uLmtpbmQgPSAnRm9ybWF0RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gRm9ybWF0RXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQ3LmRlZmF1bHQpKTsKCUZvcm1hdEV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBGb3JtYXRFeGNlcHRpb247CgoJKGZ1bmN0aW9uIChleHBvcnRzKSB7CgkvKgoJICogQ29weXJpZ2h0IDIwMDggWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCWV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHZvaWQgMDsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xID0gRm9ybWF0RXhjZXB0aW9uJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuSGFzaE1hcDsqLwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJdmFyIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnM7CgkoZnVuY3Rpb24gKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMpIHsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwNDM3Il0gPSAwXSA9ICJDcDQzNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEiXSA9IDFdID0gIklTTzg4NTlfMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzIiXSA9IDJdID0gIklTTzg4NTlfMiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzMiXSA9IDNdID0gIklTTzg4NTlfMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzQiXSA9IDRdID0gIklTTzg4NTlfNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzUiXSA9IDVdID0gIklTTzg4NTlfNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzYiXSA9IDZdID0gIklTTzg4NTlfNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzciXSA9IDddID0gIklTTzg4NTlfNyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzgiXSA9IDhdID0gIklTTzg4NTlfOCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzkiXSA9IDldID0gIklTTzg4NTlfOSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEwIl0gPSAxMF0gPSAiSVNPODg1OV8xMCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzExIl0gPSAxMV0gPSAiSVNPODg1OV8xMSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzEzIl0gPSAxMl0gPSAiSVNPODg1OV8xMyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE0Il0gPSAxM10gPSAiSVNPODg1OV8xNCI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE1Il0gPSAxNF0gPSAiSVNPODg1OV8xNSI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJJU084ODU5XzE2Il0gPSAxNV0gPSAiSVNPODg1OV8xNiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJTSklTIl0gPSAxNl0gPSAiU0pJUyI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTAiXSA9IDE3XSA9ICJDcDEyNTAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQ3AxMjUxIl0gPSAxOF0gPSAiQ3AxMjUxIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkNwMTI1MiJdID0gMTldID0gIkNwMTI1MiI7CgkgICAgQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1tDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzWyJDcDEyNTYiXSA9IDIwXSA9ICJDcDEyNTYiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siVW5pY29kZUJpZ1VubWFya2VkIl0gPSAyMV0gPSAiVW5pY29kZUJpZ1VubWFya2VkIjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIlVURjgiXSA9IDIyXSA9ICJVVEY4IjsKCSAgICBDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzW0NoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbIkFTQ0lJIl0gPSAyM10gPSAiQVNDSUkiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siQmlnNSJdID0gMjRdID0gIkJpZzUiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siR0IxODAzMCJdID0gMjVdID0gIkdCMTgwMzAiOwoJICAgIENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnNbQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVyc1siRVVDX0tSIl0gPSAyNl0gPSAiRVVDX0tSIjsKCX0pKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgPSBleHBvcnRzLkNoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMgfHwgKGV4cG9ydHMuQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycyA9IHt9KSk7CgkvKioKCSAqIEVuY2Fwc3VsYXRlcyBhIENoYXJhY3RlciBTZXQgRUNJLCBhY2NvcmRpbmcgdG8gIkV4dGVuZGVkIENoYW5uZWwgSW50ZXJwcmV0YXRpb25zIiA1LjMuMS4xCgkgKiBvZiBJU08gMTgwMDQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIENoYXJhY3RlclNldEVDSSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBDaGFyYWN0ZXJTZXRFQ0kodmFsdWVJZGVudGlmaWVyLCB2YWx1ZXNQYXJhbSwgbmFtZSkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG90aGVyRW5jb2RpbmdOYW1lcyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDM7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgb3RoZXJFbmNvZGluZ05hbWVzW19pIC0gM10gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmFsdWVJZGVudGlmaWVyID0gdmFsdWVJZGVudGlmaWVyOwoJICAgICAgICB0aGlzLm5hbWUgPSBuYW1lOwoJICAgICAgICBpZiAodHlwZW9mIHZhbHVlc1BhcmFtID09PSAnbnVtYmVyJykgewoJICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBJbnQzMkFycmF5LmZyb20oW3ZhbHVlc1BhcmFtXSk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICB0aGlzLnZhbHVlcyA9IHZhbHVlc1BhcmFtOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzOwoJICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVfSURFTlRJRklFUl9UT19FQ0kuc2V0KHZhbHVlSWRlbnRpZmllciwgdGhpcyk7CgkgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQobmFtZSwgdGhpcyk7CgkgICAgICAgIHZhciB2YWx1ZXMgPSB0aGlzLnZhbHVlczsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gdmFsdWVzLmxlbmd0aDsgaSAhPT0gbGVuZ3RoXzE7IGkrKykgewoJICAgICAgICAgICAgdmFyIHYgPSB2YWx1ZXNbaV07CgkgICAgICAgICAgICBDaGFyYWN0ZXJTZXRFQ0kuVkFMVUVTX1RPX0VDSS5zZXQodiwgdGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIG90aGVyRW5jb2RpbmdOYW1lc18xID0gX192YWx1ZXMob3RoZXJFbmNvZGluZ05hbWVzKSwgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKTsgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZTsgb3RoZXJFbmNvZGluZ05hbWVzXzFfMSA9IG90aGVyRW5jb2RpbmdOYW1lc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBvdGhlck5hbWUgPSBvdGhlckVuY29kaW5nTmFtZXNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSS5zZXQob3RoZXJOYW1lLCB0aGlzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKG90aGVyRW5jb2RpbmdOYW1lc18xXzEgJiYgIW90aGVyRW5jb2RpbmdOYW1lc18xXzEuZG9uZSAmJiAoX2EgPSBvdGhlckVuY29kaW5nTmFtZXNfMS5yZXR1cm4pKSBfYS5jYWxsKG90aGVyRW5jb2RpbmdOYW1lc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgIH0KCSAgICAvLyBDaGFyYWN0ZXJTZXRFQ0kodmFsdWU6IG51bWJlciAvKmludCovKSB7CgkgICAgLy8gICB0aGlzKG5ldyBJbnQzMkFycmF5IHt2YWx1ZX0pCgkgICAgLy8gfQoJICAgIC8vIENoYXJhY3RlclNldEVDSSh2YWx1ZTogbnVtYmVyIC8qaW50Ki8sIFN0cmluZy4uLiBvdGhlckVuY29kaW5nTmFtZXMpIHsKCSAgICAvLyAgIHRoaXMudmFsdWVzID0gbmV3IEludDMyQXJyYXkge3ZhbHVlfQoJICAgIC8vICAgdGhpcy5vdGhlckVuY29kaW5nTmFtZXMgPSBvdGhlckVuY29kaW5nTmFtZXMKCSAgICAvLyB9CgkgICAgLy8gQ2hhcmFjdGVyU2V0RUNJKHZhbHVlczogSW50MzJBcnJheSwgU3RyaW5nLi4uIG90aGVyRW5jb2RpbmdOYW1lcykgewoJICAgIC8vICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXMKCSAgICAvLyAgIHRoaXMub3RoZXJFbmNvZGluZ05hbWVzID0gb3RoZXJFbmNvZGluZ05hbWVzCgkgICAgLy8gfQoJICAgIENoYXJhY3RlclNldEVDSS5wcm90b3R5cGUuZ2V0VmFsdWVJZGVudGlmaWVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZUlkZW50aWZpZXI7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldE5hbWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm5hbWU7CgkgICAgfTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZXNbMF07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmFsdWUgY2hhcmFjdGVyIHNldCBFQ0kgdmFsdWUKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBDaGFyYWN0ZXJTZXRFQ0l9IHJlcHJlc2VudGluZyBFQ0kgb2YgZ2l2ZW4gdmFsdWUsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwgYnV0CgkgICAgICogICB1bnN1cHBvcnRlZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIEVDSSB2YWx1ZSBpcyBpbnZhbGlkCgkgICAgICovCgkgICAgQ2hhcmFjdGVyU2V0RUNJLmdldENoYXJhY3RlclNldEVDSUJ5VmFsdWUgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPCAwIHx8IHZhbHVlID49IDkwMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGNoYXJhY3RlclNldCA9IENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJLmdldCh2YWx1ZSk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNoYXJhY3RlclNldCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoJ2luY29yZWN0IHZhbHVlJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGNoYXJhY3RlclNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBuYW1lIGNoYXJhY3RlciBzZXQgRUNJIGVuY29kaW5nIG5hbWUKCSAgICAgKiBAcmV0dXJuIENoYXJhY3RlclNldEVDSSByZXByZXNlbnRpbmcgRUNJIGZvciBjaGFyYWN0ZXIgZW5jb2RpbmcsIG9yIG51bGwgaWYgaXQgaXMgbGVnYWwKCSAgICAgKiAgIGJ1dCB1bnN1cHBvcnRlZAoJICAgICAqLwoJICAgIENoYXJhY3RlclNldEVDSS5nZXRDaGFyYWN0ZXJTZXRFQ0lCeU5hbWUgPSBmdW5jdGlvbiAobmFtZSkgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gQ2hhcmFjdGVyU2V0RUNJLk5BTUVfVE9fRUNJLmdldChuYW1lKTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgnaW5jb3JlY3QgdmFsdWUnKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY2hhcmFjdGVyU2V0OwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgQ2hhcmFjdGVyU2V0RUNJKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLmdldE5hbWUoKSA9PT0gb3RoZXIuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlZBTFVFX0lERU5USUZJRVJfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5WQUxVRVNfVE9fRUNJID0gbmV3IE1hcCgpOwoJICAgIENoYXJhY3RlclNldEVDSS5OQU1FX1RPX0VDSSA9IG5ldyBNYXAoKTsKCSAgICAvLyBFbnVtIG5hbWUgaXMgYSBKYXZhIGVuY29kaW5nIHZhbGlkIGZvciBqYXZhLmxhbmcgYW5kIGphdmEuaW8KCSAgICAvLyBUWVBFU0NSSVBUUE9SVDogY2hhbmdlZCB0aGUgbWFpbiBsYWJlbCBmb3IgSVNPIGFzIHRoZSBUZXh0RW5jb2RlciBkaWQgbm90IHJlY29nbml6ZWQgdGhlbSBpbiB0aGUgZm9ybSBmcm9tIGphdmEKCSAgICAvLyAoZWcgSVNPODg1OV8xIG11c3QgYmUgSVNPODg1OTEgb3IgSVNPODg1OS0xIG9yIElTTy04ODU5LTEpCgkgICAgLy8gbGF0ZXIgb246IHdlbGwsIGV4Y2VwdCAxNiB3aWNoIGRvZXMgbm90IHdvcmsgd2l0aCBJU084ODU5MTYgc28gdXNlZCBJU08tODg1OS0xIGZvcm0gZm9yIGRlZmF1bHQKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3A0MzcgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3A0MzcsIEludDMyQXJyYXkuZnJvbShbMCwgMl0pLCAnQ3A0MzcnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMSwgSW50MzJBcnJheS5mcm9tKFsxLCAzXSksICdJU08tODg1OS0xJywgJ0lTTzg4NTkxJywgJ0lTTzg4NTlfMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzIgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8yLCA0LCAnSVNPLTg4NTktMicsICdJU084ODU5MicsICdJU084ODU5XzInKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8zID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMywgNSwgJ0lTTy04ODU5LTMnLCAnSVNPODg1OTMnLCAnSVNPODg1OV8zJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzQsIDYsICdJU08tODg1OS00JywgJ0lTTzg4NTk0JywgJ0lTTzg4NTlfNCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV81LCA3LCAnSVNPLTg4NTktNScsICdJU084ODU5NScsICdJU084ODU5XzUnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV82ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfNiwgOCwgJ0lTTy04ODU5LTYnLCAnSVNPODg1OTYnLCAnSVNPODg1OV82Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfNyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzcsIDksICdJU08tODg1OS03JywgJ0lTTzg4NTk3JywgJ0lTTzg4NTlfNycpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV84LCAxMCwgJ0lTTy04ODU5LTgnLCAnSVNPODg1OTgnLCAnSVNPODg1OV84Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfOSA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzksIDExLCAnSVNPLTg4NTktOScsICdJU084ODU5OScsICdJU084ODU5XzknKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xMCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzEwLCAxMiwgJ0lTTy04ODU5LTEwJywgJ0lTTzg4NTkxMCcsICdJU084ODU5XzEwJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xMSwgMTMsICdJU08tODg1OS0xMScsICdJU084ODU5MTEnLCAnSVNPODg1OV8xMScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzEzID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTMsIDE1LCAnSVNPLTg4NTktMTMnLCAnSVNPODg1OTEzJywgJ0lTTzg4NTlfMTMnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuSVNPODg1OV8xNCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5JU084ODU5XzE0LCAxNiwgJ0lTTy04ODU5LTE0JywgJ0lTTzg4NTkxNCcsICdJU084ODU5XzE0Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLklTTzg4NTlfMTUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuSVNPODg1OV8xNSwgMTcsICdJU08tODg1OS0xNScsICdJU084ODU5MTUnLCAnSVNPODg1OV8xNScpOwoJICAgIENoYXJhY3RlclNldEVDSS5JU084ODU5XzE2ID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLklTTzg4NTlfMTYsIDE4LCAnSVNPLTg4NTktMTYnLCAnSVNPODg1OTE2JywgJ0lTTzg4NTlfMTYnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuU0pJUyA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5TSklTLCAyMCwgJ1NKSVMnLCAnU2hpZnRfSklTJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1MCA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTAsIDIxLCAnQ3AxMjUwJywgJ3dpbmRvd3MtMTI1MCcpOwoJICAgIENoYXJhY3RlclNldEVDSS5DcDEyNTEgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQ3AxMjUxLCAyMiwgJ0NwMTI1MScsICd3aW5kb3dzLTEyNTEnKTsKCSAgICBDaGFyYWN0ZXJTZXRFQ0kuQ3AxMjUyID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkNwMTI1MiwgMjMsICdDcDEyNTInLCAnd2luZG93cy0xMjUyJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkNwMTI1NiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5DcDEyNTYsIDI0LCAnQ3AxMjU2JywgJ3dpbmRvd3MtMTI1NicpOwoJICAgIENoYXJhY3RlclNldEVDSS5Vbmljb2RlQmlnVW5tYXJrZWQgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVW5pY29kZUJpZ1VubWFya2VkLCAyNSwgJ1VuaWNvZGVCaWdVbm1hcmtlZCcsICdVVEYtMTZCRScsICdVbmljb2RlQmlnJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLlVURjggPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuVVRGOCwgMjYsICdVVEY4JywgJ1VURi04Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkFTQ0lJID0gbmV3IENoYXJhY3RlclNldEVDSShDaGFyYWN0ZXJTZXRWYWx1ZUlkZW50aWZpZXJzLkFTQ0lJLCBJbnQzMkFycmF5LmZyb20oWzI3LCAxNzBdKSwgJ0FTQ0lJJywgJ1VTLUFTQ0lJJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkJpZzUgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuQmlnNSwgMjgsICdCaWc1Jyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkdCMTgwMzAgPSBuZXcgQ2hhcmFjdGVyU2V0RUNJKENoYXJhY3RlclNldFZhbHVlSWRlbnRpZmllcnMuR0IxODAzMCwgMjksICdHQjE4MDMwJywgJ0dCMjMxMicsICdFVUNfQ04nLCAnR0JLJyk7CgkgICAgQ2hhcmFjdGVyU2V0RUNJLkVVQ19LUiA9IG5ldyBDaGFyYWN0ZXJTZXRFQ0koQ2hhcmFjdGVyU2V0VmFsdWVJZGVudGlmaWVycy5FVUNfS1IsIDMwLCAnRVVDX0tSJywgJ0VVQy1LUicpOwoJICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0k7Cgl9KCkpOwoJZXhwb3J0cy5kZWZhdWx0ID0gQ2hhcmFjdGVyU2V0RUNJOwoKCX0oQ2hhcmFjdGVyU2V0RUNJKSk7CgoJdmFyIFN0cmluZ0VuY29kaW5nJDEgPSB7fTsKCgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNiA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZShVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbi5raW5kID0gJ1Vuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCkpOwoJVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb24kMS5kZWZhdWx0ID0gVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb247CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ0VuY29kaW5nJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEgPSBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbiQxOwoJdmFyIENoYXJhY3RlclNldEVDSV8xJDIgPSBDaGFyYWN0ZXJTZXRFQ0k7CgkvKioKCSAqIFJlc3BvbnNpYmxlIGZvciBlbi9kZWNvZGluZyBzdHJpbmdzLgoJICovCgl2YXIgU3RyaW5nRW5jb2RpbmcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nRW5jb2RpbmcoKSB7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIERlY29kZXMgc29tZSBVaW50OEFycmF5IHRvIGEgc3RyaW5nIGZvcm1hdC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5kZWNvZGUgPSBmdW5jdGlvbiAoYnl0ZXMsIGVuY29kaW5nKSB7CgkgICAgICAgIHZhciBlbmNvZGluZ05hbWUgPSB0aGlzLmVuY29kaW5nTmFtZShlbmNvZGluZyk7CgkgICAgICAgIGlmICh0aGlzLmN1c3RvbURlY29kZXIpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmN1c3RvbURlY29kZXIoYnl0ZXMsIGVuY29kaW5nTmFtZSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSW5jcmVhc2VzIGJyb3dzZXIgc3VwcG9ydC4KCSAgICAgICAgaWYgKHR5cGVvZiBUZXh0RGVjb2RlciA9PT0gJ3VuZGVmaW5lZCcgfHwgdGhpcy5zaG91bGREZWNvZGVPbkZhbGxiYWNrKGVuY29kaW5nTmFtZSkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUZhbGxiYWNrKGJ5dGVzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVGV4dERlY29kZXIoZW5jb2RpbmdOYW1lKS5kZWNvZGUoYnl0ZXMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ2hlY2tzIGlmIHRoZSBkZWNvZGluZyBtZXRob2Qgc2hvdWxkIHVzZSB0aGUgZmFsbGJhY2sgZm9yIGRlY29kaW5nCgkgICAgICogb25jZSBOb2RlIFRleHREZWNvZGVyIGRvZXNuJ3Qgc3VwcG9ydCBhbGwgZW5jb2RpbmcgZm9ybWF0cy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBlbmNvZGluZ05hbWUKCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5zaG91bGREZWNvZGVPbkZhbGxiYWNrID0gZnVuY3Rpb24gKGVuY29kaW5nTmFtZSkgewoJICAgICAgICByZXR1cm4gIVN0cmluZ0VuY29kaW5nLmlzQnJvd3NlcigpICYmIGVuY29kaW5nTmFtZSA9PT0gJ0lTTy04ODU5LTEnOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRW5jb2RlcyBzb21lIHN0cmluZyBpbnRvIGEgVWludDhBcnJheS4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGUgPSBmdW5jdGlvbiAocywgZW5jb2RpbmcpIHsKCSAgICAgICAgdmFyIGVuY29kaW5nTmFtZSA9IHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKTsKCSAgICAgICAgaWYgKHRoaXMuY3VzdG9tRW5jb2RlcikgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuY3VzdG9tRW5jb2RlcihzLCBlbmNvZGluZ05hbWUpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEluY3JlYXNlcyBicm93c2VyIHN1cHBvcnQuCgkgICAgICAgIGlmICh0eXBlb2YgVGV4dEVuY29kZXIgPT09ICd1bmRlZmluZWQnKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5lbmNvZGVGYWxsYmFjayhzKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBUZXh0RW5jb2RlciBvbmx5IGVuY29kZXMgdG8gVVRGOCBieSBkZWZhdWx0IGFzIHNwZWNpZmllZCBieSBlbmNvZGluZy5zcGVjLndoYXR3Zy5vcmcKCSAgICAgICAgcmV0dXJuIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShzKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHdpbmRvdykgPT09ICdbb2JqZWN0IFdpbmRvd10nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHN0cmluZyB2YWx1ZSBmcm9tIHNvbWUgZW5jb2RpbmcgY2hhcmFjdGVyIHNldC4KCSAgICAgKi8KCSAgICBTdHJpbmdFbmNvZGluZy5lbmNvZGluZ05hbWUgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgcmV0dXJuIHR5cGVvZiBlbmNvZGluZyA9PT0gJ3N0cmluZycKCSAgICAgICAgICAgID8gZW5jb2RpbmcKCSAgICAgICAgICAgIDogZW5jb2RpbmcuZ2V0TmFtZSgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBjaGFyYWN0ZXIgc2V0IGZyb20gc29tZSBlbmNvZGluZyBjaGFyYWN0ZXIgc2V0LgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmVuY29kaW5nQ2hhcmFjdGVyU2V0ID0gZnVuY3Rpb24gKGVuY29kaW5nKSB7CgkgICAgICAgIGlmIChlbmNvZGluZyBpbnN0YW5jZW9mIENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdCkgewoJICAgICAgICAgICAgcmV0dXJuIGVuY29kaW5nOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlOYW1lKGVuY29kaW5nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJ1bnMgYSBmYWxsYmFjayBmb3IgdGhlIG5hdGl2ZSBkZWNvZGluZyBmdW5jaW9uLgoJICAgICAqLwoJICAgIFN0cmluZ0VuY29kaW5nLmRlY29kZUZhbGxiYWNrID0gZnVuY3Rpb24gKGJ5dGVzLCBlbmNvZGluZykgewoJICAgICAgICB2YXIgY2hhcmFjdGVyU2V0ID0gdGhpcy5lbmNvZGluZ0NoYXJhY3RlclNldChlbmNvZGluZyk7CgkgICAgICAgIGlmIChTdHJpbmdFbmNvZGluZy5pc0RlY29kZUZhbGxiYWNrU3VwcG9ydGVkKGNoYXJhY3RlclNldCkpIHsKCSAgICAgICAgICAgIHZhciBzID0gJyc7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbGVuZ3RoXzEgPSBieXRlcy5sZW5ndGg7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGggPSBieXRlc1tpXS50b1N0cmluZygxNik7CgkgICAgICAgICAgICAgICAgaWYgKGgubGVuZ3RoIDwgMikgewoJICAgICAgICAgICAgICAgICAgICBoID0gJzAnICsgaDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcyArPSAnJScgKyBoOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzKTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuVW5pY29kZUJpZ1VubWFya2VkKSkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgbmV3IFVpbnQxNkFycmF5KGJ5dGVzLmJ1ZmZlcikpOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBVbnN1cHBvcnRlZE9wZXJhdGlvbkV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgiRW5jb2RpbmcgIiArIHRoaXMuZW5jb2RpbmdOYW1lKGVuY29kaW5nKSArICIgbm90IHN1cHBvcnRlZCBieSBmYWxsYmFjay4iKTsKCSAgICB9OwoJICAgIFN0cmluZ0VuY29kaW5nLmlzRGVjb2RlRmFsbGJhY2tTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoY2hhcmFjdGVyU2V0KSB7CgkgICAgICAgIHJldHVybiBjaGFyYWN0ZXJTZXQuZXF1YWxzKENoYXJhY3RlclNldEVDSV8xJDIuZGVmYXVsdC5VVEY4KSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuSVNPODg1OV8xKSB8fAoJICAgICAgICAgICAgY2hhcmFjdGVyU2V0LmVxdWFscyhDaGFyYWN0ZXJTZXRFQ0lfMSQyLmRlZmF1bHQuQVNDSUkpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUnVucyBhIGZhbGxiYWNrIGZvciB0aGUgbmF0aXZlIGVuY29kaW5nIGZ1bmNpb24uCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xNzE5Mjg0NS80MzY3NjgzCgkgICAgICovCgkgICAgU3RyaW5nRW5jb2RpbmcuZW5jb2RlRmFsbGJhY2sgPSBmdW5jdGlvbiAocykgewoJICAgICAgICB2YXIgZW5jb2RlZFVSSXN0cmluZyA9IGJ0b2EodW5lc2NhcGUoZW5jb2RlVVJJQ29tcG9uZW50KHMpKSk7CgkgICAgICAgIHZhciBjaGFyTGlzdCA9IGVuY29kZWRVUklzdHJpbmcuc3BsaXQoJycpOwoJICAgICAgICB2YXIgdWludEFycmF5ID0gW107CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhckxpc3QubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHVpbnRBcnJheS5wdXNoKGNoYXJMaXN0W2ldLmNoYXJDb2RlQXQoMCkpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgVWludDhBcnJheSh1aW50QXJyYXkpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0VuY29kaW5nOwoJfSgpKTsKCVN0cmluZ0VuY29kaW5nJDEuZGVmYXVsdCA9IFN0cmluZ0VuY29kaW5nOwoKCS8qCgkgKiBDb3B5cmlnaHQgKEMpIDIwMTAgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFN0cmluZ1V0aWxzJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS5uaW8uY2hhcnNldC5DaGFyc2V0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQzID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSQxID0gQ2hhcmFjdGVyU2V0RUNJOwoJdmFyIFN0cmluZ0VuY29kaW5nXzEkMSA9IFN0cmluZ0VuY29kaW5nJDE7CgkvKioKCSAqIENvbW1vbiBzdHJpbmctcmVsYXRlZCBmdW5jdGlvbnMuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgQWxleCBEdXByZQoJICovCgl2YXIgU3RyaW5nVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nVXRpbHMoKSB7CgkgICAgfQoJICAgIC8vIFNISUZUX0pJUy5lcXVhbHNJZ25vcmVDYXNlKFBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcpIHx8CgkgICAgLy8gRVVDX0pQLmVxdWFsc0lnbm9yZUNhc2UoUExBVEZPUk1fREVGQVVMVF9FTkNPRElORyk7CgkgICAgU3RyaW5nVXRpbHMuY2FzdEFzTm9uVXRmOENoYXIgPSBmdW5jdGlvbiAoY29kZSwgZW5jb2RpbmcpIHsKCSAgICAgICAgaWYgKGVuY29kaW5nID09PSB2b2lkIDApIHsgZW5jb2RpbmcgPSBudWxsOyB9CgkgICAgICAgIC8vIElTTyA4ODU5LTEgaXMgdGhlIEphdmEgZGVmYXVsdCBhcyBVVEYtOCBpcyBKYXZhU2NyaXB0cwoJICAgICAgICAvLyB5b3UgY2FuIHNlZSB0aGlzIG1ldGhvZCBhcyBhIEphdmEgdmVyc2lvbiBvZiBTdHJpbmcuZnJvbUNoYXJDb2RlCgkgICAgICAgIHZhciBlID0gZW5jb2RpbmcgPyBlbmNvZGluZy5nZXROYW1lKCkgOiB0aGlzLklTTzg4NTkxOwoJICAgICAgICAvLyB1c2UgcGFzc2VkIGZvcm1hdCAoZnJvbUNoYXJDb2RlIHdpbGwgcmV0dXJuIFVURjggZW5jb2RpbmcpCgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5kZWNvZGUobmV3IFVpbnQ4QXJyYXkoW2NvZGVdKSwgZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYnl0ZXMgYnl0ZXMgZW5jb2RpbmcgYSBzdHJpbmcsIHdob3NlIGVuY29kaW5nIHNob3VsZCBiZSBndWVzc2VkCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kZSBoaW50cyBpZiBhcHBsaWNhYmxlCgkgICAgICogQHJldHVybiBuYW1lIG9mIGd1ZXNzZWQgZW5jb2Rpbmc7IGF0IHRoZSBtb21lbnQgd2lsbCBvbmx5IGd1ZXNzIG9uZSBvZjoKCSAgICAgKiAge0BsaW5rICNTSElGVF9KSVN9LCB7QGxpbmsgI1VURjh9LCB7QGxpbmsgI0lTTzg4NTkxfSwgb3IgdGhlIHBsYXRmb3JtCgkgICAgICogIGRlZmF1bHQgZW5jb2RpbmcgaWYgbm9uZSBvZiB0aGVzZSBjYW4gcG9zc2libHkgYmUgY29ycmVjdAoJICAgICAqLwoJICAgIFN0cmluZ1V0aWxzLmd1ZXNzRW5jb2RpbmcgPSBmdW5jdGlvbiAoYnl0ZXMsIGhpbnRzKSB7CgkgICAgICAgIGlmIChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpKSB7CgkgICAgICAgICAgICByZXR1cm4gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEkMy5kZWZhdWx0LkNIQVJBQ1RFUl9TRVQpLnRvU3RyaW5nKCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRm9yIG5vdywgbWVyZWx5IHRyaWVzIHRvIGRpc3Rpbmd1aXNoIElTTy04ODU5LTEsIFVURi04IGFuZCBTaGlmdF9KSVMsCgkgICAgICAgIC8vIHdoaWNoIHNob3VsZCBiZSBieSBmYXIgdGhlIG1vc3QgY29tbW9uIGVuY29kaW5ncy4KCSAgICAgICAgdmFyIGxlbmd0aCA9IGJ5dGVzLmxlbmd0aDsKCSAgICAgICAgdmFyIGNhbkJlSVNPODg1OTEgPSB0cnVlOwoJICAgICAgICB2YXIgY2FuQmVTaGlmdEpJUyA9IHRydWU7CgkgICAgICAgIHZhciBjYW5CZVVURjggPSB0cnVlOwoJICAgICAgICB2YXIgdXRmOEJ5dGVzTGVmdCA9IDA7CgkgICAgICAgIC8vIGludCB1dGY4TG93Q2hhcnMgPSAwCgkgICAgICAgIHZhciB1dGYyQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGYzQnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciB1dGY0Qnl0ZXNDaGFycyA9IDA7CgkgICAgICAgIHZhciBzamlzQnl0ZXNMZWZ0ID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNMb3dDaGFycyA9IDAKCSAgICAgICAgdmFyIHNqaXNLYXRha2FuYUNoYXJzID0gMDsKCSAgICAgICAgLy8gaW50IHNqaXNEb3VibGVCeXRlc0NoYXJzID0gMAoJICAgICAgICB2YXIgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgIHZhciBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgdmFyIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSAwOwoJICAgICAgICB2YXIgc2ppc01heERvdWJsZUJ5dGVzV29yZExlbmd0aCA9IDA7CgkgICAgICAgIC8vIGludCBpc29Mb3dDaGFycyA9IDAKCSAgICAgICAgLy8gaW50IGlzb0hpZ2hDaGFycyA9IDAKCSAgICAgICAgdmFyIGlzb0hpZ2hPdGhlciA9IDA7CgkgICAgICAgIHZhciB1dGY4Ym9tID0gYnl0ZXMubGVuZ3RoID4gMyAmJgoJICAgICAgICAgICAgYnl0ZXNbMF0gPT09IC8qKGJ5dGUpICovIDB4RUYgJiYKCSAgICAgICAgICAgIGJ5dGVzWzFdID09PSAvKihieXRlKSAqLyAweEJCICYmCgkgICAgICAgICAgICBieXRlc1syXSA9PT0gLyooYnl0ZSkgKi8gMHhCRjsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGggJiYgKGNhbkJlSVNPODg1OTEgfHwgY2FuQmVTaGlmdEpJUyB8fCBjYW5CZVVURjgpOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB2YWx1ZSA9IGJ5dGVzW2ldICYgMHhGRjsKCSAgICAgICAgICAgIC8vIFVURi04IHN0dWZmCgkgICAgICAgICAgICBpZiAoY2FuQmVVVEY4KSB7CgkgICAgICAgICAgICAgICAgaWYgKHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDgwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgY2FuQmVVVEY4ID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAoKHZhbHVlICYgMHg4MCkgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4NDApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjhCeXRlc0xlZnQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDIwKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjJCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh2YWx1ZSAmIDB4MTApID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV0ZjNCeXRlc0NoYXJzKys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1dGY4Qnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgodmFsdWUgJiAweDA4KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXRmNEJ5dGVzQ2hhcnMrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbkJlVVRGOCA9IGZhbHNlOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfSAvLyBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyB1dGY4TG93Q2hhcnMrKwoJICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIElTTy04ODU5LTEgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICAgICAgaWYgKHZhbHVlID4gMHg3RiAmJiB2YWx1ZSA8IDB4QTApIHsKCSAgICAgICAgICAgICAgICAgICAgY2FuQmVJU084ODU5MSA9IGZhbHNlOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmICh2YWx1ZSA+IDB4OUYpIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlIDwgMHhDMCB8fCB2YWx1ZSA9PT0gMHhENyB8fCB2YWx1ZSA9PT0gMHhGNykgewoJICAgICAgICAgICAgICAgICAgICAgICAgaXNvSGlnaE90aGVyKys7CgkgICAgICAgICAgICAgICAgICAgIH0gLy8gZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIGlzb0hpZ2hDaGFycysrCgkgICAgICAgICAgICAgICAgICAgIC8vIH0KCSAgICAgICAgICAgICAgICB9IC8vIGVsc2UgewoJICAgICAgICAgICAgICAgIC8vIGlzb0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAvLyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBTaGlmdF9KSVMgc3R1ZmYKCSAgICAgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTKSB7CgkgICAgICAgICAgICAgICAgaWYgKHNqaXNCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA8IDB4NDAgfHwgdmFsdWUgPT09IDB4N0YgfHwgdmFsdWUgPiAweEZDKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBjYW5CZVNoaWZ0SklTID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0LS07CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPT09IDB4ODAgfHwgdmFsdWUgPT09IDB4QTAgfHwgdmFsdWUgPiAweEVGKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhbkJlU2hpZnRKSVMgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAodmFsdWUgPiAweEEwICYmIHZhbHVlIDwgMHhFMCkgewoJICAgICAgICAgICAgICAgICAgICBzamlzS2F0YWthbmFDaGFycysrOwoJICAgICAgICAgICAgICAgICAgICBzamlzQ3VyRG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gMDsKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCsrOwoJICAgICAgICAgICAgICAgICAgICBpZiAoc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA+IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPSBzamlzQ3VyS2F0YWthbmFXb3JkTGVuZ3RoOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgaWYgKHZhbHVlID4gMHg3RikgewoJICAgICAgICAgICAgICAgICAgICBzamlzQnl0ZXNMZWZ0Kys7CgkgICAgICAgICAgICAgICAgICAgIC8vIHNqaXNEb3VibGVCeXRlc0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGgrKzsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPiBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID0gc2ppc0N1ckRvdWJsZUJ5dGVzV29yZExlbmd0aDsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gc2ppc0xvd0NoYXJzKysKCSAgICAgICAgICAgICAgICAgICAgc2ppc0N1ckthdGFrYW5hV29yZExlbmd0aCA9IDA7CgkgICAgICAgICAgICAgICAgICAgIHNqaXNDdXJEb3VibGVCeXRlc1dvcmRMZW5ndGggPSAwOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmIHV0ZjhCeXRlc0xlZnQgPiAwKSB7CgkgICAgICAgICAgICBjYW5CZVVURjggPSBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY2FuQmVTaGlmdEpJUyAmJiBzamlzQnl0ZXNMZWZ0ID4gMCkgewoJICAgICAgICAgICAgY2FuQmVTaGlmdEpJUyA9IGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhc3kgLS0gaWYgdGhlcmUgaXMgQk9NIG9yIGF0IGxlYXN0IDEgdmFsaWQgbm90LXNpbmdsZSBieXRlIGNoYXJhY3RlciAoYW5kIG5vIGV2aWRlbmNlIGl0IGNhbid0IGJlIFVURi04KSwgZG9uZQoJICAgICAgICBpZiAoY2FuQmVVVEY4ICYmICh1dGY4Ym9tIHx8IHV0ZjJCeXRlc0NoYXJzICsgdXRmM0J5dGVzQ2hhcnMgKyB1dGY0Qnl0ZXNDaGFycyA+IDApKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuVVRGODsKCSAgICAgICAgfQoJICAgICAgICAvLyBFYXN5IC0tIGlmIGFzc3VtaW5nIFNoaWZ0X0pJUyBvciBhdCBsZWFzdCAzIHZhbGlkIGNvbnNlY3V0aXZlIG5vdC1hc2NpaSBjaGFyYWN0ZXJzIChhbmQgbm8gZXZpZGVuY2UgaXQgY2FuJ3QgYmUpLCBkb25lCgkgICAgICAgIGlmIChjYW5CZVNoaWZ0SklTICYmIChTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTIHx8IHNqaXNNYXhLYXRha2FuYVdvcmRMZW5ndGggPj0gMyB8fCBzamlzTWF4RG91YmxlQnl0ZXNXb3JkTGVuZ3RoID49IDMpKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuU0hJRlRfSklTOwoJICAgICAgICB9CgkgICAgICAgIC8vIERpc3Rpbmd1aXNoaW5nIFNoaWZ0X0pJUyBhbmQgSVNPLTg4NTktMSBjYW4gYmUgYSBsaXR0bGUgdG91Z2ggZm9yIHNob3J0IHdvcmRzLiBUaGUgY3J1ZGUgaGV1cmlzdGljIGlzOgoJICAgICAgICAvLyAtIElmIHdlIHNhdwoJICAgICAgICAvLyAgIC0gb25seSB0d28gY29uc2VjdXRpdmUga2F0YWthbmEgY2hhcnMgaW4gdGhlIHdob2xlIHRleHQsIG9yCgkgICAgICAgIC8vICAgLSBhdCBsZWFzdCAxMCUgb2YgYnl0ZXMgdGhhdCBjb3VsZCBiZSAidXBwZXIiIG5vdC1hbHBoYW51bWVyaWMgTGF0aW4xLAoJICAgICAgICAvLyAtIHRoZW4gd2UgY29uY2x1ZGUgU2hpZnRfSklTLCBlbHNlIElTTy04ODU5LTEKCSAgICAgICAgaWYgKGNhbkJlSVNPODg1OTEgJiYgY2FuQmVTaGlmdEpJUykgewoJICAgICAgICAgICAgcmV0dXJuIChzamlzTWF4S2F0YWthbmFXb3JkTGVuZ3RoID09PSAyICYmIHNqaXNLYXRha2FuYUNoYXJzID09PSAyKSB8fCBpc29IaWdoT3RoZXIgKiAxMCA+PSBsZW5ndGgKCSAgICAgICAgICAgICAgICA/IFN0cmluZ1V0aWxzLlNISUZUX0pJUyA6IFN0cmluZ1V0aWxzLklTTzg4NTkxOwoJICAgICAgICB9CgkgICAgICAgIC8vIE90aGVyd2lzZSwgdHJ5IGluIG9yZGVyIElTTy04ODU5LTEsIFNoaWZ0IEpJUywgVVRGLTggYW5kIGZhbGwgYmFjayB0byBkZWZhdWx0IHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIGlmIChjYW5CZUlTTzg4NTkxKSB7CgkgICAgICAgICAgICByZXR1cm4gU3RyaW5nVXRpbHMuSVNPODg1OTE7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlU2hpZnRKSVMpIHsKCSAgICAgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5TSElGVF9KSVM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNhbkJlVVRGOCkgewoJICAgICAgICAgICAgcmV0dXJuIFN0cmluZ1V0aWxzLlVURjg7CgkgICAgICAgIH0KCSAgICAgICAgLy8gT3RoZXJ3aXNlLCB3ZSB0YWtlIGEgd2lsZCBndWVzcyB3aXRoIHBsYXRmb3JtIGVuY29kaW5nCgkgICAgICAgIHJldHVybiBTdHJpbmdVdGlscy5QTEFURk9STV9ERUZBVUxUX0VOQ09ESU5HOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKiBAc2VlIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQzOTcxMS80MzY3NjgzCgkgICAgICoKCSAgICAgKiBAcGFyYW0gYXBwZW5kIFRoZSBuZXcgc3RyaW5nIHRvIGFwcGVuZC4KCSAgICAgKiBAcGFyYW0gYXJncyBBcmd1bWV0cyB2YWx1ZXMgdG8gYmUgZm9ybWF0ZWQuCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZm9ybWF0ID0gZnVuY3Rpb24gKGFwcGVuZCkgewoJICAgICAgICB2YXIgYXJncyA9IFtdOwoJICAgICAgICBmb3IgKHZhciBfaSA9IDE7IF9pIDwgYXJndW1lbnRzLmxlbmd0aDsgX2krKykgewoJICAgICAgICAgICAgYXJnc1tfaSAtIDFdID0gYXJndW1lbnRzW19pXTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaSA9IC0xOwoJICAgICAgICBmdW5jdGlvbiBjYWxsYmFjayhleHAsIHAwLCBwMSwgcDIsIHAzLCBwNCkgewoJICAgICAgICAgICAgaWYgKGV4cCA9PT0gJyUlJykKCSAgICAgICAgICAgICAgICByZXR1cm4gJyUnOwoJICAgICAgICAgICAgaWYgKGFyZ3NbKytpXSA9PT0gdW5kZWZpbmVkKQoJICAgICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CgkgICAgICAgICAgICBleHAgPSBwMiA/IHBhcnNlSW50KHAyLnN1YnN0cigxKSkgOiB1bmRlZmluZWQ7CgkgICAgICAgICAgICB2YXIgYmFzZSA9IHAzID8gcGFyc2VJbnQocDMuc3Vic3RyKDEpKSA6IHVuZGVmaW5lZDsKCSAgICAgICAgICAgIHZhciB2YWw7CgkgICAgICAgICAgICBzd2l0Y2ggKHA0KSB7CgkgICAgICAgICAgICAgICAgY2FzZSAncyc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IGFyZ3NbaV07CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2MnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBhcmdzW2ldWzBdOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdmJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChhcmdzW2ldKS50b0ZpeGVkKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ3AnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvUHJlY2lzaW9uKGV4cCk7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIGNhc2UgJ2UnOgoJICAgICAgICAgICAgICAgICAgICB2YWwgPSBwYXJzZUZsb2F0KGFyZ3NbaV0pLnRvRXhwb25lbnRpYWwoZXhwKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgY2FzZSAneCc6CgkgICAgICAgICAgICAgICAgICAgIHZhbCA9IHBhcnNlSW50KGFyZ3NbaV0pLnRvU3RyaW5nKGJhc2UgPyBiYXNlIDogMTYpOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICBjYXNlICdkJzoKCSAgICAgICAgICAgICAgICAgICAgdmFsID0gcGFyc2VGbG9hdChwYXJzZUludChhcmdzW2ldLCBiYXNlID8gYmFzZSA6IDEwKS50b1ByZWNpc2lvbihleHApKS50b0ZpeGVkKDApOwoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhbCA9IHR5cGVvZiB2YWwgPT09ICdvYmplY3QnID8gSlNPTi5zdHJpbmdpZnkodmFsKSA6ICgrdmFsKS50b1N0cmluZyhiYXNlKTsKCSAgICAgICAgICAgIHZhciBzaXplID0gcGFyc2VJbnQocDEpOyAvKiBwYWRkaW5nIHNpemUgKi8KCSAgICAgICAgICAgIHZhciBjaCA9IHAxICYmIChwMVswXSArICcnKSA9PT0gJzAnID8gJzAnIDogJyAnOyAvKiBpc251bGw/ICovCgkgICAgICAgICAgICB3aGlsZSAodmFsLmxlbmd0aCA8IHNpemUpCgkgICAgICAgICAgICAgICAgdmFsID0gcDAgIT09IHVuZGVmaW5lZCA/IHZhbCArIGNoIDogY2ggKyB2YWw7IC8qIGlzbWludXM/ICovCgkgICAgICAgICAgICByZXR1cm4gdmFsOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZWdleCA9IC8lKC0pPygwP1swLTldKyk/KFsuXVswLTldKyk/KFsjXVswLTldKyk/KFtzY2ZwZXhkJV0pL2c7CgkgICAgICAgIHJldHVybiBhcHBlbmQucmVwbGFjZShyZWdleCwgY2FsbGJhY2spOwoJICAgIH07CgkgICAgLyoqCgkgICAgICoKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRCeXRlcyA9IGZ1bmN0aW9uIChzdHIsIGVuY29kaW5nKSB7CgkgICAgICAgIHJldHVybiBTdHJpbmdFbmNvZGluZ18xJDEuZGVmYXVsdC5lbmNvZGUoc3RyLCBlbmNvZGluZyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIHRoZSBjaGFyY29kZSBhdCB0aGUgc3BlY2lmaWVkIGluZGV4IG9yIGF0IGluZGV4IHplcm8uCgkgICAgICovCgkgICAgU3RyaW5nVXRpbHMuZ2V0Q2hhckNvZGUgPSBmdW5jdGlvbiAoc3RyLCBpbmRleCkgewoJICAgICAgICBpZiAoaW5kZXggPT09IHZvaWQgMCkgeyBpbmRleCA9IDA7IH0KCSAgICAgICAgcmV0dXJuIHN0ci5jaGFyQ29kZUF0KGluZGV4KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgY2hhciBmb3IgZ2l2ZW4gY2hhcmNvZGUKCSAgICAgKi8KCSAgICBTdHJpbmdVdGlscy5nZXRDaGFyQXQgPSBmdW5jdGlvbiAoY2hhckNvZGUpIHsKCSAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2hhckNvZGUpOwoJICAgIH07CgkgICAgU3RyaW5nVXRpbHMuU0hJRlRfSklTID0gQ2hhcmFjdGVyU2V0RUNJXzEkMS5kZWZhdWx0LlNKSVMuZ2V0TmFtZSgpOyAvLyAiU0pJUyIKCSAgICBTdHJpbmdVdGlscy5HQjIzMTIgPSAnR0IyMzEyJzsKCSAgICBTdHJpbmdVdGlscy5JU084ODU5MSA9IENoYXJhY3RlclNldEVDSV8xJDEuZGVmYXVsdC5JU084ODU5XzEuZ2V0TmFtZSgpOyAvLyAiSVNPODg1OV8xIgoJICAgIFN0cmluZ1V0aWxzLkVVQ19KUCA9ICdFVUNfSlAnOwoJICAgIFN0cmluZ1V0aWxzLlVURjggPSBDaGFyYWN0ZXJTZXRFQ0lfMSQxLmRlZmF1bHQuVVRGOC5nZXROYW1lKCk7IC8vICJVVEY4IgoJICAgIFN0cmluZ1V0aWxzLlBMQVRGT1JNX0RFRkFVTFRfRU5DT0RJTkcgPSBTdHJpbmdVdGlscy5VVEY4OyAvLyAiVVRGOCIvL0NoYXJzZXQuZGVmYXVsdENoYXJzZXQoKS5uYW1lKCkKCSAgICBTdHJpbmdVdGlscy5BU1NVTUVfU0hJRlRfSklTID0gZmFsc2U7CgkgICAgcmV0dXJuIFN0cmluZ1V0aWxzOwoJfSgpKTsKCVN0cmluZ1V0aWxzJDEuZGVmYXVsdCA9IFN0cmluZ1V0aWxzOwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdHJpbmdCdWlsZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBTdHJpbmdVdGlsc18xJDEgPSBTdHJpbmdVdGlscyQxOwoJdmFyIFN0cmluZ0J1aWxkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gU3RyaW5nQnVpbGRlcih2YWx1ZSkgewoJICAgICAgICBpZiAodmFsdWUgPT09IHZvaWQgMCkgeyB2YWx1ZSA9ICcnOyB9CgkgICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTsKCSAgICB9CgkgICAgU3RyaW5nQnVpbGRlci5wcm90b3R5cGUuZW5hYmxlRGVjb2RpbmcgPSBmdW5jdGlvbiAoZW5jb2RpbmcpIHsKCSAgICAgICAgdGhpcy5lbmNvZGluZyA9IGVuY29kaW5nOwoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIGlmICh0eXBlb2YgcyA9PT0gJ3N0cmluZycpIHsKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gcy50b1N0cmluZygpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHRoaXMuZW5jb2RpbmcpIHsKCSAgICAgICAgICAgIC8vIHVzZSBwYXNzZWQgZm9ybWF0IChmcm9tQ2hhckNvZGUgd2lsbCByZXR1cm4gVVRGOCBlbmNvZGluZykKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nVXRpbHNfMSQxLmRlZmF1bHQuY2FzdEFzTm9uVXRmOENoYXIocywgdGhpcy5lbmNvZGluZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBjb3JyZWN0bHkgY29udmVydHMgZnJvbSBVVEYtOCwgYnV0IG5vdCBvdGhlciBlbmNvZGluZ3MKCSAgICAgICAgICAgIHRoaXMudmFsdWUgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShzKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpczsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmFwcGVuZENoYXJzID0gZnVuY3Rpb24gKHN0ciwgb2Zmc2V0LCBsZW4pIHsKCSAgICAgICAgZm9yICh2YXIgaSA9IG9mZnNldDsgb2Zmc2V0IDwgb2Zmc2V0ICsgbGVuOyBpKyspIHsKCSAgICAgICAgICAgIHRoaXMuYXBwZW5kKHN0cltpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmxlbmd0aDsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlLmNoYXJBdChuKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmRlbGV0ZUNoYXJBdCA9IGZ1bmN0aW9uIChuKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIHRoaXMudmFsdWUuc3Vic3RyaW5nKG4gKyAxKTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnNldENoYXJBdCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgMSk7CgkgICAgfTsKCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zdWJzdHJpbmcgPSBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAbm90ZSBoZWxwZXIgbWV0aG9kIGZvciBSU1MgRXhwYW5kZWQKCSAgICAgKi8KCSAgICBTdHJpbmdCdWlsZGVyLnByb3RvdHlwZS5zZXRMZW5ndGhUb1plcm8gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSAnJzsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIFN0cmluZ0J1aWxkZXIucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uIChuLCBjKSB7CgkgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLnZhbHVlLnN1YnN0cigwLCBuKSArIGMgKyB0aGlzLnZhbHVlLnN1YnN0cihuICsgYy5sZW5ndGgpOwoJICAgIH07CgkgICAgcmV0dXJuIFN0cmluZ0J1aWxkZXI7Cgl9KCkpOwoJU3RyaW5nQnVpbGRlciQxLmRlZmF1bHQgPSBTdHJpbmdCdWlsZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQml0TWF0cml4JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5czsqLwoJdmFyIEJpdEFycmF5XzEkMSA9IEJpdEFycmF5JDE7Cgl2YXIgU3lzdGVtXzEkMyA9IFN5c3RlbSQxOwoJdmFyIEFycmF5c18xID0gQXJyYXlzJDE7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDIgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNyA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgMkQgbWF0cml4IG9mIGJpdHMuIEluIGZ1bmN0aW9uIGFyZ3VtZW50cyBiZWxvdywgYW5kIHRocm91Z2hvdXQgdGhlIGNvbW1vbgoJICogbW9kdWxlLCB4IGlzIHRoZSBjb2x1bW4gcG9zaXRpb24sIGFuZCB5IGlzIHRoZSByb3cgcG9zaXRpb24uIFRoZSBvcmRlcmluZyBpcyBhbHdheXMgeCwgeS4KCSAqIFRoZSBvcmlnaW4gaXMgYXQgdGhlIHRvcC1sZWZ0LjwvcD4KCSAqCgkgKiA8cD5JbnRlcm5hbGx5IHRoZSBiaXRzIGFyZSByZXByZXNlbnRlZCBpbiBhIDEtRCBhcnJheSBvZiAzMi1iaXQgaW50cy4gSG93ZXZlciwgZWFjaCByb3cgYmVnaW5zCgkgKiB3aXRoIGEgbmV3IGludC4gVGhpcyBpcyBkb25lIGludGVudGlvbmFsbHkgc28gdGhhdCB3ZSBjYW4gY29weSBvdXQgYSByb3cgaW50byBhIEJpdEFycmF5IHZlcnkKCSAqIGVmZmljaWVudGx5LjwvcD4KCSAqCgkgKiA8cD5UaGUgb3JkZXJpbmcgb2YgYml0cyBpcyByb3ctbWFqb3IuIFdpdGhpbiBlYWNoIGludCwgdGhlIGxlYXN0IHNpZ25pZmljYW50IGJpdHMgYXJlIHVzZWQgZmlyc3QsCgkgKiBtZWFuaW5nIHRoZXkgcmVwcmVzZW50IGxvd2VyIHggdmFsdWVzLiBUaGlzIGlzIGNvbXBhdGlibGUgd2l0aCBCaXRBcnJheSdzIGltcGxlbWVudGF0aW9uLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqLwoJdmFyIEJpdE1hdHJpeCAvKmltcGxlbWVudHMgQ2xvbmVhYmxlKi8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSBzcXVhcmUge0BsaW5rIEJpdE1hdHJpeH0uCgkgICAgICoKCSAgICAgKiBAcGFyYW0gZGltZW5zaW9uIGhlaWdodCBhbmQgd2lkdGgKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoZGltZW5zaW9uOiBudW1iZXIgLyppbnQqLykgewoJICAgIC8vICAgdGhpcyhkaW1lbnNpb24sIGRpbWVuc2lvbikKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogQ3JlYXRlcyBhbiBlbXB0eSB7QGxpbmsgQml0TWF0cml4fS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB3aWR0aCBiaXQgbWF0cml4IHdpZHRoCgkgICAgICogQHBhcmFtIGhlaWdodCBiaXQgbWF0cml4IGhlaWdodAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyIC8qaW50Ki8sIGhlaWdodDogbnVtYmVyIC8qaW50Ki8pIHsKCSAgICAvLyAgIGlmICh3aWR0aCA8IDEgfHwgaGVpZ2h0IDwgMSkgewoJICAgIC8vICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKCJCb3RoIGRpbWVuc2lvbnMgbXVzdCBiZSBncmVhdGVyIHRoYW4gMCIpCgkgICAgLy8gICB9CgkgICAgLy8gICB0aGlzLndpZHRoID0gd2lkdGgKCSAgICAvLyAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0CgkgICAgLy8gICB0aGlzLnJvd1NpemUgPSAod2lkdGggKyAzMSkgLyAzMgoJICAgIC8vICAgYml0cyA9IG5ldyBpbnRbcm93U2l6ZSAqIGhlaWdodF07CgkgICAgLy8gfQoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeCh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgcm93U2l6ZSAvKmludCovLCBiaXRzKSB7CgkgICAgICAgIHRoaXMud2lkdGggPSB3aWR0aDsKCSAgICAgICAgdGhpcy5oZWlnaHQgPSBoZWlnaHQ7CgkgICAgICAgIHRoaXMucm93U2l6ZSA9IHJvd1NpemU7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGhlaWdodCB8fCBudWxsID09PSBoZWlnaHQpIHsKCSAgICAgICAgICAgIGhlaWdodCA9IHdpZHRoOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgICAgICBpZiAod2lkdGggPCAxIHx8IGhlaWdodCA8IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0JvdGggZGltZW5zaW9ucyBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAwJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gcm93U2l6ZSB8fCBudWxsID09PSByb3dTaXplKSB7CgkgICAgICAgICAgICByb3dTaXplID0gTWF0aC5mbG9vcigod2lkdGggKyAzMSkgLyAzMik7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yb3dTaXplID0gcm93U2l6ZTsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gYml0cyB8fCBudWxsID09PSBiaXRzKSB7CgkgICAgICAgICAgICB0aGlzLmJpdHMgPSBuZXcgSW50MzJBcnJheSh0aGlzLnJvd1NpemUgKiB0aGlzLmhlaWdodCk7CgkgICAgICAgIH0KCSAgICB9CgkgICAgLyoqCgkgICAgICogSW50ZXJwcmV0cyBhIDJEIGFycmF5IG9mIGJvb2xlYW5zIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0sIHdoZXJlICJ0cnVlIiBtZWFucyBhbiAib24iIGJpdC4KCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBpbWFnZSBiaXRzIG9mIHRoZSBpbWFnZSwgYXMgYSByb3ctbWFqb3IgMkQgYXJyYXkuIEVsZW1lbnRzIGFyZSBhcnJheXMgcmVwcmVzZW50aW5nIHJvd3MKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCaXRNYXRyaXh9IHJlcHJlc2VudGF0aW9uIG9mIGltYWdlCgkgICAgICovCgkgICAgQml0TWF0cml4LnBhcnNlRnJvbUJvb2xlYW5BcnJheSA9IGZ1bmN0aW9uIChpbWFnZSkgewoJICAgICAgICB2YXIgaGVpZ2h0ID0gaW1hZ2UubGVuZ3RoOwoJICAgICAgICB2YXIgd2lkdGggPSBpbWFnZVswXS5sZW5ndGg7CgkgICAgICAgIHZhciBiaXRzID0gbmV3IEJpdE1hdHJpeCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBoZWlnaHQ7IGkrKykgewoJICAgICAgICAgICAgdmFyIGltYWdlSSA9IGltYWdlW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB3aWR0aDsgaisrKSB7CgkgICAgICAgICAgICAgICAgaWYgKGltYWdlSVtqXSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldChqLCBpKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKgoJICAgICAqIEBmdW5jdGlvbiBwYXJzZQoJICAgICAqIEBwYXJhbSBzdHJpbmdSZXByZXNlbnRhdGlvbgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcKCSAgICAgKiBAcGFyYW0gdW5zZXRTdHJpbmcKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucGFyc2VGcm9tU3RyaW5nID0gZnVuY3Rpb24gKHN0cmluZ1JlcHJlc2VudGF0aW9uLCBzZXRTdHJpbmcsIHVuc2V0U3RyaW5nKSB7CgkgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnc3RyaW5nUmVwcmVzZW50YXRpb24gY2Fubm90IGJlIG51bGwnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBBcnJheShzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpOwoJICAgICAgICB2YXIgYml0c1BvcyA9IDA7CgkgICAgICAgIHZhciByb3dTdGFydFBvcyA9IDA7CgkgICAgICAgIHZhciByb3dMZW5ndGggPSAtMTsKCSAgICAgICAgdmFyIG5Sb3dzID0gMDsKCSAgICAgICAgdmFyIHBvcyA9IDA7CgkgICAgICAgIHdoaWxlIChwb3MgPCBzdHJpbmdSZXByZXNlbnRhdGlvbi5sZW5ndGgpIHsKCSAgICAgICAgICAgIGlmIChzdHJpbmdSZXByZXNlbnRhdGlvbi5jaGFyQXQocG9zKSA9PT0gJ1xuJyB8fAoJICAgICAgICAgICAgICAgIHN0cmluZ1JlcHJlc2VudGF0aW9uLmNoYXJBdChwb3MpID09PSAnXHInKSB7CgkgICAgICAgICAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgICAgICAgICBpZiAocm93TGVuZ3RoID09PSAtMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcm93TGVuZ3RoID0gYml0c1BvcyAtIHJvd1N0YXJ0UG9zOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGJpdHNQb3MgLSByb3dTdGFydFBvcyAhPT0gcm93TGVuZ3RoKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdyb3cgbGVuZ3RocyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICByb3dTdGFydFBvcyA9IGJpdHNQb3M7CgkgICAgICAgICAgICAgICAgICAgIG5Sb3dzKys7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHBvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoc3RyaW5nUmVwcmVzZW50YXRpb24uc3Vic3RyaW5nKHBvcywgcG9zICsgc2V0U3RyaW5nLmxlbmd0aCkgPT09IHNldFN0cmluZykgewoJICAgICAgICAgICAgICAgIHBvcyArPSBzZXRTdHJpbmcubGVuZ3RoOwoJICAgICAgICAgICAgICAgIGJpdHNbYml0c1Bvc10gPSB0cnVlOwoJICAgICAgICAgICAgICAgIGJpdHNQb3MrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHN0cmluZ1JlcHJlc2VudGF0aW9uLnN1YnN0cmluZyhwb3MsIHBvcyArIHVuc2V0U3RyaW5nLmxlbmd0aCkgPT09IHVuc2V0U3RyaW5nKSB7CgkgICAgICAgICAgICAgICAgcG9zICs9IHVuc2V0U3RyaW5nLmxlbmd0aDsKCSAgICAgICAgICAgICAgICBiaXRzW2JpdHNQb3NdID0gZmFsc2U7CgkgICAgICAgICAgICAgICAgYml0c1BvcysrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnaWxsZWdhbCBjaGFyYWN0ZXIgZW5jb3VudGVyZWQ6ICcgKyBzdHJpbmdSZXByZXNlbnRhdGlvbi5zdWJzdHJpbmcocG9zKSk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gbm8gRU9MIGF0IGVuZD8KCSAgICAgICAgaWYgKGJpdHNQb3MgPiByb3dTdGFydFBvcykgewoJICAgICAgICAgICAgaWYgKHJvd0xlbmd0aCA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICByb3dMZW5ndGggPSBiaXRzUG9zIC0gcm93U3RhcnRQb3M7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmIChiaXRzUG9zIC0gcm93U3RhcnRQb3MgIT09IHJvd0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ3JvdyBsZW5ndGhzIGRvIG5vdCBtYXRjaCcpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgblJvd3MrKzsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbWF0cml4ID0gbmV3IEJpdE1hdHJpeChyb3dMZW5ndGgsIG5Sb3dzKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBiaXRzUG9zOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChiaXRzW2ldKSB7CgkgICAgICAgICAgICAgICAgbWF0cml4LnNldChNYXRoLmZsb29yKGkgJSByb3dMZW5ndGgpLCBNYXRoLmZsb29yKGkgLyByb3dMZW5ndGgpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbWF0cml4OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+R2V0cyB0aGUgcmVxdWVzdGVkIGJpdCwgd2hlcmUgdHJ1ZSBtZWFucyBibGFjay48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0geCBUaGUgaG9yaXpvbnRhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggY29sdW1uKQoJICAgICAqIEBwYXJhbSB5IFRoZSB2ZXJ0aWNhbCBjb21wb25lbnQgKGkuZS4gd2hpY2ggcm93KQoJICAgICAqIEByZXR1cm4gdmFsdWUgb2YgZ2l2ZW4gYml0IGluIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHggLyppbnQqLywgeSAvKmludCovKSB7CgkgICAgICAgIHZhciBvZmZzZXQgPSB5ICogdGhpcy5yb3dTaXplICsgTWF0aC5mbG9vcih4IC8gMzIpOwoJICAgICAgICByZXR1cm4gKCh0aGlzLmJpdHNbb2Zmc2V0XSA+Pj4gKHggJiAweDFmKSkgJiAxKSAhPT0gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgdGhlIGdpdmVuIGJpdCB0byB0cnVlLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB4IFRoZSBob3Jpem9udGFsIGNvbXBvbmVudCAoaS5lLiB3aGljaCBjb2x1bW4pCgkgICAgICogQHBhcmFtIHkgVGhlIHZlcnRpY2FsIGNvbXBvbmVudCAoaS5lLiB3aGljaCByb3cpCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIHw9ICgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRjsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdICY9IH4oKDEgPDwgKHggJiAweDFmKSkgJiAweEZGRkZGRkZGKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkZsaXBzIHRoZSBnaXZlbiBiaXQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHggVGhlIGhvcml6b250YWwgY29tcG9uZW50IChpLmUuIHdoaWNoIGNvbHVtbikKCSAgICAgKiBAcGFyYW0geSBUaGUgdmVydGljYWwgY29tcG9uZW50IChpLmUuIHdoaWNoIHJvdykKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmZsaXAgPSBmdW5jdGlvbiAoeCAvKmludCovLCB5IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiB0aGlzLnJvd1NpemUgKyBNYXRoLmZsb29yKHggLyAzMik7CgkgICAgICAgIHRoaXMuYml0c1tvZmZzZXRdIF49ICgoMSA8PCAoeCAmIDB4MWYpKSAmIDB4RkZGRkZGRkYpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRXhjbHVzaXZlLW9yIChYT1IpOiBGbGlwIHRoZSBiaXQgaW4gdGhpcyB7QGNvZGUgQml0TWF0cml4fSBpZiB0aGUgY29ycmVzcG9uZGluZwoJICAgICAqIG1hc2sgYml0IGlzIHNldC4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBtYXNrIFhPUiBtYXNrCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS54b3IgPSBmdW5jdGlvbiAobWFzaykgewoJICAgICAgICBpZiAodGhpcy53aWR0aCAhPT0gbWFzay5nZXRXaWR0aCgpIHx8IHRoaXMuaGVpZ2h0ICE9PSBtYXNrLmdldEhlaWdodCgpCgkgICAgICAgICAgICB8fCB0aGlzLnJvd1NpemUgIT09IG1hc2suZ2V0Um93U2l6ZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdpbnB1dCBtYXRyaXggZGltZW5zaW9ucyBkbyBub3QgbWF0Y2gnKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcm93QXJyYXkgPSBuZXcgQml0QXJyYXlfMSQxLmRlZmF1bHQoTWF0aC5mbG9vcih0aGlzLndpZHRoIC8gMzIpICsgMSk7CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIHZhciBvZmZzZXQgPSB5ICogcm93U2l6ZTsKCSAgICAgICAgICAgIHZhciByb3cgPSBtYXNrLmdldFJvdyh5LCByb3dBcnJheSkuZ2V0Qml0QXJyYXkoKTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgcm93U2l6ZTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgYml0c1tvZmZzZXQgKyB4XSBePSByb3dbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIENsZWFycyBhbGwgYml0cyAoc2V0cyB0byBmYWxzZSkuCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5jbGVhciA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBtYXggPSBiaXRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkrKykgewoJICAgICAgICAgICAgYml0c1tpXSA9IDA7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlNldHMgYSBzcXVhcmUgcmVnaW9uIG9mIHRoZSBiaXQgbWF0cml4IHRvIHRydWUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGxlZnQgVGhlIGhvcml6b250YWwgcG9zaXRpb24gdG8gYmVnaW4gYXQgKGluY2x1c2l2ZSkKCSAgICAgKiBAcGFyYW0gdG9wIFRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiB0byBiZWdpbiBhdCAoaW5jbHVzaXZlKQoJICAgICAqIEBwYXJhbSB3aWR0aCBUaGUgd2lkdGggb2YgdGhlIHJlZ2lvbgoJICAgICAqIEBwYXJhbSBoZWlnaHQgVGhlIGhlaWdodCBvZiB0aGUgcmVnaW9uCgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5zZXRSZWdpb24gPSBmdW5jdGlvbiAobGVmdCAvKmludCovLCB0b3AgLyppbnQqLywgd2lkdGggLyppbnQqLywgaGVpZ2h0IC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHRvcCA8IDAgfHwgbGVmdCA8IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ3LmRlZmF1bHQoJ0xlZnQgYW5kIHRvcCBtdXN0IGJlIG5vbm5lZ2F0aXZlJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGhlaWdodCA8IDEgfHwgd2lkdGggPCAxKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNy5kZWZhdWx0KCdIZWlnaHQgYW5kIHdpZHRoIG11c3QgYmUgYXQgbGVhc3QgMScpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByaWdodCA9IGxlZnQgKyB3aWR0aDsKCSAgICAgICAgdmFyIGJvdHRvbSA9IHRvcCArIGhlaWdodDsKCSAgICAgICAgaWYgKGJvdHRvbSA+IHRoaXMuaGVpZ2h0IHx8IHJpZ2h0ID4gdGhpcy53aWR0aCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDcuZGVmYXVsdCgnVGhlIHJlZ2lvbiBtdXN0IGZpdCBpbnNpZGUgdGhlIG1hdHJpeCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgZm9yICh2YXIgeSA9IHRvcDsgeSA8IGJvdHRvbTsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHJvd1NpemU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gbGVmdDsgeCA8IHJpZ2h0OyB4KyspIHsKCSAgICAgICAgICAgICAgICBiaXRzW29mZnNldCArIE1hdGguZmxvb3IoeCAvIDMyKV0gfD0gKCgxIDw8ICh4ICYgMHgxZikpICYgMHhGRkZGRkZGRik7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEEgZmFzdCBtZXRob2QgdG8gcmV0cmlldmUgb25lIHJvdyBvZiBkYXRhIGZyb20gdGhlIG1hdHJpeCBhcyBhIEJpdEFycmF5LgoJICAgICAqCgkgICAgICogQHBhcmFtIHkgVGhlIHJvdyB0byByZXRyaWV2ZQoJICAgICAqIEBwYXJhbSByb3cgQW4gb3B0aW9uYWwgY2FsbGVyLWFsbG9jYXRlZCBCaXRBcnJheSwgd2lsbCBiZSBhbGxvY2F0ZWQgaWYgbnVsbCBvciB0b28gc21hbGwKCSAgICAgKiBAcmV0dXJuIFRoZSByZXN1bHRpbmcgQml0QXJyYXkgLSB0aGlzIHJlZmVyZW5jZSBzaG91bGQgYWx3YXlzIGJlIHVzZWQgZXZlbiB3aGVuIHBhc3NpbmcKCSAgICAgKiAgICAgICAgIHlvdXIgb3duIHJvdwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Um93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIGlmIChyb3cgPT09IG51bGwgfHwgcm93ID09PSB1bmRlZmluZWQgfHwgcm93LmdldFNpemUoKSA8IHRoaXMud2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh0aGlzLndpZHRoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHJvdy5jbGVhcigpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByb3dTaXplID0gdGhpcy5yb3dTaXplOwoJICAgICAgICB2YXIgYml0cyA9IHRoaXMuYml0czsKCSAgICAgICAgdmFyIG9mZnNldCA9IHkgKiByb3dTaXplOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHJvd1NpemU7IHgrKykgewoJICAgICAgICAgICAgcm93LnNldEJ1bGsoeCAqIDMyLCBiaXRzW29mZnNldCArIHhdKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIHkgcm93IHRvIHNldAoJICAgICAqIEBwYXJhbSByb3cge0BsaW5rIEJpdEFycmF5fSB0byBjb3B5IGZyb20KCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLnNldFJvdyA9IGZ1bmN0aW9uICh5IC8qaW50Ki8sIHJvdykgewoJICAgICAgICBTeXN0ZW1fMSQzLmRlZmF1bHQuYXJyYXljb3B5KHJvdy5nZXRCaXRBcnJheSgpLCAwLCB0aGlzLmJpdHMsIHkgKiB0aGlzLnJvd1NpemUsIHRoaXMucm93U2l6ZSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBNb2RpZmllcyB0aGlzIHtAY29kZSBCaXRNYXRyaXh9IHRvIHJlcHJlc2VudCB0aGUgc2FtZSBidXQgcm90YXRlZCAxODAgZGVncmVlcwoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUucm90YXRlMTgwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgdG9wUm93ID0gbmV3IEJpdEFycmF5XzEkMS5kZWZhdWx0KHdpZHRoKTsKCSAgICAgICAgdmFyIGJvdHRvbVJvdyA9IG5ldyBCaXRBcnJheV8xJDEuZGVmYXVsdCh3aWR0aCk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IE1hdGguZmxvb3IoKGhlaWdodCArIDEpIC8gMik7IGkgPCBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB0b3BSb3cgPSB0aGlzLmdldFJvdyhpLCB0b3BSb3cpOwoJICAgICAgICAgICAgYm90dG9tUm93ID0gdGhpcy5nZXRSb3coaGVpZ2h0IC0gMSAtIGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0b3BSb3cucmV2ZXJzZSgpOwoJICAgICAgICAgICAgYm90dG9tUm93LnJldmVyc2UoKTsKCSAgICAgICAgICAgIHRoaXMuc2V0Um93KGksIGJvdHRvbVJvdyk7CgkgICAgICAgICAgICB0aGlzLnNldFJvdyhoZWlnaHQgLSAxIC0gaSwgdG9wUm93KTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIHRoZSBlbmNsb3NpbmcgcmVjdGFuZ2xlIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSBsZWZ0LHRvcCx3aWR0aCxoZWlnaHR9IGVuY2xvc2luZyByZWN0YW5nbGUgb2YgYWxsIDEgYml0cywgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldEVuY2xvc2luZ1JlY3RhbmdsZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIGhlaWdodCA9IHRoaXMuaGVpZ2h0OwoJICAgICAgICB2YXIgcm93U2l6ZSA9IHRoaXMucm93U2l6ZTsKCSAgICAgICAgdmFyIGJpdHMgPSB0aGlzLmJpdHM7CgkgICAgICAgIHZhciBsZWZ0ID0gd2lkdGg7CgkgICAgICAgIHZhciB0b3AgPSBoZWlnaHQ7CgkgICAgICAgIHZhciByaWdodCA9IC0xOwoJICAgICAgICB2YXIgYm90dG9tID0gLTE7CgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHgzMiA9IDA7IHgzMiA8IHJvd1NpemU7IHgzMisrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHRoZUJpdHMgPSBiaXRzW3kgKiByb3dTaXplICsgeDMyXTsKCSAgICAgICAgICAgICAgICBpZiAodGhlQml0cyAhPT0gMCkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA8IHRvcCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdG9wID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeSA+IGJvdHRvbSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgYm90dG9tID0geTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBpZiAoeDMyICogMzIgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYml0ID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdCsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPCBsZWZ0KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGVmdCA9IHgzMiAqIDMyICsgYml0OwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGlmICh4MzIgKiAzMiArIDMxID4gcmlnaHQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaXQgPSAzMTsKCSAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlICgodGhlQml0cyA+Pj4gYml0KSA9PT0gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh4MzIgKiAzMiArIGJpdCkgPiByaWdodCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0ID0geDMyICogMzIgKyBiaXQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJpZ2h0IDwgbGVmdCB8fCBib3R0b20gPCB0b3ApIHsKCSAgICAgICAgICAgIHJldHVybiBudWxsOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2xlZnQsIHRvcCwgcmlnaHQgLSBsZWZ0ICsgMSwgYm90dG9tIC0gdG9wICsgMV0pOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogVGhpcyBpcyB1c2VmdWwgaW4gZGV0ZWN0aW5nIGEgY29ybmVyIG9mIGEgJ3B1cmUnIGJhcmNvZGUuCgkgICAgICoKCSAgICAgKiBAcmV0dXJuIHtAY29kZSB4LHl9IGNvb3JkaW5hdGUgb2YgdG9wLWxlZnQtbW9zdCAxIGJpdCwgb3IgbnVsbCBpZiBpdCBpcyBhbGwgd2hpdGUKCSAgICAgKi8KCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmdldFRvcExlZnRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IDA7CgkgICAgICAgIHdoaWxlIChiaXRzT2Zmc2V0IDwgYml0cy5sZW5ndGggJiYgYml0c1tiaXRzT2Zmc2V0XSA9PT0gMCkgewoJICAgICAgICAgICAgYml0c09mZnNldCsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChiaXRzT2Zmc2V0ID09PSBiaXRzLmxlbmd0aCkgewoJICAgICAgICAgICAgcmV0dXJuIG51bGw7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHkgPSBiaXRzT2Zmc2V0IC8gcm93U2l6ZTsKCSAgICAgICAgdmFyIHggPSAoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDA7CgkgICAgICAgIHdoaWxlICgoKHRoZUJpdHMgPDwgKDMxIC0gYml0KSkgJiAweEZGRkZGRkZGKSA9PT0gMCkgewoJICAgICAgICAgICAgYml0Kys7CgkgICAgICAgIH0KCSAgICAgICAgeCArPSBiaXQ7CgkgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW3gsIHldKTsKCSAgICB9OwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0Qm90dG9tUmlnaHRPbkJpdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJvd1NpemUgPSB0aGlzLnJvd1NpemU7CgkgICAgICAgIHZhciBiaXRzID0gdGhpcy5iaXRzOwoJICAgICAgICB2YXIgYml0c09mZnNldCA9IGJpdHMubGVuZ3RoIC0gMTsKCSAgICAgICAgd2hpbGUgKGJpdHNPZmZzZXQgPj0gMCAmJiBiaXRzW2JpdHNPZmZzZXRdID09PSAwKSB7CgkgICAgICAgICAgICBiaXRzT2Zmc2V0LS07CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJpdHNPZmZzZXQgPCAwKSB7CgkgICAgICAgICAgICByZXR1cm4gbnVsbDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IoYml0c09mZnNldCAvIHJvd1NpemUpOwoJICAgICAgICB2YXIgeCA9IE1hdGguZmxvb3IoYml0c09mZnNldCAlIHJvd1NpemUpICogMzI7CgkgICAgICAgIHZhciB0aGVCaXRzID0gYml0c1tiaXRzT2Zmc2V0XTsKCSAgICAgICAgdmFyIGJpdCA9IDMxOwoJICAgICAgICB3aGlsZSAoKHRoZUJpdHMgPj4+IGJpdCkgPT09IDApIHsKCSAgICAgICAgICAgIGJpdC0tOwoJICAgICAgICB9CgkgICAgICAgIHggKz0gYml0OwoJICAgICAgICByZXR1cm4gSW50MzJBcnJheS5mcm9tKFt4LCB5XSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRXaWR0aCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMud2lkdGg7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSBoZWlnaHQgb2YgdGhlIG1hdHJpeAoJICAgICAqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZ2V0SGVpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5oZWlnaHQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSByb3cgc2l6ZSBvZiB0aGUgbWF0cml4CgkgICAgICovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5nZXRSb3dTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yb3dTaXplOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuZXF1YWxzID0gZnVuY3Rpb24gKG8pIHsKCSAgICAgICAgaWYgKCEobyBpbnN0YW5jZW9mIEJpdE1hdHJpeCkpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy53aWR0aCA9PT0gb3RoZXIud2lkdGggJiYgdGhpcy5oZWlnaHQgPT09IG90aGVyLmhlaWdodCAmJiB0aGlzLnJvd1NpemUgPT09IG90aGVyLnJvd1NpemUgJiYKCSAgICAgICAgICAgIEFycmF5c18xLmRlZmF1bHQuZXF1YWxzKHRoaXMuYml0cywgb3RoZXIuYml0cyk7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGhhc2ggPSB0aGlzLndpZHRoOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy53aWR0aDsKCSAgICAgICAgaGFzaCA9IDMxICogaGFzaCArIHRoaXMuaGVpZ2h0OwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgdGhpcy5yb3dTaXplOwoJICAgICAgICBoYXNoID0gMzEgKiBoYXNoICsgQXJyYXlzXzEuZGVmYXVsdC5oYXNoQ29kZSh0aGlzLmJpdHMpOwoJICAgICAgICByZXR1cm4gaGFzaDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIHVzaW5nICJYIiBmb3Igc2V0IGFuZCAiICIgZm9yIHVuc2V0IGJpdHMKCSAgICAgKi8KCSAgICAvKkBPdmVycmlkZSovCgkgICAgLy8gcHVibGljIHRvU3RyaW5nKCk6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdG9TdHJpbmcoIjogIlgsICIgICIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgdG9TdHJpbmcoc2V0U3RyaW5nOiBzdHJpbmcgPSAiWCAiLCB1bnNldFN0cmluZzogc3RyaW5nID0gIiAgIik6IHN0cmluZyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5idWlsZFRvU3RyaW5nKHNldFN0cmluZywgdW5zZXRTdHJpbmcsICJcbiIpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBzZXRTdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgYSBzZXQgYml0CgkgICAgICogQHBhcmFtIHVuc2V0U3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGFuIHVuc2V0IGJpdAoJICAgICAqIEBwYXJhbSBsaW5lU2VwYXJhdG9yIG5ld2xpbmUgY2hhcmFjdGVyIGluIHN0cmluZyByZXByZXNlbnRhdGlvbgoJICAgICAqIEByZXR1cm4gc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIGVudGlyZSBtYXRyaXggdXRpbGl6aW5nIGdpdmVuIHN0cmluZ3MgYW5kIGxpbmUgc2VwYXJhdG9yCgkgICAgICogQGRlcHJlY2F0ZWQgY2FsbCB7QGxpbmsgI3RvU3RyaW5nKFN0cmluZyxTdHJpbmcpfSBvbmx5LCB3aGljaCB1c2VzIFxuIGxpbmUgc2VwYXJhdG9yIGFsd2F5cwoJICAgICAqLwoJICAgIC8vIEBEZXByZWNhdGVkCgkgICAgQml0TWF0cml4LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIChzZXRTdHJpbmcsIHVuc2V0U3RyaW5nLCBsaW5lU2VwYXJhdG9yKSB7CgkgICAgICAgIGlmIChzZXRTdHJpbmcgPT09IHZvaWQgMCkgeyBzZXRTdHJpbmcgPSAnWCAnOyB9CgkgICAgICAgIGlmICh1bnNldFN0cmluZyA9PT0gdm9pZCAwKSB7IHVuc2V0U3RyaW5nID0gJyAgJzsgfQoJICAgICAgICBpZiAobGluZVNlcGFyYXRvciA9PT0gdm9pZCAwKSB7IGxpbmVTZXBhcmF0b3IgPSAnXG4nOyB9CgkgICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVG9TdHJpbmcoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcik7CgkgICAgfTsKCSAgICBCaXRNYXRyaXgucHJvdG90eXBlLmJ1aWxkVG9TdHJpbmcgPSBmdW5jdGlvbiAoc2V0U3RyaW5nLCB1bnNldFN0cmluZywgbGluZVNlcGFyYXRvcikgewoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgLy8gcmVzdWx0LmFwcGVuZChsaW5lU2VwYXJhdG9yKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDAsIGhlaWdodCA9IHRoaXMuaGVpZ2h0OyB5IDwgaGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IHRoaXMud2lkdGg7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCh0aGlzLmdldCh4LCB5KSA/IHNldFN0cmluZyA6IHVuc2V0U3RyaW5nKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQobGluZVNlcGFyYXRvcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdC50b1N0cmluZygpOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEJpdE1hdHJpeC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgQml0TWF0cml4KHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0LCB0aGlzLnJvd1NpemUsIHRoaXMuYml0cy5zbGljZSgpKTsKCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXg7Cgl9KCkpOwoJQml0TWF0cml4JDEuZGVmYXVsdCA9IEJpdE1hdHJpeDsKCgl2YXIgTm90Rm91bmRFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkZCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShOb3RGb3VuZEV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBOb3RGb3VuZEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkZChOb3RGb3VuZEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBOb3RGb3VuZEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5nZXROb3RGb3VuZEluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IE5vdEZvdW5kRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBOb3RGb3VuZEV4Y2VwdGlvbi5raW5kID0gJ05vdEZvdW5kRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gTm90Rm91bmRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCkpOwoJTm90Rm91bmRFeGNlcHRpb24kMS5kZWZhdWx0ID0gTm90Rm91bmRFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYyA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24geyovCgl2YXIgQmluYXJpemVyXzEgPSBCaW5hcml6ZXIkMTsKCXZhciBCaXRBcnJheV8xID0gQml0QXJyYXkkMTsKCXZhciBCaXRNYXRyaXhfMSQ1ID0gQml0TWF0cml4JDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQ2ID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qKgoJICogVGhpcyBCaW5hcml6ZXIgaW1wbGVtZW50YXRpb24gdXNlcyB0aGUgb2xkIFpYaW5nIGdsb2JhbCBoaXN0b2dyYW0gYXBwcm9hY2guIEl0IGlzIHN1aXRhYmxlCgkgKiBmb3IgbG93LWVuZCBtb2JpbGUgZGV2aWNlcyB3aGljaCBkb24ndCBoYXZlIGVub3VnaCBDUFUgb3IgbWVtb3J5IHRvIHVzZSBhIGxvY2FsIHRocmVzaG9sZGluZwoJICogYWxnb3JpdGhtLiBIb3dldmVyLCBiZWNhdXNlIGl0IHBpY2tzIGEgZ2xvYmFsIGJsYWNrIHBvaW50LCBpdCBjYW5ub3QgaGFuZGxlIGRpZmZpY3VsdCBzaGFkb3dzCgkgKiBhbmQgZ3JhZGllbnRzLgoJICoKCSAqIEZhc3RlciBtb2JpbGUgZGV2aWNlcyBhbmQgYWxsIGRlc2t0b3AgYXBwbGljYXRpb25zIHNob3VsZCBwcm9iYWJseSB1c2UgSHlicmlkQmluYXJpemVyIGluc3RlYWQuCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGMoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5sdW1pbmFuY2VzID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkVNUFRZOwoJICAgICAgICBfdGhpcy5idWNrZXRzID0gbmV3IEludDMyQXJyYXkoR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CVUNLRVRTKTsKCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvLyBBcHBsaWVzIHNpbXBsZSBzaGFycGVuaW5nIHRvIHRoZSByb3cgZGF0YSB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIG9mIHRoZSAxRCBSZWFkZXJzLgoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmdldEJsYWNrUm93ID0gZnVuY3Rpb24gKHkgLyppbnQqLywgcm93KSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gdW5kZWZpbmVkIHx8IHJvdyA9PT0gbnVsbCB8fCByb3cuZ2V0U2l6ZSgpIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBCaXRBcnJheV8xLmRlZmF1bHQod2lkdGgpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgcm93LmNsZWFyKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5pbml0QXJyYXlzKHdpZHRoKTsKCSAgICAgICAgdmFyIGxvY2FsTHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRSb3coeSwgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgdmFyIGxvY2FsQnVja2V0cyA9IHRoaXMuYnVja2V0czsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICBsb2NhbEJ1Y2tldHNbKGxvY2FsTHVtaW5hbmNlc1t4XSAmIDB4ZmYpID4+IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfU0hJRlRdKys7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGJsYWNrUG9pbnQgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuZXN0aW1hdGVCbGFja1BvaW50KGxvY2FsQnVja2V0cyk7CgkgICAgICAgIGlmICh3aWR0aCA8IDMpIHsKCSAgICAgICAgICAgIC8vIFNwZWNpYWwgY2FzZSBmb3IgdmVyeSBzbWFsbCBpbWFnZXMKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgICAgIGlmICgobG9jYWxMdW1pbmFuY2VzW3hdICYgMHhmZikgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIHJvdy5zZXQoeCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGxlZnQgPSBsb2NhbEx1bWluYW5jZXNbMF0gJiAweGZmOwoJICAgICAgICAgICAgdmFyIGNlbnRlciA9IGxvY2FsTHVtaW5hbmNlc1sxXSAmIDB4ZmY7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMTsgeCA8IHdpZHRoIC0gMTsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHJpZ2h0ID0gbG9jYWxMdW1pbmFuY2VzW3ggKyAxXSAmIDB4ZmY7CgkgICAgICAgICAgICAgICAgLy8gQSBzaW1wbGUgLTEgNCAtMSBib3ggZmlsdGVyIHdpdGggYSB3ZWlnaHQgb2YgMi4KCSAgICAgICAgICAgICAgICBpZiAoKChjZW50ZXIgKiA0KSAtIGxlZnQgLSByaWdodCkgLyAyIDwgYmxhY2tQb2ludCkgewoJICAgICAgICAgICAgICAgICAgICByb3cuc2V0KHgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBsZWZ0ID0gY2VudGVyOwoJICAgICAgICAgICAgICAgIGNlbnRlciA9IHJpZ2h0OwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByb3c7CgkgICAgfTsKCSAgICAvLyBEb2VzIG5vdCBzaGFycGVuIHRoZSBkYXRhLCBhcyB0aGlzIGNhbGwgaXMgaW50ZW5kZWQgdG8gb25seSBiZSB1c2VkIGJ5IDJEIFJlYWRlcnMuCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIG1hdHJpeCA9IG5ldyBCaXRNYXRyaXhfMSQ1LmRlZmF1bHQod2lkdGgsIGhlaWdodCk7CgkgICAgICAgIC8vIFF1aWNrbHkgY2FsY3VsYXRlcyB0aGUgaGlzdG9ncmFtIGJ5IHNhbXBsaW5nIGZvdXIgcm93cyBmcm9tIHRoZSBpbWFnZS4gVGhpcyBwcm92ZWQgdG8gYmUKCSAgICAgICAgLy8gbW9yZSByb2J1c3Qgb24gdGhlIGJsYWNrYm94IHRlc3RzIHRoYW4gc2FtcGxpbmcgYSBkaWFnb25hbCBhcyB3ZSB1c2VkIHRvIGRvLgoJICAgICAgICB0aGlzLmluaXRBcnJheXMod2lkdGgpOwoJICAgICAgICB2YXIgbG9jYWxCdWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB5ID0gMTsgeSA8IDU7IHkrKykgewoJICAgICAgICAgICAgdmFyIHJvdyA9IE1hdGguZmxvb3IoKGhlaWdodCAqIHkpIC8gNSk7CgkgICAgICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzXzEgPSBzb3VyY2UuZ2V0Um93KHJvdywgdGhpcy5sdW1pbmFuY2VzKTsKCSAgICAgICAgICAgIHZhciByaWdodCA9IE1hdGguZmxvb3IoKHdpZHRoICogNCkgLyA1KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSBNYXRoLmZsb29yKHdpZHRoIC8gNSk7IHggPCByaWdodDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzXzFbeF0gJiAweGZmOwoJICAgICAgICAgICAgICAgIGxvY2FsQnVja2V0c1twaXhlbCA+PiBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUXSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBibGFja1BvaW50ID0gR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludChsb2NhbEJ1Y2tldHMpOwoJICAgICAgICAvLyBXZSBkZWxheSByZWFkaW5nIHRoZSBlbnRpcmUgaW1hZ2UgbHVtaW5hbmNlIHVudGlsIHRoZSBibGFjayBwb2ludCBlc3RpbWF0aW9uIHN1Y2NlZWRzLgoJICAgICAgICAvLyBBbHRob3VnaCB3ZSBlbmQgdXAgcmVhZGluZyBmb3VyIHJvd3MgdHdpY2UsIGl0IGlzIGNvbnNpc3RlbnQgd2l0aCBvdXIgbW90dG8gb2YKCSAgICAgICAgLy8gImZhaWwgcXVpY2tseSIgd2hpY2ggaXMgbmVjZXNzYXJ5IGZvciBjb250aW51b3VzIHNjYW5uaW5nLgoJICAgICAgICB2YXIgbG9jYWxMdW1pbmFuY2VzID0gc291cmNlLmdldE1hdHJpeCgpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBpeGVsID0gbG9jYWxMdW1pbmFuY2VzW29mZnNldCArIHhdICYgMHhmZjsKCSAgICAgICAgICAgICAgICBpZiAocGl4ZWwgPCBibGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgIG1hdHJpeC5zZXQoeCwgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBtYXRyaXg7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLnByb3RvdHlwZS5jcmVhdGVCaW5hcml6ZXIgPSBmdW5jdGlvbiAoc291cmNlKSB7CgkgICAgICAgIHJldHVybiBuZXcgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyKHNvdXJjZSk7CgkgICAgfTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIucHJvdG90eXBlLmluaXRBcnJheXMgPSBmdW5jdGlvbiAobHVtaW5hbmNlU2l6ZSAvKmludCovKSB7CgkgICAgICAgIGlmICh0aGlzLmx1bWluYW5jZXMubGVuZ3RoIDwgbHVtaW5hbmNlU2l6ZSkgewoJICAgICAgICAgICAgdGhpcy5sdW1pbmFuY2VzID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KGx1bWluYW5jZVNpemUpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBidWNrZXRzID0gdGhpcy5idWNrZXRzOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQlVDS0VUUzsgeCsrKSB7CgkgICAgICAgICAgICBidWNrZXRzW3hdID0gMDsKCSAgICAgICAgfQoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLmVzdGltYXRlQmxhY2tQb2ludCA9IGZ1bmN0aW9uIChidWNrZXRzKSB7CgkgICAgICAgIC8vIEZpbmQgdGhlIHRhbGxlc3QgcGVhayBpbiB0aGUgaGlzdG9ncmFtLgoJICAgICAgICB2YXIgbnVtQnVja2V0cyA9IGJ1Y2tldHMubGVuZ3RoOwoJICAgICAgICB2YXIgbWF4QnVja2V0Q291bnQgPSAwOwoJICAgICAgICB2YXIgZmlyc3RQZWFrID0gMDsKCSAgICAgICAgdmFyIGZpcnN0UGVha1NpemUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgaWYgKGJ1Y2tldHNbeF0gPiBmaXJzdFBlYWtTaXplKSB7CgkgICAgICAgICAgICAgICAgZmlyc3RQZWFrID0geDsKCSAgICAgICAgICAgICAgICBmaXJzdFBlYWtTaXplID0gYnVja2V0c1t4XTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChidWNrZXRzW3hdID4gbWF4QnVja2V0Q291bnQpIHsKCSAgICAgICAgICAgICAgICBtYXhCdWNrZXRDb3VudCA9IGJ1Y2tldHNbeF07CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCB0aGUgc2Vjb25kLXRhbGxlc3QgcGVhayB3aGljaCBpcyBzb21ld2hhdCBmYXIgZnJvbSB0aGUgdGFsbGVzdCBwZWFrLgoJICAgICAgICB2YXIgc2Vjb25kUGVhayA9IDA7CgkgICAgICAgIHZhciBzZWNvbmRQZWFrU2NvcmUgPSAwOwoJICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG51bUJ1Y2tldHM7IHgrKykgewoJICAgICAgICAgICAgdmFyIGRpc3RhbmNlVG9CaWdnZXN0ID0geCAtIGZpcnN0UGVhazsKCSAgICAgICAgICAgIC8vIEVuY291cmFnZSBtb3JlIGRpc3RhbnQgc2Vjb25kIHBlYWtzIGJ5IG11bHRpcGx5aW5nIGJ5IHNxdWFyZSBvZiBkaXN0YW5jZS4KCSAgICAgICAgICAgIHZhciBzY29yZSA9IGJ1Y2tldHNbeF0gKiBkaXN0YW5jZVRvQmlnZ2VzdCAqIGRpc3RhbmNlVG9CaWdnZXN0OwoJICAgICAgICAgICAgaWYgKHNjb3JlID4gc2Vjb25kUGVha1Njb3JlKSB7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVhayA9IHg7CgkgICAgICAgICAgICAgICAgc2Vjb25kUGVha1Njb3JlID0gc2NvcmU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTWFrZSBzdXJlIGZpcnN0UGVhayBjb3JyZXNwb25kcyB0byB0aGUgYmxhY2sgcGVhay4KCSAgICAgICAgaWYgKGZpcnN0UGVhayA+IHNlY29uZFBlYWspIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZmlyc3RQZWFrOwoJICAgICAgICAgICAgZmlyc3RQZWFrID0gc2Vjb25kUGVhazsKCSAgICAgICAgICAgIHNlY29uZFBlYWsgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHRoZXJlIGlzIHRvbyBsaXR0bGUgY29udHJhc3QgaW4gdGhlIGltYWdlIHRvIHBpY2sgYSBtZWFuaW5nZnVsIGJsYWNrIHBvaW50LCB0aHJvdyByYXRoZXIKCSAgICAgICAgLy8gdGhhbiB3YXN0ZSB0aW1lIHRyeWluZyB0byBkZWNvZGUgdGhlIGltYWdlLCBhbmQgcmlzayBmYWxzZSBwb3NpdGl2ZXMuCgkgICAgICAgIGlmIChzZWNvbmRQZWFrIC0gZmlyc3RQZWFrIDw9IG51bUJ1Y2tldHMgLyAxNikgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRmluZCBhIHZhbGxleSBiZXR3ZWVuIHRoZW0gdGhhdCBpcyBsb3cgYW5kIGNsb3NlciB0byB0aGUgd2hpdGUgcGVhay4KCSAgICAgICAgdmFyIGJlc3RWYWxsZXkgPSBzZWNvbmRQZWFrIC0gMTsKCSAgICAgICAgdmFyIGJlc3RWYWxsZXlTY29yZSA9IC0xOwoJICAgICAgICBmb3IgKHZhciB4ID0gc2Vjb25kUGVhayAtIDE7IHggPiBmaXJzdFBlYWs7IHgtLSkgewoJICAgICAgICAgICAgdmFyIGZyb21GaXJzdCA9IHggLSBmaXJzdFBlYWs7CgkgICAgICAgICAgICB2YXIgc2NvcmUgPSBmcm9tRmlyc3QgKiBmcm9tRmlyc3QgKiAoc2Vjb25kUGVhayAtIHgpICogKG1heEJ1Y2tldENvdW50IC0gYnVja2V0c1t4XSk7CgkgICAgICAgICAgICBpZiAoc2NvcmUgPiBiZXN0VmFsbGV5U2NvcmUpIHsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5ID0geDsKCSAgICAgICAgICAgICAgICBiZXN0VmFsbGV5U2NvcmUgPSBzY29yZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gYmVzdFZhbGxleSA8PCBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUOwoJICAgIH07CgkgICAgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLkxVTUlOQU5DRV9CSVRTID0gNTsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX1NISUZUID0gOCAtIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuTFVNSU5BTkNFX0JVQ0tFVFMgPSAxIDw8IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplci5MVU1JTkFOQ0VfQklUUzsKCSAgICBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIuRU1QVFkgPSBVaW50OENsYW1wZWRBcnJheS5mcm9tKFswXSk7CgkgICAgcmV0dXJuIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCX0oQmluYXJpemVyXzEuZGVmYXVsdCkpOwoJR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyJDEuZGVmYXVsdCA9IEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplcjsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyRiID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEh5YnJpZEJpbmFyaXplciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyXzEgPSBHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXIkMTsKCXZhciBCaXRNYXRyaXhfMSQ0ID0gQml0TWF0cml4JDE7CgkvKioKCSAqIFRoaXMgY2xhc3MgaW1wbGVtZW50cyBhIGxvY2FsIHRocmVzaG9sZGluZyBhbGdvcml0aG0sIHdoaWNoIHdoaWxlIHNsb3dlciB0aGFuIHRoZQoJICogR2xvYmFsSGlzdG9ncmFtQmluYXJpemVyLCBpcyBmYWlybHkgZWZmaWNpZW50IGZvciB3aGF0IGl0IGRvZXMuIEl0IGlzIGRlc2lnbmVkIGZvcgoJICogaGlnaCBmcmVxdWVuY3kgaW1hZ2VzIG9mIGJhcmNvZGVzIHdpdGggYmxhY2sgZGF0YSBvbiB3aGl0ZSBiYWNrZ3JvdW5kcy4gRm9yIHRoaXMgYXBwbGljYXRpb24sCgkgKiBpdCBkb2VzIGEgbXVjaCBiZXR0ZXIgam9iIHRoYW4gYSBnbG9iYWwgYmxhY2twb2ludCB3aXRoIHNldmVyZSBzaGFkb3dzIGFuZCBncmFkaWVudHMuCgkgKiBIb3dldmVyIGl0IHRlbmRzIHRvIHByb2R1Y2UgYXJ0aWZhY3RzIG9uIGxvd2VyIGZyZXF1ZW5jeSBpbWFnZXMgYW5kIGlzIHRoZXJlZm9yZSBub3QKCSAqIGEgZ29vZCBnZW5lcmFsIHB1cnBvc2UgYmluYXJpemVyIGZvciB1c2VzIG91dHNpZGUgWlhpbmcuCgkgKgoJICogVGhpcyBjbGFzcyBleHRlbmRzIEdsb2JhbEhpc3RvZ3JhbUJpbmFyaXplciwgdXNpbmcgdGhlIG9sZGVyIGhpc3RvZ3JhbSBhcHByb2FjaCBmb3IgMUQgcmVhZGVycywKCSAqIGFuZCB0aGUgbmV3ZXIgbG9jYWwgYXBwcm9hY2ggZm9yIDJEIHJlYWRlcnMuIDFEIGRlY29kaW5nIHVzaW5nIGEgcGVyLXJvdyBoaXN0b2dyYW0gaXMgYWxyZWFkeQoJICogaW5oZXJlbnRseSBsb2NhbCwgYW5kIG9ubHkgZmFpbHMgZm9yIGhvcml6b250YWwgZ3JhZGllbnRzLiBXZSBjYW4gcmV2aXNpdCB0aGF0IHByb2JsZW0gbGF0ZXIsCgkgKiBidXQgZm9yIG5vdyBpdCB3YXMgbm90IGEgd2luIHRvIHVzZSBsb2NhbCBibG9ja3MgZm9yIDFELgoJICoKCSAqIFRoaXMgQmluYXJpemVyIGlzIHRoZSBkZWZhdWx0IGZvciB0aGUgdW5pdCB0ZXN0cyBhbmQgdGhlIHJlY29tbWVuZGVkIGNsYXNzIGZvciBsaWJyYXJ5IHVzZXJzLgoJICoKCSAqIEBhdXRob3IgZHN3aXRraW5AZ29vZ2xlLmNvbSAoRGFuaWVsIFN3aXRraW4pCgkgKi8KCXZhciBIeWJyaWRCaW5hcml6ZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGIoSHlicmlkQmluYXJpemVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIEh5YnJpZEJpbmFyaXplcihzb3VyY2UpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgc291cmNlKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5tYXRyaXggPSBudWxsOwoJICAgICAgICByZXR1cm4gX3RoaXM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIENhbGN1bGF0ZXMgdGhlIGZpbmFsIEJpdE1hdHJpeCBvbmNlIGZvciBhbGwgcmVxdWVzdHMuIFRoaXMgY291bGQgYmUgY2FsbGVkIG9uY2UgZnJvbSB0aGUKCSAgICAgKiBjb25zdHJ1Y3RvciBpbnN0ZWFkLCBidXQgdGhlcmUgYXJlIHNvbWUgYWR2YW50YWdlcyB0byBkb2luZyBpdCBsYXppbHksIHN1Y2ggYXMgbWFraW5nCgkgICAgICogcHJvZmlsaW5nIGVhc2llciwgYW5kIG5vdCBkb2luZyBoZWF2eSBsaWZ0aW5nIHdoZW4gY2FsbGVycyBkb24ndCBleHBlY3QgaXQuCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuZ2V0QmxhY2tNYXRyaXggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLm1hdHJpeCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIHZhciBzb3VyY2UgPSB0aGlzLmdldEx1bWluYW5jZVNvdXJjZSgpOwoJICAgICAgICB2YXIgd2lkdGggPSBzb3VyY2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IHNvdXJjZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKHdpZHRoID49IEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiAmJiBoZWlnaHQgPj0gSHlicmlkQmluYXJpemVyLk1JTklNVU1fRElNRU5TSU9OKSB7CgkgICAgICAgICAgICB2YXIgbHVtaW5hbmNlcyA9IHNvdXJjZS5nZXRNYXRyaXgoKTsKCSAgICAgICAgICAgIHZhciBzdWJXaWR0aCA9IHdpZHRoID4+IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKCh3aWR0aCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViV2lkdGgrKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciBzdWJIZWlnaHQgPSBoZWlnaHQgPj4gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICBpZiAoKGhlaWdodCAmIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0spICE9PSAwKSB7CgkgICAgICAgICAgICAgICAgc3ViSGVpZ2h0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgYmxhY2tQb2ludHMgPSBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMobHVtaW5hbmNlcywgc3ViV2lkdGgsIHN1YkhlaWdodCwgd2lkdGgsIGhlaWdodCk7CgkgICAgICAgICAgICB2YXIgbmV3TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDQuZGVmYXVsdCh3aWR0aCwgaGVpZ2h0KTsKCSAgICAgICAgICAgIEh5YnJpZEJpbmFyaXplci5jYWxjdWxhdGVUaHJlc2hvbGRGb3JCbG9jayhsdW1pbmFuY2VzLCBzdWJXaWR0aCwgc3ViSGVpZ2h0LCB3aWR0aCwgaGVpZ2h0LCBibGFja1BvaW50cywgbmV3TWF0cml4KTsKCSAgICAgICAgICAgIHRoaXMubWF0cml4ID0gbmV3TWF0cml4OwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgLy8gSWYgdGhlIGltYWdlIGlzIHRvbyBzbWFsbCwgZmFsbCBiYWNrIHRvIHRoZSBnbG9iYWwgaGlzdG9ncmFtIGFwcHJvYWNoLgoJICAgICAgICAgICAgdGhpcy5tYXRyaXggPSBfc3VwZXIucHJvdG90eXBlLmdldEJsYWNrTWF0cml4LmNhbGwodGhpcyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMubWF0cml4OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEh5YnJpZEJpbmFyaXplci5wcm90b3R5cGUuY3JlYXRlQmluYXJpemVyID0gZnVuY3Rpb24gKHNvdXJjZSkgewoJICAgICAgICByZXR1cm4gbmV3IEh5YnJpZEJpbmFyaXplcihzb3VyY2UpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogRm9yIGVhY2ggYmxvY2sgaW4gdGhlIGltYWdlLCBjYWxjdWxhdGUgdGhlIGF2ZXJhZ2UgYmxhY2sgcG9pbnQgdXNpbmcgYSA1eDUgZ3JpZAoJICAgICAqIG9mIHRoZSBibG9ja3MgYXJvdW5kIGl0LiBBbHNvIGhhbmRsZXMgdGhlIGNvcm5lciBjYXNlcyAoZnJhY3Rpb25hbCBibG9ja3MgYXJlIGNvbXB1dGVkIGJhc2VkCgkgICAgICogb24gdGhlIGxhc3QgcGl4ZWxzIGluIHRoZSByb3cvY29sdW1uIHdoaWNoIGFyZSBhbHNvIHVzZWQgaW4gdGhlIHByZXZpb3VzIGJsb2NrKS4KCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlVGhyZXNob2xkRm9yQmxvY2sgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBibGFja1BvaW50cywgbWF0cml4KSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBzdWJIZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgdG9wXzEgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHksIDIsIHN1YkhlaWdodCAtIDMpOwoJICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBzdWJXaWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHhvZmZzZXQgPSB4IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgICAgIGlmICh4b2Zmc2V0ID4gbWF4WE9mZnNldCkgewoJICAgICAgICAgICAgICAgICAgICB4b2Zmc2V0ID0gbWF4WE9mZnNldDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgdmFyIGxlZnQgPSBIeWJyaWRCaW5hcml6ZXIuY2FwKHgsIDIsIHN1YldpZHRoIC0gMyk7CgkgICAgICAgICAgICAgICAgdmFyIHN1bSA9IDA7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeiA9IC0yOyB6IDw9IDI7IHorKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgYmxhY2tSb3cgPSBibGFja1BvaW50c1t0b3BfMSArIHpdOwoJICAgICAgICAgICAgICAgICAgICBzdW0gKz0gYmxhY2tSb3dbbGVmdCAtIDJdICsgYmxhY2tSb3dbbGVmdCAtIDFdICsgYmxhY2tSb3dbbGVmdF0gKyBibGFja1Jvd1tsZWZ0ICsgMV0gKyBibGFja1Jvd1tsZWZ0ICsgMl07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlID0gc3VtIC8gMjU7CgkgICAgICAgICAgICAgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrKGx1bWluYW5jZXMsIHhvZmZzZXQsIHlvZmZzZXQsIGF2ZXJhZ2UsIHdpZHRoLCBtYXRyaXgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FwID0gZnVuY3Rpb24gKHZhbHVlIC8qaW50Ki8sIG1pbiAvKmludCovLCBtYXggLyppbnQqLykgewoJICAgICAgICByZXR1cm4gdmFsdWUgPCBtaW4gPyBtaW4gOiB2YWx1ZSA+IG1heCA/IG1heCA6IHZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbGllcyBhIHNpbmdsZSB0aHJlc2hvbGQgdG8gYSBibG9jayBvZiBwaXhlbHMuCgkgICAgICovCgkgICAgSHlicmlkQmluYXJpemVyLnRocmVzaG9sZEJsb2NrID0gZnVuY3Rpb24gKGx1bWluYW5jZXMsIHhvZmZzZXQgLyppbnQqLywgeW9mZnNldCAvKmludCovLCB0aHJlc2hvbGQgLyppbnQqLywgc3RyaWRlIC8qaW50Ki8sIG1hdHJpeCkgewoJICAgICAgICBmb3IgKHZhciB5ID0gMCwgb2Zmc2V0ID0geW9mZnNldCAqIHN0cmlkZSArIHhvZmZzZXQ7IHkgPCBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsgeSsrLCBvZmZzZXQgKz0gc3RyaWRlKSB7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB4KyspIHsKCSAgICAgICAgICAgICAgICAvLyBDb21wYXJpc29uIG5lZWRzIHRvIGJlIDw9IHNvIHRoYXQgYmxhY2sgPT0gMCBwaXhlbHMgYXJlIGJsYWNrIGV2ZW4gaWYgdGhlIHRocmVzaG9sZCBpcyAwLgoJICAgICAgICAgICAgICAgIGlmICgobHVtaW5hbmNlc1tvZmZzZXQgKyB4XSAmIDB4RkYpIDw9IHRocmVzaG9sZCkgewoJICAgICAgICAgICAgICAgICAgICBtYXRyaXguc2V0KHhvZmZzZXQgKyB4LCB5b2Zmc2V0ICsgeSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBDYWxjdWxhdGVzIGEgc2luZ2xlIGJsYWNrIHBvaW50IGZvciBlYWNoIGJsb2NrIG9mIHBpeGVscyBhbmQgc2F2ZXMgaXQgYXdheS4KCSAgICAgKiBTZWUgdGhlIGZvbGxvd2luZyB0aHJlYWQgZm9yIGEgZGlzY3Vzc2lvbiBvZiB0aGlzIGFsZ29yaXRobToKCSAgICAgKiAgaHR0cDovL2dyb3Vwcy5nb29nbGUuY29tL2dyb3VwL3p4aW5nL2Jyb3dzZV90aHJlYWQvdGhyZWFkL2QwNmVmYTJjMzVhN2RkYzAKCSAgICAgKi8KCSAgICBIeWJyaWRCaW5hcml6ZXIuY2FsY3VsYXRlQmxhY2tQb2ludHMgPSBmdW5jdGlvbiAobHVtaW5hbmNlcywgc3ViV2lkdGggLyppbnQqLywgc3ViSGVpZ2h0IC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHZhciBtYXhZT2Zmc2V0ID0gaGVpZ2h0IC0gSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7CgkgICAgICAgIHZhciBtYXhYT2Zmc2V0ID0gd2lkdGggLSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRTsKCSAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOndoaXRlc3BhY2UKCSAgICAgICAgdmFyIGJsYWNrUG9pbnRzID0gbmV3IEFycmF5KHN1YkhlaWdodCk7IC8vIHN1YldpZHRoCgkgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgc3ViSGVpZ2h0OyB5KyspIHsKCSAgICAgICAgICAgIGJsYWNrUG9pbnRzW3ldID0gbmV3IEludDMyQXJyYXkoc3ViV2lkdGgpOwoJICAgICAgICAgICAgdmFyIHlvZmZzZXQgPSB5IDw8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSOwoJICAgICAgICAgICAgaWYgKHlvZmZzZXQgPiBtYXhZT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgeW9mZnNldCA9IG1heFlPZmZzZXQ7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IHN1YldpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgeG9mZnNldCA9IHggPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7CgkgICAgICAgICAgICAgICAgaWYgKHhvZmZzZXQgPiBtYXhYT2Zmc2V0KSB7CgkgICAgICAgICAgICAgICAgICAgIHhvZmZzZXQgPSBtYXhYT2Zmc2V0OwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB2YXIgc3VtID0gMDsKCSAgICAgICAgICAgICAgICB2YXIgbWluID0gMHhGRjsKCSAgICAgICAgICAgICAgICB2YXIgbWF4ID0gMDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciB5eSA9IDAsIG9mZnNldCA9IHlvZmZzZXQgKiB3aWR0aCArIHhvZmZzZXQ7IHl5IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHl5KyssIG9mZnNldCArPSB3aWR0aCkgewoJICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwaXhlbCA9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgIHN1bSArPSBwaXhlbDsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0aWxsIGxvb2tpbmcgZm9yIGdvb2QgY29udHJhc3QKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaXhlbCA8IG1pbikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbiA9IHBpeGVsOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpeGVsID4gbWF4KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4ID0gcGl4ZWw7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgLy8gc2hvcnQtY2lyY3VpdCBtaW4vbWF4IHRlc3RzIG9uY2UgZHluYW1pYyByYW5nZSBpcyBtZXQKCSAgICAgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA+IEh5YnJpZEJpbmFyaXplci5NSU5fRFlOQU1JQ19SQU5HRSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluaXNoIHRoZSByZXN0IG9mIHRoZSByb3dzIHF1aWNrbHkKCSAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeXkrKywgb2Zmc2V0ICs9IHdpZHRoOyB5eSA8IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFOyB5eSsrLCBvZmZzZXQgKz0gd2lkdGgpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4eCA9IDA7IHh4IDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkU7IHh4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VtICs9IGx1bWluYW5jZXNbb2Zmc2V0ICsgeHhdICYgMHhGRjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgLy8gVGhlIGRlZmF1bHQgZXN0aW1hdGUgaXMgdGhlIGF2ZXJhZ2Ugb2YgdGhlIHZhbHVlcyBpbiB0aGUgYmxvY2suCgkgICAgICAgICAgICAgICAgdmFyIGF2ZXJhZ2UgPSBzdW0gPj4gKEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSICogMik7CgkgICAgICAgICAgICAgICAgaWYgKG1heCAtIG1pbiA8PSBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gSWYgdmFyaWF0aW9uIHdpdGhpbiB0aGUgYmxvY2sgaXMgbG93LCBhc3N1bWUgdGhpcyBpcyBhIGJsb2NrIHdpdGggb25seSBsaWdodCBvciBvbmx5CgkgICAgICAgICAgICAgICAgICAgIC8vIGRhcmsgcGl4ZWxzLiBJbiB0aGF0IGNhc2Ugd2UgZG8gbm90IHdhbnQgdG8gdXNlIHRoZSBhdmVyYWdlLCBhcyBpdCB3b3VsZCBkaXZpZGUgdGhpcwoJICAgICAgICAgICAgICAgICAgICAvLyBsb3cgY29udHJhc3QgYXJlYSBpbnRvIGJsYWNrIGFuZCB3aGl0ZSBwaXhlbHMsIGVzc2VudGlhbGx5IGNyZWF0aW5nIGRhdGEgb3V0IG9mIG5vaXNlLgoJICAgICAgICAgICAgICAgICAgICAvLwoJICAgICAgICAgICAgICAgICAgICAvLyBUaGUgZGVmYXVsdCBhc3N1bXB0aW9uIGlzIHRoYXQgdGhlIGJsb2NrIGlzIGxpZ2h0L2JhY2tncm91bmQuIFNpbmNlIG5vIGVzdGltYXRlIGZvcgoJICAgICAgICAgICAgICAgICAgICAvLyB0aGUgbGV2ZWwgb2YgZGFyayBwaXhlbHMgZXhpc3RzIGxvY2FsbHksIHVzZSBoYWxmIHRoZSBtaW4gZm9yIHRoZSBibG9jay4KCSAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IG1pbiAvIDI7CgkgICAgICAgICAgICAgICAgICAgIGlmICh5ID4gMCAmJiB4ID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29ycmVjdCB0aGUgIndoaXRlIGJhY2tncm91bmQiIGFzc3VtcHRpb24gZm9yIGJsb2NrcyB0aGF0IGhhdmUgbmVpZ2hib3JzIGJ5IGNvbXBhcmluZwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHBpeGVscyBpbiB0aGlzIGJsb2NrIHRvIHRoZSBwcmV2aW91c2x5IGNhbGN1bGF0ZWQgYmxhY2sgcG9pbnRzLiBUaGlzIGlzIGJhc2VkIG9uCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGUgZmFjdCB0aGF0IGRhcmsgYmFyY29kZSBzeW1ib2xvZ3kgaXMgYWx3YXlzIHN1cnJvdW5kZWQgYnkgc29tZSBhbW91bnQgb2YgbGlnaHQKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJhY2tncm91bmQgZm9yIHdoaWNoIHJlYXNvbmFibGUgYmxhY2sgcG9pbnQgZXN0aW1hdGVzIHdlcmUgbWFkZS4gVGhlIGJwIGVzdGltYXRlZCBhdAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGJvdW5kYXJpZXMgaXMgdXNlZCBmb3IgdGhlIGludGVyaW9yLgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIChtaW4gPCBicCkgaXMgYXJiaXRyYXJ5IGJ1dCB3b3JrcyBiZXR0ZXIgdGhhbiBvdGhlciBoZXVyaXN0aWNzIHRoYXQgd2VyZSB0cmllZC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50ID0gKGJsYWNrUG9pbnRzW3kgLSAxXVt4XSArICgyICogYmxhY2tQb2ludHNbeV1beCAtIDFdKSArIGJsYWNrUG9pbnRzW3kgLSAxXVt4IC0gMV0pIC8gNDsKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW4gPCBhdmVyYWdlTmVpZ2hib3JCbGFja1BvaW50KSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXZlcmFnZSA9IGF2ZXJhZ2VOZWlnaGJvckJsYWNrUG9pbnQ7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgYmxhY2tQb2ludHNbeV1beF0gPSBhdmVyYWdlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBibGFja1BvaW50czsKCSAgICB9OwoJICAgIC8vIFRoaXMgY2xhc3MgdXNlcyA1eDUgYmxvY2tzIHRvIGNvbXB1dGUgbG9jYWwgbHVtaW5hbmNlLCB3aGVyZSBlYWNoIGJsb2NrIGlzIDh4OCBwaXhlbHMuCgkgICAgLy8gU28gdGhpcyBpcyB0aGUgc21hbGxlc3QgZGltZW5zaW9uIGluIGVhY2ggYXhpcyB3ZSBjYW4gYWNjZXB0LgoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX1BPV0VSID0gMzsKCSAgICBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSA9IDEgPDwgSHlicmlkQmluYXJpemVyLkJMT0NLX1NJWkVfUE9XRVI7IC8vIC4uLjAxMDAuLi4wMAoJICAgIEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFX01BU0sgPSBIeWJyaWRCaW5hcml6ZXIuQkxPQ0tfU0laRSAtIDE7IC8vIC4uLjAwMTEuLi4xMQoJICAgIEh5YnJpZEJpbmFyaXplci5NSU5JTVVNX0RJTUVOU0lPTiA9IEh5YnJpZEJpbmFyaXplci5CTE9DS19TSVpFICogNTsKCSAgICBIeWJyaWRCaW5hcml6ZXIuTUlOX0RZTkFNSUNfUkFOR0UgPSAyNDsKCSAgICByZXR1cm4gSHlicmlkQmluYXJpemVyOwoJfShHbG9iYWxIaXN0b2dyYW1CaW5hcml6ZXJfMS5kZWZhdWx0KSk7Cgl2YXIgX2RlZmF1bHQkMiA9IEh5YnJpZEJpbmFyaXplciQxLmRlZmF1bHQgPSBIeWJyaWRCaW5hcml6ZXI7CgoJdmFyIFJHQkx1bWluYW5jZVNvdXJjZSQxID0ge307CgoJdmFyIEludmVydGVkTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgl2YXIgTHVtaW5hbmNlU291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgU3RyaW5nQnVpbGRlcl8xJDEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMSA9IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uJDE7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nIHsqLwoJLyoqCgkgKiBUaGUgcHVycG9zZSBvZiB0aGlzIGNsYXNzIGhpZXJhcmNoeSBpcyB0byBhYnN0cmFjdCBkaWZmZXJlbnQgYml0bWFwIGltcGxlbWVudGF0aW9ucyBhY3Jvc3MKCSAqIHBsYXRmb3JtcyBpbnRvIGEgc3RhbmRhcmQgaW50ZXJmYWNlIGZvciByZXF1ZXN0aW5nIGdyZXlzY2FsZSBsdW1pbmFuY2UgdmFsdWVzLiBUaGUgaW50ZXJmYWNlCgkgKiBvbmx5IHByb3ZpZGVzIGltbXV0YWJsZSBtZXRob2RzOyB0aGVyZWZvcmUgY3JvcCBhbmQgcm90YXRpb24gY3JlYXRlIGNvcGllcy4gVGhpcyBpcyB0byBlbnN1cmUKCSAqIHRoYXQgb25lIFJlYWRlciBkb2VzIG5vdCBtb2RpZnkgdGhlIG9yaWdpbmFsIGx1bWluYW5jZSBzb3VyY2UgYW5kIGxlYXZlIGl0IGluIGFuIHVua25vd24gc3RhdGUKCSAqIGZvciBvdGhlciBSZWFkZXJzIGluIHRoZSBjaGFpbi4KCSAqCgkgKiBAYXV0aG9yIGRzd2l0a2luQGdvb2dsZS5jb20gKERhbmllbCBTd2l0a2luKQoJICovCgl2YXIgTHVtaW5hbmNlU291cmNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEx1bWluYW5jZVNvdXJjZSh3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aGlzLndpZHRoID0gd2lkdGg7CgkgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIFRoZSB3aWR0aCBvZiB0aGUgYml0bWFwLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0V2lkdGggPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLndpZHRoOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBUaGUgaGVpZ2h0IG9mIHRoZSBiaXRtYXAuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRIZWlnaHQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmhlaWdodDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNyb3BwaW5nLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBSZXR1cm5zIGEgbmV3IG9iamVjdCB3aXRoIGNyb3BwZWQgaW1hZ2UgZGF0YS4gSW1wbGVtZW50YXRpb25zIG1heSBrZWVwIGEgcmVmZXJlbmNlIHRvIHRoZQoJICAgICAqIG9yaWdpbmFsIGRhdGEgcmF0aGVyIHRoYW4gYSBjb3B5LiBPbmx5IGNhbGxhYmxlIGlmIGlzQ3JvcFN1cHBvcnRlZCgpIGlzIHRydWUuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gbGVmdCBUaGUgbGVmdCBjb29yZGluYXRlLCB3aGljaCBtdXN0IGJlIGluIFswLGdldFdpZHRoKCkpCgkgICAgICogQHBhcmFtIHRvcCBUaGUgdG9wIGNvb3JkaW5hdGUsIHdoaWNoIG11c3QgYmUgaW4gWzAsZ2V0SGVpZ2h0KCkpCgkgICAgICogQHBhcmFtIHdpZHRoIFRoZSB3aWR0aCBvZiB0aGUgcmVjdGFuZ2xlIHRvIGNyb3AuCgkgICAgICogQHBhcmFtIGhlaWdodCBUaGUgaGVpZ2h0IG9mIHRoZSByZWN0YW5nbGUgdG8gY3JvcC4KCSAgICAgKiBAcmV0dXJuIEEgY3JvcHBlZCB2ZXJzaW9uIG9mIHRoaXMgb2JqZWN0LgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCBjcm9wcGluZy4nKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gV2hldGhlciB0aGlzIHN1YmNsYXNzIHN1cHBvcnRzIGNvdW50ZXItY2xvY2t3aXNlIHJvdGF0aW9uLgoJICAgICAqLwoJICAgIEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgYSBuZXcgb2JqZWN0IHdpdGggcm90YXRlZCBpbWFnZSBkYXRhIGJ5IDkwIGRlZ3JlZXMgY291bnRlcmNsb2Nrd2lzZS4KCSAgICAgKiBPbmx5IGNhbGxhYmxlIGlmIHtAbGluayAjaXNSb3RhdGVTdXBwb3J0ZWQoKX0gaXMgdHJ1ZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gQSByb3RhdGVkIHZlcnNpb24gb2YgdGhpcyBvYmplY3QuCgkgICAgICovCgkgICAgTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB0aHJvdyBuZXcgVW5zdXBwb3J0ZWRPcGVyYXRpb25FeGNlcHRpb25fMS5kZWZhdWx0KCdUaGlzIGx1bWluYW5jZSBzb3VyY2UgZG9lcyBub3Qgc3VwcG9ydCByb3RhdGlvbiBieSA5MCBkZWdyZWVzLicpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogUmV0dXJucyBhIG5ldyBvYmplY3Qgd2l0aCByb3RhdGVkIGltYWdlIGRhdGEgYnkgNDUgZGVncmVlcyBjb3VudGVyY2xvY2t3aXNlLgoJICAgICAqIE9ubHkgY2FsbGFibGUgaWYge0BsaW5rICNpc1JvdGF0ZVN1cHBvcnRlZCgpfSBpcyB0cnVlLgoJICAgICAqCgkgICAgICogQHJldHVybiBBIHJvdGF0ZWQgdmVyc2lvbiBvZiB0aGlzIG9iamVjdC4KCSAgICAgKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnJvdGF0ZUNvdW50ZXJDbG9ja3dpc2U0NSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdGhyb3cgbmV3IFVuc3VwcG9ydGVkT3BlcmF0aW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnVGhpcyBsdW1pbmFuY2Ugc291cmNlIGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24gYnkgNDUgZGVncmVlcy4nKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgcm93ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHRoaXMud2lkdGgpOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFN0cmluZ0J1aWxkZXJfMSQxLmRlZmF1bHQoKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCB0aGlzLmhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgc291cmNlUm93ID0gdGhpcy5nZXRSb3coeSwgcm93KTsKCSAgICAgICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgdGhpcy53aWR0aDsgeCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGx1bWluYW5jZSA9IHNvdXJjZVJvd1t4XSAmIDB4RkY7CgkgICAgICAgICAgICAgICAgdmFyIGMgPSB2b2lkIDA7CgkgICAgICAgICAgICAgICAgaWYgKGx1bWluYW5jZSA8IDB4NDApIHsKCSAgICAgICAgICAgICAgICAgICAgYyA9ICcjJzsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSBpZiAobHVtaW5hbmNlIDwgMHg4MCkgewoJICAgICAgICAgICAgICAgICAgICBjID0gJysnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIGlmIChsdW1pbmFuY2UgPCAweEMwKSB7CgkgICAgICAgICAgICAgICAgICAgIGMgPSAnLic7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICBjID0gJyAnOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICByZXN1bHQuYXBwZW5kKGMpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZCgnXG4nKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0LnRvU3RyaW5nKCk7CgkgICAgfTsKCSAgICByZXR1cm4gTHVtaW5hbmNlU291cmNlOwoJfSgpKTsKCUx1bWluYW5jZVNvdXJjZSQxLmRlZmF1bHQgPSBMdW1pbmFuY2VTb3VyY2U7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA5IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMkYSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnZlcnRlZEx1bWluYW5jZVNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEkMSA9IEx1bWluYW5jZVNvdXJjZSQxOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogQSB3cmFwcGVyIGltcGxlbWVudGF0aW9uIG9mIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHdoaWNoIGludmVydHMgdGhlIGx1bWluYW5jZXMgaXQgcmV0dXJucyAtLSBibGFjayBiZWNvbWVzCgkgKiB3aGl0ZSBhbmQgdmljZSB2ZXJzYSwgYW5kIGVhY2ggdmFsdWUgYmVjb21lcyAoMjU1LXZhbHVlKS4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJGEoSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UsIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UoZGVsZWdhdGUpIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgZGVsZWdhdGUuZ2V0V2lkdGgoKSwgZGVsZWdhdGUuZ2V0SGVpZ2h0KCkpIHx8IHRoaXM7CgkgICAgICAgIF90aGlzLmRlbGVnYXRlID0gZGVsZWdhdGU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgdmFyIHNvdXJjZVJvdyA9IHRoaXMuZGVsZWdhdGUuZ2V0Um93KHksIHJvdyk7CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB3aWR0aDsgaSsrKSB7CgkgICAgICAgICAgICBzb3VyY2VSb3dbaV0gPSAvKihieXRlKSovICgyNTUgLSAoc291cmNlUm93W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBzb3VyY2VSb3c7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmdldE1hdHJpeCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIG1hdHJpeCA9IHRoaXMuZGVsZWdhdGUuZ2V0TWF0cml4KCk7CgkgICAgICAgIHZhciBsZW5ndGggPSB0aGlzLmdldFdpZHRoKCkgKiB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgaW52ZXJ0ZWRNYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkobGVuZ3RoKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykgewoJICAgICAgICAgICAgaW52ZXJ0ZWRNYXRyaXhbaV0gPSAvKihieXRlKSovICgyNTUgLSAobWF0cml4W2ldICYgMHhGRikpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBpbnZlcnRlZE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNDcm9wU3VwcG9ydGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5kZWxlZ2F0ZS5pc0Nyb3BTdXBwb3J0ZWQoKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuY3JvcCA9IGZ1bmN0aW9uIChsZWZ0IC8qaW50Ki8sIHRvcCAvKmludCovLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUuY3JvcChsZWZ0LCB0b3AsIHdpZHRoLCBoZWlnaHQpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuaXNSb3RhdGVTdXBwb3J0ZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlLmlzUm90YXRlU3VwcG9ydGVkKCk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG9yaWdpbmFsIGRlbGVnYXRlIHtAbGluayBMdW1pbmFuY2VTb3VyY2V9IHNpbmNlIGludmVydCB1bmRvZXMgaXRzZWxmCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlbGVnYXRlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEludmVydGVkTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5yb3RhdGVDb3VudGVyQ2xvY2t3aXNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZSgpKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBJbnZlcnRlZEx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IEludmVydGVkTHVtaW5hbmNlU291cmNlKHRoaXMuZGVsZWdhdGUucm90YXRlQ291bnRlckNsb2Nrd2lzZTQ1KCkpOwoJICAgIH07CgkgICAgcmV0dXJuIEludmVydGVkTHVtaW5hbmNlU291cmNlOwoJfShMdW1pbmFuY2VTb3VyY2VfMSQxLmRlZmF1bHQpKTsKCUludmVydGVkTHVtaW5hbmNlU291cmNlJDEuZGVmYXVsdCA9IEludmVydGVkTHVtaW5hbmNlU291cmNlOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwOSBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDkgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUkdCTHVtaW5hbmNlU291cmNlJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcgeyovCgkgLy8gcmVxdWlyZWQgYmVjYXVzZSBvZiBjaXJjdWxhciBkZXBlbmRlbmNpZXMgYmV0d2VlbiBMdW1pbmFuY2VTb3VyY2UgYW5kIEludmVydGVkTHVtaW5hbmNlU291cmNlCgl2YXIgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMSA9IEludmVydGVkTHVtaW5hbmNlU291cmNlJDE7Cgl2YXIgTHVtaW5hbmNlU291cmNlXzEgPSBMdW1pbmFuY2VTb3VyY2UkMTsKCXZhciBTeXN0ZW1fMSQyID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNiA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBUaGlzIGNsYXNzIGlzIHVzZWQgdG8gaGVscCBkZWNvZGUgaW1hZ2VzIGZyb20gZmlsZXMgd2hpY2ggYXJyaXZlIGFzIFJHQiBkYXRhIGZyb20KCSAqIGFuIEFSR0IgcGl4ZWwgYXJyYXkuIEl0IGRvZXMgbm90IHN1cHBvcnQgcm90YXRpb24uCgkgKgoJICogQGF1dGhvciBkc3dpdGtpbkBnb29nbGUuY29tIChEYW5pZWwgU3dpdGtpbikKCSAqIEBhdXRob3IgQmV0YW1pbm9zCgkgKi8KCXZhciBSR0JMdW1pbmFuY2VTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDkoUkdCTHVtaW5hbmNlU291cmNlLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIFJHQkx1bWluYW5jZVNvdXJjZShsdW1pbmFuY2VzLCB3aWR0aCAvKmludCovLCBoZWlnaHQgLyppbnQqLywgZGF0YVdpZHRoIC8qaW50Ki8sIGRhdGFIZWlnaHQgLyppbnQqLywgbGVmdCAvKmludCovLCB0b3AgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCB3aWR0aCwgaGVpZ2h0KSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5kYXRhV2lkdGggPSBkYXRhV2lkdGg7CgkgICAgICAgIF90aGlzLmRhdGFIZWlnaHQgPSBkYXRhSGVpZ2h0OwoJICAgICAgICBfdGhpcy5sZWZ0ID0gbGVmdDsKCSAgICAgICAgX3RoaXMudG9wID0gdG9wOwoJICAgICAgICBpZiAobHVtaW5hbmNlcy5CWVRFU19QRVJfRUxFTUVOVCA9PT0gNCkgeyAvLyBJbnQzMkFycmF5CgkgICAgICAgICAgICB2YXIgc2l6ZSA9IHdpZHRoICogaGVpZ2h0OwoJICAgICAgICAgICAgdmFyIGx1bWluYW5jZXNVaW50OEFycmF5ID0gbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KHNpemUpOwoJICAgICAgICAgICAgZm9yICh2YXIgb2Zmc2V0ID0gMDsgb2Zmc2V0IDwgc2l6ZTsgb2Zmc2V0KyspIHsKCSAgICAgICAgICAgICAgICB2YXIgcGl4ZWwgPSBsdW1pbmFuY2VzW29mZnNldF07CgkgICAgICAgICAgICAgICAgdmFyIHIgPSAocGl4ZWwgPj4gMTYpICYgMHhmZjsgLy8gcmVkCgkgICAgICAgICAgICAgICAgdmFyIGcyID0gKHBpeGVsID4+IDcpICYgMHgxZmU7IC8vIDIgKiBncmVlbgoJICAgICAgICAgICAgICAgIHZhciBiID0gcGl4ZWwgJiAweGZmOyAvLyBibHVlCgkgICAgICAgICAgICAgICAgLy8gQ2FsY3VsYXRlIGdyZWVuLWZhdm91cmluZyBhdmVyYWdlIGNoZWFwbHkKCSAgICAgICAgICAgICAgICBsdW1pbmFuY2VzVWludDhBcnJheVtvZmZzZXRdID0gLyooYnl0ZSkgKi8gKChyICsgZzIgKyBiKSAvIDQpICYgMHhGRjsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzVWludDhBcnJheTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIF90aGlzLmx1bWluYW5jZXMgPSBsdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGRhdGFXaWR0aCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YVdpZHRoID0gd2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gZGF0YUhlaWdodCkgewoJICAgICAgICAgICAgX3RoaXMuZGF0YUhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSBsZWZ0KSB7CgkgICAgICAgICAgICBfdGhpcy5sZWZ0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAodW5kZWZpbmVkID09PSB0b3ApIHsKCSAgICAgICAgICAgIF90aGlzLnRvcCA9IDA7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKF90aGlzLmxlZnQgKyB3aWR0aCA+IF90aGlzLmRhdGFXaWR0aCB8fCBfdGhpcy50b3AgKyBoZWlnaHQgPiBfdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNi5kZWZhdWx0KCdDcm9wIHJlY3RhbmdsZSBkb2VzIG5vdCBmaXQgd2l0aGluIGltYWdlIGRhdGEuJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5nZXRSb3cgPSBmdW5jdGlvbiAoeSAvKmludCovLCByb3cpIHsKCSAgICAgICAgaWYgKHkgPCAwIHx8IHkgPj0gdGhpcy5nZXRIZWlnaHQoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDYuZGVmYXVsdCgnUmVxdWVzdGVkIHJvdyBpcyBvdXRzaWRlIHRoZSBpbWFnZTogJyArIHkpOwoJICAgICAgICB9CgkgICAgICAgIHZhciB3aWR0aCA9IHRoaXMuZ2V0V2lkdGgoKTsKCSAgICAgICAgaWYgKHJvdyA9PT0gbnVsbCB8fCByb3cgPT09IHVuZGVmaW5lZCB8fCByb3cubGVuZ3RoIDwgd2lkdGgpIHsKCSAgICAgICAgICAgIHJvdyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSh3aWR0aCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG9mZnNldCA9ICh5ICsgdGhpcy50b3ApICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIFN5c3RlbV8xJDIuZGVmYXVsdC5hcnJheWNvcHkodGhpcy5sdW1pbmFuY2VzLCBvZmZzZXQsIHJvdywgMCwgd2lkdGgpOwoJICAgICAgICByZXR1cm4gcm93OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJHQkx1bWluYW5jZVNvdXJjZS5wcm90b3R5cGUuZ2V0TWF0cml4ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgd2lkdGggPSB0aGlzLmdldFdpZHRoKCk7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBJZiB0aGUgY2FsbGVyIGFza3MgZm9yIHRoZSBlbnRpcmUgdW5kZXJseWluZyBpbWFnZSwgc2F2ZSB0aGUgY29weSBhbmQgZ2l2ZSB0aGVtIHRoZQoJICAgICAgICAvLyBvcmlnaW5hbCBkYXRhLiBUaGUgZG9jcyBzcGVjaWZpY2FsbHkgd2FybiB0aGF0IHJlc3VsdC5sZW5ndGggbXVzdCBiZSBpZ25vcmVkLgoJICAgICAgICBpZiAod2lkdGggPT09IHRoaXMuZGF0YVdpZHRoICYmIGhlaWdodCA9PT0gdGhpcy5kYXRhSGVpZ2h0KSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5sdW1pbmFuY2VzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhcmVhID0gd2lkdGggKiBoZWlnaHQ7CgkgICAgICAgIHZhciBtYXRyaXggPSBuZXcgVWludDhDbGFtcGVkQXJyYXkoYXJlYSk7CgkgICAgICAgIHZhciBpbnB1dE9mZnNldCA9IHRoaXMudG9wICogdGhpcy5kYXRhV2lkdGggKyB0aGlzLmxlZnQ7CgkgICAgICAgIC8vIElmIHRoZSB3aWR0aCBtYXRjaGVzIHRoZSBmdWxsIHdpZHRoIG9mIHRoZSB1bmRlcmx5aW5nIGRhdGEsIHBlcmZvcm0gYSBzaW5nbGUgY29weS4KCSAgICAgICAgaWYgKHdpZHRoID09PSB0aGlzLmRhdGFXaWR0aCkgewoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIDAsIGFyZWEpOwoJICAgICAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICAgICAgfQoJICAgICAgICAvLyBPdGhlcndpc2UgY29weSBvbmUgY3JvcHBlZCByb3cgYXQgYSB0aW1lLgoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgb3V0cHV0T2Zmc2V0ID0geSAqIHdpZHRoOwoJICAgICAgICAgICAgU3lzdGVtXzEkMi5kZWZhdWx0LmFycmF5Y29weSh0aGlzLmx1bWluYW5jZXMsIGlucHV0T2Zmc2V0LCBtYXRyaXgsIG91dHB1dE9mZnNldCwgd2lkdGgpOwoJICAgICAgICAgICAgaW5wdXRPZmZzZXQgKz0gdGhpcy5kYXRhV2lkdGg7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSR0JMdW1pbmFuY2VTb3VyY2UucHJvdG90eXBlLmlzQ3JvcFN1cHBvcnRlZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5jcm9wID0gZnVuY3Rpb24gKGxlZnQgLyppbnQqLywgdG9wIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovKSB7CgkgICAgICAgIHJldHVybiBuZXcgUkdCTHVtaW5hbmNlU291cmNlKHRoaXMubHVtaW5hbmNlcywgd2lkdGgsIGhlaWdodCwgdGhpcy5kYXRhV2lkdGgsIHRoaXMuZGF0YUhlaWdodCwgdGhpcy5sZWZ0ICsgbGVmdCwgdGhpcy50b3AgKyB0b3ApOwoJICAgIH07CgkgICAgUkdCTHVtaW5hbmNlU291cmNlLnByb3RvdHlwZS5pbnZlcnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiBuZXcgSW52ZXJ0ZWRMdW1pbmFuY2VTb3VyY2VfMS5kZWZhdWx0KHRoaXMpOwoJICAgIH07CgkgICAgcmV0dXJuIFJHQkx1bWluYW5jZVNvdXJjZTsKCX0oTHVtaW5hbmNlU291cmNlXzEuZGVmYXVsdCkpOwoJdmFyIF9kZWZhdWx0JDEgPSBSR0JMdW1pbmFuY2VTb3VyY2UkMS5kZWZhdWx0ID0gUkdCTHVtaW5hbmNlU291cmNlOwoKCXZhciBRUkNvZGVSZWFkZXIkMSA9IHt9OwoKCXZhciBCYXJjb2RlRm9ybWF0JDEgPSB7fTsKCgkvKgoJICogRGlyZWN0IHBvcnQgdG8gVHlwZVNjcmlwdCBvZiBaWGluZyBieSBBZHJpYW4gVG/ImWPEgwoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoQmFyY29kZUZvcm1hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKgoJICogQ29weXJpZ2h0IDIwMDkgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogRW51bWVyYXRlcyBiYXJjb2RlIGZvcm1hdHMga25vd24gdG8gdGhpcyBwYWNrYWdlLiBQbGVhc2Uga2VlcCBhbHBoYWJldGl6ZWQuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJhcmNvZGVGb3JtYXQ7CgkoZnVuY3Rpb24gKEJhcmNvZGVGb3JtYXQpIHsKCSAgICAvKiogQXp0ZWMgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJBWlRFQyJdID0gMF0gPSAiQVpURUMiOwoJICAgIC8qKiBDT0RBQkFSIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREFCQVIiXSA9IDFdID0gIkNPREFCQVIiOwoJICAgIC8qKiBDb2RlIDM5IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfMzkiXSA9IDJdID0gIkNPREVfMzkiOwoJICAgIC8qKiBDb2RlIDkzIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkNPREVfOTMiXSA9IDNdID0gIkNPREVfOTMiOwoJICAgIC8qKiBDb2RlIDEyOCAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJDT0RFXzEyOCJdID0gNF0gPSAiQ09ERV8xMjgiOwoJICAgIC8qKiBEYXRhIE1hdHJpeCAyRCBiYXJjb2RlIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkRBVEFfTUFUUklYIl0gPSA1XSA9ICJEQVRBX01BVFJJWCI7CgkgICAgLyoqIEVBTi04IDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIkVBTl84Il0gPSA2XSA9ICJFQU5fOCI7CgkgICAgLyoqIEVBTi0xMyAxRCBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJFQU5fMTMiXSA9IDddID0gIkVBTl8xMyI7CgkgICAgLyoqIElURiAoSW50ZXJsZWF2ZWQgVHdvIG9mIEZpdmUpIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIklURiJdID0gOF0gPSAiSVRGIjsKCSAgICAvKiogTWF4aUNvZGUgMkQgYmFyY29kZSBmb3JtYXQuICovCgkgICAgQmFyY29kZUZvcm1hdFtCYXJjb2RlRm9ybWF0WyJNQVhJQ09ERSJdID0gOV0gPSAiTUFYSUNPREUiOwoJICAgIC8qKiBQREY0MTcgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUERGXzQxNyJdID0gMTBdID0gIlBERl80MTciOwoJICAgIC8qKiBRUiBDb2RlIDJEIGJhcmNvZGUgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUVJfQ09ERSJdID0gMTFdID0gIlFSX0NPREUiOwoJICAgIC8qKiBSU1MgMTQgKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlJTU18xNCJdID0gMTJdID0gIlJTU18xNCI7CgkgICAgLyoqIFJTUyBFWFBBTkRFRCAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiUlNTX0VYUEFOREVEIl0gPSAxM10gPSAiUlNTX0VYUEFOREVEIjsKCSAgICAvKiogVVBDLUEgMUQgZm9ybWF0LiAqLwoJICAgIEJhcmNvZGVGb3JtYXRbQmFyY29kZUZvcm1hdFsiVVBDX0EiXSA9IDE0XSA9ICJVUENfQSI7CgkgICAgLyoqIFVQQy1FIDFEIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FIl0gPSAxNV0gPSAiVVBDX0UiOwoJICAgIC8qKiBVUEMvRUFOIGV4dGVuc2lvbiBmb3JtYXQuIE5vdCBhIHN0YW5kLWFsb25lIGZvcm1hdC4gKi8KCSAgICBCYXJjb2RlRm9ybWF0W0JhcmNvZGVGb3JtYXRbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSAxNl0gPSAiVVBDX0VBTl9FWFRFTlNJT04iOwoJfSkoQmFyY29kZUZvcm1hdCB8fCAoQmFyY29kZUZvcm1hdCA9IHt9KSk7CglCYXJjb2RlRm9ybWF0JDEuZGVmYXVsdCA9IEJhcmNvZGVGb3JtYXQ7CgoJdmFyIFJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIFN5c3RlbV8xJDEgPSBTeXN0ZW0kMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBiYXJjb2RlIHdpdGhpbiBhbiBpbWFnZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocHJpdmF0ZSB0ZXh0OiBzdHJpbmcsCgkgICAgLy8gICAgICAgICAgICAgICBVaW50OEFycmF5IHJhd0J5dGVzLAoJICAgIC8vICAgICAgICAgICAgICAgUmVzdWx0UG9jb25zdCByZXN1bHRQb2ludHM6IEludDMyQXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICBCYXJjb2RlRm9ybWF0IGZvcm1hdCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmVzdWx0UG9pbnRzLCBmb3JtYXQsIFN5c3RlbS5jdXJyZW50VGltZU1pbGxpcygpKQoJICAgIC8vIH0KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IodGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgVWludDhBcnJheSByYXdCeXRlcywKCSAgICAvLyAgICAgICAgICAgICAgIFJlc3VsdFBvY29uc3QgcmVzdWx0UG9pbnRzOiBJbnQzMkFycmF5LAoJICAgIC8vICAgICAgICAgICAgICAgQmFyY29kZUZvcm1hdCBmb3JtYXQsCgkgICAgLy8gICAgICAgICAgICAgICBsb25nIHRpbWVzdGFtcCkgewoJICAgIC8vICAgdGhpcyh0ZXh0LCByYXdCeXRlcywgcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoLAoJICAgIC8vICAgICAgICByZXN1bHRQb2ludHMsIGZvcm1hdCwgdGltZXN0YW1wKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBSZXN1bHQodGV4dCwgcmF3Qnl0ZXMsIG51bUJpdHMsIHJlc3VsdFBvaW50cywgZm9ybWF0LCB0aW1lc3RhbXApIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPT09IHZvaWQgMCkgeyBudW1CaXRzID0gcmF3Qnl0ZXMgPT0gbnVsbCA/IDAgOiA4ICogcmF3Qnl0ZXMubGVuZ3RoOyB9CgkgICAgICAgIGlmICh0aW1lc3RhbXAgPT09IHZvaWQgMCkgeyB0aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsgfQoJICAgICAgICB0aGlzLnRleHQgPSB0ZXh0OwoJICAgICAgICB0aGlzLnJhd0J5dGVzID0gcmF3Qnl0ZXM7CgkgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gcmVzdWx0UG9pbnRzOwoJICAgICAgICB0aGlzLmZvcm1hdCA9IGZvcm1hdDsKCSAgICAgICAgdGhpcy50aW1lc3RhbXAgPSB0aW1lc3RhbXA7CgkgICAgICAgIHRoaXMudGV4dCA9IHRleHQ7CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gbnVtQml0cyB8fCBudWxsID09PSBudW1CaXRzKSB7CgkgICAgICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IG51bGwgfHwgcmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMubnVtQml0cyA9IG51bUJpdHM7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludHMgPSByZXN1bHRQb2ludHM7CgkgICAgICAgIHRoaXMuZm9ybWF0ID0gZm9ybWF0OwoJICAgICAgICB0aGlzLnJlc3VsdE1ldGFkYXRhID0gbnVsbDsKCSAgICAgICAgaWYgKHVuZGVmaW5lZCA9PT0gdGltZXN0YW1wIHx8IG51bGwgPT09IHRpbWVzdGFtcCkgewoJICAgICAgICAgICAgdGhpcy50aW1lc3RhbXAgPSBTeXN0ZW1fMSQxLmRlZmF1bHQuY3VycmVudFRpbWVNaWxsaXMoKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHRoaXMudGltZXN0YW1wID0gdGltZXN0YW1wOwoJICAgICAgICB9CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IHRleHQgZW5jb2RlZCBieSB0aGUgYmFyY29kZQoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0VGV4dCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGV4dDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcmF3IGJ5dGVzIGVuY29kZWQgYnkgdGhlIGJhcmNvZGUsIGlmIGFwcGxpY2FibGUsIG90aGVyd2lzZSB7QGNvZGUgbnVsbH0KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0TnVtQml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMubnVtQml0czsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gcG9pbnRzIHJlbGF0ZWQgdG8gdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGVzZSBhcmUgdHlwaWNhbGx5IHBvaW50cwoJICAgICAqICAgICAgICAgaWRlbnRpZnlpbmcgZmluZGVyIHBhdHRlcm5zIG9yIHRoZSBjb3JuZXJzIG9mIHRoZSBiYXJjb2RlLiBUaGUgZXhhY3QgbWVhbmluZyBpcwoJICAgICAqICAgICAgICAgc3BlY2lmaWMgdG8gdGhlIHR5cGUgb2YgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkLgoJICAgICAqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUuZ2V0UmVzdWx0UG9pbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBCYXJjb2RlRm9ybWF0fSByZXByZXNlbnRpbmcgdGhlIGZvcm1hdCBvZiB0aGUgYmFyY29kZSB0aGF0IHdhcyBkZWNvZGVkCgkgICAgICovCgkgICAgUmVzdWx0LnByb3RvdHlwZS5nZXRCYXJjb2RlRm9ybWF0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5mb3JtYXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHtAbGluayBNYXB9IG1hcHBpbmcge0BsaW5rIFJlc3VsdE1ldGFkYXRhVHlwZX0ga2V5cyB0byB2YWx1ZXMuIE1heSBiZQoJICAgICAqICAge0Bjb2RlIG51bGx9LiBUaGlzIGNvbnRhaW5zIG9wdGlvbmFsIG1ldGFkYXRhIGFib3V0IHdoYXQgd2FzIGRldGVjdGVkIGFib3V0IHRoZSBiYXJjb2RlLAoJICAgICAqICAgbGlrZSBvcmllbnRhdGlvbi4KCSAgICAgKi8KCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFJlc3VsdE1ldGFkYXRhID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRNZXRhZGF0YTsKCSAgICB9OwoJICAgIFJlc3VsdC5wcm90b3R5cGUucHV0TWV0YWRhdGEgPSBmdW5jdGlvbiAodHlwZSwgdmFsdWUpIHsKCSAgICAgICAgaWYgKHRoaXMucmVzdWx0TWV0YWRhdGEgPT09IG51bGwpIHsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0TWV0YWRhdGEgPSBuZXcgTWFwKCk7CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YS5zZXQodHlwZSwgdmFsdWUpOwoJICAgIH07CgkgICAgUmVzdWx0LnByb3RvdHlwZS5wdXRBbGxNZXRhZGF0YSA9IGZ1bmN0aW9uIChtZXRhZGF0YSkgewoJICAgICAgICBpZiAobWV0YWRhdGEgIT09IG51bGwpIHsKCSAgICAgICAgICAgIGlmICh0aGlzLnJlc3VsdE1ldGFkYXRhID09PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG1ldGFkYXRhOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRNZXRhZGF0YSA9IG5ldyBNYXAobWV0YWRhdGEpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmFkZFJlc3VsdFBvaW50cyA9IGZ1bmN0aW9uIChuZXdQb2ludHMpIHsKCSAgICAgICAgdmFyIG9sZFBvaW50cyA9IHRoaXMucmVzdWx0UG9pbnRzOwoJICAgICAgICBpZiAob2xkUG9pbnRzID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aGlzLnJlc3VsdFBvaW50cyA9IG5ld1BvaW50czsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChuZXdQb2ludHMgIT09IG51bGwgJiYgbmV3UG9pbnRzLmxlbmd0aCA+IDApIHsKCSAgICAgICAgICAgIHZhciBhbGxQb2ludHMgPSBuZXcgQXJyYXkob2xkUG9pbnRzLmxlbmd0aCArIG5ld1BvaW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgU3lzdGVtXzEkMS5kZWZhdWx0LmFycmF5Y29weShvbGRQb2ludHMsIDAsIGFsbFBvaW50cywgMCwgb2xkUG9pbnRzLmxlbmd0aCk7CgkgICAgICAgICAgICBTeXN0ZW1fMSQxLmRlZmF1bHQuYXJyYXljb3B5KG5ld1BvaW50cywgMCwgYWxsUG9pbnRzLCBvbGRQb2ludHMubGVuZ3RoLCBuZXdQb2ludHMubGVuZ3RoKTsKCSAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRzID0gYWxsUG9pbnRzOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZXN1bHQucHJvdG90eXBlLmdldFRpbWVzdGFtcCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMudGltZXN0YW1wOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRleHQ7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0OwoJfSgpKTsKCVJlc3VsdCQxLmRlZmF1bHQgPSBSZXN1bHQ7CgoJdmFyIFJlc3VsdE1ldGFkYXRhVHlwZSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA4IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZXN1bHRNZXRhZGF0YVR5cGUkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCS8qKgoJICogUmVwcmVzZW50cyBzb21lIHR5cGUgb2YgbWV0YWRhdGEgYWJvdXQgdGhlIHJlc3VsdCBvZiB0aGUgZGVjb2RpbmcgdGhhdCB0aGUgZGVjb2RlcgoJICogd2lzaGVzIHRvIGNvbW11bmljYXRlIGJhY2sgdG8gdGhlIGNhbGxlci4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlOwoJKGZ1bmN0aW9uIChSZXN1bHRNZXRhZGF0YVR5cGUpIHsKCSAgICAvKioKCSAgICAgKiBVbnNwZWNpZmllZCwgYXBwbGljYXRpb24tc3BlY2lmaWMgbWV0YWRhdGEuIE1hcHMgdG8gYW4gdW5zcGVjaWZpZWQge0BsaW5rIE9iamVjdH0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiT1RIRVIiXSA9IDBdID0gIk9USEVSIjsKCSAgICAvKioKCSAgICAgKiBEZW5vdGVzIHRoZSBsaWtlbHkgYXBwcm94aW1hdGUgb3JpZW50YXRpb24gb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLiBUaGlzIHZhbHVlCgkgICAgICogaXMgZ2l2ZW4gYXMgZGVncmVlcyByb3RhdGVkIGNsb2Nrd2lzZSBmcm9tIHRoZSBub3JtYWwsIHVwcmlnaHQgb3JpZW50YXRpb24uCgkgICAgICogRm9yIGV4YW1wbGUgYSAxRCBiYXJjb2RlIHdoaWNoIHdhcyBmb3VuZCBieSByZWFkaW5nIHRvcC10by1ib3R0b20gd291bGQgYmUKCSAgICAgKiBzYWlkIHRvIGhhdmUgb3JpZW50YXRpb24gIjkwIi4gVGhpcyBrZXkgbWFwcyB0byBhbiB7QGxpbmsgSW50ZWdlcn0gd2hvc2UKCSAgICAgKiB2YWx1ZSBpcyBpbiB0aGUgcmFuZ2UgWzAsMzYwKS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJPUklFTlRBVElPTiJdID0gMV0gPSAiT1JJRU5UQVRJT04iOwoJICAgIC8qKgoJICAgICAqIDxwPjJEIGJhcmNvZGUgZm9ybWF0cyB0eXBpY2FsbHkgZW5jb2RlIHRleHQsIGJ1dCBhbGxvdyBmb3IgYSBzb3J0IG9mICdieXRlIG1vZGUnCgkgICAgICogd2hpY2ggaXMgc29tZXRpbWVzIHVzZWQgdG8gZW5jb2RlIGJpbmFyeSBkYXRhLiBXaGlsZSB7QGxpbmsgUmVzdWx0fSBtYWtlcyBhdmFpbGFibGUKCSAgICAgKiB0aGUgY29tcGxldGUgcmF3IGJ5dGVzIGluIHRoZSBiYXJjb2RlIGZvciB0aGVzZSBmb3JtYXRzLCBpdCBkb2VzIG5vdCBvZmZlciB0aGUgYnl0ZXMKCSAgICAgKiBmcm9tIHRoZSBieXRlIHNlZ21lbnRzIGFsb25lLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWFwcyB0byBhIHtAbGluayBqYXZhLnV0aWwuTGlzdH0gb2YgYnl0ZSBhcnJheXMgY29ycmVzcG9uZGluZyB0byB0aGUKCSAgICAgKiByYXcgYnl0ZXMgaW4gdGhlIGJ5dGUgc2VnbWVudHMgaW4gdGhlIGJhcmNvZGUsIGluIG9yZGVyLjwvcD4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJCWVRFX1NFR01FTlRTIl0gPSAyXSA9ICJCWVRFX1NFR01FTlRTIjsKCSAgICAvKioKCSAgICAgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIHVzZWQsIGlmIGFwcGxpY2FibGUuIFRoZSB2YWx1ZSB0eXBlIGRlcGVuZHMgb24gdGhlCgkgICAgICogZm9ybWF0LCBidXQgaXMgdHlwaWNhbGx5IGEgU3RyaW5nLgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiXSA9IDNdID0gIkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHBlcmlvZGljYWxzLCBpbmRpY2F0ZXMgdGhlIGlzc3VlIG51bWJlciBhcyBhbiB7QGxpbmsgSW50ZWdlcn0uCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiSVNTVUVfTlVNQkVSIl0gPSA0XSA9ICJJU1NVRV9OVU1CRVIiOwoJICAgIC8qKgoJICAgICAqIEZvciBzb21lIHByb2R1Y3RzLCBpbmRpY2F0ZXMgdGhlIHN1Z2dlc3RlZCByZXRhaWwgcHJpY2UgaW4gdGhlIGJhcmNvZGUgYXMgYQoJICAgICAqIGZvcm1hdHRlZCB7QGxpbmsgU3RyaW5nfS4KCSAgICAgKi8KCSAgICBSZXN1bHRNZXRhZGF0YVR5cGVbUmVzdWx0TWV0YWRhdGFUeXBlWyJTVUdHRVNURURfUFJJQ0UiXSA9IDVdID0gIlNVR0dFU1RFRF9QUklDRSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBwb3NzaWJsZSBjb3VudHJ5IG9mIG1hbnVmYWN0dXJlIGFzIGEge0BsaW5rIFN0cmluZ30gZGVub3RpbmcgdGhlCgkgICAgICogSVNPIGNvdW50cnkgY29kZS4gU29tZSBtYXAgdG8gbXVsdGlwbGUgcG9zc2libGUgY291bnRyaWVzLCBsaWtlICJVUy9DQSIuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUE9TU0lCTEVfQ09VTlRSWSJdID0gNl0gPSAiUE9TU0lCTEVfQ09VTlRSWSI7CgkgICAgLyoqCgkgICAgICogRm9yIHNvbWUgcHJvZHVjdHMsIHRoZSBleHRlbnNpb24gdGV4dAoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlVQQ19FQU5fRVhURU5TSU9OIl0gPSA3XSA9ICJVUENfRUFOX0VYVEVOU0lPTiI7CgkgICAgLyoqCgkgICAgICogUERGNDE3LXNwZWNpZmljIG1ldGFkYXRhCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiUERGNDE3X0VYVFJBX01FVEFEQVRBIl0gPSA4XSA9ICJQREY0MTdfRVhUUkFfTUVUQURBVEEiOwoJICAgIC8qKgoJICAgICAqIElmIHRoZSBjb2RlIGZvcm1hdCBzdXBwb3J0cyBzdHJ1Y3R1cmVkIGFwcGVuZCBhbmQgdGhlIGN1cnJlbnQgc2Nhbm5lZCBjb2RlIGlzIHBhcnQgb2Ygb25lIHRoZW4gdGhlCgkgICAgICogc2VxdWVuY2UgbnVtYmVyIGlzIGdpdmVuIHdpdGggaXQuCgkgICAgICovCgkgICAgUmVzdWx0TWV0YWRhdGFUeXBlW1Jlc3VsdE1ldGFkYXRhVHlwZVsiU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UiXSA9IDldID0gIlNUUlVDVFVSRURfQVBQRU5EX1NFUVVFTkNFIjsKCSAgICAvKioKCSAgICAgKiBJZiB0aGUgY29kZSBmb3JtYXQgc3VwcG9ydHMgc3RydWN0dXJlZCBhcHBlbmQgYW5kIHRoZSBjdXJyZW50IHNjYW5uZWQgY29kZSBpcyBwYXJ0IG9mIG9uZSB0aGVuIHRoZQoJICAgICAqIHBhcml0eSBpcyBnaXZlbiB3aXRoIGl0LgoJICAgICAqLwoJICAgIFJlc3VsdE1ldGFkYXRhVHlwZVtSZXN1bHRNZXRhZGF0YVR5cGVbIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSJdID0gMTBdID0gIlNUUlVDVFVSRURfQVBQRU5EX1BBUklUWSI7Cgl9KShSZXN1bHRNZXRhZGF0YVR5cGUgfHwgKFJlc3VsdE1ldGFkYXRhVHlwZSA9IHt9KSk7CglSZXN1bHRNZXRhZGF0YVR5cGUkMS5kZWZhdWx0ID0gUmVzdWx0TWV0YWRhdGFUeXBlOwoKCXZhciBEZWNvZGVyJDEgPSB7fTsKCgl2YXIgQ2hlY2tzdW1FeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkOCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShDaGVja3N1bUV4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkNCA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBDaGVja3N1bUV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkOChDaGVja3N1bUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBDaGVja3N1bUV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5nZXRDaGVja3N1bUluc3RhbmNlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gbmV3IENoZWNrc3VtRXhjZXB0aW9uKCk7CgkgICAgfTsKCSAgICBDaGVja3N1bUV4Y2VwdGlvbi5raW5kID0gJ0NoZWNrc3VtRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQ2hlY2tzdW1FeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCkpOwoJQ2hlY2tzdW1FeGNlcHRpb24kMS5kZWZhdWx0ID0gQ2hlY2tzdW1FeGNlcHRpb247CgoJdmFyIEdlbmVyaWNHRiQxID0ge307CgoJdmFyIEdlbmVyaWNHRlBvbHkkMSA9IHt9OwoKCXZhciBBYnN0cmFjdEdlbmVyaWNHRiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYnN0cmFjdEdlbmVyaWNHRiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGNvbnRhaW5zIHV0aWxpdHkgbWV0aG9kcyBmb3IgcGVyZm9ybWluZyBtYXRoZW1hdGljYWwgb3BlcmF0aW9ucyBvdmVyCgkgKiB0aGUgR2Fsb2lzIEZpZWxkcy4gT3BlcmF0aW9ucyB1c2UgYSBnaXZlbiBwcmltaXRpdmUgcG9seW5vbWlhbCBpbiBjYWxjdWxhdGlvbnMuPC9wPgoJICoKCSAqIDxwPlRocm91Z2hvdXQgdGhpcyBwYWNrYWdlLCBlbGVtZW50cyBvZiB0aGUgR0YgYXJlIHJlcHJlc2VudGVkIGFzIGFuIHtAY29kZSBpbnR9CgkgKiBmb3IgY29udmVuaWVuY2UgYW5kIHNwZWVkIChidXQgYXQgdGhlIGNvc3Qgb2YgbWVtb3J5KS4KCSAqIDwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICogQGF1dGhvciBEYXZpZCBPbGl2aWVyCgkgKi8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBBYnN0cmFjdEdlbmVyaWNHRigpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiAyIHRvIHRoZSBwb3dlciBvZiBhIGluIEdGKHNpemUpCgkgICAgICovCgkgICAgQWJzdHJhY3RHZW5lcmljR0YucHJvdG90eXBlLmV4cCA9IGZ1bmN0aW9uIChhKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmV4cFRhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBiYXNlIDIgbG9nIG9mIGEgaW4gR0Yoc2l6ZSkKCSAgICAgKi8KCSAgICBBYnN0cmFjdEdlbmVyaWNHRi5wcm90b3R5cGUubG9nID0gZnVuY3Rpb24gKGEgLyppbnQqLykgewoJICAgICAgICBpZiAoYSA9PT0gMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDUuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiB0aGlzLmxvZ1RhYmxlW2FdOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogSW1wbGVtZW50cyBib3RoIGFkZGl0aW9uIGFuZCBzdWJ0cmFjdGlvbiAtLSB0aGV5IGFyZSB0aGUgc2FtZSBpbiBHRihzaXplKS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gc3VtL2RpZmZlcmVuY2Ugb2YgYSBhbmQgYgoJICAgICAqLwoJICAgIEFic3RyYWN0R2VuZXJpY0dGLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIGEgXiBiOwoJICAgIH07CgkgICAgcmV0dXJuIEFic3RyYWN0R2VuZXJpY0dGOwoJfSgpKTsKCUFic3RyYWN0R2VuZXJpY0dGJDEuZGVmYXVsdCA9IEFic3RyYWN0R2VuZXJpY0dGOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGUG9seSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5yZWVkc29sb21vbiB7Ki8KCXZhciBBYnN0cmFjdEdlbmVyaWNHRl8xJDEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIFN5c3RlbV8xID0gU3lzdGVtJDE7Cgl2YXIgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNCA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5SZXByZXNlbnRzIGEgcG9seW5vbWlhbCB3aG9zZSBjb2VmZmljaWVudHMgYXJlIGVsZW1lbnRzIG9mIGEgR0YuCgkgKiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBhcmUgaW1tdXRhYmxlLjwvcD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdlbmVyaWNHRlBvbHkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGZpZWxkIHRoZSB7QGxpbmsgR2VuZXJpY0dGfSBpbnN0YW5jZSByZXByZXNlbnRpbmcgdGhlIGZpZWxkIHRvIHVzZQoJICAgICAqIHRvIHBlcmZvcm0gY29tcHV0YXRpb25zCgkgICAgICogQHBhcmFtIGNvZWZmaWNpZW50cyBjb2VmZmljaWVudHMgYXMgaW50cyByZXByZXNlbnRpbmcgZWxlbWVudHMgb2YgR0Yoc2l6ZSksIGFycmFuZ2VkCgkgICAgICogZnJvbSBtb3N0IHNpZ25pZmljYW50IChoaWdoZXN0LXBvd2VyIHRlcm0pIGNvZWZmaWNpZW50IHRvIGxlYXN0IHNpZ25pZmljYW50CgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYXJndW1lbnQgaXMgbnVsbCBvciBlbXB0eSwKCSAgICAgKiBvciBpZiBsZWFkaW5nIGNvZWZmaWNpZW50IGlzIDAgYW5kIHRoaXMgaXMgbm90IGEKCSAgICAgKiBjb25zdGFudCBwb2x5bm9taWFsICh0aGF0IGlzLCBpdCBpcyBub3QgdGhlIG1vbm9taWFsICIwIikKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBHZW5lcmljR0ZQb2x5KGZpZWxkLCBjb2VmZmljaWVudHMpIHsKCSAgICAgICAgaWYgKGNvZWZmaWNpZW50cy5sZW5ndGggPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHNMZW5ndGggPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICBpZiAoY29lZmZpY2llbnRzTGVuZ3RoID4gMSAmJiBjb2VmZmljaWVudHNbMF0gPT09IDApIHsKCSAgICAgICAgICAgIC8vIExlYWRpbmcgdGVybSBtdXN0IGJlIG5vbi16ZXJvIGZvciBhbnl0aGluZyBleGNlcHQgdGhlIGNvbnN0YW50IHBvbHlub21pYWwgIjAiCgkgICAgICAgICAgICB2YXIgZmlyc3ROb25aZXJvID0gMTsKCSAgICAgICAgICAgIHdoaWxlIChmaXJzdE5vblplcm8gPCBjb2VmZmljaWVudHNMZW5ndGggJiYgY29lZmZpY2llbnRzW2ZpcnN0Tm9uWmVyb10gPT09IDApIHsKCSAgICAgICAgICAgICAgICBmaXJzdE5vblplcm8rKzsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmIChmaXJzdE5vblplcm8gPT09IGNvZWZmaWNpZW50c0xlbmd0aCkgewoJICAgICAgICAgICAgICAgIHRoaXMuY29lZmZpY2llbnRzID0gSW50MzJBcnJheS5mcm9tKFswXSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICB0aGlzLmNvZWZmaWNpZW50cyA9IG5ldyBJbnQzMkFycmF5KGNvZWZmaWNpZW50c0xlbmd0aCAtIGZpcnN0Tm9uWmVybyk7CgkgICAgICAgICAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkoY29lZmZpY2llbnRzLCBmaXJzdE5vblplcm8sIHRoaXMuY29lZmZpY2llbnRzLCAwLCB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGgpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdGhpcy5jb2VmZmljaWVudHMgPSBjb2VmZmljaWVudHM7CgkgICAgICAgIH0KCSAgICB9CgkgICAgR2VuZXJpY0dGUG9seS5wcm90b3R5cGUuZ2V0Q29lZmZpY2llbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGRlZ3JlZSBvZiB0aGlzIHBvbHlub21pYWwKCSAgICAgKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5nZXREZWdyZWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGlzIHBvbHlub21pYWwgaXMgdGhlIG1vbm9taWFsICIwIgoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmlzWmVybyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29lZmZpY2llbnRzWzBdID09PSAwOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBjb2VmZmljaWVudCBvZiB4XmRlZ3JlZSB0ZXJtIGluIHRoaXMgcG9seW5vbWlhbAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmdldENvZWZmaWNpZW50ID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvZWZmaWNpZW50c1t0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGggLSAxIC0gZGVncmVlXTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gZXZhbHVhdGlvbiBvZiB0aGlzIHBvbHlub21pYWwgYXQgYSBnaXZlbiBwb2ludAoJICAgICAqLwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmV2YWx1YXRlQXQgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHJldHVybiB0aGUgeF4wIGNvZWZmaWNpZW50CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgY29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciByZXN1bHQ7CgkgICAgICAgIGlmIChhID09PSAxKSB7CgkgICAgICAgICAgICAvLyBKdXN0IHRoZSBzdW0gb2YgdGhlIGNvZWZmaWNpZW50cwoJICAgICAgICAgICAgcmVzdWx0ID0gMDsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBsZW5ndGhfMSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7IGkgIT09IGxlbmd0aF8xOyBpKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgY29lZmZpY2llbnQgPSBjb2VmZmljaWVudHNbaV07CgkgICAgICAgICAgICAgICAgcmVzdWx0ID0gQWJzdHJhY3RHZW5lcmljR0ZfMSQxLmRlZmF1bHQuYWRkT3JTdWJ0cmFjdChyZXN1bHQsIGNvZWZmaWNpZW50KTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgICAgIH0KCSAgICAgICAgcmVzdWx0ID0gY29lZmZpY2llbnRzWzBdOwoJICAgICAgICB2YXIgc2l6ZSA9IGNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgc2l6ZTsgaSsrKSB7CgkgICAgICAgICAgICByZXN1bHQgPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KGZpZWxkLm11bHRpcGx5KGEsIHJlc3VsdCksIGNvZWZmaWNpZW50c1tpXSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLmFkZE9yU3VidHJhY3QgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRoaXMuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiBvdGhlcjsKCSAgICAgICAgfQoJICAgICAgICBpZiAob3RoZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzbWFsbGVyQ29lZmZpY2llbnRzID0gdGhpcy5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBsYXJnZXJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIGlmIChzbWFsbGVyQ29lZmZpY2llbnRzLmxlbmd0aCA+IGxhcmdlckNvZWZmaWNpZW50cy5sZW5ndGgpIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gc21hbGxlckNvZWZmaWNpZW50czsKCSAgICAgICAgICAgIHNtYWxsZXJDb2VmZmljaWVudHMgPSBsYXJnZXJDb2VmZmljaWVudHM7CgkgICAgICAgICAgICBsYXJnZXJDb2VmZmljaWVudHMgPSB0ZW1wOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzdW1EaWZmID0gbmV3IEludDMyQXJyYXkobGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCk7CgkgICAgICAgIHZhciBsZW5ndGhEaWZmID0gbGFyZ2VyQ29lZmZpY2llbnRzLmxlbmd0aCAtIHNtYWxsZXJDb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICAvLyBDb3B5IGhpZ2gtb3JkZXIgdGVybXMgb25seSBmb3VuZCBpbiBoaWdoZXItZGVncmVlIHBvbHlub21pYWwncyBjb2VmZmljaWVudHMKCSAgICAgICAgU3lzdGVtXzEuZGVmYXVsdC5hcnJheWNvcHkobGFyZ2VyQ29lZmZpY2llbnRzLCAwLCBzdW1EaWZmLCAwLCBsZW5ndGhEaWZmKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IGxlbmd0aERpZmY7IGkgPCBsYXJnZXJDb2VmZmljaWVudHMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHN1bURpZmZbaV0gPSBBYnN0cmFjdEdlbmVyaWNHRl8xJDEuZGVmYXVsdC5hZGRPclN1YnRyYWN0KHNtYWxsZXJDb2VmZmljaWVudHNbaSAtIGxlbmd0aERpZmZdLCBsYXJnZXJDb2VmZmljaWVudHNbaV0pOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seSh0aGlzLmZpZWxkLCBzdW1EaWZmKTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5ID0gZnVuY3Rpb24gKG90aGVyKSB7CgkgICAgICAgIGlmICghdGhpcy5maWVsZC5lcXVhbHMob3RoZXIuZmllbGQpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdHZW5lcmljR0ZQb2x5cyBkbyBub3QgaGF2ZSBzYW1lIEdlbmVyaWNHRiBmaWVsZCcpOwoJICAgICAgICB9CgkgICAgICAgIGlmICh0aGlzLmlzWmVybygpIHx8IG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGFDb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIGFMZW5ndGggPSBhQ29lZmZpY2llbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGJDb2VmZmljaWVudHMgPSBvdGhlci5jb2VmZmljaWVudHM7CgkgICAgICAgIHZhciBiTGVuZ3RoID0gYkNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoYUxlbmd0aCArIGJMZW5ndGggLSAxKTsKCSAgICAgICAgdmFyIGZpZWxkID0gdGhpcy5maWVsZDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhTGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBhQ29lZmYgPSBhQ29lZmZpY2llbnRzW2ldOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBiTGVuZ3RoOyBqKyspIHsKCSAgICAgICAgICAgICAgICBwcm9kdWN0W2kgKyBqXSA9IEFic3RyYWN0R2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocHJvZHVjdFtpICsgal0sIGZpZWxkLm11bHRpcGx5KGFDb2VmZiwgYkNvZWZmaWNpZW50c1tqXSkpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5tdWx0aXBseVNjYWxhciA9IGZ1bmN0aW9uIChzY2FsYXIgLyppbnQqLykgewoJICAgICAgICBpZiAoc2NhbGFyID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5nZXRaZXJvKCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHNjYWxhciA9PT0gMSkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXM7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHNpemUgPSB0aGlzLmNvZWZmaWNpZW50cy5sZW5ndGg7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBwcm9kdWN0ID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIHByb2R1Y3RbaV0gPSBmaWVsZC5tdWx0aXBseShjb2VmZmljaWVudHNbaV0sIHNjYWxhcik7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBHZW5lcmljR0ZQb2x5KGZpZWxkLCBwcm9kdWN0KTsKCSAgICB9OwoJICAgIEdlbmVyaWNHRlBvbHkucHJvdG90eXBlLm11bHRpcGx5QnlNb25vbWlhbCA9IGZ1bmN0aW9uIChkZWdyZWUgLyppbnQqLywgY29lZmZpY2llbnQgLyppbnQqLykgewoJICAgICAgICBpZiAoZGVncmVlIDwgMCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDQuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChjb2VmZmljaWVudCA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQuZ2V0WmVybygpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSB0aGlzLmNvZWZmaWNpZW50czsKCSAgICAgICAgdmFyIHNpemUgPSBjb2VmZmljaWVudHMubGVuZ3RoOwoJICAgICAgICB2YXIgcHJvZHVjdCA9IG5ldyBJbnQzMkFycmF5KHNpemUgKyBkZWdyZWUpOwoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNpemU7IGkrKykgewoJICAgICAgICAgICAgcHJvZHVjdFtpXSA9IGZpZWxkLm11bHRpcGx5KGNvZWZmaWNpZW50c1tpXSwgY29lZmZpY2llbnQpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seShmaWVsZCwgcHJvZHVjdCk7CgkgICAgfTsKCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS5kaXZpZGUgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKCF0aGlzLmZpZWxkLmVxdWFscyhvdGhlci5maWVsZCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoJ0dlbmVyaWNHRlBvbHlzIGRvIG5vdCBoYXZlIHNhbWUgR2VuZXJpY0dGIGZpZWxkJyk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG90aGVyLmlzWmVybygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkNC5kZWZhdWx0KCdEaXZpZGUgYnkgMCcpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIHZhciBxdW90aWVudCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHJlbWFpbmRlciA9IHRoaXM7CgkgICAgICAgIHZhciBkZW5vbWluYXRvckxlYWRpbmdUZXJtID0gb3RoZXIuZ2V0Q29lZmZpY2llbnQob3RoZXIuZ2V0RGVncmVlKCkpOwoJICAgICAgICB2YXIgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0gPSBmaWVsZC5pbnZlcnNlKGRlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICB3aGlsZSAocmVtYWluZGVyLmdldERlZ3JlZSgpID49IG90aGVyLmdldERlZ3JlZSgpICYmICFyZW1haW5kZXIuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgIHZhciBkZWdyZWVEaWZmZXJlbmNlID0gcmVtYWluZGVyLmdldERlZ3JlZSgpIC0gb3RoZXIuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICB2YXIgc2NhbGUgPSBmaWVsZC5tdWx0aXBseShyZW1haW5kZXIuZ2V0Q29lZmZpY2llbnQocmVtYWluZGVyLmdldERlZ3JlZSgpKSwgaW52ZXJzZURlbm9taW5hdG9yTGVhZGluZ1Rlcm0pOwoJICAgICAgICAgICAgdmFyIHRlcm0gPSBvdGhlci5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZmVyZW5jZSwgc2NhbGUpOwoJICAgICAgICAgICAgdmFyIGl0ZXJhdGlvblF1b3RpZW50ID0gZmllbGQuYnVpbGRNb25vbWlhbChkZWdyZWVEaWZmZXJlbmNlLCBzY2FsZSk7CgkgICAgICAgICAgICBxdW90aWVudCA9IHF1b3RpZW50LmFkZE9yU3VidHJhY3QoaXRlcmF0aW9uUXVvdGllbnQpOwoJICAgICAgICAgICAgcmVtYWluZGVyID0gcmVtYWluZGVyLmFkZE9yU3VidHJhY3QodGVybSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFtxdW90aWVudCwgcmVtYWluZGVyXTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBHZW5lcmljR0ZQb2x5LnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIHJlc3VsdCA9ICcnOwoJICAgICAgICBmb3IgKHZhciBkZWdyZWUgPSB0aGlzLmdldERlZ3JlZSgpOyBkZWdyZWUgPj0gMDsgZGVncmVlLS0pIHsKCSAgICAgICAgICAgIHZhciBjb2VmZmljaWVudCA9IHRoaXMuZ2V0Q29lZmZpY2llbnQoZGVncmVlKTsKCSAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIGlmIChjb2VmZmljaWVudCA8IDApIHsKCSAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgLSAnOwoJICAgICAgICAgICAgICAgICAgICBjb2VmZmljaWVudCA9IC1jb2VmZmljaWVudDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICcgKyAnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgPT09IDAgfHwgY29lZmZpY2llbnQgIT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGFscGhhUG93ZXIgPSB0aGlzLmZpZWxkLmxvZyhjb2VmZmljaWVudCk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChhbHBoYVBvd2VyID09PSAwKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJzEnOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFscGhhUG93ZXIgPT09IDEpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAnYSc7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgKz0gJ2FeJzsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSBhbHBoYVBvd2VyOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGlmIChkZWdyZWUgIT09IDApIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKGRlZ3JlZSA9PT0gMSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9ICd4JzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCArPSAneF4nOwoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0ICs9IGRlZ3JlZTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIEdlbmVyaWNHRlBvbHk7Cgl9KCkpOwoJR2VuZXJpY0dGUG9seSQxLmRlZmF1bHQgPSBHZW5lcmljR0ZQb2x5OwoKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDcgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgRXhjZXB0aW9uXzEkMyA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcml0aG1ldGljRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ3KEFyaXRobWV0aWNFeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gQXJpdGhtZXRpY0V4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcml0aG1ldGljRXhjZXB0aW9uLmtpbmQgPSAnQXJpdGhtZXRpY0V4Y2VwdGlvbic7CgkgICAgcmV0dXJuIEFyaXRobWV0aWNFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCkpOwoJQXJpdGhtZXRpY0V4Y2VwdGlvbiQxLmRlZmF1bHQgPSBBcml0aG1ldGljRXhjZXB0aW9uOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoR2VuZXJpY0dGJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uLnJlZWRzb2xvbW9uIHsqLwoJdmFyIEdlbmVyaWNHRlBvbHlfMSQxID0gR2VuZXJpY0dGUG9seSQxOwoJdmFyIEFic3RyYWN0R2VuZXJpY0dGXzEgPSBBYnN0cmFjdEdlbmVyaWNHRiQxOwoJdmFyIEludGVnZXJfMSQxID0gSW50ZWdlciQxOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDMgPSBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBBcml0aG1ldGljRXhjZXB0aW9uXzEgPSBBcml0aG1ldGljRXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgY29udGFpbnMgdXRpbGl0eSBtZXRob2RzIGZvciBwZXJmb3JtaW5nIG1hdGhlbWF0aWNhbCBvcGVyYXRpb25zIG92ZXIKCSAqIHRoZSBHYWxvaXMgRmllbGRzLiBPcGVyYXRpb25zIHVzZSBhIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsIGluIGNhbGN1bGF0aW9ucy48L3A+CgkgKgoJICogPHA+VGhyb3VnaG91dCB0aGlzIHBhY2thZ2UsIGVsZW1lbnRzIG9mIHRoZSBHRiBhcmUgcmVwcmVzZW50ZWQgYXMgYW4ge0Bjb2RlIGludH0KCSAqIGZvciBjb252ZW5pZW5jZSBhbmQgc3BlZWQgKGJ1dCBhdCB0aGUgY29zdCBvZiBtZW1vcnkpLgoJICogPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKiBAYXV0aG9yIERhdmlkIE9saXZpZXIKCSAqLwoJdmFyIEdlbmVyaWNHRiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkNihHZW5lcmljR0YsIF9zdXBlcik7CgkgICAgLyoqCgkgICAgICogQ3JlYXRlIGEgcmVwcmVzZW50YXRpb24gb2YgR0Yoc2l6ZSkgdXNpbmcgdGhlIGdpdmVuIHByaW1pdGl2ZSBwb2x5bm9taWFsLgoJICAgICAqCgkgICAgICogQHBhcmFtIHByaW1pdGl2ZSBpcnJlZHVjaWJsZSBwb2x5bm9taWFsIHdob3NlIGNvZWZmaWNpZW50cyBhcmUgcmVwcmVzZW50ZWQgYnkKCSAgICAgKiAgdGhlIGJpdHMgb2YgYW4gaW50LCB3aGVyZSB0aGUgbGVhc3Qtc2lnbmlmaWNhbnQgYml0IHJlcHJlc2VudHMgdGhlIGNvbnN0YW50CgkgICAgICogIGNvZWZmaWNpZW50CgkgICAgICogQHBhcmFtIHNpemUgdGhlIHNpemUgb2YgdGhlIGZpZWxkCgkgICAgICogQHBhcmFtIGIgdGhlIGZhY3RvciBiIGluIHRoZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBjYW4gYmUgMC0gb3IgMS1iYXNlZAoJICAgICAqICAoZyh4KSA9ICh4K2FeYikoeCthXihiKzEpKS4uLih4K2FeKGIrMnQtMSkpKS4KCSAgICAgKiAgSW4gbW9zdCBjYXNlcyBpdCBzaG91bGQgYmUgMSwgYnV0IGZvciBRUiBjb2RlIGl0IGlzIDAuCgkgICAgICovCgkgICAgZnVuY3Rpb24gR2VuZXJpY0dGKHByaW1pdGl2ZSAvKmludCovLCBzaXplIC8qaW50Ki8sIGdlbmVyYXRvckJhc2UgLyppbnQqLykgewoJICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzKSB8fCB0aGlzOwoJICAgICAgICBfdGhpcy5wcmltaXRpdmUgPSBwcmltaXRpdmU7CgkgICAgICAgIF90aGlzLnNpemUgPSBzaXplOwoJICAgICAgICBfdGhpcy5nZW5lcmF0b3JCYXNlID0gZ2VuZXJhdG9yQmFzZTsKCSAgICAgICAgdmFyIGV4cFRhYmxlID0gbmV3IEludDMyQXJyYXkoc2l6ZSk7CgkgICAgICAgIHZhciB4ID0gMTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplOyBpKyspIHsKCSAgICAgICAgICAgIGV4cFRhYmxlW2ldID0geDsKCSAgICAgICAgICAgIHggKj0gMjsgLy8gd2UncmUgYXNzdW1pbmcgdGhlIGdlbmVyYXRvciBhbHBoYSBpcyAyCgkgICAgICAgICAgICBpZiAoeCA+PSBzaXplKSB7CgkgICAgICAgICAgICAgICAgeCBePSBwcmltaXRpdmU7CgkgICAgICAgICAgICAgICAgeCAmPSBzaXplIC0gMTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBfdGhpcy5leHBUYWJsZSA9IGV4cFRhYmxlOwoJICAgICAgICB2YXIgbG9nVGFibGUgPSBuZXcgSW50MzJBcnJheShzaXplKTsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzaXplIC0gMTsgaSsrKSB7CgkgICAgICAgICAgICBsb2dUYWJsZVtleHBUYWJsZVtpXV0gPSBpOwoJICAgICAgICB9CgkgICAgICAgIF90aGlzLmxvZ1RhYmxlID0gbG9nVGFibGU7CgkgICAgICAgIC8vIGxvZ1RhYmxlWzBdID09IDAgYnV0IHRoaXMgc2hvdWxkIG5ldmVyIGJlIHVzZWQKCSAgICAgICAgX3RoaXMuemVybyA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzBdKSk7CgkgICAgICAgIF90aGlzLm9uZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEkMS5kZWZhdWx0KF90aGlzLCBJbnQzMkFycmF5LmZyb20oWzFdKSk7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRaZXJvID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5nZXRPbmUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm9uZTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdGhlIG1vbm9taWFsIHJlcHJlc2VudGluZyBjb2VmZmljaWVudCAqIHheZGVncmVlCgkgICAgICovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5idWlsZE1vbm9taWFsID0gZnVuY3Rpb24gKGRlZ3JlZSAvKmludCovLCBjb2VmZmljaWVudCAvKmludCovKSB7CgkgICAgICAgIGlmIChkZWdyZWUgPCAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uXzEkMy5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvZWZmaWNpZW50ID09PSAwKSB7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy56ZXJvOwoJICAgICAgICB9CgkgICAgICAgIHZhciBjb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheShkZWdyZWUgKyAxKTsKCSAgICAgICAgY29lZmZpY2llbnRzWzBdID0gY29lZmZpY2llbnQ7CgkgICAgICAgIHJldHVybiBuZXcgR2VuZXJpY0dGUG9seV8xJDEuZGVmYXVsdCh0aGlzLCBjb2VmZmljaWVudHMpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBtdWx0aXBsaWNhdGl2ZSBpbnZlcnNlIG9mIGEKCSAgICAgKi8KCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmludmVyc2UgPSBmdW5jdGlvbiAoYSAvKmludCovKSB7CgkgICAgICAgIGlmIChhID09PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQXJpdGhtZXRpY0V4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5leHBUYWJsZVt0aGlzLnNpemUgLSB0aGlzLmxvZ1RhYmxlW2FdIC0gMV07CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHByb2R1Y3Qgb2YgYSBhbmQgYiBpbiBHRihzaXplKQoJICAgICAqLwoJICAgIEdlbmVyaWNHRi5wcm90b3R5cGUubXVsdGlwbHkgPSBmdW5jdGlvbiAoYSAvKmludCovLCBiIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGEgPT09IDAgfHwgYiA9PT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIDA7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZXhwVGFibGVbKHRoaXMubG9nVGFibGVbYV0gKyB0aGlzLmxvZ1RhYmxlW2JdKSAlICh0aGlzLnNpemUgLSAxKV07CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldFNpemUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnNpemU7CgkgICAgfTsKCSAgICBHZW5lcmljR0YucHJvdG90eXBlLmdldEdlbmVyYXRvckJhc2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmdlbmVyYXRvckJhc2U7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICgnR0YoMHgnICsgSW50ZWdlcl8xJDEuZGVmYXVsdC50b0hleFN0cmluZyh0aGlzLnByaW1pdGl2ZSkgKyAnLCcgKyB0aGlzLnNpemUgKyAnKScpOwoJICAgIH07CgkgICAgR2VuZXJpY0dGLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICByZXR1cm4gbyA9PT0gdGhpczsKCSAgICB9OwoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEyID0gbmV3IEdlbmVyaWNHRigweDEwNjksIDQwOTYsIDEpOyAvLyB4XjEyICsgeF42ICsgeF41ICsgeF4zICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19EQVRBXzEwID0gbmV3IEdlbmVyaWNHRigweDQwOSwgMTAyNCwgMSk7IC8vIHheMTAgKyB4XjMgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfNiA9IG5ldyBHZW5lcmljR0YoMHg0MywgNjQsIDEpOyAvLyB4XjYgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5BWlRFQ19QQVJBTSA9IG5ldyBHZW5lcmljR0YoMHgxMywgMTYsIDEpOyAvLyB4XjQgKyB4ICsgMQoJICAgIEdlbmVyaWNHRi5RUl9DT0RFX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTFkLCAyNTYsIDApOyAvLyB4XjggKyB4XjQgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkRBVEFfTUFUUklYX0ZJRUxEXzI1NiA9IG5ldyBHZW5lcmljR0YoMHgwMTJkLCAyNTYsIDEpOyAvLyB4XjggKyB4XjUgKyB4XjMgKyB4XjIgKyAxCgkgICAgR2VuZXJpY0dGLkFaVEVDX0RBVEFfOCA9IEdlbmVyaWNHRi5EQVRBX01BVFJJWF9GSUVMRF8yNTY7CgkgICAgR2VuZXJpY0dGLk1BWElDT0RFX0ZJRUxEXzY0ID0gR2VuZXJpY0dGLkFaVEVDX0RBVEFfNjsKCSAgICByZXR1cm4gR2VuZXJpY0dGOwoJfShBYnN0cmFjdEdlbmVyaWNHRl8xLmRlZmF1bHQpKTsKCUdlbmVyaWNHRiQxLmRlZmF1bHQgPSBHZW5lcmljR0Y7CgoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciQxID0ge307CgoJdmFyIFJlZWRTb2xvbW9uRXhjZXB0aW9uJDEgPSB7fTsKCgl2YXIgX19leHRlbmRzJDUgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVlZFNvbG9tb25FeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDIgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgUmVlZFNvbG9tb25FeGNlcHRpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDUoUmVlZFNvbG9tb25FeGNlcHRpb24sIF9zdXBlcik7CgkgICAgZnVuY3Rpb24gUmVlZFNvbG9tb25FeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgUmVlZFNvbG9tb25FeGNlcHRpb24ua2luZCA9ICdSZWVkU29sb21vbkV4Y2VwdGlvbic7CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQyLmRlZmF1bHQpKTsKCVJlZWRTb2xvbW9uRXhjZXB0aW9uJDEuZGVmYXVsdCA9IFJlZWRTb2xvbW9uRXhjZXB0aW9uOwoKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSA9IHt9OwoKCXZhciBfX2V4dGVuZHMkNCA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7CgkgICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8CgkgICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8CgkgICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsgfTsKCSAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgfTsKCSAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9CgkgICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTsKCSAgICB9OwoJfSkoKTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbGxlZ2FsU3RhdGVFeGNlcHRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIEV4Y2VwdGlvbl8xJDEgPSBFeGNlcHRpb24kMTsKCS8qKgoJICogQ3VzdG9tIEVycm9yIGNsYXNzIG9mIHR5cGUgRXhjZXB0aW9uLgoJICovCgl2YXIgSWxsZWdhbFN0YXRlRXhjZXB0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyQ0KElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBJbGxlZ2FsU3RhdGVFeGNlcHRpb24oKSB7CgkgICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpczsKCSAgICB9CgkgICAgSWxsZWdhbFN0YXRlRXhjZXB0aW9uLmtpbmQgPSAnSWxsZWdhbFN0YXRlRXhjZXB0aW9uJzsKCSAgICByZXR1cm4gSWxsZWdhbFN0YXRlRXhjZXB0aW9uOwoJfShFeGNlcHRpb25fMSQxLmRlZmF1bHQpKTsKCUlsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxLmRlZmF1bHQgPSBJbGxlZ2FsU3RhdGVFeGNlcHRpb247CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShSZWVkU29sb21vbkRlY29kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5jb21tb24ucmVlZHNvbG9tb24geyovCgl2YXIgR2VuZXJpY0dGXzEkMSA9IEdlbmVyaWNHRiQxOwoJdmFyIEdlbmVyaWNHRlBvbHlfMSA9IEdlbmVyaWNHRlBvbHkkMTsKCXZhciBSZWVkU29sb21vbkV4Y2VwdGlvbl8xID0gUmVlZFNvbG9tb25FeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMSA9IElsbGVnYWxTdGF0ZUV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5JbXBsZW1lbnRzIFJlZWQtU29sb21vbiBkZWNvZGluZywgYXMgdGhlIG5hbWUgaW1wbGllcy48L3A+CgkgKgoJICogPHA+VGhlIGFsZ29yaXRobSB3aWxsIG5vdCBiZSBleHBsYWluZWQgaGVyZSwgYnV0IHRoZSBmb2xsb3dpbmcgcmVmZXJlbmNlcyB3ZXJlIGhlbHBmdWwKCSAqIGluIGNyZWF0aW5nIHRoaXMgaW1wbGVtZW50YXRpb246PC9wPgoJICoKCSAqIDx1bD4KCSAqIDxsaT5CcnVjZSBNYWdncy4KCSAqIDxhIGhyZWY9Imh0dHA6Ly93d3cuY3MuY211LmVkdS9hZnMvY3MuY211LmVkdS9wcm9qZWN0L3BzY2ljby1ndXliL3JlYWx3b3JsZC93d3cvcnNfZGVjb2RlLnBzIj4KCSAqICJEZWNvZGluZyBSZWVkLVNvbG9tb24gQ29kZXMiPC9hPiAoc2VlIGRpc2N1c3Npb24gb2YgRm9ybmV5J3MgRm9ybXVsYSk8L2xpPgoJICogPGxpPkouSS4gSGFsbC4gPGEgaHJlZj0id3d3Lm10aC5tc3UuZWR1L35qaGFsbC9jbGFzc2VzL2NvZGVub3Rlcy9HUlMucGRmIj4KCSAqICJDaGFwdGVyIDUuIEdlbmVyYWxpemVkIFJlZWQtU29sb21vbiBDb2RlcyI8L2E+CgkgKiAoc2VlIGRpc2N1c3Npb24gb2YgRXVjbGlkZWFuIGFsZ29yaXRobSk8L2xpPgoJICogPC91bD4KCSAqCgkgKiA8cD5NdWNoIGNyZWRpdCBpcyBkdWUgdG8gV2lsbGlhbSBSdWNrbGlkZ2Ugc2luY2UgcG9ydGlvbnMgb2YgdGhpcyBjb2RlIGFyZSBhbiBpbmRpcmVjdAoJICogcG9ydCBvZiBoaXMgQysrIFJlZWQtU29sb21vbiBpbXBsZW1lbnRhdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBhdXRob3IgV2lsbGlhbSBSdWNrbGlkZ2UKCSAqIEBhdXRob3Igc2FuZm9yZHNxdWlyZXMKCSAqLwoJdmFyIFJlZWRTb2xvbW9uRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBSZWVkU29sb21vbkRlY29kZXIoZmllbGQpIHsKCSAgICAgICAgdGhpcy5maWVsZCA9IGZpZWxkOwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5EZWNvZGVzIGdpdmVuIHNldCBvZiByZWNlaXZlZCBjb2Rld29yZHMsIHdoaWNoIGluY2x1ZGUgYm90aCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uCgkgICAgICogY29kZXdvcmRzLiBSZWFsbHksIHRoaXMgbWVhbnMgaXQgdXNlcyBSZWVkLVNvbG9tb24gdG8gZGV0ZWN0IGFuZCBjb3JyZWN0IGVycm9ycywgaW4tcGxhY2UsCgkgICAgICogaW4gdGhlIGlucHV0LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByZWNlaXZlZCBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcwoJICAgICAqIEBwYXJhbSB0d29TIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBhdmFpbGFibGUKCSAgICAgKiBAdGhyb3dzIFJlZWRTb2xvbW9uRXhjZXB0aW9uIGlmIGRlY29kaW5nIGZhaWxzIGZvciBhbnkgcmVhc29uCgkgICAgICovCgkgICAgUmVlZFNvbG9tb25EZWNvZGVyLnByb3RvdHlwZS5kZWNvZGUgPSBmdW5jdGlvbiAocmVjZWl2ZWQsIHR3b1MgLyppbnQqLykgewoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgcG9seSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgcmVjZWl2ZWQpOwoJICAgICAgICB2YXIgc3luZHJvbWVDb2VmZmljaWVudHMgPSBuZXcgSW50MzJBcnJheSh0d29TKTsKCSAgICAgICAgdmFyIG5vRXJyb3IgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHR3b1M7IGkrKykgewoJICAgICAgICAgICAgdmFyIGV2YWxSZXN1bHQgPSBwb2x5LmV2YWx1YXRlQXQoZmllbGQuZXhwKGkgKyBmaWVsZC5nZXRHZW5lcmF0b3JCYXNlKCkpKTsKCSAgICAgICAgICAgIHN5bmRyb21lQ29lZmZpY2llbnRzW3N5bmRyb21lQ29lZmZpY2llbnRzLmxlbmd0aCAtIDEgLSBpXSA9IGV2YWxSZXN1bHQ7CgkgICAgICAgICAgICBpZiAoZXZhbFJlc3VsdCAhPT0gMCkgewoJICAgICAgICAgICAgICAgIG5vRXJyb3IgPSBmYWxzZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBpZiAobm9FcnJvcikgewoJICAgICAgICAgICAgcmV0dXJuOwoJICAgICAgICB9CgkgICAgICAgIHZhciBzeW5kcm9tZSA9IG5ldyBHZW5lcmljR0ZQb2x5XzEuZGVmYXVsdChmaWVsZCwgc3luZHJvbWVDb2VmZmljaWVudHMpOwoJICAgICAgICB2YXIgc2lnbWFPbWVnYSA9IHRoaXMucnVuRXVjbGlkZWFuQWxnb3JpdGhtKGZpZWxkLmJ1aWxkTW9ub21pYWwodHdvUywgMSksIHN5bmRyb21lLCB0d29TKTsKCSAgICAgICAgdmFyIHNpZ21hID0gc2lnbWFPbWVnYVswXTsKCSAgICAgICAgdmFyIG9tZWdhID0gc2lnbWFPbWVnYVsxXTsKCSAgICAgICAgdmFyIGVycm9yTG9jYXRpb25zID0gdGhpcy5maW5kRXJyb3JMb2NhdGlvbnMoc2lnbWEpOwoJICAgICAgICB2YXIgZXJyb3JNYWduaXR1ZGVzID0gdGhpcy5maW5kRXJyb3JNYWduaXR1ZGVzKG9tZWdhLCBlcnJvckxvY2F0aW9ucyk7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXJyb3JMb2NhdGlvbnMubGVuZ3RoOyBpKyspIHsKCSAgICAgICAgICAgIHZhciBwb3NpdGlvbiA9IHJlY2VpdmVkLmxlbmd0aCAtIDEgLSBmaWVsZC5sb2coZXJyb3JMb2NhdGlvbnNbaV0pOwoJICAgICAgICAgICAgaWYgKHBvc2l0aW9uIDwgMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ0JhZCBlcnJvciBsb2NhdGlvbicpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVjZWl2ZWRbcG9zaXRpb25dID0gR2VuZXJpY0dGXzEkMS5kZWZhdWx0LmFkZE9yU3VidHJhY3QocmVjZWl2ZWRbcG9zaXRpb25dLCBlcnJvck1hZ25pdHVkZXNbaV0pOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBSZWVkU29sb21vbkRlY29kZXIucHJvdG90eXBlLnJ1bkV1Y2xpZGVhbkFsZ29yaXRobSA9IGZ1bmN0aW9uIChhLCBiLCBSIC8qaW50Ki8pIHsKCSAgICAgICAgLy8gQXNzdW1lIGEncyBkZWdyZWUgaXMgPj0gYidzCgkgICAgICAgIGlmIChhLmdldERlZ3JlZSgpIDwgYi5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgdmFyIHRlbXAgPSBhOwoJICAgICAgICAgICAgYSA9IGI7CgkgICAgICAgICAgICBiID0gdGVtcDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmllbGQgPSB0aGlzLmZpZWxkOwoJICAgICAgICB2YXIgckxhc3QgPSBhOwoJICAgICAgICB2YXIgciA9IGI7CgkgICAgICAgIHZhciB0TGFzdCA9IGZpZWxkLmdldFplcm8oKTsKCSAgICAgICAgdmFyIHQgPSBmaWVsZC5nZXRPbmUoKTsKCSAgICAgICAgLy8gUnVuIEV1Y2xpZGVhbiBhbGdvcml0aG0gdW50aWwgcidzIGRlZ3JlZSBpcyBsZXNzIHRoYW4gUi8yCgkgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IChSIC8gMiB8IDApKSB7CgkgICAgICAgICAgICB2YXIgckxhc3RMYXN0ID0gckxhc3Q7CgkgICAgICAgICAgICB2YXIgdExhc3RMYXN0ID0gdExhc3Q7CgkgICAgICAgICAgICByTGFzdCA9IHI7CgkgICAgICAgICAgICB0TGFzdCA9IHQ7CgkgICAgICAgICAgICAvLyBEaXZpZGUgckxhc3RMYXN0IGJ5IHJMYXN0LCB3aXRoIHF1b3RpZW50IGluIHEgYW5kIHJlbWFpbmRlciBpbiByCgkgICAgICAgICAgICBpZiAockxhc3QuaXNaZXJvKCkpIHsKCSAgICAgICAgICAgICAgICAvLyBPb3BzLCBFdWNsaWRlYW4gYWxnb3JpdGhtIGFscmVhZHkgdGVybWluYXRlZD8KCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgUmVlZFNvbG9tb25FeGNlcHRpb25fMS5kZWZhdWx0KCdyX3tpLTF9IHdhcyB6ZXJvJyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByID0gckxhc3RMYXN0OwoJICAgICAgICAgICAgdmFyIHEgPSBmaWVsZC5nZXRaZXJvKCk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3JMZWFkaW5nVGVybSA9IHJMYXN0LmdldENvZWZmaWNpZW50KHJMYXN0LmdldERlZ3JlZSgpKTsKCSAgICAgICAgICAgIHZhciBkbHRJbnZlcnNlID0gZmllbGQuaW52ZXJzZShkZW5vbWluYXRvckxlYWRpbmdUZXJtKTsKCSAgICAgICAgICAgIHdoaWxlIChyLmdldERlZ3JlZSgpID49IHJMYXN0LmdldERlZ3JlZSgpICYmICFyLmlzWmVybygpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlZ3JlZURpZmYgPSByLmdldERlZ3JlZSgpIC0gckxhc3QuZ2V0RGVncmVlKCk7CgkgICAgICAgICAgICAgICAgdmFyIHNjYWxlID0gZmllbGQubXVsdGlwbHkoci5nZXRDb2VmZmljaWVudChyLmdldERlZ3JlZSgpKSwgZGx0SW52ZXJzZSk7CgkgICAgICAgICAgICAgICAgcSA9IHEuYWRkT3JTdWJ0cmFjdChmaWVsZC5idWlsZE1vbm9taWFsKGRlZ3JlZURpZmYsIHNjYWxlKSk7CgkgICAgICAgICAgICAgICAgciA9IHIuYWRkT3JTdWJ0cmFjdChyTGFzdC5tdWx0aXBseUJ5TW9ub21pYWwoZGVncmVlRGlmZiwgc2NhbGUpKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHQgPSBxLm11bHRpcGx5KHRMYXN0KS5hZGRPclN1YnRyYWN0KHRMYXN0TGFzdCk7CgkgICAgICAgICAgICBpZiAoci5nZXREZWdyZWUoKSA+PSByTGFzdC5nZXREZWdyZWUoKSkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsU3RhdGVFeGNlcHRpb25fMS5kZWZhdWx0KCdEaXZpc2lvbiBhbGdvcml0aG0gZmFpbGVkIHRvIHJlZHVjZSBwb2x5bm9taWFsPycpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciBzaWdtYVRpbGRlQXRaZXJvID0gdC5nZXRDb2VmZmljaWVudCgwKTsKCSAgICAgICAgaWYgKHNpZ21hVGlsZGVBdFplcm8gPT09IDApIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBSZWVkU29sb21vbkV4Y2VwdGlvbl8xLmRlZmF1bHQoJ3NpZ21hVGlsZGUoMCkgd2FzIHplcm8nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgaW52ZXJzZSA9IGZpZWxkLmludmVyc2Uoc2lnbWFUaWxkZUF0WmVybyk7CgkgICAgICAgIHZhciBzaWdtYSA9IHQubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHZhciBvbWVnYSA9IHIubXVsdGlwbHlTY2FsYXIoaW52ZXJzZSk7CgkgICAgICAgIHJldHVybiBbc2lnbWEsIG9tZWdhXTsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTG9jYXRpb25zID0gZnVuY3Rpb24gKGVycm9yTG9jYXRvcikgewoJICAgICAgICAvLyBUaGlzIGlzIGEgZGlyZWN0IGFwcGxpY2F0aW9uIG9mIENoaWVuJ3Mgc2VhcmNoCgkgICAgICAgIHZhciBudW1FcnJvcnMgPSBlcnJvckxvY2F0b3IuZ2V0RGVncmVlKCk7CgkgICAgICAgIGlmIChudW1FcnJvcnMgPT09IDEpIHsgLy8gc2hvcnRjdXQKCSAgICAgICAgICAgIHJldHVybiBJbnQzMkFycmF5LmZyb20oW2Vycm9yTG9jYXRvci5nZXRDb2VmZmljaWVudCgxKV0pOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgSW50MzJBcnJheShudW1FcnJvcnMpOwoJICAgICAgICB2YXIgZSA9IDA7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZmllbGQuZ2V0U2l6ZSgpICYmIGUgPCBudW1FcnJvcnM7IGkrKykgewoJICAgICAgICAgICAgaWYgKGVycm9yTG9jYXRvci5ldmFsdWF0ZUF0KGkpID09PSAwKSB7CgkgICAgICAgICAgICAgICAgcmVzdWx0W2VdID0gZmllbGQuaW52ZXJzZShpKTsKCSAgICAgICAgICAgICAgICBlKys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGUgIT09IG51bUVycm9ycykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IFJlZWRTb2xvbW9uRXhjZXB0aW9uXzEuZGVmYXVsdCgnRXJyb3IgbG9jYXRvciBkZWdyZWUgZG9lcyBub3QgbWF0Y2ggbnVtYmVyIG9mIHJvb3RzJyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIFJlZWRTb2xvbW9uRGVjb2Rlci5wcm90b3R5cGUuZmluZEVycm9yTWFnbml0dWRlcyA9IGZ1bmN0aW9uIChlcnJvckV2YWx1YXRvciwgZXJyb3JMb2NhdGlvbnMpIHsKCSAgICAgICAgLy8gVGhpcyBpcyBkaXJlY3RseSBhcHBseWluZyBGb3JuZXkncyBGb3JtdWxhCgkgICAgICAgIHZhciBzID0gZXJyb3JMb2NhdGlvbnMubGVuZ3RoOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEludDMyQXJyYXkocyk7CgkgICAgICAgIHZhciBmaWVsZCA9IHRoaXMuZmllbGQ7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgczsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgeGlJbnZlcnNlID0gZmllbGQuaW52ZXJzZShlcnJvckxvY2F0aW9uc1tpXSk7CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSAxOwoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaSAhPT0gaikgewoJICAgICAgICAgICAgICAgICAgICAvLyBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLAoJICAgICAgICAgICAgICAgICAgICAvLyAgICBHZW5lcmljR0YuYWRkT3JTdWJ0cmFjdCgxLCBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKSkpCgkgICAgICAgICAgICAgICAgICAgIC8vIEFib3ZlIHNob3VsZCB3b3JrIGJ1dCBmYWlscyBvbiBzb21lIEFwcGxlIGFuZCBMaW51eCBKREtzIGR1ZSB0byBhIEhvdHNwb3QgYnVnLgoJICAgICAgICAgICAgICAgICAgICAvLyBCZWxvdyBpcyBhIGZ1bm55LWxvb2tpbmcgd29ya2Fyb3VuZCBmcm9tIFN0ZXZlbiBQYXJrZXMKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm0gPSBmaWVsZC5tdWx0aXBseShlcnJvckxvY2F0aW9uc1tqXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIHRlcm1QbHVzMSA9ICh0ZXJtICYgMHgxKSA9PT0gMCA/IHRlcm0gfCAxIDogdGVybSAmIH4xOwoJICAgICAgICAgICAgICAgICAgICBkZW5vbWluYXRvciA9IGZpZWxkLm11bHRpcGx5KGRlbm9taW5hdG9yLCB0ZXJtUGx1czEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KGVycm9yRXZhbHVhdG9yLmV2YWx1YXRlQXQoeGlJbnZlcnNlKSwgZmllbGQuaW52ZXJzZShkZW5vbWluYXRvcikpOwoJICAgICAgICAgICAgaWYgKGZpZWxkLmdldEdlbmVyYXRvckJhc2UoKSAhPT0gMCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtpXSA9IGZpZWxkLm11bHRpcGx5KHJlc3VsdFtpXSwgeGlJbnZlcnNlKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgcmV0dXJuIFJlZWRTb2xvbW9uRGVjb2RlcjsKCX0oKSk7CglSZWVkU29sb21vbkRlY29kZXIkMS5kZWZhdWx0ID0gUmVlZFNvbG9tb25EZWNvZGVyOwoKCXZhciBCaXRNYXRyaXhQYXJzZXIkMSA9IHt9OwoKCXZhciBWZXJzaW9uJDEgPSB7fTsKCgl2YXIgRm9ybWF0SW5mb3JtYXRpb24kMSA9IHt9OwoKCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IHt9OwoKCXZhciBBcmd1bWVudEV4Y2VwdGlvbiQxID0ge307CgoJdmFyIF9fZXh0ZW5kcyQzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFyZ3VtZW50RXhjZXB0aW9uJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBFeGNlcHRpb25fMSA9IEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBDdXN0b20gRXJyb3IgY2xhc3Mgb2YgdHlwZSBFeGNlcHRpb24uCgkgKi8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHsKCSAgICBfX2V4dGVuZHMkMyhBcmd1bWVudEV4Y2VwdGlvbiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBcmd1bWVudEV4Y2VwdGlvbigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICBBcmd1bWVudEV4Y2VwdGlvbi5raW5kID0gJ0FyZ3VtZW50RXhjZXB0aW9uJzsKCSAgICByZXR1cm4gQXJndW1lbnRFeGNlcHRpb247Cgl9KEV4Y2VwdGlvbl8xLmRlZmF1bHQpKTsKCUFyZ3VtZW50RXhjZXB0aW9uJDEuZGVmYXVsdCA9IEFyZ3VtZW50RXhjZXB0aW9uOwoKCShmdW5jdGlvbiAoZXhwb3J0cykgewoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CglleHBvcnRzLkVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gdm9pZCAwOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBBcmd1bWVudEV4Y2VwdGlvbl8xID0gQXJndW1lbnRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJdmFyIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzOwoJKGZ1bmN0aW9uIChFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcykgewoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJMIl0gPSAwXSA9ICJMIjsKCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1tFcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlc1siTSJdID0gMV0gPSAiTSI7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXNbIlEiXSA9IDJdID0gIlEiOwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzW0Vycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzWyJIIl0gPSAzXSA9ICJIIjsKCX0pKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzID0gZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyB8fCAoZXhwb3J0cy5FcnJvckNvcnJlY3Rpb25MZXZlbFZhbHVlcyA9IHt9KSk7CgkvKioKCSAqIDxwPlNlZSBJU08gMTgwMDQ6MjAwNiwgNi41LjEuIFRoaXMgZW51bSBlbmNhcHN1bGF0ZXMgdGhlIGZvdXIgZXJyb3IgY29ycmVjdGlvbiBsZXZlbHMKCSAqIGRlZmluZWQgYnkgdGhlIFFSIGNvZGUgc3RhbmRhcmQuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFcnJvckNvcnJlY3Rpb25MZXZlbCh2YWx1ZSwgc3RyaW5nVmFsdWUsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5iaXRzID0gYml0czsKCSAgICAgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2V0KGJpdHMsIHRoaXMpOwoJICAgICAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52YWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5nZXRCaXRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRzOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZnJvbVN0cmluZyA9IGZ1bmN0aW9uIChzKSB7CgkgICAgICAgIHN3aXRjaCAocykgewoJICAgICAgICAgICAgY2FzZSAnTCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5MOwoJICAgICAgICAgICAgY2FzZSAnTSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5NOwoJICAgICAgICAgICAgY2FzZSAnUSc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5ROwoJICAgICAgICAgICAgY2FzZSAnSCc6IHJldHVybiBFcnJvckNvcnJlY3Rpb25MZXZlbC5IOwoJICAgICAgICAgICAgZGVmYXVsdDogdGhyb3cgbmV3IEFyZ3VtZW50RXhjZXB0aW9uXzEuZGVmYXVsdChzICsgJ25vdCBhdmFpbGFibGUnKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIEVycm9yQ29ycmVjdGlvbkxldmVsLnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAobykgewoJICAgICAgICBpZiAoIShvIGluc3RhbmNlb2YgRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG90aGVyID0gbzsKCSAgICAgICAgcmV0dXJuIHRoaXMudmFsdWUgPT09IG90aGVyLnZhbHVlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgaW50IGNvbnRhaW5pbmcgdGhlIHR3byBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSdzIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCSAgICAgKiBAcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsIHJlcHJlc2VudGluZyB0aGUgZW5jb2RlZCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkgICAgICovCgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuZm9yQml0cyA9IGZ1bmN0aW9uIChiaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGJpdHMgPCAwIHx8IGJpdHMgPj0gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuc2l6ZSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMuZ2V0KGJpdHMpOwoJICAgIH07CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgRXJyb3JDb3JyZWN0aW9uTGV2ZWwuRk9SX1ZBTFVFID0gbmV3IE1hcCgpOwoJICAgIC8qKiBMID0gfjclIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5MID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkwsICdMJywgMHgwMSk7CgkgICAgLyoqIE0gPSB+MTUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5NID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLk0sICdNJywgMHgwMCk7CgkgICAgLyoqIFEgPSB+MjUlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5RID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLlEsICdRJywgMHgwMyk7CgkgICAgLyoqIEggPSB+MzAlIGNvcnJlY3Rpb24gKi8KCSAgICBFcnJvckNvcnJlY3Rpb25MZXZlbC5IID0gbmV3IEVycm9yQ29ycmVjdGlvbkxldmVsKEVycm9yQ29ycmVjdGlvbkxldmVsVmFsdWVzLkgsICdIJywgMHgwMik7CgkgICAgcmV0dXJuIEVycm9yQ29ycmVjdGlvbkxldmVsOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IEVycm9yQ29ycmVjdGlvbkxldmVsOwoKCX0oRXJyb3JDb3JyZWN0aW9uTGV2ZWwpKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDYgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRm9ybWF0SW5mb3JtYXRpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBFcnJvckNvcnJlY3Rpb25MZXZlbF8xID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWw7Cgl2YXIgSW50ZWdlcl8xID0gSW50ZWdlciQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBRUiBDb2RlJ3MgZm9ybWF0IGluZm9ybWF0aW9uLCBpbmNsdWRpbmcgdGhlIGRhdGEgbWFzayB1c2VkIGFuZAoJICogZXJyb3IgY29ycmVjdGlvbiBsZXZlbC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqIEBzZWUgRGF0YU1hc2sKCSAqIEBzZWUgRXJyb3JDb3JyZWN0aW9uTGV2ZWwKCSAqLwoJdmFyIEZvcm1hdEluZm9ybWF0aW9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZvcm1hdEluZm9ybWF0aW9uKGZvcm1hdEluZm8gLyppbnQqLykgewoJICAgICAgICAvLyBCaXRzIDMsNAoJICAgICAgICB0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsID0gRXJyb3JDb3JyZWN0aW9uTGV2ZWxfMS5kZWZhdWx0LmZvckJpdHMoKGZvcm1hdEluZm8gPj4gMykgJiAweDAzKTsKCSAgICAgICAgLy8gQm90dG9tIDMgYml0cwoJICAgICAgICB0aGlzLmRhdGFNYXNrID0gLyooYnl0ZSkgKi8gKGZvcm1hdEluZm8gJiAweDA3KTsKCSAgICB9CgkgICAgRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyA9IGZ1bmN0aW9uIChhIC8qaW50Ki8sIGIgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gSW50ZWdlcl8xLmRlZmF1bHQuYml0Q291bnQoYSBeIGIpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHBhcmFtIG1hc2tlZEZvcm1hdEluZm8xIGZvcm1hdCBpbmZvIGluZGljYXRvciwgd2l0aCBtYXNrIHN0aWxsIGFwcGxpZWQKCSAgICAgKiBAcGFyYW0gbWFza2VkRm9ybWF0SW5mbzIgc2Vjb25kIGNvcHkgb2Ygc2FtZSBpbmZvOyBib3RoIGFyZSBjaGVja2VkIGF0IHRoZSBzYW1lIHRpbWUKCSAgICAgKiAgdG8gZXN0YWJsaXNoIGJlc3QgbWF0Y2gKCSAgICAgKiBAcmV0dXJuIGluZm9ybWF0aW9uIGFib3V0IHRoZSBmb3JtYXQgaXQgc3BlY2lmaWVzLCBvciB7QGNvZGUgbnVsbH0KCSAgICAgKiAgaWYgZG9lc24ndCBzZWVtIHRvIG1hdGNoIGFueSBrbm93biBwYXR0ZXJuCgkgICAgICovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24uZGVjb2RlRm9ybWF0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAobWFza2VkRm9ybWF0SW5mbzEgLyppbnQqLywgbWFza2VkRm9ybWF0SW5mbzIgLyppbnQqLykgewoJICAgICAgICB2YXIgZm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uLmRvRGVjb2RlRm9ybWF0SW5mb3JtYXRpb24obWFza2VkRm9ybWF0SW5mbzEsIG1hc2tlZEZvcm1hdEluZm8yKTsKCSAgICAgICAgaWYgKGZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiBmb3JtYXRJbmZvOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNob3VsZCByZXR1cm4gbnVsbCwgYnV0LCBzb21lIFFSIGNvZGVzIGFwcGFyZW50bHkKCSAgICAgICAgLy8gZG8gbm90IG1hc2sgdGhpcyBpbmZvLiBUcnkgYWdhaW4gYnkgYWN0dWFsbHkgbWFza2luZyB0aGUgcGF0dGVybgoJICAgICAgICAvLyBmaXJzdAoJICAgICAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb24uZG9EZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihtYXNrZWRGb3JtYXRJbmZvMSBeIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX01BU0tfUVIsIG1hc2tlZEZvcm1hdEluZm8yIF4gRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUik7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5kb0RlY29kZUZvcm1hdEluZm9ybWF0aW9uID0gZnVuY3Rpb24gKG1hc2tlZEZvcm1hdEluZm8xIC8qaW50Ki8sIG1hc2tlZEZvcm1hdEluZm8yIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGVfMSwgX2E7CgkgICAgICAgIC8vIEZpbmQgdGhlIGludCBpbiBGT1JNQVRfSU5GT19ERUNPREVfTE9PS1VQIHdpdGggZmV3ZXN0IGJpdHMgZGlmZmVyaW5nCgkgICAgICAgIHZhciBiZXN0RGlmZmVyZW5jZSA9IE51bWJlci5NQVhfU0FGRV9JTlRFR0VSOwoJICAgICAgICB2YXIgYmVzdEZvcm1hdEluZm8gPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyQ2KEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVApLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRlY29kZUluZm8gPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0SW5mbyA9IGRlY29kZUluZm9bMF07CgkgICAgICAgICAgICAgICAgaWYgKHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8xIHx8IHRhcmdldEluZm8gPT09IG1hc2tlZEZvcm1hdEluZm8yKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGFuIGV4YWN0IG1hdGNoCgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgRm9ybWF0SW5mb3JtYXRpb24oZGVjb2RlSW5mb1sxXSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIHZhciBiaXRzRGlmZmVyZW5jZSA9IEZvcm1hdEluZm9ybWF0aW9uLm51bUJpdHNEaWZmZXJpbmcobWFza2VkRm9ybWF0SW5mbzEsIHRhcmdldEluZm8pOwoJICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgIGJlc3RGb3JtYXRJbmZvID0gZGVjb2RlSW5mb1sxXTsKCSAgICAgICAgICAgICAgICAgICAgYmVzdERpZmZlcmVuY2UgPSBiaXRzRGlmZmVyZW5jZTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKG1hc2tlZEZvcm1hdEluZm8xICE9PSBtYXNrZWRGb3JtYXRJbmZvMikgewoJICAgICAgICAgICAgICAgICAgICAvLyBhbHNvIHRyeSB0aGUgb3RoZXIgb3B0aW9uCgkgICAgICAgICAgICAgICAgICAgIGJpdHNEaWZmZXJlbmNlID0gRm9ybWF0SW5mb3JtYXRpb24ubnVtQml0c0RpZmZlcmluZyhtYXNrZWRGb3JtYXRJbmZvMiwgdGFyZ2V0SW5mbyk7CgkgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0Rm9ybWF0SW5mbyA9IGRlY29kZUluZm9bMV07CgkgICAgICAgICAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2MgJiYgIV9jLmRvbmUgJiYgKF9hID0gX2IucmV0dXJuKSkgX2EuY2FsbChfYik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSGFtbWluZyBkaXN0YW5jZSBvZiB0aGUgMzIgbWFza2VkIGNvZGVzIGlzIDcsIGJ5IGNvbnN0cnVjdGlvbiwgc28gPD0gMyBiaXRzCgkgICAgICAgIC8vIGRpZmZlcmluZyBtZWFucyB3ZSBmb3VuZCBhIG1hdGNoCgkgICAgICAgIGlmIChiZXN0RGlmZmVyZW5jZSA8PSAzKSB7CgkgICAgICAgICAgICByZXR1cm4gbmV3IEZvcm1hdEluZm9ybWF0aW9uKGJlc3RGb3JtYXRJbmZvKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbnVsbDsKCSAgICB9OwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5nZXRFcnJvckNvcnJlY3Rpb25MZXZlbCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJyb3JDb3JyZWN0aW9uTGV2ZWw7CgkgICAgfTsKCSAgICBGb3JtYXRJbmZvcm1hdGlvbi5wcm90b3R5cGUuZ2V0RGF0YU1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFNYXNrOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICh0aGlzLmVycm9yQ29ycmVjdGlvbkxldmVsLmdldEJpdHMoKSA8PCAzKSB8IHRoaXMuZGF0YU1hc2s7CgkgICAgfTsKCSAgICAvKkBPdmVycmlkZSovCgkgICAgRm9ybWF0SW5mb3JtYXRpb24ucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBGb3JtYXRJbmZvcm1hdGlvbikpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgb3RoZXIgPSBvOwoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvckNvcnJlY3Rpb25MZXZlbCA9PT0gb3RoZXIuZXJyb3JDb3JyZWN0aW9uTGV2ZWwgJiYKCSAgICAgICAgICAgIHRoaXMuZGF0YU1hc2sgPT09IG90aGVyLmRhdGFNYXNrOwoJICAgIH07CgkgICAgRm9ybWF0SW5mb3JtYXRpb24uRk9STUFUX0lORk9fTUFTS19RUiA9IDB4NTQxMjsKCSAgICAvKioKCSAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYsIEFubmV4IEMsIFRhYmxlIEMuMQoJICAgICAqLwoJICAgIEZvcm1hdEluZm9ybWF0aW9uLkZPUk1BVF9JTkZPX0RFQ09ERV9MT09LVVAgPSBbCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1NDEyLCAweDAwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1MTI1LCAweDAxXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1RTdDLCAweDAyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg1QjRCLCAweDAzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0NUY5LCAweDA0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0MENFLCAweDA1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0Rjk3LCAweDA2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg0QUEwLCAweDA3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3N0M0LCAweDA4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3MkYzLCAweDA5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3REFBLCAweDBBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg3ODlELCAweDBCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2NjJGLCAweDBDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2MzE4LCAweDBEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2QzQxLCAweDBFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHg2OTc2LCAweDBGXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxNjg5LCAweDEwXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxM0JFLCAweDExXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxQ0U3LCAweDEyXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgxOUQwLCAweDEzXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwNzYyLCAweDE0XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwMjU1LCAweDE1XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwRDBDLCAweDE2XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgwODNCLCAweDE3XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzNTVGLCAweDE4XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzMDY4LCAweDE5XSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzRjMxLCAweDFBXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgzQTA2LCAweDFCXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyNEI0LCAweDFDXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyMTgzLCAweDFEXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyRURBLCAweDFFXSksCgkgICAgICAgIEludDMyQXJyYXkuZnJvbShbMHgyQkVELCAweDFGXSksCgkgICAgXTsKCSAgICByZXR1cm4gRm9ybWF0SW5mb3JtYXRpb247Cgl9KCkpOwoJRm9ybWF0SW5mb3JtYXRpb24kMS5kZWZhdWx0ID0gRm9ybWF0SW5mb3JtYXRpb247CgoJdmFyIEVDQmxvY2tzJDEgPSB7fTsKCgl2YXIgX192YWx1ZXMkNSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0Jsb2NrcyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHNldCBvZiBlcnJvci1jb3JyZWN0aW9uIGJsb2NrcyBpbiBvbmUgc3ltYm9sIHZlcnNpb24uIE1vc3QgdmVyc2lvbnMgd2lsbAoJICogdXNlIGJsb2NrcyBvZiBkaWZmZXJpbmcgc2l6ZXMgd2l0aGluIG9uZSB2ZXJzaW9uLCBzbywgdGhpcyBlbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yCgkgKiBlYWNoIHNldCBvZiBibG9ja3MuIEl0IGFsc28gaG9sZHMgdGhlIG51bWJlciBvZiBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyBwZXIgYmxvY2sgc2luY2UgaXQKCSAqIHdpbGwgYmUgdGhlIHNhbWUgYWNyb3NzIGFsbCBibG9ja3Mgd2l0aGluIG9uZSB2ZXJzaW9uLjwvcD4KCSAqLwoJdmFyIEVDQmxvY2tzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEVDQmxvY2tzKGVjQ29kZXdvcmRzUGVyQmxvY2sgLyppbnQqLykgewoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAxOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMV0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayA9IGVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgICAgIHRoaXMuZWNCbG9ja3MgPSBlY0Jsb2NrczsKCSAgICB9CgkgICAgRUNCbG9ja3MucHJvdG90eXBlLmdldEVDQ29kZXdvcmRzUGVyQmxvY2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQ29kZXdvcmRzUGVyQmxvY2s7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0TnVtQmxvY2tzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIHRvdGFsID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tzID0gdGhpcy5lY0Jsb2NrczsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIGVjQmxvY2tzXzEgPSBfX3ZhbHVlcyQ1KGVjQmxvY2tzKSwgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCk7ICFlY0Jsb2Nrc18xXzEuZG9uZTsgZWNCbG9ja3NfMV8xID0gZWNCbG9ja3NfMS5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tzXzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbCArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2Nrc18xXzEgJiYgIWVjQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGVjQmxvY2tzXzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2Nrc18xKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdG90YWw7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0VG90YWxFQ0NvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZWNDb2Rld29yZHNQZXJCbG9jayAqIHRoaXMuZ2V0TnVtQmxvY2tzKCk7CgkgICAgfTsKCSAgICBFQ0Jsb2Nrcy5wcm90b3R5cGUuZ2V0RUNCbG9ja3MgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmVjQmxvY2tzOwoJICAgIH07CgkgICAgcmV0dXJuIEVDQmxvY2tzOwoJfSgpKTsKCUVDQmxvY2tzJDEuZGVmYXVsdCA9IEVDQmxvY2tzOwoKCXZhciBFQ0IkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShFQ0IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgdGhlIHBhcmFtZXRlcnMgZm9yIG9uZSBlcnJvci1jb3JyZWN0aW9uIGJsb2NrIGluIG9uZSBzeW1ib2wgdmVyc2lvbi4KCSAqIFRoaXMgaW5jbHVkZXMgdGhlIG51bWJlciBvZiBkYXRhIGNvZGV3b3JkcywgYW5kIHRoZSBudW1iZXIgb2YgdGltZXMgYSBibG9jayB3aXRoIHRoZXNlCgkgKiBwYXJhbWV0ZXJzIGlzIHVzZWQgY29uc2VjdXRpdmVseSBpbiB0aGUgUVIgY29kZSB2ZXJzaW9uJ3MgZm9ybWF0LjwvcD4KCSAqLwoJdmFyIEVDQiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBFQ0IoY291bnQgLyppbnQqLywgZGF0YUNvZGV3b3JkcyAvKmludCovKSB7CgkgICAgICAgIHRoaXMuY291bnQgPSBjb3VudDsKCSAgICAgICAgdGhpcy5kYXRhQ29kZXdvcmRzID0gZGF0YUNvZGV3b3JkczsKCSAgICB9CgkgICAgRUNCLnByb3RvdHlwZS5nZXRDb3VudCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY291bnQ7CgkgICAgfTsKCSAgICBFQ0IucHJvdG90eXBlLmdldERhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICByZXR1cm4gRUNCOwoJfSgpKTsKCUVDQiQxLmRlZmF1bHQgPSBFQ0I7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX3ZhbHVlcyQ0ID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFZlcnNpb24kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGVjb2RlciB7Ki8KCXZhciBCaXRNYXRyaXhfMSQzID0gQml0TWF0cml4JDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSQxID0gRm9ybWF0SW5mb3JtYXRpb24kMTsKCXZhciBFQ0Jsb2Nrc18xID0gRUNCbG9ja3MkMTsKCXZhciBFQ0JfMSA9IEVDQiQxOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDIgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQyID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIFNlZSBJU08gMTgwMDQ6MjAwNiBBbm5leCBECgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFZlcnNpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gVmVyc2lvbih2ZXJzaW9uTnVtYmVyIC8qaW50Ki8sIGFsaWdubWVudFBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgZWNCbG9ja3MgPSBbXTsKCSAgICAgICAgZm9yICh2YXIgX2kgPSAyOyBfaSA8IGFyZ3VtZW50cy5sZW5ndGg7IF9pKyspIHsKCSAgICAgICAgICAgIGVjQmxvY2tzW19pIC0gMl0gPSBhcmd1bWVudHNbX2ldOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMudmVyc2lvbk51bWJlciA9IHZlcnNpb25OdW1iZXI7CgkgICAgICAgIHRoaXMuYWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBhbGlnbm1lbnRQYXR0ZXJuQ2VudGVyczsKCSAgICAgICAgdGhpcy5lY0Jsb2NrcyA9IGVjQmxvY2tzOwoJICAgICAgICB2YXIgdG90YWwgPSAwOwoJICAgICAgICB2YXIgZWNDb2Rld29yZHMgPSBlY0Jsb2Nrc1swXS5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIHZhciBlY2JBcnJheSA9IGVjQmxvY2tzWzBdLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY2JBcnJheV8xID0gX192YWx1ZXMkNChlY2JBcnJheSksIGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpOyAhZWNiQXJyYXlfMV8xLmRvbmU7IGVjYkFycmF5XzFfMSA9IGVjYkFycmF5XzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGVjQmxvY2sgPSBlY2JBcnJheV8xXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdG90YWwgKz0gZWNCbG9jay5nZXRDb3VudCgpICogKGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpICsgZWNDb2Rld29yZHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzFfMSkgeyBlXzEgPSB7IGVycm9yOiBlXzFfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoZWNiQXJyYXlfMV8xICYmICFlY2JBcnJheV8xXzEuZG9uZSAmJiAoX2EgPSBlY2JBcnJheV8xLnJldHVybikpIF9hLmNhbGwoZWNiQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdGhpcy50b3RhbENvZGV3b3JkcyA9IHRvdGFsOwoJICAgIH0KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5nZXRWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0VG90YWxDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnRvdGFsQ29kZXdvcmRzOwoJICAgIH07CgkgICAgVmVyc2lvbi5wcm90b3R5cGUuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDE3ICsgNCAqIHRoaXMudmVyc2lvbk51bWJlcjsKCSAgICB9OwoJICAgIFZlcnNpb24ucHJvdG90eXBlLmdldEVDQmxvY2tzRm9yTGV2ZWwgPSBmdW5jdGlvbiAoZWNMZXZlbCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0Jsb2Nrc1tlY0xldmVsLmdldFZhbHVlKCldOwoJICAgICAgICAvLyBUWVBFU0NSSVBUUE9SVDogb3JpZ2luYWwgd2FzIHVzaW5nIG9yZGluYWwsIGFuZCB1c2luZyB0aGUgb3JkZXIgb2YgbGV2ZWxzIGFzIGRlZmluZWQgaW4gRXJyb3JDb3JyZWN0aW9uTGV2ZWwgZW51bSAoTE1RSCkKCSAgICAgICAgLy8gSSB3aWxsIHVzZSB0aGUgZGlyZWN0IHZhbHVlIGZyb20gRXJyb3JDb3JyZWN0aW9uTGV2ZWxWYWx1ZXMgZW51bSB3aGljaCBpbiB0eXBlc2NyaXB0IGdvZXMgdG8gYSBudW1iZXIKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkRlZHVjZXMgdmVyc2lvbiBpbmZvcm1hdGlvbiBwdXJlbHkgZnJvbSBRUiBDb2RlIGRpbWVuc2lvbnMuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gaW4gbW9kdWxlcwoJICAgICAqIEByZXR1cm4gVmVyc2lvbiBmb3IgYSBRUiBDb2RlIG9mIHRoYXQgZGltZW5zaW9uCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCAxIG1vZCA0CgkgICAgICovCgkgICAgVmVyc2lvbi5nZXRQcm92aXNpb25hbFZlcnNpb25Gb3JEaW1lbnNpb24gPSBmdW5jdGlvbiAoZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiAlIDQgIT09IDEpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMSQyLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0VmVyc2lvbkZvck51bWJlcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlciA9IGZ1bmN0aW9uICh2ZXJzaW9uTnVtYmVyIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPCAxIHx8IHZlcnNpb25OdW1iZXIgPiA0MCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDIuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBWZXJzaW9uLlZFUlNJT05TW3ZlcnNpb25OdW1iZXIgLSAxXTsKCSAgICB9OwoJICAgIFZlcnNpb24uZGVjb2RlVmVyc2lvbkluZm9ybWF0aW9uID0gZnVuY3Rpb24gKHZlcnNpb25CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGJlc3REaWZmZXJlbmNlID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHZhciBiZXN0VmVyc2lvbiA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgVmVyc2lvbi5WRVJTSU9OX0RFQ09ERV9JTkZPLmxlbmd0aDsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgdGFyZ2V0VmVyc2lvbiA9IFZlcnNpb24uVkVSU0lPTl9ERUNPREVfSU5GT1tpXTsKCSAgICAgICAgICAgIC8vIERvIHRoZSB2ZXJzaW9uIGluZm8gYml0cyBtYXRjaCBleGFjdGx5PyBkb25lLgoJICAgICAgICAgICAgaWYgKHRhcmdldFZlcnNpb24gPT09IHZlcnNpb25CaXRzKSB7CgkgICAgICAgICAgICAgICAgcmV0dXJuIFZlcnNpb24uZ2V0VmVyc2lvbkZvck51bWJlcihpICsgNyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBPdGhlcndpc2Ugc2VlIGlmIHRoaXMgaXMgdGhlIGNsb3Nlc3QgdG8gYSByZWFsIHZlcnNpb24gaW5mbyBiaXQgc3RyaW5nCgkgICAgICAgICAgICAvLyB3ZSBoYXZlIHNlZW4gc28gZmFyCgkgICAgICAgICAgICB2YXIgYml0c0RpZmZlcmVuY2UgPSBGb3JtYXRJbmZvcm1hdGlvbl8xJDEuZGVmYXVsdC5udW1CaXRzRGlmZmVyaW5nKHZlcnNpb25CaXRzLCB0YXJnZXRWZXJzaW9uKTsKCSAgICAgICAgICAgIGlmIChiaXRzRGlmZmVyZW5jZSA8IGJlc3REaWZmZXJlbmNlKSB7CgkgICAgICAgICAgICAgICAgYmVzdFZlcnNpb24gPSBpICsgNzsKCSAgICAgICAgICAgICAgICBiZXN0RGlmZmVyZW5jZSA9IGJpdHNEaWZmZXJlbmNlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFdlIGNhbiB0b2xlcmF0ZSB1cCB0byAzIGJpdHMgb2YgZXJyb3Igc2luY2Ugbm8gdHdvIHZlcnNpb24gaW5mbyBjb2Rld29yZHMgd2lsbAoJICAgICAgICAvLyBkaWZmZXIgaW4gbGVzcyB0aGFuIDggYml0cy4KCSAgICAgICAgaWYgKGJlc3REaWZmZXJlbmNlIDw9IDMpIHsKCSAgICAgICAgICAgIHJldHVybiBWZXJzaW9uLmdldFZlcnNpb25Gb3JOdW1iZXIoYmVzdFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2UgZW5vdWdoIG1hdGNoLCBmYWlsCgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIElTTyAxODAwNDoyMDA2IEFubmV4IEUKCSAgICAgKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS5idWlsZEZ1bmN0aW9uUGF0dGVybiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpOwoJICAgICAgICB2YXIgYml0TWF0cml4ID0gbmV3IEJpdE1hdHJpeF8xJDMuZGVmYXVsdChkaW1lbnNpb24pOwoJICAgICAgICAvLyBUb3AgbGVmdCBmaW5kZXIgcGF0dGVybiArIHNlcGFyYXRvciArIGZvcm1hdAoJICAgICAgICBiaXRNYXRyaXguc2V0UmVnaW9uKDAsIDAsIDksIDkpOwoJICAgICAgICAvLyBUb3AgcmlnaHQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbihkaW1lbnNpb24gLSA4LCAwLCA4LCA5KTsKCSAgICAgICAgLy8gQm90dG9tIGxlZnQgZmluZGVyIHBhdHRlcm4gKyBzZXBhcmF0b3IgKyBmb3JtYXQKCSAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSA4LCA5LCA4KTsKCSAgICAgICAgLy8gQWxpZ25tZW50IHBhdHRlcm5zCgkgICAgICAgIHZhciBtYXggPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHgrKykgewoJICAgICAgICAgICAgdmFyIGkgPSB0aGlzLmFsaWdubWVudFBhdHRlcm5DZW50ZXJzW3hdIC0gMjsKCSAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgbWF4OyB5KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoKHggPT09IDAgJiYgKHkgPT09IDAgfHwgeSA9PT0gbWF4IC0gMSkpIHx8ICh4ID09PSBtYXggLSAxICYmIHkgPT09IDApKSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE5vIGFsaWdubWVudCBwYXR0ZXJucyBuZWFyIHRoZSB0aHJlZSBmaW5kZXIgcGF0dGVybnMKCSAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24odGhpcy5hbGlnbm1lbnRQYXR0ZXJuQ2VudGVyc1t5XSAtIDIsIGksIDUsIDUpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIFZlcnRpY2FsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oNiwgOSwgMSwgZGltZW5zaW9uIC0gMTcpOwoJICAgICAgICAvLyBIb3Jpem9udGFsIHRpbWluZyBwYXR0ZXJuCgkgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oOSwgNiwgZGltZW5zaW9uIC0gMTcsIDEpOwoJICAgICAgICBpZiAodGhpcy52ZXJzaW9uTnVtYmVyID4gNikgewoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCB0b3AgcmlnaHQKCSAgICAgICAgICAgIGJpdE1hdHJpeC5zZXRSZWdpb24oZGltZW5zaW9uIC0gMTEsIDAsIDMsIDYpOwoJICAgICAgICAgICAgLy8gVmVyc2lvbiBpbmZvLCBib3R0b20gbGVmdAoJICAgICAgICAgICAgYml0TWF0cml4LnNldFJlZ2lvbigwLCBkaW1lbnNpb24gLSAxMSwgNiwgMyk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdE1hdHJpeDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBWZXJzaW9uLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuICcnICsgdGhpcy52ZXJzaW9uTnVtYmVyOwoJICAgIH07CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgQW5uZXggRC4KCSAgICAgICAqIEVsZW1lbnQgaSByZXByZXNlbnRzIHRoZSByYXcgdmVyc2lvbiBiaXRzIHRoYXQgc3BlY2lmeSB2ZXJzaW9uIGkgKyA3CgkgICAgICAgKi8KCSAgICBWZXJzaW9uLlZFUlNJT05fREVDT0RFX0lORk8gPSBJbnQzMkFycmF5LmZyb20oWwoJICAgICAgICAweDA3Qzk0LCAweDA4NUJDLCAweDA5QTk5LCAweDBBNEQzLCAweDBCQkY2LAoJICAgICAgICAweDBDNzYyLCAweDBEODQ3LCAweDBFNjBELCAweDBGOTI4LCAweDEwQjc4LAoJICAgICAgICAweDExNDVELCAweDEyQTE3LCAweDEzNTMyLCAweDE0OUE2LCAweDE1NjgzLAoJICAgICAgICAweDE2OEM5LCAweDE3N0VDLCAweDE4RUM0LCAweDE5MUUxLCAweDFBRkFCLAoJICAgICAgICAweDFCMDhFLCAweDFDQzFBLCAweDFEMzNGLCAweDFFRDc1LCAweDFGMjUwLAoJICAgICAgICAweDIwOUQ1LCAweDIxNkYwLCAweDIyOEJBLCAweDIzNzlGLCAweDI0QjBCLAoJICAgICAgICAweDI1NDJFLCAweDI2QTY0LCAweDI3NTQxLCAweDI4QzY5CgkgICAgXSk7CgkgICAgLyoqCgkgICAgICAgKiBTZWUgSVNPIDE4MDA0OjIwMDYgNi41LjEgVGFibGUgOQoJICAgICAgICovCgkgICAgVmVyc2lvbi5WRVJTSU9OUyA9IFsKCSAgICAgICAgbmV3IFZlcnNpb24oMSwgbmV3IEludDMyQXJyYXkoMCksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxMywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNywgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOSkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMiwgSW50MzJBcnJheS5mcm9tKFs2LCAxOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDEwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMywgSW50MzJBcnJheS5mcm9tKFs2LCAyMl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE1LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1NSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA4MCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyNCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA5KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCA0MykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDE4LCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTIpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDYsIEludDMyQXJyYXkuZnJvbShbNiwgMzRdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgxNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDcsIEludDMyQXJyYXkuZnJvbShbNiwgMjIsIDM4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDc4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDMxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxNCkpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNCwgNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMzgpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzOSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxOCksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE5KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDksIEludDMyQXJyYXkuZnJvbShbNiwgMjYsIDQ2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIyLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAzNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDM3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTAsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDUwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMTgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDY4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgNjkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDMpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA0NCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxOSksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDIwKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDExLCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDIwLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA4MSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCA1MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDUxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTIpLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMykpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTIsIEludDMyQXJyYXkuZnJvbShbNiwgMzIsIDU4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDkyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgOTMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMzYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAzNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDE0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDEzLCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2Ml0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyMiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMzcpLCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAzOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAyMCksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDEyLCAxMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDYsIDY2XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCg0LCA0MCksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDQxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDE3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNSwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNDgsIDcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjIsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDg3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgODgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgNDEpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigxNiwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjQsIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDk4KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgOTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0NikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI0LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTkpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAyMCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMTcsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU0LCA3OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxLCAxMDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE4LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NiwgODJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIwKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTIxKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDQzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMiwgMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxOSwgMTUpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDE5LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1OCwgODZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTE0KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDQ0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDQ1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDE3LCAyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjYsIG5ldyBFQ0JfMS5kZWZhdWx0KDksIDEzKSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDE0KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMCwgSW50MzJBcnJheS5mcm9tKFs2LCAzNCwgNjIsIDkwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDEwNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDUsIDEwOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgzLCA0MSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCA0MikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIxLCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1MCwgNzIsIDk0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExNykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI2LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDIpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDIyLCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1MCwgNzQsIDk4XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDExMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDExMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNCwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDEzKSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyMywgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIxKSwgbmV3IEVDQl8xLmRlZmF1bHQoNSwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI0LCBJbnQzMkFycmF5LmZyb20oWzYsIDI4LCA1NCwgODAsIDEwNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTcpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTYsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMwLCAxNiksIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDE3KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyNSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyNiwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMTA2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTA3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEzLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMjYsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0XSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxMTUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNiwgMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzMsIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDI3LCBJbnQzMkFycmF5LmZyb20oWzYsIDM0LCA2MiwgOTAsIDExOF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg4LCAxMjIpLCBuZXcgRUNCXzEuZGVmYXVsdCg0LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjIsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoOCwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjgsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTAsIDc0LCA5OCwgMTIyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDMsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAxMTgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMywgNDUpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTEsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigyOSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTQsIDc4LCAxMDIsIDEyNl0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTYpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCAxMTcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMjEsIDQ1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgNDYpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMjMpLCBuZXcgRUNCXzEuZGVmYXVsdCgzNywgMjQpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMCwgSW50MzJBcnJheS5mcm9tKFs2LCAyNiwgNTIsIDc4LCAxMDQsIDEzMF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg1LCAxMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCA0NyksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNSwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjMsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjUsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzMSwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTYsIDgyLCAxMDgsIDEzNF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxMywgMTE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoMywgMTE2KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDIsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQyLCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIzLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDI4LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzIsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYwLCA4NiwgMTEyLCAxMzhdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzUsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDM1LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzMsIEludDMyQXJyYXkuZnJvbShbNiwgMzAsIDU4LCA4NiwgMTE0LCAxNDJdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTcsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDEsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMSwgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTksIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDExLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzQsIEludDMyQXJyYXkuZnJvbShbNiwgMzQsIDYyLCA5MCwgMTE4LCAxNDZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDExNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDExNikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgNDYpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMywgNDcpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNDQsIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoNywgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoNTksIDE2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMSwgMTcpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM1LCBJbnQzMkFycmF5LmZyb20oWzYsIDMwLCA1NCwgNzgsIDEwMiwgMTI2LCAxNTBdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTIsIDEyMSksIG5ldyBFQ0JfMS5kZWZhdWx0KDcsIDEyMikpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCgxMiwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCgyNiwgNDgpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMzksIDI0KSwgbmV3IEVDQl8xLmRlZmF1bHQoMTQsIDI1KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDIyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDQxLCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzYsIEludDMyQXJyYXkuZnJvbShbNiwgMjQsIDUwLCA3NiwgMTAyLCAxMjgsIDE1NF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMjEpLCBuZXcgRUNCXzEuZGVmYXVsdCgxNCwgMTIyKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDYsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzQsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ2LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDEwLCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyLCAxNSksIG5ldyBFQ0JfMS5kZWZhdWx0KDY0LCAxNikpKSwKCSAgICAgICAgbmV3IFZlcnNpb24oMzcsIEludDMyQXJyYXkuZnJvbShbNiwgMjgsIDU0LCA4MCwgMTA2LCAxMzIsIDE1OF0pLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgxNywgMTIyKSwgbmV3IEVDQl8xLmRlZmF1bHQoNCwgMTIzKSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMjgsIG5ldyBFQ0JfMS5kZWZhdWx0KDI5LCA0NiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCA0NykpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0OSwgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgxMCwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjQsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNDYsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbigzOCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMiwgNTgsIDg0LCAxMTAsIDEzNiwgMTYyXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDEyMiksIG5ldyBFQ0JfMS5kZWZhdWx0KDE4LCAxMjMpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTMsIDQ2KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzIsIDQ3KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDQ4LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDE0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MiwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCgzMiwgMTYpKSksCgkgICAgICAgIG5ldyBWZXJzaW9uKDM5LCBJbnQzMkFycmF5LmZyb20oWzYsIDI2LCA1NCwgODIsIDExMCwgMTM4LCAxNjZdKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMjAsIDExNyksIG5ldyBFQ0JfMS5kZWZhdWx0KDQsIDExOCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDI4LCBuZXcgRUNCXzEuZGVmYXVsdCg0MCwgNDcpLCBuZXcgRUNCXzEuZGVmYXVsdCg3LCA0OCkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCg0MywgMjQpLCBuZXcgRUNCXzEuZGVmYXVsdCgyMiwgMjUpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgzMCwgbmV3IEVDQl8xLmRlZmF1bHQoMTAsIDE1KSwgbmV3IEVDQl8xLmRlZmF1bHQoNjcsIDE2KSkpLAoJICAgICAgICBuZXcgVmVyc2lvbig0MCwgSW50MzJBcnJheS5mcm9tKFs2LCAzMCwgNTgsIDg2LCAxMTQsIDE0MiwgMTcwXSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDE5LCAxMTgpLCBuZXcgRUNCXzEuZGVmYXVsdCg2LCAxMTkpKSwgbmV3IEVDQmxvY2tzXzEuZGVmYXVsdCgyOCwgbmV3IEVDQl8xLmRlZmF1bHQoMTgsIDQ3KSwgbmV3IEVDQl8xLmRlZmF1bHQoMzEsIDQ4KSksIG5ldyBFQ0Jsb2Nrc18xLmRlZmF1bHQoMzAsIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNCksIG5ldyBFQ0JfMS5kZWZhdWx0KDM0LCAyNSkpLCBuZXcgRUNCbG9ja3NfMS5kZWZhdWx0KDMwLCBuZXcgRUNCXzEuZGVmYXVsdCgyMCwgMTUpLCBuZXcgRUNCXzEuZGVmYXVsdCg2MSwgMTYpKSkKCSAgICBdOwoJICAgIHJldHVybiBWZXJzaW9uOwoJfSgpKTsKCVZlcnNpb24kMS5kZWZhdWx0ID0gVmVyc2lvbjsKCgl2YXIgRGF0YU1hc2sgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5EYXRhTWFza1ZhbHVlcyA9IHZvaWQgMDsKCXZhciBEYXRhTWFza1ZhbHVlczsKCShmdW5jdGlvbiAoRGF0YU1hc2tWYWx1ZXMpIHsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAwMCJdID0gMF0gPSAiREFUQV9NQVNLXzAwMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18wMDEiXSA9IDFdID0gIkRBVEFfTUFTS18wMDEiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMDEwIl0gPSAyXSA9ICJEQVRBX01BU0tfMDEwIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzAxMSJdID0gM10gPSAiREFUQV9NQVNLXzAxMSI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMDAiXSA9IDRdID0gIkRBVEFfTUFTS18xMDAiOwoJICAgIERhdGFNYXNrVmFsdWVzW0RhdGFNYXNrVmFsdWVzWyJEQVRBX01BU0tfMTAxIl0gPSA1XSA9ICJEQVRBX01BU0tfMTAxIjsKCSAgICBEYXRhTWFza1ZhbHVlc1tEYXRhTWFza1ZhbHVlc1siREFUQV9NQVNLXzExMCJdID0gNl0gPSAiREFUQV9NQVNLXzExMCI7CgkgICAgRGF0YU1hc2tWYWx1ZXNbRGF0YU1hc2tWYWx1ZXNbIkRBVEFfTUFTS18xMTEiXSA9IDddID0gIkRBVEFfTUFTS18xMTEiOwoJfSkoRGF0YU1hc2tWYWx1ZXMgPSBleHBvcnRzLkRhdGFNYXNrVmFsdWVzIHx8IChleHBvcnRzLkRhdGFNYXNrVmFsdWVzID0ge30pKTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGRhdGEgbWFza3MgZm9yIHRoZSBkYXRhIGJpdHMgaW4gYSBRUiBjb2RlLCBwZXIgSVNPIDE4MDA0OjIwMDYgNi44LiBJbXBsZW1lbnRhdGlvbnMKCSAqIG9mIHRoaXMgY2xhc3MgY2FuIHVuLW1hc2sgYSByYXcgQml0TWF0cml4LiBGb3Igc2ltcGxpY2l0eSwgdGhleSB3aWxsIHVubWFzayB0aGUgZW50aXJlIEJpdE1hdHJpeCwKCSAqIGluY2x1ZGluZyBhcmVhcyB1c2VkIGZvciBmaW5kZXIgcGF0dGVybnMsIHRpbWluZyBwYXR0ZXJucywgZXRjLiBUaGVzZSBhcmVhcyBzaG91bGQgYmUgdW51c2VkCgkgKiBhZnRlciB0aGUgcG9pbnQgdGhleSBhcmUgdW5tYXNrZWQgYW55d2F5LjwvcD4KCSAqCgkgKiA8cD5Ob3RlIHRoYXQgdGhlIGRpYWdyYW0gaW4gc2VjdGlvbiA2LjguMSBpcyBtaXNsZWFkaW5nIHNpbmNlIGl0IGluZGljYXRlcyB0aGF0IGkgaXMgY29sdW1uIHBvc2l0aW9uCgkgKiBhbmQgaiBpcyByb3cgcG9zaXRpb24uIEluIGZhY3QsIGFzIHRoZSB0ZXh0IHNheXMsIGkgaXMgcm93IHBvc2l0aW9uIGFuZCBqIGlzIGNvbHVtbiBwb3NpdGlvbi48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFNYXNrID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8vIFNlZSBJU08gMTgwMDQ6MjAwNiA2LjguMQoJICAgIGZ1bmN0aW9uIERhdGFNYXNrKHZhbHVlLCBpc01hc2tlZCkgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuaXNNYXNrZWQgPSBpc01hc2tlZDsKCSAgICB9CgkgICAgLy8gRW5kIG9mIGVudW0gY29uc3RhbnRzLgoJICAgIC8qKgoJICAgICAqIDxwPkltcGxlbWVudGF0aW9ucyBvZiB0aGlzIG1ldGhvZCByZXZlcnNlIHRoZSBkYXRhIG1hc2tpbmcgcHJvY2VzcyBhcHBsaWVkIHRvIGEgUVIgQ29kZSBhbmQKCSAgICAgKiBtYWtlIGl0cyBiaXRzIHJlYWR5IHRvIHJlYWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGJpdHMgcmVwcmVzZW50YXRpb24gb2YgUVIgQ29kZSBiaXRzCgkgICAgICogQHBhcmFtIGRpbWVuc2lvbiBkaW1lbnNpb24gb2YgUVIgQ29kZSwgcmVwcmVzZW50ZWQgYnkgYml0cywgYmVpbmcgdW5tYXNrZWQKCSAgICAgKi8KCSAgICBEYXRhTWFzay5wcm90b3R5cGUudW5tYXNrQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGRpbWVuc2lvbiAvKmludCovKSB7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgZGltZW5zaW9uOyBqKyspIHsKCSAgICAgICAgICAgICAgICBpZiAodGhpcy5pc01hc2tlZChpLCBqKSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLmZsaXAoaiwgaSk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICBEYXRhTWFzay52YWx1ZXMgPSBuZXcgTWFwKFsKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDAwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeCArIHkpIG1vZCAyID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDAwLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMCwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoKGkgKyBqKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeCBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAwMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMDEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgJiAweDAxKSA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMDEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoIHkgbW9kIDMgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMDEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuIGogJSAzID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAwMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKHggKyB5KSBtb2QgMyA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzAxMSwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18wMTEsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKGkgKyBqKSAlIDMgPT09IDA7IH0pXSwKCSAgICAgICAgLyoqCgkgICAgICAgICAqIDEwMDogbWFzayBiaXRzIGZvciB3aGljaCAoeC8yICsgeS8zKSBtb2QgMiA9PSAwCgkgICAgICAgICAqLwoJICAgICAgICBbRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMCwgbmV3IERhdGFNYXNrKERhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMDAsIGZ1bmN0aW9uIChpIC8qaW50Ki8sIGogLyppbnQqLykgeyByZXR1cm4gKChNYXRoLmZsb29yKGkgLyAyKSArIE1hdGguZmxvb3IoaiAvIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMDE6IG1hc2sgYml0cyBmb3Igd2hpY2ggeHkgbW9kIDIgKyB4eSBtb2QgMyA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2ID09IDAKCSAgICAgICAgICovCgkgICAgICAgIFtEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTAxLCBuZXcgRGF0YU1hc2soRGF0YU1hc2tWYWx1ZXMuREFUQV9NQVNLXzEwMSwgZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovKSB7IHJldHVybiAoaSAqIGopICUgNiA9PT0gMDsgfSldLAoJICAgICAgICAvKioKCSAgICAgICAgICogMTEwOiBtYXNrIGJpdHMgZm9yIHdoaWNoICh4eSBtb2QgMiArIHh5IG1vZCAzKSBtb2QgMiA9PSAwCgkgICAgICAgICAqIGVxdWl2YWxlbnRseSwgc3VjaCB0aGF0IHh5IG1vZCA2IDwgMwoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTAsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTEwLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSAqIGopICUgNikgPCAzOyB9KV0sCgkgICAgICAgIC8qKgoJICAgICAgICAgKiAxMTE6IG1hc2sgYml0cyBmb3Igd2hpY2ggKCh4K3kpbW9kIDIgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKiBlcXVpdmFsZW50bHksIHN1Y2ggdGhhdCAoeCArIHkgKyB4eSBtb2QgMykgbW9kIDIgPT0gMAoJICAgICAgICAgKi8KCSAgICAgICAgW0RhdGFNYXNrVmFsdWVzLkRBVEFfTUFTS18xMTEsIG5ldyBEYXRhTWFzayhEYXRhTWFza1ZhbHVlcy5EQVRBX01BU0tfMTExLCBmdW5jdGlvbiAoaSAvKmludCovLCBqIC8qaW50Ki8pIHsgcmV0dXJuICgoaSArIGogKyAoKGkgKiBqKSAlIDMpKSAmIDB4MDEpID09PSAwOyB9KV0sCgkgICAgXSk7CgkgICAgcmV0dXJuIERhdGFNYXNrOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IERhdGFNYXNrOwoKCX0oRGF0YU1hc2spKTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdE1hdHJpeFBhcnNlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7Cgl2YXIgVmVyc2lvbl8xJDEgPSBWZXJzaW9uJDE7Cgl2YXIgRm9ybWF0SW5mb3JtYXRpb25fMSA9IEZvcm1hdEluZm9ybWF0aW9uJDE7Cgl2YXIgRGF0YU1hc2tfMSA9IERhdGFNYXNrOwoJdmFyIEZvcm1hdEV4Y2VwdGlvbl8xJDEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCS8qKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEJpdE1hdHJpeFBhcnNlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYml0TWF0cml4IHtAbGluayBCaXRNYXRyaXh9IHRvIHBhcnNlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgZGltZW5zaW9uIGlzIG5vdCA+PSAyMSBhbmQgMSBtb2QgNAoJICAgICAqLwoJICAgIGZ1bmN0aW9uIEJpdE1hdHJpeFBhcnNlcihiaXRNYXRyaXgpIHsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IGJpdE1hdHJpeC5nZXRIZWlnaHQoKTsKCSAgICAgICAgaWYgKGRpbWVuc2lvbiA8IDIxIHx8IChkaW1lbnNpb24gJiAweDAzKSAhPT0gMSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0TWF0cml4ID0gYml0TWF0cml4OwoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5SZWFkcyBmb3JtYXQgaW5mb3JtYXRpb24gZnJvbSBvbmUgb2YgaXRzIHR3byBsb2NhdGlvbnMgd2l0aGluIHRoZSBRUiBDb2RlLjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEZvcm1hdEluZm9ybWF0aW9ufSBlbmNhcHN1bGF0aW5nIHRoZSBRUiBDb2RlJ3MgZm9ybWF0IGluZm8KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIGZvcm1hdCBpbmZvcm1hdGlvbiBsb2NhdGlvbnMgY2Fubm90IGJlIHBhcnNlZCBhcwoJICAgICAqIHRoZSB2YWxpZCBlbmNvZGluZyBvZiBmb3JtYXQgaW5mb3JtYXRpb24KCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRGb3JtYXRJbmZvcm1hdGlvbiA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgaWYgKHRoaXMucGFyc2VkRm9ybWF0SW5mbyAhPT0gbnVsbCAmJiB0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucGFyc2VkRm9ybWF0SW5mbzsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRvcC1sZWZ0IGZvcm1hdCBpbmZvIGJpdHMKCSAgICAgICAgdmFyIGZvcm1hdEluZm9CaXRzMSA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjsgaSsrKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoaSwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyAuLiBhbmQgc2tpcCBhIGJpdCBpbiB0aGUgdGltaW5nIHBhdHRlcm4gLi4uCgkgICAgICAgIGZvcm1hdEluZm9CaXRzMSA9IHRoaXMuY29weUJpdCg3LCA4LCBmb3JtYXRJbmZvQml0czEpOwoJICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgOCwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgZm9ybWF0SW5mb0JpdHMxID0gdGhpcy5jb3B5Qml0KDgsIDcsIGZvcm1hdEluZm9CaXRzMSk7CgkgICAgICAgIC8vIC4uIGFuZCBza2lwIGEgYml0IGluIHRoZSB0aW1pbmcgcGF0dGVybiAuLi4KCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3JtYXRJbmZvQml0czEgPSB0aGlzLmNvcHlCaXQoOCwgaiwgZm9ybWF0SW5mb0JpdHMxKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBSZWFkIHRoZSB0b3AtcmlnaHQvYm90dG9tLWxlZnQgcGF0dGVybiB0b28KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgZm9ybWF0SW5mb0JpdHMyID0gMDsKCSAgICAgICAgdmFyIGpNaW4gPSBkaW1lbnNpb24gLSA3OwoJICAgICAgICBmb3IgKHZhciBqID0gZGltZW5zaW9uIC0gMTsgaiA+PSBqTWluOyBqLS0pIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdCg4LCBqLCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIGZvciAodmFyIGkgPSBkaW1lbnNpb24gLSA4OyBpIDwgZGltZW5zaW9uOyBpKyspIHsKCSAgICAgICAgICAgIGZvcm1hdEluZm9CaXRzMiA9IHRoaXMuY29weUJpdChpLCA4LCBmb3JtYXRJbmZvQml0czIpOwoJICAgICAgICB9CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IEZvcm1hdEluZm9ybWF0aW9uXzEuZGVmYXVsdC5kZWNvZGVGb3JtYXRJbmZvcm1hdGlvbihmb3JtYXRJbmZvQml0czEsIGZvcm1hdEluZm9CaXRzMik7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZEZvcm1hdEluZm87CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+UmVhZHMgdmVyc2lvbiBpbmZvcm1hdGlvbiBmcm9tIG9uZSBvZiBpdHMgdHdvIGxvY2F0aW9ucyB3aXRoaW4gdGhlIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgVmVyc2lvbn0gZW5jYXBzdWxhdGluZyB0aGUgUVIgQ29kZSdzIHZlcnNpb24KCSAgICAgKiBAdGhyb3dzIEZvcm1hdEV4Y2VwdGlvbiBpZiBib3RoIHZlcnNpb24gaW5mb3JtYXRpb24gbG9jYXRpb25zIGNhbm5vdCBiZSBwYXJzZWQgYXMKCSAgICAgKiB0aGUgdmFsaWQgZW5jb2Rpbmcgb2YgdmVyc2lvbiBpbmZvcm1hdGlvbgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUucmVhZFZlcnNpb24gPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZFZlcnNpb24gIT09IG51bGwgJiYgdGhpcy5wYXJzZWRWZXJzaW9uICE9PSB1bmRlZmluZWQpIHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLnBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgcHJvdmlzaW9uYWxWZXJzaW9uID0gTWF0aC5mbG9vcigoZGltZW5zaW9uIC0gMTcpIC8gNCk7CgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24gPD0gNikgewoJICAgICAgICAgICAgcmV0dXJuIFZlcnNpb25fMSQxLmRlZmF1bHQuZ2V0VmVyc2lvbkZvck51bWJlcihwcm92aXNpb25hbFZlcnNpb24pOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJlYWQgdG9wLXJpZ2h0IHZlcnNpb24gaW5mbzogMyB3aWRlIGJ5IDYgdGFsbAoJICAgICAgICB2YXIgdmVyc2lvbkJpdHMgPSAwOwoJICAgICAgICB2YXIgaWpNaW4gPSBkaW1lbnNpb24gLSAxMTsKCSAgICAgICAgZm9yICh2YXIgaiA9IDU7IGogPj0gMDsgai0tKSB7CgkgICAgICAgICAgICBmb3IgKHZhciBpID0gZGltZW5zaW9uIC0gOTsgaSA+PSBpak1pbjsgaS0tKSB7CgkgICAgICAgICAgICAgICAgdmVyc2lvbkJpdHMgPSB0aGlzLmNvcHlCaXQoaSwgaiwgdmVyc2lvbkJpdHMpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHZhciB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBmYWlsZWQuIFRyeSBib3R0b20gbGVmdDogNiB3aWRlIGJ5IDMgdGFsbAoJICAgICAgICB2ZXJzaW9uQml0cyA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSA1OyBpID49IDA7IGktLSkgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IGRpbWVuc2lvbiAtIDk7IGogPj0gaWpNaW47IGotLSkgewoJICAgICAgICAgICAgICAgIHZlcnNpb25CaXRzID0gdGhpcy5jb3B5Qml0KGksIGosIHZlcnNpb25CaXRzKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICB0aGVQYXJzZWRWZXJzaW9uID0gVmVyc2lvbl8xJDEuZGVmYXVsdC5kZWNvZGVWZXJzaW9uSW5mb3JtYXRpb24odmVyc2lvbkJpdHMpOwoJICAgICAgICBpZiAodGhlUGFyc2VkVmVyc2lvbiAhPT0gbnVsbCAmJiB0aGVQYXJzZWRWZXJzaW9uLmdldERpbWVuc2lvbkZvclZlcnNpb24oKSA9PT0gZGltZW5zaW9uKSB7CgkgICAgICAgICAgICB0aGlzLnBhcnNlZFZlcnNpb24gPSB0aGVQYXJzZWRWZXJzaW9uOwoJICAgICAgICAgICAgcmV0dXJuIHRoZVBhcnNlZFZlcnNpb247CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5jb3B5Qml0ID0gZnVuY3Rpb24gKGkgLyppbnQqLywgaiAvKmludCovLCB2ZXJzaW9uQml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBiaXQgPSB0aGlzLmlzTWlycm9yID8gdGhpcy5iaXRNYXRyaXguZ2V0KGosIGkpIDogdGhpcy5iaXRNYXRyaXguZ2V0KGksIGopOwoJICAgICAgICByZXR1cm4gYml0ID8gKHZlcnNpb25CaXRzIDw8IDEpIHwgMHgxIDogdmVyc2lvbkJpdHMgPDwgMTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlJlYWRzIHRoZSBiaXRzIGluIHRoZSB7QGxpbmsgQml0TWF0cml4fSByZXByZXNlbnRpbmcgdGhlIGZpbmRlciBwYXR0ZXJuIGluIHRoZQoJICAgICAqIGNvcnJlY3Qgb3JkZXIgaW4gb3JkZXIgdG8gcmVjb25zdHJ1Y3QgdGhlIGNvZGV3b3JkcyBieXRlcyBjb250YWluZWQgd2l0aGluIHRoZQoJICAgICAqIFFSIENvZGUuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBleGFjdCBudW1iZXIgb2YgYnl0ZXMgZXhwZWN0ZWQgaXMgbm90IHJlYWQKCSAgICAgKi8KCSAgICBCaXRNYXRyaXhQYXJzZXIucHJvdG90eXBlLnJlYWRDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHZhciBmb3JtYXRJbmZvID0gdGhpcy5yZWFkRm9ybWF0SW5mb3JtYXRpb24oKTsKCSAgICAgICAgdmFyIHZlcnNpb24gPSB0aGlzLnJlYWRWZXJzaW9uKCk7CgkgICAgICAgIC8vIEdldCB0aGUgZGF0YSBtYXNrIGZvciB0aGUgZm9ybWF0IHVzZWQgaW4gdGhpcyBRUiBDb2RlLiBUaGlzIHdpbGwgZXhjbHVkZQoJICAgICAgICAvLyBzb21lIGJpdHMgZnJvbSByZWFkaW5nIGFzIHdlIHdpbmQgdGhyb3VnaCB0aGUgYml0IG1hdHJpeC4KCSAgICAgICAgdmFyIGRhdGFNYXNrID0gRGF0YU1hc2tfMS5kZWZhdWx0LnZhbHVlcy5nZXQoZm9ybWF0SW5mby5nZXREYXRhTWFzaygpKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuYml0TWF0cml4LmdldEhlaWdodCgpOwoJICAgICAgICBkYXRhTWFzay51bm1hc2tCaXRNYXRyaXgodGhpcy5iaXRNYXRyaXgsIGRpbWVuc2lvbik7CgkgICAgICAgIHZhciBmdW5jdGlvblBhdHRlcm4gPSB2ZXJzaW9uLmJ1aWxkRnVuY3Rpb25QYXR0ZXJuKCk7CgkgICAgICAgIHZhciByZWFkaW5nVXAgPSB0cnVlOwoJICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IFVpbnQ4QXJyYXkodmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKTsKCSAgICAgICAgdmFyIHJlc3VsdE9mZnNldCA9IDA7CgkgICAgICAgIHZhciBjdXJyZW50Qnl0ZSA9IDA7CgkgICAgICAgIHZhciBiaXRzUmVhZCA9IDA7CgkgICAgICAgIC8vIFJlYWQgY29sdW1ucyBpbiBwYWlycywgZnJvbSByaWdodCB0byBsZWZ0CgkgICAgICAgIGZvciAodmFyIGogPSBkaW1lbnNpb24gLSAxOyBqID4gMDsgaiAtPSAyKSB7CgkgICAgICAgICAgICBpZiAoaiA9PT0gNikgewoJICAgICAgICAgICAgICAgIC8vIFNraXAgd2hvbGUgY29sdW1uIHdpdGggdmVydGljYWwgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgICAgICAgICAgICAvLyBzYXZlcyB0aW1lIGFuZCBtYWtlcyB0aGUgb3RoZXIgY29kZSBwcm9jZWVkIG1vcmUgY2xlYW5seQoJICAgICAgICAgICAgICAgIGotLTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIC8vIFJlYWQgYWx0ZXJuYXRpbmdseSBmcm9tIGJvdHRvbSB0byB0b3AgdGhlbiB0b3AgdG8gYm90dG9tCgkgICAgICAgICAgICBmb3IgKHZhciBjb3VudCA9IDA7IGNvdW50IDwgZGltZW5zaW9uOyBjb3VudCsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIGkgPSByZWFkaW5nVXAgPyBkaW1lbnNpb24gLSAxIC0gY291bnQgOiBjb3VudDsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBjb2wgPSAwOyBjb2wgPCAyOyBjb2wrKykgewoJICAgICAgICAgICAgICAgICAgICAvLyBJZ25vcmUgYml0cyBjb3ZlcmVkIGJ5IHRoZSBmdW5jdGlvbiBwYXR0ZXJuCgkgICAgICAgICAgICAgICAgICAgIGlmICghZnVuY3Rpb25QYXR0ZXJuLmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVhZCBhIGJpdAoJICAgICAgICAgICAgICAgICAgICAgICAgYml0c1JlYWQrKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIDw8PSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuYml0TWF0cml4LmdldChqIC0gY29sLCBpKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRCeXRlIHw9IDE7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSd2ZSBtYWRlIGEgd2hvbGUgYnl0ZSwgc2F2ZSBpdCBvZmYKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiaXRzUmVhZCA9PT0gOCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtyZXN1bHRPZmZzZXQrK10gPSAvKihieXRlKSAqLyBjdXJyZW50Qnl0ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaXRzUmVhZCA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudEJ5dGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVhZGluZ1VwID0gIXJlYWRpbmdVcDsgLy8gcmVhZGluZ1VwIF49IHRydWU7IC8vIHJlYWRpbmdVcCA9ICFyZWFkaW5nVXA7IC8vIHN3aXRjaCBkaXJlY3Rpb25zCgkgICAgICAgIH0KCSAgICAgICAgaWYgKHJlc3VsdE9mZnNldCAhPT0gdmVyc2lvbi5nZXRUb3RhbENvZGV3b3JkcygpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEkMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldmVydCB0aGUgbWFzayByZW1vdmFsIGRvbmUgd2hpbGUgcmVhZGluZyB0aGUgY29kZSB3b3Jkcy4gVGhlIGJpdCBtYXRyaXggc2hvdWxkIHJldmVydCB0byBpdHMgb3JpZ2luYWwgc3RhdGUuCgkgICAgICovCgkgICAgQml0TWF0cml4UGFyc2VyLnByb3RvdHlwZS5yZW1hc2sgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIGlmICh0aGlzLnBhcnNlZEZvcm1hdEluZm8gPT09IG51bGwpIHsKCSAgICAgICAgICAgIHJldHVybjsgLy8gV2UgaGF2ZSBubyBmb3JtYXQgaW5mb3JtYXRpb24sIGFuZCBoYXZlIG5vIGRhdGEgbWFzawoJICAgICAgICB9CgkgICAgICAgIHZhciBkYXRhTWFzayA9IERhdGFNYXNrXzEuZGVmYXVsdC52YWx1ZXNbdGhpcy5wYXJzZWRGb3JtYXRJbmZvLmdldERhdGFNYXNrKCldOwoJICAgICAgICB2YXIgZGltZW5zaW9uID0gdGhpcy5iaXRNYXRyaXguZ2V0SGVpZ2h0KCk7CgkgICAgICAgIGRhdGFNYXNrLnVubWFza0JpdE1hdHJpeCh0aGlzLmJpdE1hdHJpeCwgZGltZW5zaW9uKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFByZXBhcmUgdGhlIHBhcnNlciBmb3IgYSBtaXJyb3JlZCBvcGVyYXRpb24uCgkgICAgICogVGhpcyBmbGFnIGhhcyBlZmZlY3Qgb25seSBvbiB0aGUge0BsaW5rICNyZWFkRm9ybWF0SW5mb3JtYXRpb24oKX0gYW5kIHRoZQoJICAgICAqIHtAbGluayAjcmVhZFZlcnNpb24oKX0uIEJlZm9yZSBwcm9jZWVkaW5nIHdpdGgge0BsaW5rICNyZWFkQ29kZXdvcmRzKCl9IHRoZQoJICAgICAqIHtAbGluayAjbWlycm9yKCl9IG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkLgoJICAgICAqCgkgICAgICogQHBhcmFtIG1pcnJvciBXaGV0aGVyIHRvIHJlYWQgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm9ybWF0aW9uIG1pcnJvcmVkLgoJICAgICAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUuc2V0TWlycm9yID0gZnVuY3Rpb24gKGlzTWlycm9yKSB7CgkgICAgICAgIHRoaXMucGFyc2VkVmVyc2lvbiA9IG51bGw7CgkgICAgICAgIHRoaXMucGFyc2VkRm9ybWF0SW5mbyA9IG51bGw7CgkgICAgICAgIHRoaXMuaXNNaXJyb3IgPSBpc01pcnJvcjsKCSAgICB9OwoJICAgIC8qKiBNaXJyb3IgdGhlIGJpdCBtYXRyaXggaW4gb3JkZXIgdG8gYXR0ZW1wdCBhIHNlY29uZCByZWFkaW5nLiAqLwoJICAgIEJpdE1hdHJpeFBhcnNlci5wcm90b3R5cGUubWlycm9yID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgYml0TWF0cml4ID0gdGhpcy5iaXRNYXRyaXg7CgkgICAgICAgIGZvciAodmFyIHggPSAwLCB3aWR0aCA9IGJpdE1hdHJpeC5nZXRXaWR0aCgpOyB4IDwgd2lkdGg7IHgrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgeSA9IHggKyAxLCBoZWlnaHQgPSBiaXRNYXRyaXguZ2V0SGVpZ2h0KCk7IHkgPCBoZWlnaHQ7IHkrKykgewoJICAgICAgICAgICAgICAgIGlmIChiaXRNYXRyaXguZ2V0KHgsIHkpICE9PSBiaXRNYXRyaXguZ2V0KHksIHgpKSB7CgkgICAgICAgICAgICAgICAgICAgIGJpdE1hdHJpeC5mbGlwKHksIHgpOwoJICAgICAgICAgICAgICAgICAgICBiaXRNYXRyaXguZmxpcCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHJldHVybiBCaXRNYXRyaXhQYXJzZXI7Cgl9KCkpOwoJQml0TWF0cml4UGFyc2VyJDEuZGVmYXVsdCA9IEJpdE1hdHJpeFBhcnNlcjsKCgl2YXIgRGF0YUJsb2NrJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGF0YUJsb2NrJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSQxID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIGJsb2NrIG9mIGRhdGEgd2l0aGluIGEgUVIgQ29kZS4gUVIgQ29kZXMgbWF5IHNwbGl0IHRoZWlyIGRhdGEgaW50bwoJICogbXVsdGlwbGUgYmxvY2tzLCBlYWNoIG9mIHdoaWNoIGlzIGEgdW5pdCBvZiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3Jkcy4gRWFjaAoJICogaXMgcmVwcmVzZW50ZWQgYnkgYW4gaW5zdGFuY2Ugb2YgdGhpcyBjbGFzcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERhdGFCbG9jayA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEYXRhQmxvY2sobnVtRGF0YUNvZGV3b3JkcyAvKmludCovLCBjb2Rld29yZHMpIHsKCSAgICAgICAgdGhpcy5udW1EYXRhQ29kZXdvcmRzID0gbnVtRGF0YUNvZGV3b3JkczsKCSAgICAgICAgdGhpcy5jb2Rld29yZHMgPSBjb2Rld29yZHM7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIDxwPldoZW4gUVIgQ29kZXMgdXNlIG11bHRpcGxlIGRhdGEgYmxvY2tzLCB0aGV5IGFyZSBhY3R1YWxseSBpbnRlcmxlYXZlZC4KCSAgICAgKiBUaGF0IGlzLCB0aGUgZmlyc3QgYnl0ZSBvZiBkYXRhIGJsb2NrIDEgdG8gbiBpcyB3cml0dGVuLCB0aGVuIHRoZSBzZWNvbmQgYnl0ZXMsIGFuZCBzbyBvbi4gVGhpcwoJICAgICAqIG1ldGhvZCB3aWxsIHNlcGFyYXRlIHRoZSBkYXRhIGludG8gb3JpZ2luYWwgYmxvY2tzLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSByYXdDb2Rld29yZHMgYnl0ZXMgYXMgcmVhZCBkaXJlY3RseSBmcm9tIHRoZSBRUiBDb2RlCgkgICAgICogQHBhcmFtIHZlcnNpb24gdmVyc2lvbiBvZiB0aGUgUVIgQ29kZQoJICAgICAqIEBwYXJhbSBlY0xldmVsIGVycm9yLWNvcnJlY3Rpb24gbGV2ZWwgb2YgdGhlIFFSIENvZGUKCSAgICAgKiBAcmV0dXJuIERhdGFCbG9ja3MgY29udGFpbmluZyBvcmlnaW5hbCBieXRlcywgImRlLWludGVybGVhdmVkIiBmcm9tIHJlcHJlc2VudGF0aW9uIGluIHRoZQoJICAgICAqICAgICAgICAgUVIgQ29kZQoJICAgICAqLwoJICAgIERhdGFCbG9jay5nZXREYXRhQmxvY2tzID0gZnVuY3Rpb24gKHJhd0NvZGV3b3JkcywgdmVyc2lvbiwgZWNMZXZlbCkgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgaWYgKHJhd0NvZGV3b3Jkcy5sZW5ndGggIT09IHZlcnNpb24uZ2V0VG90YWxDb2Rld29yZHMoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG51bWJlciBhbmQgc2l6ZSBvZiBkYXRhIGJsb2NrcyB1c2VkIGJ5IHRoaXMgdmVyc2lvbiBhbmQKCSAgICAgICAgLy8gZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJICAgICAgICB2YXIgZWNCbG9ja3MgPSB2ZXJzaW9uLmdldEVDQmxvY2tzRm9yTGV2ZWwoZWNMZXZlbCk7CgkgICAgICAgIC8vIEZpcnN0IGNvdW50IHRoZSB0b3RhbCBudW1iZXIgb2YgZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIHRvdGFsQmxvY2tzID0gMDsKCSAgICAgICAgdmFyIGVjQmxvY2tBcnJheSA9IGVjQmxvY2tzLmdldEVDQmxvY2tzKCk7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICBmb3IgKHZhciBlY0Jsb2NrQXJyYXlfMSA9IF9fdmFsdWVzJDMoZWNCbG9ja0FycmF5KSwgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKTsgIWVjQmxvY2tBcnJheV8xXzEuZG9uZTsgZWNCbG9ja0FycmF5XzFfMSA9IGVjQmxvY2tBcnJheV8xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgIHZhciBlY0Jsb2NrID0gZWNCbG9ja0FycmF5XzFfMS52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbEJsb2NrcyArPSBlY0Jsb2NrLmdldENvdW50KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChlY0Jsb2NrQXJyYXlfMV8xICYmICFlY0Jsb2NrQXJyYXlfMV8xLmRvbmUgJiYgKF9hID0gZWNCbG9ja0FycmF5XzEucmV0dXJuKSkgX2EuY2FsbChlY0Jsb2NrQXJyYXlfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGVzdGFibGlzaCBEYXRhQmxvY2tzIG9mIHRoZSBhcHByb3ByaWF0ZSBzaXplIGFuZCBudW1iZXIgb2YgZGF0YSBjb2Rld29yZHMKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBBcnJheSh0b3RhbEJsb2Nrcyk7CgkgICAgICAgIHZhciBudW1SZXN1bHRCbG9ja3MgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZWNCbG9ja0FycmF5XzIgPSBfX3ZhbHVlcyQzKGVjQmxvY2tBcnJheSksIGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCk7ICFlY0Jsb2NrQXJyYXlfMl8xLmRvbmU7IGVjQmxvY2tBcnJheV8yXzEgPSBlY0Jsb2NrQXJyYXlfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZWNCbG9jayA9IGVjQmxvY2tBcnJheV8yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlY0Jsb2NrLmdldENvdW50KCk7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtRGF0YUNvZGV3b3JkcyA9IGVjQmxvY2suZ2V0RGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgICAgICB2YXIgbnVtQmxvY2tDb2Rld29yZHMgPSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCkgKyBudW1EYXRhQ29kZXdvcmRzOwoJICAgICAgICAgICAgICAgICAgICByZXN1bHRbbnVtUmVzdWx0QmxvY2tzKytdID0gbmV3IERhdGFCbG9jayhudW1EYXRhQ29kZXdvcmRzLCBuZXcgVWludDhBcnJheShudW1CbG9ja0NvZGV3b3JkcykpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGVjQmxvY2tBcnJheV8yXzEgJiYgIWVjQmxvY2tBcnJheV8yXzEuZG9uZSAmJiAoX2IgPSBlY0Jsb2NrQXJyYXlfMi5yZXR1cm4pKSBfYi5jYWxsKGVjQmxvY2tBcnJheV8yKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8yKSB0aHJvdyBlXzIuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICAvLyBBbGwgYmxvY2tzIGhhdmUgdGhlIHNhbWUgYW1vdW50IG9mIGRhdGEsIGV4Y2VwdCB0aGF0IHRoZSBsYXN0IG4KCSAgICAgICAgLy8gKHdoZXJlIG4gbWF5IGJlIDApIGhhdmUgMSBtb3JlIGJ5dGUuIEZpZ3VyZSBvdXQgd2hlcmUgdGhlc2Ugc3RhcnQuCgkgICAgICAgIHZhciBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGxvbmdlckJsb2Nrc1N0YXJ0QXQgPSByZXN1bHQubGVuZ3RoIC0gMTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IGNoZWNrIGxlbmd0aCBpcyBjb3JyZWN0IGhlcmUKCSAgICAgICAgd2hpbGUgKGxvbmdlckJsb2Nrc1N0YXJ0QXQgPj0gMCkgewoJICAgICAgICAgICAgdmFyIG51bUNvZGV3b3JkcyA9IHJlc3VsdFtsb25nZXJCbG9ja3NTdGFydEF0XS5jb2Rld29yZHMubGVuZ3RoOwoJICAgICAgICAgICAgaWYgKG51bUNvZGV3b3JkcyA9PT0gc2hvcnRlckJsb2Nrc1RvdGFsQ29kZXdvcmRzKSB7CgkgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsb25nZXJCbG9ja3NTdGFydEF0LS07CgkgICAgICAgIH0KCSAgICAgICAgbG9uZ2VyQmxvY2tzU3RhcnRBdCsrOwoJICAgICAgICB2YXIgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHMgPSBzaG9ydGVyQmxvY2tzVG90YWxDb2Rld29yZHMgLSBlY0Jsb2Nrcy5nZXRFQ0NvZGV3b3Jkc1BlckJsb2NrKCk7CgkgICAgICAgIC8vIFRoZSBsYXN0IGVsZW1lbnRzIG9mIHJlc3VsdCBtYXkgYmUgMSBlbGVtZW50IGxvbmdlcgoJICAgICAgICAvLyBmaXJzdCBmaWxsIG91dCBhcyBtYW55IGVsZW1lbnRzIGFzIGFsbCBvZiB0aGVtIGhhdmUKCSAgICAgICAgdmFyIHJhd0NvZGV3b3Jkc09mZnNldCA9IDA7CgkgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBudW1SZXN1bHRCbG9ja3M7IGorKykgewoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaV0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIC8vIEZpbGwgb3V0IHRoZSBsYXN0IGRhdGEgYmxvY2sgaW4gdGhlIGxvbmdlciBvbmVzCgkgICAgICAgIGZvciAodmFyIGogPSBsb25nZXJCbG9ja3NTdGFydEF0OyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbc2hvcnRlckJsb2Nrc051bURhdGFDb2Rld29yZHNdID0gcmF3Q29kZXdvcmRzW3Jhd0NvZGV3b3Jkc09mZnNldCsrXTsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cgYWRkIGluIGVycm9yIGNvcnJlY3Rpb24gYmxvY2tzCgkgICAgICAgIHZhciBtYXggPSByZXN1bHRbMF0uY29kZXdvcmRzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IHNob3J0ZXJCbG9ja3NOdW1EYXRhQ29kZXdvcmRzOyBpIDwgbWF4OyBpKyspIHsKCSAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbnVtUmVzdWx0QmxvY2tzOyBqKyspIHsKCSAgICAgICAgICAgICAgICB2YXIgaU9mZnNldCA9IGogPCBsb25nZXJCbG9ja3NTdGFydEF0ID8gaSA6IGkgKyAxOwoJICAgICAgICAgICAgICAgIHJlc3VsdFtqXS5jb2Rld29yZHNbaU9mZnNldF0gPSByYXdDb2Rld29yZHNbcmF3Q29kZXdvcmRzT2Zmc2V0KytdOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiByZXN1bHQ7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldE51bURhdGFDb2Rld29yZHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bURhdGFDb2Rld29yZHM7CgkgICAgfTsKCSAgICBEYXRhQmxvY2sucHJvdG90eXBlLmdldENvZGV3b3JkcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuY29kZXdvcmRzOwoJICAgIH07CgkgICAgcmV0dXJuIERhdGFCbG9jazsKCX0oKSk7CglEYXRhQmxvY2skMS5kZWZhdWx0ID0gRGF0YUJsb2NrOwoKCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEgPSB7fTsKCgl2YXIgQml0U291cmNlJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEJpdFNvdXJjZSQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbiB7Ki8KCXZhciBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMSA9IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiA8cD5UaGlzIHByb3ZpZGVzIGFuIGVhc3kgYWJzdHJhY3Rpb24gdG8gcmVhZCBiaXRzIGF0IGEgdGltZSBmcm9tIGEgc2VxdWVuY2Ugb2YgYnl0ZXMsIHdoZXJlIHRoZQoJICogbnVtYmVyIG9mIGJpdHMgcmVhZCBpcyBub3Qgb2Z0ZW4gYSBtdWx0aXBsZSBvZiA4LjwvcD4KCSAqCgkgKiA8cD5UaGlzIGNsYXNzIGlzIHRocmVhZC1zYWZlIGJ1dCBub3QgcmVlbnRyYW50IC0tIHVubGVzcyB0aGUgY2FsbGVyIG1vZGlmaWVzIHRoZSBieXRlcyBhcnJheQoJICogaXQgcGFzc2VkIGluLCBpbiB3aGljaCBjYXNlIGFsbCBiZXRzIGFyZSBvZmYuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBCaXRTb3VyY2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJ5dGVzIGJ5dGVzIGZyb20gd2hpY2ggdGhpcyB3aWxsIHJlYWQgYml0cy4gQml0cyB3aWxsIGJlIHJlYWQgZnJvbSB0aGUgZmlyc3QgYnl0ZSBmaXJzdC4KCSAgICAgKiBCaXRzIGFyZSByZWFkIHdpdGhpbiBhIGJ5dGUgZnJvbSBtb3N0LXNpZ25pZmljYW50IHRvIGxlYXN0LXNpZ25pZmljYW50IGJpdC4KCSAgICAgKi8KCSAgICBmdW5jdGlvbiBCaXRTb3VyY2UoYnl0ZXMpIHsKCSAgICAgICAgdGhpcy5ieXRlcyA9IGJ5dGVzOwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSAwOwoJICAgICAgICB0aGlzLmJpdE9mZnNldCA9IDA7CgkgICAgfQoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaW5kZXggb2YgbmV4dCBiaXQgaW4gY3VycmVudCBieXRlIHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qml0T2Zmc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5iaXRPZmZzZXQ7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGluZGV4IG9mIG5leHQgYnl0ZSBpbiBpbnB1dCBieXRlIGFycmF5IHdoaWNoIHdvdWxkIGJlIHJlYWQgYnkgdGhlIG5leHQgY2FsbCB0byB7QGxpbmsgI3JlYWRCaXRzKGludCl9LgoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuZ2V0Qnl0ZU9mZnNldCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYnl0ZU9mZnNldDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBudW1CaXRzIG51bWJlciBvZiBiaXRzIHRvIHJlYWQKCSAgICAgKiBAcmV0dXJuIGludCByZXByZXNlbnRpbmcgdGhlIGJpdHMgcmVhZC4gVGhlIGJpdHMgd2lsbCBhcHBlYXIgYXMgdGhlIGxlYXN0LXNpZ25pZmljYW50CgkgICAgICogICAgICAgICBiaXRzIG9mIHRoZSBpbnQKCSAgICAgKiBAdGhyb3dzIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbiBpZiBudW1CaXRzIGlzbid0IGluIFsxLDMyXSBvciBtb3JlIHRoYW4gaXMgYXZhaWxhYmxlCgkgICAgICovCgkgICAgQml0U291cmNlLnByb3RvdHlwZS5yZWFkQml0cyA9IGZ1bmN0aW9uIChudW1CaXRzIC8qaW50Ki8pIHsKCSAgICAgICAgaWYgKG51bUJpdHMgPCAxIHx8IG51bUJpdHMgPiAzMiB8fCBudW1CaXRzID4gdGhpcy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xLmRlZmF1bHQoJycgKyBudW1CaXRzKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVzdWx0ID0gMDsKCSAgICAgICAgdmFyIGJpdE9mZnNldCA9IHRoaXMuYml0T2Zmc2V0OwoJICAgICAgICB2YXIgYnl0ZU9mZnNldCA9IHRoaXMuYnl0ZU9mZnNldDsKCSAgICAgICAgdmFyIGJ5dGVzID0gdGhpcy5ieXRlczsKCSAgICAgICAgLy8gRmlyc3QsIHJlYWQgcmVtYWluZGVyIGZyb20gY3VycmVudCBieXRlCgkgICAgICAgIGlmIChiaXRPZmZzZXQgPiAwKSB7CgkgICAgICAgICAgICB2YXIgYml0c0xlZnQgPSA4IC0gYml0T2Zmc2V0OwoJICAgICAgICAgICAgdmFyIHRvUmVhZCA9IG51bUJpdHMgPCBiaXRzTGVmdCA/IG51bUJpdHMgOiBiaXRzTGVmdDsKCSAgICAgICAgICAgIHZhciBiaXRzVG9Ob3RSZWFkID0gYml0c0xlZnQgLSB0b1JlYWQ7CgkgICAgICAgICAgICB2YXIgbWFzayA9ICgweEZGID4+ICg4IC0gdG9SZWFkKSkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgIHJlc3VsdCA9IChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQ7CgkgICAgICAgICAgICBudW1CaXRzIC09IHRvUmVhZDsKCSAgICAgICAgICAgIGJpdE9mZnNldCArPSB0b1JlYWQ7CgkgICAgICAgICAgICBpZiAoYml0T2Zmc2V0ID09PSA4KSB7CgkgICAgICAgICAgICAgICAgYml0T2Zmc2V0ID0gMDsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gTmV4dCByZWFkIHdob2xlIGJ5dGVzCgkgICAgICAgIGlmIChudW1CaXRzID4gMCkgewoJICAgICAgICAgICAgd2hpbGUgKG51bUJpdHMgPj0gOCkgewoJICAgICAgICAgICAgICAgIHJlc3VsdCA9IChyZXN1bHQgPDwgOCkgfCAoYnl0ZXNbYnl0ZU9mZnNldF0gJiAweEZGKTsKCSAgICAgICAgICAgICAgICBieXRlT2Zmc2V0Kys7CgkgICAgICAgICAgICAgICAgbnVtQml0cyAtPSA4OwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gRmluYWxseSByZWFkIGEgcGFydGlhbCBieXRlCgkgICAgICAgICAgICBpZiAobnVtQml0cyA+IDApIHsKCSAgICAgICAgICAgICAgICB2YXIgYml0c1RvTm90UmVhZCA9IDggLSBudW1CaXRzOwoJICAgICAgICAgICAgICAgIHZhciBtYXNrID0gKDB4RkYgPj4gYml0c1RvTm90UmVhZCkgPDwgYml0c1RvTm90UmVhZDsKCSAgICAgICAgICAgICAgICByZXN1bHQgPSAocmVzdWx0IDw8IG51bUJpdHMpIHwgKChieXRlc1tieXRlT2Zmc2V0XSAmIG1hc2spID4+IGJpdHNUb05vdFJlYWQpOwoJICAgICAgICAgICAgICAgIGJpdE9mZnNldCArPSBudW1CaXRzOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHRoaXMuYml0T2Zmc2V0ID0gYml0T2Zmc2V0OwoJICAgICAgICB0aGlzLmJ5dGVPZmZzZXQgPSBieXRlT2Zmc2V0OwoJICAgICAgICByZXR1cm4gcmVzdWx0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB0aGF0IGNhbiBiZSByZWFkIHN1Y2Nlc3NmdWxseQoJICAgICAqLwoJICAgIEJpdFNvdXJjZS5wcm90b3R5cGUuYXZhaWxhYmxlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gOCAqICh0aGlzLmJ5dGVzLmxlbmd0aCAtIHRoaXMuYnl0ZU9mZnNldCkgLSB0aGlzLmJpdE9mZnNldDsKCSAgICB9OwoJICAgIHJldHVybiBCaXRTb3VyY2U7Cgl9KCkpOwoJQml0U291cmNlJDEuZGVmYXVsdCA9IEJpdFNvdXJjZTsKCgl2YXIgRGVjb2RlclJlc3VsdCQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVyUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGVjb2RpbmcgYSBtYXRyaXggb2YgYml0cy4gVGhpcyB0eXBpY2FsbHkKCSAqIGFwcGxpZXMgdG8gMkQgYmFyY29kZSBmb3JtYXRzLiBGb3Igbm93IGl0IGNvbnRhaW5zIHRoZSByYXcgYnl0ZXMgb2J0YWluZWQsCgkgKiBhcyB3ZWxsIGFzIGEgU3RyaW5nIGludGVycHJldGF0aW9uIG9mIHRob3NlIGJ5dGVzLCBpZiBhcHBsaWNhYmxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlclJlc3VsdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IocmF3Qnl0ZXM6IFVpbnQ4QXJyYXksCgkgICAgLy8gICAgICAgICAgICAgICAgICAgICAgdGV4dDogc3RyaW5nLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIExpc3Q8VWludDhBcnJheT4gYnl0ZVNlZ21lbnRzLAoJICAgIC8vICAgICAgICAgICAgICAgICAgICAgIFN0cmluZyBlY0xldmVsKSB7CgkgICAgLy8gICB0aGlzKHJhd0J5dGVzLCB0ZXh0LCBieXRlU2VnbWVudHMsIGVjTGV2ZWwsIC0xLCAtMSkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRGVjb2RlclJlc3VsdChyYXdCeXRlcywgdGV4dCwgYnl0ZVNlZ21lbnRzLCBlY0xldmVsLCBzdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXIsIHN0cnVjdHVyZWRBcHBlbmRQYXJpdHkpIHsKCSAgICAgICAgaWYgKHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9PT0gdm9pZCAwKSB7IHN0cnVjdHVyZWRBcHBlbmRTZXF1ZW5jZU51bWJlciA9IC0xOyB9CgkgICAgICAgIGlmIChzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID09PSB2b2lkIDApIHsgc3RydWN0dXJlZEFwcGVuZFBhcml0eSA9IC0xOyB9CgkgICAgICAgIHRoaXMucmF3Qnl0ZXMgPSByYXdCeXRlczsKCSAgICAgICAgdGhpcy50ZXh0ID0gdGV4dDsKCSAgICAgICAgdGhpcy5ieXRlU2VnbWVudHMgPSBieXRlU2VnbWVudHM7CgkgICAgICAgIHRoaXMuZWNMZXZlbCA9IGVjTGV2ZWw7CgkgICAgICAgIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyOwoJICAgICAgICB0aGlzLnN0cnVjdHVyZWRBcHBlbmRQYXJpdHkgPSBzdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgICAgICB0aGlzLm51bUJpdHMgPSAocmF3Qnl0ZXMgPT09IHVuZGVmaW5lZCB8fCByYXdCeXRlcyA9PT0gbnVsbCkgPyAwIDogOCAqIHJhd0J5dGVzLmxlbmd0aDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiByYXcgYnl0ZXMgcmVwcmVzZW50aW5nIHRoZSByZXN1bHQsIG9yIHtAY29kZSBudWxsfSBpZiBub3QgYXBwbGljYWJsZQoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldFJhd0J5dGVzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yYXdCeXRlczsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gaG93IG1hbnkgYml0cyBvZiB7QGxpbmsgI2dldFJhd0J5dGVzKCl9IGFyZSB2YWxpZDsgdHlwaWNhbGx5IDggdGltZXMgaXRzIGxlbmd0aAoJICAgICAqIEBzaW5jZSAzLjMuMAoJICAgICAqLwoJICAgIERlY29kZXJSZXN1bHQucHJvdG90eXBlLmdldE51bUJpdHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm51bUJpdHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gbnVtQml0cyBvdmVycmlkZXMgdGhlIG51bWJlciBvZiBiaXRzIHRoYXQgYXJlIHZhbGlkIGluIHtAbGluayAjZ2V0UmF3Qnl0ZXMoKX0KCSAgICAgKiBAc2luY2UgMy4zLjAKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXROdW1CaXRzID0gZnVuY3Rpb24gKG51bUJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLm51bUJpdHMgPSBudW1CaXRzOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0ZXh0IHJlcHJlc2VudGF0aW9uIG9mIHRoZSByZXN1bHQKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRUZXh0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50ZXh0OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBsaXN0IG9mIGJ5dGUgc2VnbWVudHMgaW4gdGhlIHJlc3VsdCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0Qnl0ZVNlZ21lbnRzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5ieXRlU2VnbWVudHM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIG5hbWUgb2YgZXJyb3IgY29ycmVjdGlvbiBsZXZlbCB1c2VkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFQ0xldmVsID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lY0xldmVsOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJyb3JzIGNvcnJlY3RlZCwgb3Ige0Bjb2RlIG51bGx9IGlmIG5vdCBhcHBsaWNhYmxlCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0RXJyb3JzQ29ycmVjdGVkID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lcnJvcnNDb3JyZWN0ZWQ7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcnJvcnNDb3JyZWN0ZWQgPSBmdW5jdGlvbiAoZXJyb3JzQ29ycmVjdGVkIC8qSW50ZWdlciovKSB7CgkgICAgICAgIHRoaXMuZXJyb3JzQ29ycmVjdGVkID0gZXJyb3JzQ29ycmVjdGVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgZXJhc3VyZXMgY29ycmVjdGVkLCBvciB7QGNvZGUgbnVsbH0gaWYgbm90IGFwcGxpY2FibGUKCSAgICAgKi8KCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRFcmFzdXJlcyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuZXJhc3VyZXM7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5zZXRFcmFzdXJlcyA9IGZ1bmN0aW9uIChlcmFzdXJlcyAvKkludGVnZXIqLykgewoJICAgICAgICB0aGlzLmVyYXN1cmVzID0gZXJhc3VyZXM7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIGFyYml0cmFyeSBhZGRpdGlvbmFsIG1ldGFkYXRhCgkgICAgICovCgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0T3RoZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuc2V0T3RoZXIgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgdGhpcy5vdGhlciA9IG90aGVyOwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuaGFzU3RydWN0dXJlZEFwcGVuZCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuc3RydWN0dXJlZEFwcGVuZFBhcml0eSA+PSAwICYmIHRoaXMuc3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID49IDA7CgkgICAgfTsKCSAgICBEZWNvZGVyUmVzdWx0LnByb3RvdHlwZS5nZXRTdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kUGFyaXR5OwoJICAgIH07CgkgICAgRGVjb2RlclJlc3VsdC5wcm90b3R5cGUuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJ1Y3R1cmVkQXBwZW5kU2VxdWVuY2VOdW1iZXI7CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlclJlc3VsdDsKCX0oKSk7CglEZWNvZGVyUmVzdWx0JDEuZGVmYXVsdCA9IERlY29kZXJSZXN1bHQ7CgoJdmFyIE1vZGUgPSB7fTsKCgkoZnVuY3Rpb24gKGV4cG9ydHMpIHsKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJZXhwb3J0cy5Nb2RlVmFsdWVzID0gdm9pZCAwOwoJdmFyIElsbGVnYWxBcmd1bWVudEV4Y2VwdGlvbl8xID0gSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uJDE7Cgl2YXIgTW9kZVZhbHVlczsKCShmdW5jdGlvbiAoTW9kZVZhbHVlcykgewoJICAgIE1vZGVWYWx1ZXNbTW9kZVZhbHVlc1siVEVSTUlOQVRPUiJdID0gMF0gPSAiVEVSTUlOQVRPUiI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJOVU1FUklDIl0gPSAxXSA9ICJOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkFMUEhBTlVNRVJJQyJdID0gMl0gPSAiQUxQSEFOVU1FUklDIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIlNUUlVDVFVSRURfQVBQRU5EIl0gPSAzXSA9ICJTVFJVQ1RVUkVEX0FQUEVORCI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJCWVRFIl0gPSA0XSA9ICJCWVRFIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkVDSSJdID0gNV0gPSAiRUNJIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIktBTkpJIl0gPSA2XSA9ICJLQU5KSSI7CgkgICAgTW9kZVZhbHVlc1tNb2RlVmFsdWVzWyJGTkMxX0ZJUlNUX1BPU0lUSU9OIl0gPSA3XSA9ICJGTkMxX0ZJUlNUX1BPU0lUSU9OIjsKCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkZOQzFfU0VDT05EX1BPU0lUSU9OIl0gPSA4XSA9ICJGTkMxX1NFQ09ORF9QT1NJVElPTiI7CgkgICAgLyoqIFNlZSBHQlQgMTgyODQtMjAwMDsgIkhhbnppIiBpcyBhIHRyYW5zbGl0ZXJhdGlvbiBvZiB0aGlzIG1vZGUgbmFtZS4gKi8KCSAgICBNb2RlVmFsdWVzW01vZGVWYWx1ZXNbIkhBTlpJIl0gPSA5XSA9ICJIQU5aSSI7Cgl9KShNb2RlVmFsdWVzID0gZXhwb3J0cy5Nb2RlVmFsdWVzIHx8IChleHBvcnRzLk1vZGVWYWx1ZXMgPSB7fSkpOwoJLyoqCgkgKiA8cD5TZWUgSVNPIDE4MDA0OjIwMDYsIDYuNC4xLCBUYWJsZXMgMiBhbmQgMy4gVGhpcyBlbnVtIGVuY2Fwc3VsYXRlcyB0aGUgdmFyaW91cyBtb2RlcyBpbiB3aGljaAoJICogZGF0YSBjYW4gYmUgZW5jb2RlZCB0byBiaXRzIGluIHRoZSBRUiBjb2RlIHN0YW5kYXJkLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgTW9kZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBNb2RlKHZhbHVlLCBzdHJpbmdWYWx1ZSwgY2hhcmFjdGVyQ291bnRCaXRzRm9yVmVyc2lvbnMsIGJpdHMgLyppbnQqLykgewoJICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7CgkgICAgICAgIHRoaXMuc3RyaW5nVmFsdWUgPSBzdHJpbmdWYWx1ZTsKCSAgICAgICAgdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9ucyA9IGNoYXJhY3RlckNvdW50Qml0c0ZvclZlcnNpb25zOwoJICAgICAgICB0aGlzLmJpdHMgPSBiaXRzOwoJICAgICAgICBNb2RlLkZPUl9CSVRTLnNldChiaXRzLCB0aGlzKTsKCSAgICAgICAgTW9kZS5GT1JfVkFMVUUuc2V0KHZhbHVlLCB0aGlzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHBhcmFtIGJpdHMgZm91ciBiaXRzIGVuY29kaW5nIGEgUVIgQ29kZSBkYXRhIG1vZGUKCSAgICAgKiBAcmV0dXJuIE1vZGUgZW5jb2RlZCBieSB0aGVzZSBiaXRzCgkgICAgICogQHRocm93cyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb24gaWYgYml0cyBkbyBub3QgY29ycmVzcG9uZCB0byBhIGtub3duIG1vZGUKCSAgICAgKi8KCSAgICBNb2RlLmZvckJpdHMgPSBmdW5jdGlvbiAoYml0cyAvKmludCovKSB7CgkgICAgICAgIHZhciBtb2RlID0gTW9kZS5GT1JfQklUUy5nZXQoYml0cyk7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IG1vZGUpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBJbGxlZ2FsQXJndW1lbnRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG1vZGU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gdmVyc2lvbiB2ZXJzaW9uIGluIHF1ZXN0aW9uCgkgICAgICogQHJldHVybiBudW1iZXIgb2YgYml0cyB1c2VkLCBpbiB0aGlzIFFSIENvZGUgc3ltYm9sIHtAbGluayBWZXJzaW9ufSwgdG8gZW5jb2RlIHRoZQoJICAgICAqICAgICAgICAgY291bnQgb2YgY2hhcmFjdGVycyB0aGF0IHdpbGwgZm9sbG93IGVuY29kZWQgaW4gdGhpcyBNb2RlCgkgICAgICovCgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Q2hhcmFjdGVyQ291bnRCaXRzID0gZnVuY3Rpb24gKHZlcnNpb24pIHsKCSAgICAgICAgdmFyIHZlcnNpb25OdW1iZXIgPSB2ZXJzaW9uLmdldFZlcnNpb25OdW1iZXIoKTsKCSAgICAgICAgdmFyIG9mZnNldDsKCSAgICAgICAgaWYgKHZlcnNpb25OdW1iZXIgPD0gOSkgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmICh2ZXJzaW9uTnVtYmVyIDw9IDI2KSB7CgkgICAgICAgICAgICBvZmZzZXQgPSAxOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgb2Zmc2V0ID0gMjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gdGhpcy5jaGFyYWN0ZXJDb3VudEJpdHNGb3JWZXJzaW9uc1tvZmZzZXRdOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0VmFsdWUgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlOwoJICAgIH07CgkgICAgTW9kZS5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLmVxdWFscyA9IGZ1bmN0aW9uIChvKSB7CgkgICAgICAgIGlmICghKG8gaW5zdGFuY2VvZiBNb2RlKSkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlciA9IG87CgkgICAgICAgIHJldHVybiB0aGlzLnZhbHVlID09PSBvdGhlci52YWx1ZTsKCSAgICB9OwoJICAgIE1vZGUucHJvdG90eXBlLnRvU3RyaW5nID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5zdHJpbmdWYWx1ZTsKCSAgICB9OwoJICAgIE1vZGUuRk9SX0JJVFMgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5GT1JfVkFMVUUgPSBuZXcgTWFwKCk7CgkgICAgTW9kZS5URVJNSU5BVE9SID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5URVJNSU5BVE9SLCAnVEVSTUlOQVRPUicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDAwKTsgLy8gTm90IHJlYWxseSBhIG1vZGUuLi4KCSAgICBNb2RlLk5VTUVSSUMgPSBuZXcgTW9kZShNb2RlVmFsdWVzLk5VTUVSSUMsICdOVU1FUklDJywgSW50MzJBcnJheS5mcm9tKFsxMCwgMTIsIDE0XSksIDB4MDEpOwoJICAgIE1vZGUuQUxQSEFOVU1FUklDID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5BTFBIQU5VTUVSSUMsICdBTFBIQU5VTUVSSUMnLCBJbnQzMkFycmF5LmZyb20oWzksIDExLCAxM10pLCAweDAyKTsKCSAgICBNb2RlLlNUUlVDVFVSRURfQVBQRU5EID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5TVFJVQ1RVUkVEX0FQUEVORCwgJ1NUUlVDVFVSRURfQVBQRU5EJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDMpOyAvLyBOb3Qgc3VwcG9ydGVkCgkgICAgTW9kZS5CWVRFID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5CWVRFLCAnQllURScsIEludDMyQXJyYXkuZnJvbShbOCwgMTYsIDE2XSksIDB4MDQpOwoJICAgIE1vZGUuRUNJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5FQ0ksICdFQ0knLCBJbnQzMkFycmF5LmZyb20oWzAsIDAsIDBdKSwgMHgwNyk7IC8vIGNoYXJhY3RlciBjb3VudHMgZG9uJ3QgYXBwbHkKCSAgICBNb2RlLktBTkpJID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5LQU5KSSwgJ0tBTkpJJywgSW50MzJBcnJheS5mcm9tKFs4LCAxMCwgMTJdKSwgMHgwOCk7CgkgICAgTW9kZS5GTkMxX0ZJUlNUX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX0ZJUlNUX1BPU0lUSU9OLCAnRk5DMV9GSVJTVF9QT1NJVElPTicsIEludDMyQXJyYXkuZnJvbShbMCwgMCwgMF0pLCAweDA1KTsKCSAgICBNb2RlLkZOQzFfU0VDT05EX1BPU0lUSU9OID0gbmV3IE1vZGUoTW9kZVZhbHVlcy5GTkMxX1NFQ09ORF9QT1NJVElPTiwgJ0ZOQzFfU0VDT05EX1BPU0lUSU9OJywgSW50MzJBcnJheS5mcm9tKFswLCAwLCAwXSksIDB4MDkpOwoJICAgIC8qKiBTZWUgR0JUIDE4Mjg0LTIwMDA7ICJIYW56aSIgaXMgYSB0cmFuc2xpdGVyYXRpb24gb2YgdGhpcyBtb2RlIG5hbWUuICovCgkgICAgTW9kZS5IQU5aSSA9IG5ldyBNb2RlKE1vZGVWYWx1ZXMuSEFOWkksICdIQU5aSScsIEludDMyQXJyYXkuZnJvbShbOCwgMTAsIDEyXSksIDB4MEQpOwoJICAgIHJldHVybiBNb2RlOwoJfSgpKTsKCWV4cG9ydHMuZGVmYXVsdCA9IE1vZGU7CgoJfShNb2RlKSk7CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlLmRlY29kZXIgeyovCgl2YXIgQml0U291cmNlXzEgPSBCaXRTb3VyY2UkMTsKCXZhciBDaGFyYWN0ZXJTZXRFQ0lfMSA9IENoYXJhY3RlclNldEVDSTsKCXZhciBEZWNvZGVyUmVzdWx0XzEgPSBEZWNvZGVyUmVzdWx0JDE7Cgl2YXIgU3RyaW5nVXRpbHNfMSA9IFN0cmluZ1V0aWxzJDE7Cgl2YXIgRm9ybWF0RXhjZXB0aW9uXzEgPSBGb3JtYXRFeGNlcHRpb24kMTsKCXZhciBTdHJpbmdCdWlsZGVyXzEgPSBTdHJpbmdCdWlsZGVyJDE7Cgl2YXIgU3RyaW5nRW5jb2RpbmdfMSA9IFN0cmluZ0VuY29kaW5nJDE7Cgl2YXIgTW9kZV8xID0gTW9kZTsKCS8qaW1wb3J0IGphdmEuaW8uVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbjsqLwoJLyppbXBvcnQgamF2YS51dGlsLkFycmF5TGlzdDsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbGxlY3Rpb247Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlFSIENvZGVzIGNhbiBlbmNvZGUgdGV4dCBhcyBiaXRzIGluIG9uZSBvZiBzZXZlcmFsIG1vZGVzLCBhbmQgY2FuIHVzZSBtdWx0aXBsZSBtb2RlcwoJICogaW4gb25lIFFSIENvZGUuIFRoaXMgY2xhc3MgZGVjb2RlcyB0aGUgYml0cyBiYWNrIGludG8gdGV4dC48L3A+CgkgKgoJICogPHA+U2VlIElTTyAxODAwNDoyMDA2LCA2LjQuMyAtIDYuNC43PC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWNvZGVkQml0U3RyZWFtUGFyc2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERlY29kZWRCaXRTdHJlYW1QYXJzZXIoKSB7CgkgICAgfQoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlID0gZnVuY3Rpb24gKGJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cykgewoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRTb3VyY2VfMS5kZWZhdWx0KGJ5dGVzKTsKCSAgICAgICAgdmFyIHJlc3VsdCA9IG5ldyBTdHJpbmdCdWlsZGVyXzEuZGVmYXVsdCgpOwoJICAgICAgICB2YXIgYnl0ZVNlZ21lbnRzID0gbmV3IEFycmF5KCk7IC8vIDEKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IEkgZG8gbm90IHVzZSBjb25zdHJ1Y3RvciB3aXRoIHNpemUgMSBhcyBpbiBvcmlnaW5hbCBKYXZhIG1lYW5zIGNhcGFjaXR5IGFuZCB0aGUgYXJyYXkgbGVuZ3RoIGlzIGNoZWNrZWQgYmVsb3cKCSAgICAgICAgdmFyIHN5bWJvbFNlcXVlbmNlID0gLTE7CgkgICAgICAgIHZhciBwYXJpdHlEYXRhID0gLTE7CgkgICAgICAgIHRyeSB7CgkgICAgICAgICAgICB2YXIgY3VycmVudENoYXJhY3RlclNldEVDSSA9IG51bGw7CgkgICAgICAgICAgICB2YXIgZmMxSW5FZmZlY3QgPSBmYWxzZTsKCSAgICAgICAgICAgIHZhciBtb2RlID0gdm9pZCAwOwoJICAgICAgICAgICAgZG8gewoJICAgICAgICAgICAgICAgIC8vIFdoaWxlIHN0aWxsIGFub3RoZXIgc2VnbWVudCB0byByZWFkLi4uCgkgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA0KSB7CgkgICAgICAgICAgICAgICAgICAgIC8vIE9LLCBhc3N1bWUgd2UncmUgZG9uZS4gUmVhbGx5LCBhIFRFUk1JTkFUT1IgbW9kZSBzaG91bGQgaGF2ZSBiZWVuIHJlY29yZGVkIGhlcmUKCSAgICAgICAgICAgICAgICAgICAgbW9kZSA9IE1vZGVfMS5kZWZhdWx0LlRFUk1JTkFUT1I7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZUJpdHMgPSBiaXRzLnJlYWRCaXRzKDQpOwoJICAgICAgICAgICAgICAgICAgICBtb2RlID0gTW9kZV8xLmRlZmF1bHQuZm9yQml0cyhtb2RlQml0cyk7IC8vIG1vZGUgaXMgZW5jb2RlZCBieSA0IGJpdHMKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgc3dpdGNoIChtb2RlKSB7CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUjoKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkZOQzFfRklSU1RfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuRk5DMV9TRUNPTkRfUE9TSVRJT046CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBkbyBsaXR0bGUgd2l0aCBGTkMxIGV4Y2VwdCBhbHRlciB0aGUgcGFyc2VkIHJlc3VsdCBhIGJpdCBhY2NvcmRpbmcgdG8gdGhlIHNwZWMKCSAgICAgICAgICAgICAgICAgICAgICAgIGZjMUluRWZmZWN0ID0gdHJ1ZTsKCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LlNUUlVDVFVSRURfQVBQRU5EOgoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCAxNikgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXF1ZW5jZSBudW1iZXIgYW5kIHBhcml0eSBpcyBhZGRlZCBsYXRlciB0byB0aGUgcmVzdWx0IG1ldGFkYXRhCgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWFkIG5leHQgOCBiaXRzIChzeW1ib2wgc2VxdWVuY2UgIykgYW5kIDggYml0cyAoZGF0YTogcGFyaXR5KSwgdGhlbiBjb250aW51ZQoJICAgICAgICAgICAgICAgICAgICAgICAgc3ltYm9sU2VxdWVuY2UgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgcGFyaXR5RGF0YSA9IGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5FQ0k6CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb3VudCBkb2Vzbid0IGFwcGx5IHRvIEVDSQoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5wYXJzZUVDSVZhbHVlKGJpdHMpOwoJICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudENoYXJhY3RlclNldEVDSSA9IENoYXJhY3RlclNldEVDSV8xLmRlZmF1bHQuZ2V0Q2hhcmFjdGVyU2V0RUNJQnlWYWx1ZSh2YWx1ZSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgY2FzZSBNb2RlXzEuZGVmYXVsdC5IQU5aSToKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IGhhbmRsZSBIYW56aSBtb2RlIHdoaWNoIGRvZXMgbm90IHN0YXJ0IHdpdGggY2hhcmFjdGVyIGNvdW50CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBDaGluZXNlIG1vZGUgY29udGFpbnMgYSBzdWIgc2V0IGluZGljYXRvciByaWdodCBhZnRlciBtb2RlIGluZGljYXRvcgoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN1YnNldCA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY291bnRIYW56aSA9IGJpdHMucmVhZEJpdHMobW9kZS5nZXRDaGFyYWN0ZXJDb3VudEJpdHModmVyc2lvbikpOwoJICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN1YnNldCA9PT0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUKSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVIYW56aVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudEhhbnppKTsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk5vcm1hbCIgUVIgY29kZSBtb2RlczoKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhvdyBtYW55IGNoYXJhY3RlcnMgd2lsbCBmb2xsb3csIGVuY29kZWQgaW4gdGhpcyBtb2RlPwoJICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ID0gYml0cy5yZWFkQml0cyhtb2RlLmdldENoYXJhY3RlckNvdW50Qml0cyh2ZXJzaW9uKSk7CgkgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKG1vZGUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0Lk5VTUVSSUM6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlTnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuQUxQSEFOVU1FUklDOgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgZmMxSW5FZmZlY3QpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIE1vZGVfMS5kZWZhdWx0LkJZVEU6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQoYml0cywgcmVzdWx0LCBjb3VudCwgY3VycmVudENoYXJhY3RlclNldEVDSSwgYnl0ZVNlZ21lbnRzLCBoaW50cyk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTW9kZV8xLmRlZmF1bHQuS0FOSkk6CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlS2FuamlTZWdtZW50KGJpdHMsIHJlc3VsdCwgY291bnQpOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSB3aGlsZSAobW9kZSAhPT0gTW9kZV8xLmRlZmF1bHQuVEVSTUlOQVRPUik7CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlhZSAvKjogSWxsZWdhbEFyZ3VtZW50RXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIGZyb20gcmVhZEJpdHMoKSBjYWxscwoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gbmV3IERlY29kZXJSZXN1bHRfMS5kZWZhdWx0KGJ5dGVzLCByZXN1bHQudG9TdHJpbmcoKSwgYnl0ZVNlZ21lbnRzLmxlbmd0aCA9PT0gMCA/IG51bGwgOiBieXRlU2VnbWVudHMsIGVjTGV2ZWwgPT09IG51bGwgPyBudWxsIDogZWNMZXZlbC50b1N0cmluZygpLCBzeW1ib2xTZXF1ZW5jZSwgcGFyaXR5RGF0YSk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBTZWUgc3BlY2lmaWNhdGlvbiBHQlQgMTgyODQtMjAwMAoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlSGFuemlTZWdtZW50ID0gZnVuY3Rpb24gKGJpdHMsIHJlc3VsdCwgY291bnQgLyppbnQqLykgewoJICAgICAgICAvLyBEb24ndCBjcmFzaCB0cnlpbmcgdG8gcmVhZCBtb3JlIGJpdHMgdGhhbiB3ZSBoYXZlIGF2YWlsYWJsZS4KCSAgICAgICAgaWYgKGNvdW50ICogMTMgPiBiaXRzLmF2YWlsYWJsZSgpKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIC8vIEVhY2ggY2hhcmFjdGVyIHdpbGwgcmVxdWlyZSAyIGJ5dGVzLiBSZWFkIHRoZSBjaGFyYWN0ZXJzIGFzIDItYnl0ZSBwYWlycwoJICAgICAgICAvLyBhbmQgZGVjb2RlIGFzIEdCMjMxMiBhZnRlcndhcmRzCgkgICAgICAgIHZhciBidWZmZXIgPSBuZXcgVWludDhBcnJheSgyICogY291bnQpOwoJICAgICAgICB2YXIgb2Zmc2V0ID0gMDsKCSAgICAgICAgd2hpbGUgKGNvdW50ID4gMCkgewoJICAgICAgICAgICAgLy8gRWFjaCAxMyBiaXRzIGVuY29kZXMgYSAyLWJ5dGUgY2hhcmFjdGVyCgkgICAgICAgICAgICB2YXIgdHdvQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDEzKTsKCSAgICAgICAgICAgIHZhciBhc3NlbWJsZWRUd29CeXRlcyA9ICgoKHR3b0J5dGVzIC8gMHgwNjApIDw8IDgpICYgMHhGRkZGRkZGRikgfCAodHdvQnl0ZXMgJSAweDA2MCk7CgkgICAgICAgICAgICBpZiAoYXNzZW1ibGVkVHdvQnl0ZXMgPCAweDAwM0JGKSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QTFBMSB0byAweEFBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBMUExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgLy8gSW4gdGhlIDB4QjBBMSB0byAweEZBRkUgcmFuZ2UKCSAgICAgICAgICAgICAgICBhc3NlbWJsZWRUd29CeXRlcyArPSAweDBBNkExOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYnVmZmVyW29mZnNldF0gPSAvKihieXRlKSAqLyAoKGFzc2VtYmxlZFR3b0J5dGVzID4+IDgpICYgMHhGRik7CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0ICsgMV0gPSAvKihieXRlKSAqLyAoYXNzZW1ibGVkVHdvQnl0ZXMgJiAweEZGKTsKCSAgICAgICAgICAgIG9mZnNldCArPSAyOwoJICAgICAgICAgICAgY291bnQtLTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKGJ1ZmZlciwgU3RyaW5nVXRpbHNfMS5kZWZhdWx0LkdCMjMxMikpOwoJICAgICAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IFRPRE86IGltcGxlbWVudCBHQjIzMTIgZGVjb2RlLiBTdHJpbmdWaWV3IGZyb20gTUROIGNvdWxkIGJlIGEgc3RhcnRpbmcgcG9pbnQKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVLYW5qaVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoY291bnQgKiAxMyA+IGJpdHMuYXZhaWxhYmxlKCkpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gRWFjaCBjaGFyYWN0ZXIgd2lsbCByZXF1aXJlIDIgYnl0ZXMuIFJlYWQgdGhlIGNoYXJhY3RlcnMgYXMgMi1ieXRlIHBhaXJzCgkgICAgICAgIC8vIGFuZCBkZWNvZGUgYXMgU2hpZnRfSklTIGFmdGVyd2FyZHMKCSAgICAgICAgdmFyIGJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KDIgKiBjb3VudCk7CgkgICAgICAgIHZhciBvZmZzZXQgPSAwOwoJICAgICAgICB3aGlsZSAoY291bnQgPiAwKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEzIGJpdHMgZW5jb2RlcyBhIDItYnl0ZSBjaGFyYWN0ZXIKCSAgICAgICAgICAgIHZhciB0d29CeXRlcyA9IGJpdHMucmVhZEJpdHMoMTMpOwoJICAgICAgICAgICAgdmFyIGFzc2VtYmxlZFR3b0J5dGVzID0gKCgodHdvQnl0ZXMgLyAweDBDMCkgPDwgOCkgJiAweEZGRkZGRkZGKSB8ICh0d29CeXRlcyAlIDB4MEMwKTsKCSAgICAgICAgICAgIGlmIChhc3NlbWJsZWRUd29CeXRlcyA8IDB4MDFGMDApIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHg4MTQwIHRvIDB4OUZGQyByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MDgxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAvLyBJbiB0aGUgMHhFMDQwIHRvIDB4RUJCRiByYW5nZQoJICAgICAgICAgICAgICAgIGFzc2VtYmxlZFR3b0J5dGVzICs9IDB4MEMxNDA7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBidWZmZXJbb2Zmc2V0XSA9IC8qKGJ5dGUpICovIChhc3NlbWJsZWRUd29CeXRlcyA+PiA4KTsKCSAgICAgICAgICAgIGJ1ZmZlcltvZmZzZXQgKyAxXSA9IC8qKGJ5dGUpICovIGFzc2VtYmxlZFR3b0J5dGVzOwoJICAgICAgICAgICAgb2Zmc2V0ICs9IDI7CgkgICAgICAgICAgICBjb3VudC0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIFNoaWZ0X0pJUyBtYXkgbm90IGJlIHN1cHBvcnRlZCBpbiBzb21lIGVudmlyb25tZW50czoKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoU3RyaW5nRW5jb2RpbmdfMS5kZWZhdWx0LmRlY29kZShidWZmZXIsIFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5TSElGVF9KSVMpKTsKCSAgICAgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBUT0RPOiBpbXBsZW1lbnQgU0hJRlRfSklTIGRlY29kZS4gU3RyaW5nVmlldyBmcm9tIE1ETiBjb3VsZCBiZSBhIHN0YXJ0aW5nIHBvaW50CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGlnbm9yZWQgLyo6IFVuc3VwcG9ydGVkRW5jb2RpbmdFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoaWdub3JlZCk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuZGVjb2RlQnl0ZVNlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLCBieXRlU2VnbWVudHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIERvbid0IGNyYXNoIHRyeWluZyB0byByZWFkIG1vcmUgYml0cyB0aGFuIHdlIGhhdmUgYXZhaWxhYmxlLgoJICAgICAgICBpZiAoOCAqIGNvdW50ID4gYml0cy5hdmFpbGFibGUoKSkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgcmVhZEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoY291bnQpOwoJICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHsKCSAgICAgICAgICAgIHJlYWRCeXRlc1tpXSA9IC8qKGJ5dGUpICovIGJpdHMucmVhZEJpdHMoOCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVuY29kaW5nOwoJICAgICAgICBpZiAoY3VycmVudENoYXJhY3RlclNldEVDSSA9PT0gbnVsbCkgewoJICAgICAgICAgICAgLy8gVGhlIHNwZWMgaXNuJ3QgY2xlYXIgb24gdGhpcyBtb2RlOyBzZWUKCSAgICAgICAgICAgIC8vIHNlY3Rpb24gNi40LjU6IHQgZG9lcyBub3Qgc2F5IHdoaWNoIGVuY29kaW5nIHRvIGFzc3VtaW5nCgkgICAgICAgICAgICAvLyB1cG9uIGRlY29kaW5nLiBJIGhhdmUgc2VlbiBJU08tODg1OS0xIHVzZWQgYXMgd2VsbCBhcwoJICAgICAgICAgICAgLy8gU2hpZnRfSklTIC0tIHdpdGhvdXQgYW55dGhpbmcgbGlrZSBhbiBFQ0kgZGVzaWduYXRvciB0bwoJICAgICAgICAgICAgLy8gZ2l2ZSBhIGhpbnQuCgkgICAgICAgICAgICBlbmNvZGluZyA9IFN0cmluZ1V0aWxzXzEuZGVmYXVsdC5ndWVzc0VuY29kaW5nKHJlYWRCeXRlcywgaGludHMpOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgZW5jb2RpbmcgPSBjdXJyZW50Q2hhcmFjdGVyU2V0RUNJLmdldE5hbWUoKTsKCSAgICAgICAgfQoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChTdHJpbmdFbmNvZGluZ18xLmRlZmF1bHQuZGVjb2RlKHJlYWRCeXRlcywgZW5jb2RpbmcpKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoaWdub3JlZCAvKjogVW5zdXBwb3J0ZWRFbmNvZGluZ0V4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdChpZ25vcmVkKTsKCSAgICAgICAgfQoJICAgICAgICBieXRlU2VnbWVudHMucHVzaChyZWFkQnl0ZXMpOwoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIgPSBmdW5jdGlvbiAodmFsdWUgLyppbnQqLykgewoJICAgICAgICBpZiAodmFsdWUgPj0gRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5BTFBIQU5VTUVSSUNfQ0hBUlMubGVuZ3RoKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLkFMUEhBTlVNRVJJQ19DSEFSU1t2YWx1ZV07CgkgICAgfTsKCSAgICBEZWNvZGVkQml0U3RyZWFtUGFyc2VyLmRlY29kZUFscGhhbnVtZXJpY1NlZ21lbnQgPSBmdW5jdGlvbiAoYml0cywgcmVzdWx0LCBjb3VudCAvKmludCovLCBmYzFJbkVmZmVjdCkgewoJICAgICAgICAvLyBSZWFkIHR3byBjaGFyYWN0ZXJzIGF0IGEgdGltZQoJICAgICAgICB2YXIgc3RhcnQgPSByZXN1bHQubGVuZ3RoKCk7CgkgICAgICAgIHdoaWxlIChjb3VudCA+IDEpIHsKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTEpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIG5leHRUd29DaGFyc0JpdHMgPSBiaXRzLnJlYWRCaXRzKDExKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcihuZXh0VHdvQ2hhcnNCaXRzIC8gNDUpKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKG5leHRUd29DaGFyc0JpdHMgJSA0NSkpOwoJICAgICAgICAgICAgY291bnQgLT0gMjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoY291bnQgPT09IDEpIHsKCSAgICAgICAgICAgIC8vIHNwZWNpYWwgY2FzZTogb25lIGNoYXJhY3RlciBsZWZ0CgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDYpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcihiaXRzLnJlYWRCaXRzKDYpKSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gU2VlIHNlY3Rpb24gNi40LjguMSwgNi40LjguMgoJICAgICAgICBpZiAoZmMxSW5FZmZlY3QpIHsKCSAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gbWFzc2FnZSB0aGUgcmVzdWx0IGEgYml0IGlmIGluIGFuIEZOQzEgbW9kZToKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSBzdGFydDsgaSA8IHJlc3VsdC5sZW5ndGgoKTsgaSsrKSB7CgkgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5jaGFyQXQoaSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaSA8IHJlc3VsdC5sZW5ndGgoKSAtIDEgJiYgcmVzdWx0LmNoYXJBdChpICsgMSkgPT09ICclJykgewoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gJSUgaXMgcmVuZGVyZWQgYXMgJQoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmRlbGV0ZUNoYXJBdChpICsgMSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBJbiBhbHBoYSBtb2RlLCAlIHNob3VsZCBiZSBjb252ZXJ0ZWQgdG8gRk5DMSBzZXBhcmF0b3IgMHgxRAoJICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldENoYXJBdChpLCBTdHJpbmcuZnJvbUNoYXJDb2RlKDB4MUQpKTsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgIH07CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5kZWNvZGVOdW1lcmljU2VnbWVudCA9IGZ1bmN0aW9uIChiaXRzLCByZXN1bHQsIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgLy8gUmVhZCB0aHJlZSBkaWdpdHMgYXQgYSB0aW1lCgkgICAgICAgIHdoaWxlIChjb3VudCA+PSAzKSB7CgkgICAgICAgICAgICAvLyBFYWNoIDEwIGJpdHMgZW5jb2RlcyB0aHJlZSBkaWdpdHMKCSAgICAgICAgICAgIGlmIChiaXRzLmF2YWlsYWJsZSgpIDwgMTApIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIHRocmVlRGlnaXRzQml0cyA9IGJpdHMucmVhZEJpdHMoMTApOwoJICAgICAgICAgICAgaWYgKHRocmVlRGlnaXRzQml0cyA+PSAxMDAwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoTWF0aC5mbG9vcih0aHJlZURpZ2l0c0JpdHMgLyAxMDApKSk7CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodGhyZWVEaWdpdHNCaXRzIC8gMTApICUgMTApKTsKCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIodGhyZWVEaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgICAgIGNvdW50IC09IDM7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvdW50ID09PSAyKSB7CgkgICAgICAgICAgICAvLyBUd28gZGlnaXRzIGxlZnQgb3ZlciB0byByZWFkLCBlbmNvZGVkIGluIDcgYml0cwoJICAgICAgICAgICAgaWYgKGJpdHMuYXZhaWxhYmxlKCkgPCA3KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHZhciB0d29EaWdpdHNCaXRzID0gYml0cy5yZWFkQml0cyg3KTsKCSAgICAgICAgICAgIGlmICh0d29EaWdpdHNCaXRzID49IDEwMCkgewoJICAgICAgICAgICAgICAgIHRocm93IG5ldyBGb3JtYXRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICByZXN1bHQuYXBwZW5kKERlY29kZWRCaXRTdHJlYW1QYXJzZXIudG9BbHBoYU51bWVyaWNDaGFyKE1hdGguZmxvb3IodHdvRGlnaXRzQml0cyAvIDEwKSkpOwoJICAgICAgICAgICAgcmVzdWx0LmFwcGVuZChEZWNvZGVkQml0U3RyZWFtUGFyc2VyLnRvQWxwaGFOdW1lcmljQ2hhcih0d29EaWdpdHNCaXRzICUgMTApKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChjb3VudCA9PT0gMSkgewoJICAgICAgICAgICAgLy8gT25lIGRpZ2l0IGxlZnQgb3ZlciB0byByZWFkCgkgICAgICAgICAgICBpZiAoYml0cy5hdmFpbGFibGUoKSA8IDQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRm9ybWF0RXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdmFyIGRpZ2l0Qml0cyA9IGJpdHMucmVhZEJpdHMoNCk7CgkgICAgICAgICAgICBpZiAoZGlnaXRCaXRzID49IDEwKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIHJlc3VsdC5hcHBlbmQoRGVjb2RlZEJpdFN0cmVhbVBhcnNlci50b0FscGhhTnVtZXJpY0NoYXIoZGlnaXRCaXRzKSk7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIucGFyc2VFQ0lWYWx1ZSA9IGZ1bmN0aW9uIChiaXRzKSB7CgkgICAgICAgIHZhciBmaXJzdEJ5dGUgPSBiaXRzLnJlYWRCaXRzKDgpOwoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4ODApID09PSAwKSB7CgkgICAgICAgICAgICAvLyBqdXN0IG9uZSBieXRlCgkgICAgICAgICAgICByZXR1cm4gZmlyc3RCeXRlICYgMHg3RjsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4QzApID09PSAweDgwKSB7CgkgICAgICAgICAgICAvLyB0d28gYnl0ZXMKCSAgICAgICAgICAgIHZhciBzZWNvbmRCeXRlID0gYml0cy5yZWFkQml0cyg4KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDNGKSA8PCA4KSAmIDB4RkZGRkZGRkYpIHwgc2Vjb25kQnl0ZTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoKGZpcnN0Qnl0ZSAmIDB4RTApID09PSAweEMwKSB7CgkgICAgICAgICAgICAvLyB0aHJlZSBieXRlcwoJICAgICAgICAgICAgdmFyIHNlY29uZFRoaXJkQnl0ZXMgPSBiaXRzLnJlYWRCaXRzKDE2KTsKCSAgICAgICAgICAgIHJldHVybiAoKChmaXJzdEJ5dGUgJiAweDFGKSA8PCAxNikgJiAweEZGRkZGRkZGKSB8IHNlY29uZFRoaXJkQnl0ZXM7CgkgICAgICAgIH0KCSAgICAgICAgdGhyb3cgbmV3IEZvcm1hdEV4Y2VwdGlvbl8xLmRlZmF1bHQoKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFNlZSBJU08gMTgwMDQ6MjAwNiwgNi40LjQgVGFibGUgNQoJICAgICAqLwoJICAgIERlY29kZWRCaXRTdHJlYW1QYXJzZXIuQUxQSEFOVU1FUklDX0NIQVJTID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiAkJSorLS4vOic7CgkgICAgRGVjb2RlZEJpdFN0cmVhbVBhcnNlci5HQjIzMTJfU1VCU0VUID0gMTsKCSAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcjsKCX0oKSk7CglEZWNvZGVkQml0U3RyZWFtUGFyc2VyJDEuZGVmYXVsdCA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXI7CgoJdmFyIFFSQ29kZURlY29kZXJNZXRhRGF0YSQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDEzIFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShRUkNvZGVEZWNvZGVyTWV0YURhdGEkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLyoqCgkgKiBNZXRhLWRhdGEgY29udGFpbmVyIGZvciBRUiBDb2RlIGRlY29kaW5nLiBJbnN0YW5jZXMgb2YgdGhpcyBjbGFzcyBtYXkgYmUgdXNlZCB0byBjb252ZXkgaW5mb3JtYXRpb24gYmFjayB0byB0aGUKCSAqIGRlY29kaW5nIGNhbGxlci4gQ2FsbGVycyBhcmUgZXhwZWN0ZWQgdG8gcHJvY2VzcyB0aGlzLgoJICoKCSAqIEBzZWUgY29tLmdvb2dsZS56eGluZy5jb21tb24uRGVjb2RlclJlc3VsdCNnZXRPdGhlcigpCgkgKi8KCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGEgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUVJDb2RlRGVjb2Rlck1ldGFEYXRhKG1pcnJvcmVkKSB7CgkgICAgICAgIHRoaXMubWlycm9yZWQgPSBtaXJyb3JlZDsKCSAgICB9CgkgICAgLyoqCgkgICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBRUiBDb2RlIHdhcyBtaXJyb3JlZC4KCSAgICAgKi8KCSAgICBRUkNvZGVEZWNvZGVyTWV0YURhdGEucHJvdG90eXBlLmlzTWlycm9yZWQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLm1pcnJvcmVkOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQXBwbHkgdGhlIHJlc3VsdCBwb2ludHMnIG9yZGVyIGNvcnJlY3Rpb24gZHVlIHRvIG1pcnJvcmluZy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBwb2ludHMgQXJyYXkgb2YgcG9pbnRzIHRvIGFwcGx5IG1pcnJvciBjb3JyZWN0aW9uIHRvLgoJICAgICAqLwoJICAgIFFSQ29kZURlY29kZXJNZXRhRGF0YS5wcm90b3R5cGUuYXBwbHlNaXJyb3JlZENvcnJlY3Rpb24gPSBmdW5jdGlvbiAocG9pbnRzKSB7CgkgICAgICAgIGlmICghdGhpcy5taXJyb3JlZCB8fCBwb2ludHMgPT09IG51bGwgfHwgcG9pbnRzLmxlbmd0aCA8IDMpIHsKCSAgICAgICAgICAgIHJldHVybjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IHBvaW50c1swXTsKCSAgICAgICAgcG9pbnRzWzBdID0gcG9pbnRzWzJdOwoJICAgICAgICBwb2ludHNbMl0gPSBib3R0b21MZWZ0OwoJICAgICAgICAvLyBObyBuZWVkIHRvICdmaXgnIHRvcC1sZWZ0IGFuZCBhbGlnbm1lbnQgcGF0dGVybi4KCSAgICB9OwoJICAgIHJldHVybiBRUkNvZGVEZWNvZGVyTWV0YURhdGE7Cgl9KCkpOwoJUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDEuZGVmYXVsdCA9IFFSQ29kZURlY29kZXJNZXRhRGF0YTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX192YWx1ZXMpIHx8IGZ1bmN0aW9uKG8pIHsKCSAgICB2YXIgcyA9IHR5cGVvZiBTeW1ib2wgPT09ICJmdW5jdGlvbiIgJiYgU3ltYm9sLml0ZXJhdG9yLCBtID0gcyAmJiBvW3NdLCBpID0gMDsKCSAgICBpZiAobSkgcmV0dXJuIG0uY2FsbChvKTsKCSAgICBpZiAobyAmJiB0eXBlb2Ygby5sZW5ndGggPT09ICJudW1iZXIiKSByZXR1cm4gewoJICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CgkgICAgICAgICAgICBpZiAobyAmJiBpID49IG8ubGVuZ3RoKSBvID0gdm9pZCAwOwoJICAgICAgICAgICAgcmV0dXJuIHsgdmFsdWU6IG8gJiYgb1tpKytdLCBkb25lOiAhbyB9OwoJICAgICAgICB9CgkgICAgfTsKCSAgICB0aHJvdyBuZXcgVHlwZUVycm9yKHMgPyAiT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iIDogIlN5bWJvbC5pdGVyYXRvciBpcyBub3QgZGVmaW5lZC4iKTsKCX07CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVjb2RlciQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZWNvZGVyIHsqLwoJdmFyIENoZWNrc3VtRXhjZXB0aW9uXzEgPSBDaGVja3N1bUV4Y2VwdGlvbiQxOwoJdmFyIEJpdE1hdHJpeF8xJDIgPSBCaXRNYXRyaXgkMTsKCXZhciBHZW5lcmljR0ZfMSA9IEdlbmVyaWNHRiQxOwoJdmFyIFJlZWRTb2xvbW9uRGVjb2Rlcl8xID0gUmVlZFNvbG9tb25EZWNvZGVyJDE7Cgl2YXIgQml0TWF0cml4UGFyc2VyXzEgPSBCaXRNYXRyaXhQYXJzZXIkMTsKCXZhciBEYXRhQmxvY2tfMSA9IERhdGFCbG9jayQxOwoJdmFyIERlY29kZWRCaXRTdHJlYW1QYXJzZXJfMSA9IERlY29kZWRCaXRTdHJlYW1QYXJzZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxID0gUVJDb2RlRGVjb2Rlck1ldGFEYXRhJDE7CgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoZSBtYWluIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgUVIgQ29kZSBkZWNvZGluZyAtLSBhcyBvcHBvc2VkIHRvIGxvY2F0aW5nIGFuZCBleHRyYWN0aW5nCgkgKiB0aGUgUVIgQ29kZSBmcm9tIGFuIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGVjb2RlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBEZWNvZGVyKCkgewoJICAgICAgICB0aGlzLnJzRGVjb2RlciA9IG5ldyBSZWVkU29sb21vbkRlY29kZXJfMS5kZWZhdWx0KEdlbmVyaWNHRl8xLmRlZmF1bHQuUVJfQ09ERV9GSUVMRF8yNTYpOwoJICAgIH0KCSAgICAvLyBwdWJsaWMgZGVjb2RlKGltYWdlOiBib29sZWFuW11bXSk6IERlY29kZXJSZXN1bHQgLyp0aHJvd3MgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkNvbnZlbmllbmNlIG1ldGhvZCB0aGF0IGNhbiBkZWNvZGUgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEgMkQgYXJyYXkgb2YgYm9vbGVhbnMuCgkgICAgICogInRydWUiIGlzIHRha2VuIHRvIG1lYW4gYSBibGFjayBtb2R1bGUuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGJvb2xlYW5zIHJlcHJlc2VudGluZyB3aGl0ZS9ibGFjayBRUiBDb2RlIG1vZHVsZXMKCSAgICAgKiBAcGFyYW0gaGludHMgZGVjb2RpbmcgaGludHMgdGhhdCBzaG91bGQgYmUgdXNlZCB0byBpbmZsdWVuY2UgZGVjb2RpbmcKCSAgICAgKiBAcmV0dXJuIHRleHQgYW5kIGJ5dGVzIGVuY29kZWQgd2l0aGluIHRoZSBRUiBDb2RlCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgdGhlIFFSIENvZGUgY2Fubm90IGJlIGRlY29kZWQKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCb29sZWFuQXJyYXkgPSBmdW5jdGlvbiAoaW1hZ2UsIGhpbnRzKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeChCaXRNYXRyaXhfMSQyLmRlZmF1bHQucGFyc2VGcm9tQm9vbGVhbkFycmF5KGltYWdlKSwgaGludHMpOwoJICAgIH07CgkgICAgLy8gcHVibGljIGRlY29kZUJpdE1hdHJpeChiaXRzOiBCaXRNYXRyaXgpOiBEZWNvZGVyUmVzdWx0IC8qdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uLCBGb3JtYXRFeGNlcHRpb24qLyB7CgkgICAgLy8gICByZXR1cm4gZGVjb2RlKGJpdHMsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qKgoJICAgICAqIDxwPkRlY29kZXMgYSBRUiBDb2RlIHJlcHJlc2VudGVkIGFzIGEge0BsaW5rIEJpdE1hdHJpeH0uIEEgMSBvciAidHJ1ZSIgaXMgdGFrZW4gdG8gbWVhbiBhIGJsYWNrIG1vZHVsZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gYml0cyBib29sZWFucyByZXByZXNlbnRpbmcgd2hpdGUvYmxhY2sgUVIgQ29kZSBtb2R1bGVzCgkgICAgICogQHBhcmFtIGhpbnRzIGRlY29kaW5nIGhpbnRzIHRoYXQgc2hvdWxkIGJlIHVzZWQgdG8gaW5mbHVlbmNlIGRlY29kaW5nCgkgICAgICogQHJldHVybiB0ZXh0IGFuZCBieXRlcyBlbmNvZGVkIHdpdGhpbiB0aGUgUVIgQ29kZQoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIHRoZSBRUiBDb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgRGVjb2Rlci5wcm90b3R5cGUuZGVjb2RlQml0TWF0cml4ID0gZnVuY3Rpb24gKGJpdHMsIGhpbnRzKSB7CgkgICAgICAgIC8vIENvbnN0cnVjdCBhIHBhcnNlciBhbmQgcmVhZCB2ZXJzaW9uLCBlcnJvci1jb3JyZWN0aW9uIGxldmVsCgkgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgQml0TWF0cml4UGFyc2VyXzEuZGVmYXVsdChiaXRzKTsKCSAgICAgICAgdmFyIGV4ID0gbnVsbDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHJldHVybiB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKjogRm9ybWF0RXhjZXB0aW9uLCBDaGVja3N1bUV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICBleCA9IGU7CgkgICAgICAgIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIC8vIFJldmVydCB0aGUgYml0IG1hdHJpeAoJICAgICAgICAgICAgcGFyc2VyLnJlbWFzaygpOwoJICAgICAgICAgICAgLy8gV2lsbCBiZSBhdHRlbXB0aW5nIGEgbWlycm9yZWQgcmVhZGluZyBvZiB0aGUgdmVyc2lvbiBhbmQgZm9ybWF0IGluZm8uCgkgICAgICAgICAgICBwYXJzZXIuc2V0TWlycm9yKHRydWUpOwoJICAgICAgICAgICAgLy8gUHJlZW1wdGl2ZWx5IHJlYWQgdGhlIHZlcnNpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgICAgIC8vIFByZWVtcHRpdmVseSByZWFkIHRoZSBmb3JtYXQgaW5mb3JtYXRpb24uCgkgICAgICAgICAgICBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCk7CgkgICAgICAgICAgICAvKgoJICAgICAgICAgICAgICogU2luY2Ugd2UncmUgaGVyZSwgdGhpcyBtZWFucyB3ZSBoYXZlIHN1Y2Nlc3NmdWxseSBkZXRlY3RlZCBzb21lIGtpbmQKCSAgICAgICAgICAgICAqIG9mIHZlcnNpb24gYW5kIGZvcm1hdCBpbmZvcm1hdGlvbiB3aGVuIG1pcnJvcmVkLiBUaGlzIGlzIGEgZ29vZCBzaWduLAoJICAgICAgICAgICAgICogdGhhdCB0aGUgUVIgY29kZSBtYXkgYmUgbWlycm9yZWQsIGFuZCB3ZSBzaG91bGQgdHJ5IG9uY2UgbW9yZSB3aXRoIGEKCSAgICAgICAgICAgICAqIG1pcnJvcmVkIGNvbnRlbnQuCgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIFByZXBhcmUgZm9yIGEgbWlycm9yZWQgcmVhZGluZy4KCSAgICAgICAgICAgIHBhcnNlci5taXJyb3IoKTsKCSAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmRlY29kZUJpdE1hdHJpeFBhcnNlcihwYXJzZXIsIGhpbnRzKTsKCSAgICAgICAgICAgIC8vIFN1Y2Nlc3MhIE5vdGlmeSB0aGUgY2FsbGVyIHRoYXQgdGhlIGNvZGUgd2FzIG1pcnJvcmVkLgoJICAgICAgICAgICAgcmVzdWx0LnNldE90aGVyKG5ldyBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSQxLmRlZmF1bHQodHJ1ZSkpOwoJICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZSAvKkZvcm1hdEV4Y2VwdGlvbiB8IENoZWNrc3VtRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgIC8vIFRocm93IHRoZSBleGNlcHRpb24gZnJvbSB0aGUgb3JpZ2luYWwgcmVhZGluZwoJICAgICAgICAgICAgaWYgKGV4ICE9PSBudWxsKSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgZXg7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0aHJvdyBlOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBEZWNvZGVyLnByb3RvdHlwZS5kZWNvZGVCaXRNYXRyaXhQYXJzZXIgPSBmdW5jdGlvbiAocGFyc2VyLCBoaW50cykgewoJICAgICAgICB2YXIgZV8xLCBfYSwgZV8yLCBfYjsKCSAgICAgICAgdmFyIHZlcnNpb24gPSBwYXJzZXIucmVhZFZlcnNpb24oKTsKCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBwYXJzZXIucmVhZEZvcm1hdEluZm9ybWF0aW9uKCkuZ2V0RXJyb3JDb3JyZWN0aW9uTGV2ZWwoKTsKCSAgICAgICAgLy8gUmVhZCBjb2Rld29yZHMKCSAgICAgICAgdmFyIGNvZGV3b3JkcyA9IHBhcnNlci5yZWFkQ29kZXdvcmRzKCk7CgkgICAgICAgIC8vIFNlcGFyYXRlIGludG8gZGF0YSBibG9ja3MKCSAgICAgICAgdmFyIGRhdGFCbG9ja3MgPSBEYXRhQmxvY2tfMS5kZWZhdWx0LmdldERhdGFCbG9ja3MoY29kZXdvcmRzLCB2ZXJzaW9uLCBlY0xldmVsKTsKCSAgICAgICAgLy8gQ291bnQgdG90YWwgbnVtYmVyIG9mIGRhdGEgYnl0ZXMKCSAgICAgICAgdmFyIHRvdGFsQnl0ZXMgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgZGF0YUJsb2Nrc18xID0gX192YWx1ZXMkMihkYXRhQmxvY2tzKSwgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpOyAhZGF0YUJsb2Nrc18xXzEuZG9uZTsgZGF0YUJsb2Nrc18xXzEgPSBkYXRhQmxvY2tzXzEubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIGRhdGFCbG9jayA9IGRhdGFCbG9ja3NfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgIHRvdGFsQnl0ZXMgKz0gZGF0YUJsb2NrLmdldE51bURhdGFDb2Rld29yZHMoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMV8xICYmICFkYXRhQmxvY2tzXzFfMS5kb25lICYmIChfYSA9IGRhdGFCbG9ja3NfMS5yZXR1cm4pKSBfYS5jYWxsKGRhdGFCbG9ja3NfMSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHJlc3VsdEJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkodG90YWxCeXRlcyk7CgkgICAgICAgIHZhciByZXN1bHRPZmZzZXQgPSAwOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgLy8gRXJyb3ItY29ycmVjdCBhbmQgY29weSBkYXRhIGJsb2NrcyB0b2dldGhlciBpbnRvIGEgc3RyZWFtIG9mIGJ5dGVzCgkgICAgICAgICAgICBmb3IgKHZhciBkYXRhQmxvY2tzXzIgPSBfX3ZhbHVlcyQyKGRhdGFCbG9ja3MpLCBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCk7ICFkYXRhQmxvY2tzXzJfMS5kb25lOyBkYXRhQmxvY2tzXzJfMSA9IGRhdGFCbG9ja3NfMi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZGF0YUJsb2NrID0gZGF0YUJsb2Nrc18yXzEudmFsdWU7CgkgICAgICAgICAgICAgICAgdmFyIGNvZGV3b3JkQnl0ZXMgPSBkYXRhQmxvY2suZ2V0Q29kZXdvcmRzKCk7CgkgICAgICAgICAgICAgICAgdmFyIG51bURhdGFDb2Rld29yZHMgPSBkYXRhQmxvY2suZ2V0TnVtRGF0YUNvZGV3b3JkcygpOwoJICAgICAgICAgICAgICAgIHRoaXMuY29ycmVjdEVycm9ycyhjb2Rld29yZEJ5dGVzLCBudW1EYXRhQ29kZXdvcmRzKTsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG51bURhdGFDb2Rld29yZHM7IGkrKykgewoJICAgICAgICAgICAgICAgICAgICByZXN1bHRCeXRlc1tyZXN1bHRPZmZzZXQrK10gPSBjb2Rld29yZEJ5dGVzW2ldOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICBjYXRjaCAoZV8yXzEpIHsgZV8yID0geyBlcnJvcjogZV8yXzEgfTsgfQoJICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgaWYgKGRhdGFCbG9ja3NfMl8xICYmICFkYXRhQmxvY2tzXzJfMS5kb25lICYmIChfYiA9IGRhdGFCbG9ja3NfMi5yZXR1cm4pKSBfYi5jYWxsKGRhdGFCbG9ja3NfMik7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gRGVjb2RlIHRoZSBjb250ZW50cyBvZiB0aGF0IHN0cmVhbSBvZiBieXRlcwoJICAgICAgICByZXR1cm4gRGVjb2RlZEJpdFN0cmVhbVBhcnNlcl8xLmRlZmF1bHQuZGVjb2RlKHJlc3VsdEJ5dGVzLCB2ZXJzaW9uLCBlY0xldmVsLCBoaW50cyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5HaXZlbiBkYXRhIGFuZCBlcnJvci1jb3JyZWN0aW9uIGNvZGV3b3JkcyByZWNlaXZlZCwgcG9zc2libHkgY29ycnVwdGVkIGJ5IGVycm9ycywgYXR0ZW1wdHMgdG8KCSAgICAgKiBjb3JyZWN0IHRoZSBlcnJvcnMgaW4tcGxhY2UgdXNpbmcgUmVlZC1Tb2xvbW9uIGVycm9yIGNvcnJlY3Rpb24uPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGNvZGV3b3JkQnl0ZXMgZGF0YSBhbmQgZXJyb3IgY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgKiBAcGFyYW0gbnVtRGF0YUNvZGV3b3JkcyBudW1iZXIgb2YgY29kZXdvcmRzIHRoYXQgYXJlIGRhdGEgYnl0ZXMKCSAgICAgKiBAdGhyb3dzIENoZWNrc3VtRXhjZXB0aW9uIGlmIGVycm9yIGNvcnJlY3Rpb24gZmFpbHMKCSAgICAgKi8KCSAgICBEZWNvZGVyLnByb3RvdHlwZS5jb3JyZWN0RXJyb3JzID0gZnVuY3Rpb24gKGNvZGV3b3JkQnl0ZXMsIG51bURhdGFDb2Rld29yZHMgLyppbnQqLykgewoJICAgICAgICAvLyBjb25zdCBudW1Db2Rld29yZHMgPSBjb2Rld29yZEJ5dGVzLmxlbmd0aDsKCSAgICAgICAgLy8gRmlyc3QgcmVhZCBpbnRvIGFuIGFycmF5IG9mIGludHMKCSAgICAgICAgdmFyIGNvZGV3b3Jkc0ludHMgPSBuZXcgSW50MzJBcnJheShjb2Rld29yZEJ5dGVzKTsKCSAgICAgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG5vdCByZWFseSBuZWNlc3NhcnkgdG8gdHJhbnNmb3JtIHRvIGludHM/IGNvdWxkIHJlZGVzaWduIGV2ZXJ5dGhpbmcgdG8gd29yayB3aXRoIHVuc2lnbmVkIGJ5dGVzPwoJICAgICAgICAvLyBjb25zdCBjb2Rld29yZHNJbnRzID0gbmV3IEludDMyQXJyYXkobnVtQ29kZXdvcmRzKQoJICAgICAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IG51bUNvZGV3b3JkczsgaSsrKSB7CgkgICAgICAgIC8vICAgY29kZXdvcmRzSW50c1tpXSA9IGNvZGV3b3JkQnl0ZXNbaV0gJiAweEZGCgkgICAgICAgIC8vIH0KCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIHRoaXMucnNEZWNvZGVyLmRlY29kZShjb2Rld29yZHNJbnRzLCBjb2Rld29yZEJ5dGVzLmxlbmd0aCAtIG51bURhdGFDb2Rld29yZHMpOwoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChpZ25vcmVkIC8qOiBSZWVkU29sb21vbkV4Y2VwdGlvbiovKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgQ2hlY2tzdW1FeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29weSBiYWNrIGludG8gYXJyYXkgb2YgYnl0ZXMgLS0gb25seSBuZWVkIHRvIHdvcnJ5IGFib3V0IHRoZSBieXRlcyB0aGF0IHdlcmUgZGF0YQoJICAgICAgICAvLyBXZSBkb24ndCBjYXJlIGFib3V0IGVycm9ycyBpbiB0aGUgZXJyb3ItY29ycmVjdGlvbiBjb2Rld29yZHMKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBudW1EYXRhQ29kZXdvcmRzOyBpKyspIHsKCSAgICAgICAgICAgIGNvZGV3b3JkQnl0ZXNbaV0gPSAvKihieXRlKSAqLyBjb2Rld29yZHNJbnRzW2ldOwoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gRGVjb2RlcjsKCX0oKSk7CglEZWNvZGVyJDEuZGVmYXVsdCA9IERlY29kZXI7CgoJdmFyIERldGVjdG9yJDEgPSB7fTsKCgl2YXIgTWF0aFV0aWxzJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMTIgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KE1hdGhVdGlscyQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLmNvbW1vbi5kZXRlY3RvciB7Ki8KCS8qKgoJICogR2VuZXJhbCBtYXRoLXJlbGF0ZWQgYW5kIG51bWVyaWMgdXRpbGl0eSBmdW5jdGlvbnMuCgkgKi8KCXZhciBNYXRoVXRpbHMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gTWF0aFV0aWxzKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBFbmRzIHVwIGJlaW5nIGEgYml0IGZhc3RlciB0aGFuIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0uIFRoaXMgbWVyZWx5IHJvdW5kcyBpdHMKCSAgICAgKiBhcmd1bWVudCB0byB0aGUgbmVhcmVzdCBpbnQsIHdoZXJlIHguNSByb3VuZHMgdXAgdG8geCsxLiBTZW1hbnRpY3Mgb2YgdGhpcyBzaG9ydGN1dAoJICAgICAqIGRpZmZlciBzbGlnaHRseSBmcm9tIHtAbGluayBNYXRoI3JvdW5kKGZsb2F0KX0gaW4gdGhhdCBoYWxmIHJvdW5kcyBkb3duIGZvciBuZWdhdGl2ZQoJICAgICAqIHZhbHVlcy4gLTIuNSByb3VuZHMgdG8gLTMsIG5vdCAtMi4gRm9yIHB1cnBvc2VzIGhlcmUgaXQgbWFrZXMgbm8gZGlmZmVyZW5jZS4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBkIHJlYWwgdmFsdWUgdG8gcm91bmQKCSAgICAgKiBAcmV0dXJuIG5lYXJlc3Qge0Bjb2RlIGludH0KCSAgICAgKi8KCSAgICBNYXRoVXRpbHMucm91bmQgPSBmdW5jdGlvbiAoZCAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE5hTiA9PT0gZCkKCSAgICAgICAgICAgIHJldHVybiAwOwoJICAgICAgICBpZiAoZCA8PSBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUikKCSAgICAgICAgICAgIHJldHVybiBOdW1iZXIuTUlOX1NBRkVfSU5URUdFUjsKCSAgICAgICAgaWYgKGQgPj0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVIpCgkgICAgICAgICAgICByZXR1cm4gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgICAgIHJldHVybiAvKihpbnQpICovIChkICsgKGQgPCAwLjAgPyAtMC41IDogMC41KSkgfCAwOwoJICAgIH07CgkgICAgLy8gVFlQRVNDUklQVFBPUlQ6IG1heWJlIHJlbW92ZSByb3VuZCBtZXRob2QgYW5kIGNhbGwgZGlyZWN0bHkgTWF0aC5yb3VuZCwgaXQgbG9va3MgbGlrZSBpdCBkb2Vzbid0IG1ha2Ugc2Vuc2UgZm9yIGpzCgkgICAgLyoqCgkgICAgICogQHBhcmFtIGFYIHBvaW50IEEgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGFZIHBvaW50IEEgeSBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJYIHBvaW50IEIgeCBjb29yZGluYXRlCgkgICAgICogQHBhcmFtIGJZIHBvaW50IEIgeSBjb29yZGluYXRlCgkgICAgICogQHJldHVybiBFdWNsaWRlYW4gZGlzdGFuY2UgYmV0d2VlbiBwb2ludHMgQSBhbmQgQgoJICAgICAqLwoJICAgIE1hdGhVdGlscy5kaXN0YW5jZSA9IGZ1bmN0aW9uIChhWCAvKmZsb2F0fGludCovLCBhWSAvKmZsb2F0fGludCovLCBiWCAvKmZsb2F0fGludCovLCBiWSAvKmZsb2F0fGludCovKSB7CgkgICAgICAgIHZhciB4RGlmZiA9IGFYIC0gYlg7CgkgICAgICAgIHZhciB5RGlmZiA9IGFZIC0gYlk7CgkgICAgICAgIHJldHVybiAvKihmbG9hdCkgKi8gTWF0aC5zcXJ0KHhEaWZmICogeERpZmYgKyB5RGlmZiAqIHlEaWZmKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBhWCBwb2ludCBBIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBhWSBwb2ludCBBIHkgY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWCBwb2ludCBCIHggY29vcmRpbmF0ZQoJICAgICAqIEBwYXJhbSBiWSBwb2ludCBCIHkgY29vcmRpbmF0ZQoJICAgICAqIEByZXR1cm4gRXVjbGlkZWFuIGRpc3RhbmNlIGJldHdlZW4gcG9pbnRzIEEgYW5kIEIKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgc3RhdGljIGRpc3RhbmNlKGFYOiBudW1iZXIgLyppbnQqLywgYVk6IG51bWJlciAvKmludCovLCBiWDogbnVtYmVyIC8qaW50Ki8sIGJZOiBudW1iZXIgLyppbnQqLyk6IGZsb2F0IHsKCSAgICAvLyAgIGNvbnN0IHhEaWZmID0gYVggLSBiWAoJICAgIC8vICAgY29uc3QgeURpZmYgPSBhWSAtIGJZCgkgICAgLy8gICByZXR1cm4gKGZsb2F0KSBNYXRoLnNxcnQoeERpZmYgKiB4RGlmZiArIHlEaWZmICogeURpZmYpOwoJICAgIC8vIH0KCSAgICAvKioKCSAgICAgKiBAcGFyYW0gYXJyYXkgdmFsdWVzIHRvIHN1bQoJICAgICAqIEByZXR1cm4gc3VtIG9mIHZhbHVlcyBpbiBhcnJheQoJICAgICAqLwoJICAgIE1hdGhVdGlscy5zdW0gPSBmdW5jdGlvbiAoYXJyYXkpIHsKCSAgICAgICAgdmFyIGNvdW50ID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbmd0aF8xID0gYXJyYXkubGVuZ3RoOyBpICE9PSBsZW5ndGhfMTsgaSsrKSB7CgkgICAgICAgICAgICB2YXIgYSA9IGFycmF5W2ldOwoJICAgICAgICAgICAgY291bnQgKz0gYTsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gY291bnQ7CgkgICAgfTsKCSAgICByZXR1cm4gTWF0aFV0aWxzOwoJfSgpKTsKCU1hdGhVdGlscyQxLmRlZmF1bHQgPSBNYXRoVXRpbHM7CgoJdmFyIERldGVjdG9yUmVzdWx0JDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KERldGVjdG9yUmVzdWx0JDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIHRoZSByZXN1bHQgb2YgZGV0ZWN0aW5nIGEgYmFyY29kZSBpbiBhbiBpbWFnZS4gVGhpcyBpbmNsdWRlcyB0aGUgcmF3CgkgKiBtYXRyaXggb2YgYmxhY2svd2hpdGUgcGl4ZWxzIGNvcnJlc3BvbmRpbmcgdG8gdGhlIGJhcmNvZGUsIGFuZCBwb3NzaWJseSBwb2ludHMgb2YgaW50ZXJlc3QKCSAqIGluIHRoZSBpbWFnZSwgbGlrZSB0aGUgbG9jYXRpb24gb2YgZmluZGVyIHBhdHRlcm5zIG9yIGNvcm5lcnMgb2YgdGhlIGJhcmNvZGUgaW4gdGhlIGltYWdlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgRGV0ZWN0b3JSZXN1bHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gRGV0ZWN0b3JSZXN1bHQoYml0cywgcG9pbnRzKSB7CgkgICAgICAgIHRoaXMuYml0cyA9IGJpdHM7CgkgICAgICAgIHRoaXMucG9pbnRzID0gcG9pbnRzOwoJICAgIH0KCSAgICBEZXRlY3RvclJlc3VsdC5wcm90b3R5cGUuZ2V0Qml0cyA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYml0czsKCSAgICB9OwoJICAgIERldGVjdG9yUmVzdWx0LnByb3RvdHlwZS5nZXRQb2ludHMgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLnBvaW50czsKCSAgICB9OwoJICAgIHJldHVybiBEZXRlY3RvclJlc3VsdDsKCX0oKSk7CglEZXRlY3RvclJlc3VsdCQxLmRlZmF1bHQgPSBEZXRlY3RvclJlc3VsdDsKCgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSQxID0ge307CgoJdmFyIERlZmF1bHRHcmlkU2FtcGxlciQxID0ge307CgoJdmFyIEdyaWRTYW1wbGVyJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDUgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyoqCgkgKiBJbXBsZW1lbnRhdGlvbnMgb2YgdGhpcyBjbGFzcyBjYW4sIGdpdmVuIGxvY2F0aW9ucyBvZiBmaW5kZXIgcGF0dGVybnMgZm9yIGEgUVIgY29kZSBpbiBhbgoJICogaW1hZ2UsIHNhbXBsZSB0aGUgcmlnaHQgcG9pbnRzIGluIHRoZSBpbWFnZSB0byByZWNvbnN0cnVjdCB0aGUgUVIgY29kZSwgYWNjb3VudGluZyBmb3IKCSAqIHBlcnNwZWN0aXZlIGRpc3RvcnRpb24uIEl0IGlzIGFic3RyYWN0ZWQgc2luY2UgaXQgaXMgcmVsYXRpdmVseSBleHBlbnNpdmUgYW5kIHNob3VsZCBiZSBhbGxvd2VkCgkgKiB0byB0YWtlIGFkdmFudGFnZSBvZiBwbGF0Zm9ybS1zcGVjaWZpYyBvcHRpbWl6ZWQgaW1wbGVtZW50YXRpb25zLCBsaWtlIFN1bidzIEphdmEgQWR2YW5jZWQKCSAqIEltYWdpbmcgbGlicmFyeSwgYnV0IHdoaWNoIG1heSBub3QgYmUgYXZhaWxhYmxlIGluIG90aGVyIGVudmlyb25tZW50cyBzdWNoIGFzIEoyTUUsIGFuZCB2aWNlCgkgKiB2ZXJzYS4KCSAqCgkgKiBUaGUgaW1wbGVtZW50YXRpb24gdXNlZCBjYW4gYmUgY29udHJvbGxlZCBieSBjYWxsaW5nIHtAbGluayAjc2V0R3JpZFNhbXBsZXIoR3JpZFNhbXBsZXIpfQoJICogd2l0aCBhbiBpbnN0YW5jZSBvZiBhIGNsYXNzIHdoaWNoIGltcGxlbWVudHMgdGhpcyBpbnRlcmZhY2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEdyaWRTYW1wbGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEdyaWRTYW1wbGVyKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiA8cD5DaGVja3MgYSBzZXQgb2YgcG9pbnRzIHRoYXQgaGF2ZSBiZWVuIHRyYW5zZm9ybWVkIHRvIHNhbXBsZSBwb2ludHMgb24gYW4gaW1hZ2UgYWdhaW5zdAoJICAgICAqIHRoZSBpbWFnZSdzIGRpbWVuc2lvbnMgdG8gc2VlIGlmIHRoZSBwb2ludCBhcmUgZXZlbiB3aXRoaW4gdGhlIGltYWdlLjwvcD4KCSAgICAgKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHdpbGwgYWN0dWFsbHkgIm51ZGdlIiB0aGUgZW5kcG9pbnRzIGJhY2sgb250byB0aGUgaW1hZ2UgaWYgdGhleSBhcmUgZm91bmQgdG8gYmUKCSAgICAgKiBiYXJlbHkgKGxlc3MgdGhhbiAxIHBpeGVsKSBvZmYgdGhlIGltYWdlLiBUaGlzIGFjY291bnRzIGZvciBpbXBlcmZlY3QgZGV0ZWN0aW9uIG9mIGZpbmRlcgoJICAgICAqIHBhdHRlcm5zIGluIGFuIGltYWdlIHdoZXJlIHRoZSBRUiBDb2RlIHJ1bnMgYWxsIHRoZSB3YXkgdG8gdGhlIGltYWdlIGJvcmRlci48L3A+CgkgICAgICoKCSAgICAgKiA8cD5Gb3IgZWZmaWNpZW5jeSwgdGhlIG1ldGhvZCB3aWxsIGNoZWNrIHBvaW50cyBmcm9tIGVpdGhlciBlbmQgb2YgdGhlIGxpbmUgdW50aWwgb25lIGlzIGZvdW5kCgkgICAgICogdG8gYmUgd2l0aGluIHRoZSBpbWFnZS4gQmVjYXVzZSB0aGUgc2V0IG9mIHBvaW50cyBhcmUgYXNzdW1lZCB0byBiZSBsaW5lYXIsIHRoaXMgaXMgdmFsaWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGltYWdlIGltYWdlIGludG8gd2hpY2ggdGhlIHBvaW50cyBzaG91bGQgbWFwCgkgICAgICogQHBhcmFtIHBvaW50cyBhY3R1YWwgcG9pbnRzIGluIHgxLHkxLC4uLix4bix5biBmb3JtCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhbiBlbmRwb2ludCBpcyBsaWVzIG91dHNpZGUgdGhlIGltYWdlIGJvdW5kYXJpZXMKCSAgICAgKi8KCSAgICBHcmlkU2FtcGxlci5jaGVja0FuZE51ZGdlUG9pbnRzID0gZnVuY3Rpb24gKGltYWdlLCBwb2ludHMpIHsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIGhlaWdodCA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gc3RhcnQgdW50aWwgd2Ugc2VlIHNvbWUgdGhhdCBhcmUgT0s6CgkgICAgICAgIHZhciBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSAwOyBvZmZzZXQgPCBwb2ludHMubGVuZ3RoICYmIG51ZGdlZDsgb2Zmc2V0ICs9IDIpIHsKCSAgICAgICAgICAgIHZhciB4ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0XSk7CgkgICAgICAgICAgICB2YXIgeSA9IE1hdGguZmxvb3IocG9pbnRzW29mZnNldCArIDFdKTsKCSAgICAgICAgICAgIGlmICh4IDwgLTEgfHwgeCA+IHdpZHRoIHx8IHkgPCAtMSB8fCB5ID4gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBudWRnZWQgPSBmYWxzZTsKCSAgICAgICAgICAgIGlmICh4ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gMC4wOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIGlmICh4ID09PSB3aWR0aCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXRdID0gd2lkdGggLSAxOwoJICAgICAgICAgICAgICAgIG51ZGdlZCA9IHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAoeSA9PT0gLTEpIHsKCSAgICAgICAgICAgICAgICBwb2ludHNbb2Zmc2V0ICsgMV0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IGhlaWdodCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBDaGVjayBhbmQgbnVkZ2UgcG9pbnRzIGZyb20gZW5kOgoJICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICBmb3IgKHZhciBvZmZzZXQgPSBwb2ludHMubGVuZ3RoIC0gMjsgb2Zmc2V0ID49IDAgJiYgbnVkZ2VkOyBvZmZzZXQgLT0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBNYXRoLmZsb29yKHBvaW50c1tvZmZzZXRdKTsKCSAgICAgICAgICAgIHZhciB5ID0gTWF0aC5mbG9vcihwb2ludHNbb2Zmc2V0ICsgMV0pOwoJICAgICAgICAgICAgaWYgKHggPCAtMSB8fCB4ID4gd2lkdGggfHwgeSA8IC0xIHx8IHkgPiBoZWlnaHQpIHsKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ1LmRlZmF1bHQoKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIG51ZGdlZCA9IGZhbHNlOwoJICAgICAgICAgICAgaWYgKHggPT09IC0xKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSAwLjA7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGVsc2UgaWYgKHggPT09IHdpZHRoKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldF0gPSB3aWR0aCAtIDE7CgkgICAgICAgICAgICAgICAgbnVkZ2VkID0gdHJ1ZTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGlmICh5ID09PSAtMSkgewoJICAgICAgICAgICAgICAgIHBvaW50c1tvZmZzZXQgKyAxXSA9IDAuMDsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZWxzZSBpZiAoeSA9PT0gaGVpZ2h0KSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW29mZnNldCArIDFdID0gaGVpZ2h0IC0gMTsKCSAgICAgICAgICAgICAgICBudWRnZWQgPSB0cnVlOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgfTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXI7Cgl9KCkpOwoJR3JpZFNhbXBsZXIkMS5kZWZhdWx0ID0gR3JpZFNhbXBsZXI7CgoJdmFyIFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KFBlcnNwZWN0aXZlVHJhbnNmb3JtJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJLyoqCgkgKiA8cD5UaGlzIGNsYXNzIGltcGxlbWVudHMgYSBwZXJzcGVjdGl2ZSB0cmFuc2Zvcm0gaW4gdHdvIGRpbWVuc2lvbnMuIEdpdmVuIGZvdXIgc291cmNlIGFuZCBmb3VyCgkgKiBkZXN0aW5hdGlvbiBwb2ludHMsIGl0IHdpbGwgY29tcHV0ZSB0aGUgdHJhbnNmb3JtYXRpb24gaW1wbGllZCBiZXR3ZWVuIHRoZW0uIFRoZSBjb2RlIGlzIGJhc2VkCgkgKiBkaXJlY3RseSB1cG9uIHNlY3Rpb24gMy40LjIgb2YgR2VvcmdlIFdvbGJlcmcncyAiRGlnaXRhbCBJbWFnZSBXYXJwaW5nIjsgc2VlIHBhZ2VzIDU0LTU2LjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUGVyc3BlY3RpdmVUcmFuc2Zvcm0oYTExIC8qZmxvYXQqLywgYTIxIC8qZmxvYXQqLywgYTMxIC8qZmxvYXQqLywgYTEyIC8qZmxvYXQqLywgYTIyIC8qZmxvYXQqLywgYTMyIC8qZmxvYXQqLywgYTEzIC8qZmxvYXQqLywgYTIzIC8qZmxvYXQqLywgYTMzIC8qZmxvYXQqLykgewoJICAgICAgICB0aGlzLmExMSA9IGExMTsKCSAgICAgICAgdGhpcy5hMjEgPSBhMjE7CgkgICAgICAgIHRoaXMuYTMxID0gYTMxOwoJICAgICAgICB0aGlzLmExMiA9IGExMjsKCSAgICAgICAgdGhpcy5hMjIgPSBhMjI7CgkgICAgICAgIHRoaXMuYTMyID0gYTMyOwoJICAgICAgICB0aGlzLmExMyA9IGExMzsKCSAgICAgICAgdGhpcy5hMjMgPSBhMjM7CgkgICAgICAgIHRoaXMuYTMzID0gYTMzOwoJICAgIH0KCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsID0gZnVuY3Rpb24gKHgwIC8qZmxvYXQqLywgeTAgLypmbG9hdCovLCB4MSAvKmZsb2F0Ki8sIHkxIC8qZmxvYXQqLywgeDIgLypmbG9hdCovLCB5MiAvKmZsb2F0Ki8sIHgzIC8qZmxvYXQqLywgeTMgLypmbG9hdCovLCB4MHAgLypmbG9hdCovLCB5MHAgLypmbG9hdCovLCB4MXAgLypmbG9hdCovLCB5MXAgLypmbG9hdCovLCB4MnAgLypmbG9hdCovLCB5MnAgLypmbG9hdCovLCB4M3AgLypmbG9hdCovLCB5M3AgLypmbG9hdCovKSB7CgkgICAgICAgIHZhciBxVG9TID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0ucXVhZHJpbGF0ZXJhbFRvU3F1YXJlKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5Myk7CgkgICAgICAgIHZhciBzVG9RID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwcCwgeTBwLCB4MXAsIHkxcCwgeDJwLCB5MnAsIHgzcCwgeTNwKTsKCSAgICAgICAgcmV0dXJuIHNUb1EudGltZXMocVRvUyk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUudHJhbnNmb3JtUG9pbnRzID0gZnVuY3Rpb24gKHBvaW50cykgewoJICAgICAgICB2YXIgbWF4ID0gcG9pbnRzLmxlbmd0aDsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXg7IGkgKz0gMikgewoJICAgICAgICAgICAgdmFyIHggPSBwb2ludHNbaV07CgkgICAgICAgICAgICB2YXIgeSA9IHBvaW50c1tpICsgMV07CgkgICAgICAgICAgICB2YXIgZGVub21pbmF0b3IgPSBhMTMgKiB4ICsgYTIzICogeSArIGEzMzsKCSAgICAgICAgICAgIHBvaW50c1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHBvaW50c1tpICsgMV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50cmFuc2Zvcm1Qb2ludHNXaXRoVmFsdWVzID0gZnVuY3Rpb24gKHhWYWx1ZXMsIHlWYWx1ZXMpIHsKCSAgICAgICAgdmFyIGExMSA9IHRoaXMuYTExOwoJICAgICAgICB2YXIgYTEyID0gdGhpcy5hMTI7CgkgICAgICAgIHZhciBhMTMgPSB0aGlzLmExMzsKCSAgICAgICAgdmFyIGEyMSA9IHRoaXMuYTIxOwoJICAgICAgICB2YXIgYTIyID0gdGhpcy5hMjI7CgkgICAgICAgIHZhciBhMjMgPSB0aGlzLmEyMzsKCSAgICAgICAgdmFyIGEzMSA9IHRoaXMuYTMxOwoJICAgICAgICB2YXIgYTMyID0gdGhpcy5hMzI7CgkgICAgICAgIHZhciBhMzMgPSB0aGlzLmEzMzsKCSAgICAgICAgdmFyIG4gPSB4VmFsdWVzLmxlbmd0aDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBuOyBpKyspIHsKCSAgICAgICAgICAgIHZhciB4ID0geFZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciB5ID0geVZhbHVlc1tpXTsKCSAgICAgICAgICAgIHZhciBkZW5vbWluYXRvciA9IGExMyAqIHggKyBhMjMgKiB5ICsgYTMzOwoJICAgICAgICAgICAgeFZhbHVlc1tpXSA9IChhMTEgKiB4ICsgYTIxICogeSArIGEzMSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHlWYWx1ZXNbaV0gPSAoYTEyICogeCArIGEyMiAqIHkgKyBhMzIpIC8gZGVub21pbmF0b3I7CgkgICAgICAgIH0KCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnNxdWFyZVRvUXVhZHJpbGF0ZXJhbCA9IGZ1bmN0aW9uICh4MCAvKmZsb2F0Ki8sIHkwIC8qZmxvYXQqLywgeDEgLypmbG9hdCovLCB5MSAvKmZsb2F0Ki8sIHgyIC8qZmxvYXQqLywgeTIgLypmbG9hdCovLCB4MyAvKmZsb2F0Ki8sIHkzIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgZHgzID0geDAgLSB4MSArIHgyIC0geDM7CgkgICAgICAgIHZhciBkeTMgPSB5MCAtIHkxICsgeTIgLSB5MzsKCSAgICAgICAgaWYgKGR4MyA9PT0gMC4wICYmIGR5MyA9PT0gMC4wKSB7CgkgICAgICAgICAgICAvLyBBZmZpbmUKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCwgeDIgLSB4MSwgeDAsIHkxIC0geTAsIHkyIC0geTEsIHkwLCAwLjAsIDAuMCwgMS4wKTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHZhciBkeDEgPSB4MSAtIHgyOwoJICAgICAgICAgICAgdmFyIGR4MiA9IHgzIC0geDI7CgkgICAgICAgICAgICB2YXIgZHkxID0geTEgLSB5MjsKCSAgICAgICAgICAgIHZhciBkeTIgPSB5MyAtIHkyOwoJICAgICAgICAgICAgdmFyIGRlbm9taW5hdG9yID0gZHgxICogZHkyIC0gZHgyICogZHkxOwoJICAgICAgICAgICAgdmFyIGExMyA9IChkeDMgKiBkeTIgLSBkeDIgKiBkeTMpIC8gZGVub21pbmF0b3I7CgkgICAgICAgICAgICB2YXIgYTIzID0gKGR4MSAqIGR5MyAtIGR4MyAqIGR5MSkgLyBkZW5vbWluYXRvcjsKCSAgICAgICAgICAgIHJldHVybiBuZXcgUGVyc3BlY3RpdmVUcmFuc2Zvcm0oeDEgLSB4MCArIGExMyAqIHgxLCB4MyAtIHgwICsgYTIzICogeDMsIHgwLCB5MSAtIHkwICsgYTEzICogeTEsIHkzIC0geTAgKyBhMjMgKiB5MywgeTAsIGExMywgYTIzLCAxLjApOwoJICAgICAgICB9CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5xdWFkcmlsYXRlcmFsVG9TcXVhcmUgPSBmdW5jdGlvbiAoeDAgLypmbG9hdCovLCB5MCAvKmZsb2F0Ki8sIHgxIC8qZmxvYXQqLywgeTEgLypmbG9hdCovLCB4MiAvKmZsb2F0Ki8sIHkyIC8qZmxvYXQqLywgeDMgLypmbG9hdCovLCB5MyAvKmZsb2F0Ki8pIHsKCSAgICAgICAgLy8gSGVyZSwgdGhlIGFkam9pbnQgc2VydmVzIGFzIHRoZSBpbnZlcnNlOgoJICAgICAgICByZXR1cm4gUGVyc3BlY3RpdmVUcmFuc2Zvcm0uc3F1YXJlVG9RdWFkcmlsYXRlcmFsKHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIsIHgzLCB5MykuYnVpbGRBZGpvaW50KCk7CgkgICAgfTsKCSAgICBQZXJzcGVjdGl2ZVRyYW5zZm9ybS5wcm90b3R5cGUuYnVpbGRBZGpvaW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBBZGpvaW50IGlzIHRoZSB0cmFuc3Bvc2Ugb2YgdGhlIGNvZmFjdG9yIG1hdHJpeDoKCSAgICAgICAgcmV0dXJuIG5ldyBQZXJzcGVjdGl2ZVRyYW5zZm9ybSh0aGlzLmEyMiAqIHRoaXMuYTMzIC0gdGhpcy5hMjMgKiB0aGlzLmEzMiwgdGhpcy5hMjMgKiB0aGlzLmEzMSAtIHRoaXMuYTIxICogdGhpcy5hMzMsIHRoaXMuYTIxICogdGhpcy5hMzIgLSB0aGlzLmEyMiAqIHRoaXMuYTMxLCB0aGlzLmExMyAqIHRoaXMuYTMyIC0gdGhpcy5hMTIgKiB0aGlzLmEzMywgdGhpcy5hMTEgKiB0aGlzLmEzMyAtIHRoaXMuYTEzICogdGhpcy5hMzEsIHRoaXMuYTEyICogdGhpcy5hMzEgLSB0aGlzLmExMSAqIHRoaXMuYTMyLCB0aGlzLmExMiAqIHRoaXMuYTIzIC0gdGhpcy5hMTMgKiB0aGlzLmEyMiwgdGhpcy5hMTMgKiB0aGlzLmEyMSAtIHRoaXMuYTExICogdGhpcy5hMjMsIHRoaXMuYTExICogdGhpcy5hMjIgLSB0aGlzLmExMiAqIHRoaXMuYTIxKTsKCSAgICB9OwoJICAgIFBlcnNwZWN0aXZlVHJhbnNmb3JtLnByb3RvdHlwZS50aW1lcyA9IGZ1bmN0aW9uIChvdGhlcikgewoJICAgICAgICByZXR1cm4gbmV3IFBlcnNwZWN0aXZlVHJhbnNmb3JtKHRoaXMuYTExICogb3RoZXIuYTExICsgdGhpcy5hMjEgKiBvdGhlci5hMTIgKyB0aGlzLmEzMSAqIG90aGVyLmExMywgdGhpcy5hMTEgKiBvdGhlci5hMjEgKyB0aGlzLmEyMSAqIG90aGVyLmEyMiArIHRoaXMuYTMxICogb3RoZXIuYTIzLCB0aGlzLmExMSAqIG90aGVyLmEzMSArIHRoaXMuYTIxICogb3RoZXIuYTMyICsgdGhpcy5hMzEgKiBvdGhlci5hMzMsIHRoaXMuYTEyICogb3RoZXIuYTExICsgdGhpcy5hMjIgKiBvdGhlci5hMTIgKyB0aGlzLmEzMiAqIG90aGVyLmExMywgdGhpcy5hMTIgKiBvdGhlci5hMjEgKyB0aGlzLmEyMiAqIG90aGVyLmEyMiArIHRoaXMuYTMyICogb3RoZXIuYTIzLCB0aGlzLmExMiAqIG90aGVyLmEzMSArIHRoaXMuYTIyICogb3RoZXIuYTMyICsgdGhpcy5hMzIgKiBvdGhlci5hMzMsIHRoaXMuYTEzICogb3RoZXIuYTExICsgdGhpcy5hMjMgKiBvdGhlci5hMTIgKyB0aGlzLmEzMyAqIG90aGVyLmExMywgdGhpcy5hMTMgKiBvdGhlci5hMjEgKyB0aGlzLmEyMyAqIG90aGVyLmEyMiArIHRoaXMuYTMzICogb3RoZXIuYTIzLCB0aGlzLmExMyAqIG90aGVyLmEzMSArIHRoaXMuYTIzICogb3RoZXIuYTMyICsgdGhpcy5hMzMgKiBvdGhlci5hMzMpOwoJICAgIH07CgkgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoJfSgpKTsKCVBlcnNwZWN0aXZlVHJhbnNmb3JtJDEuZGVmYXVsdCA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX19leHRlbmRzJDIgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGVmYXVsdEdyaWRTYW1wbGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcuY29tbW9uIHsqLwoJdmFyIEdyaWRTYW1wbGVyXzEgPSBHcmlkU2FtcGxlciQxOwoJdmFyIEJpdE1hdHJpeF8xJDEgPSBCaXRNYXRyaXgkMTsKCXZhciBQZXJzcGVjdGl2ZVRyYW5zZm9ybV8xJDEgPSBQZXJzcGVjdGl2ZVRyYW5zZm9ybSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEkNCA9IE5vdEZvdW5kRXhjZXB0aW9uJDE7CgkvKioKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBEZWZhdWx0R3JpZFNhbXBsZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDIoRGVmYXVsdEdyaWRTYW1wbGVyLCBfc3VwZXIpOwoJICAgIGZ1bmN0aW9uIERlZmF1bHRHcmlkU2FtcGxlcigpIHsKCSAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzOwoJICAgIH0KCSAgICAvKkBPdmVycmlkZSovCgkgICAgRGVmYXVsdEdyaWRTYW1wbGVyLnByb3RvdHlwZS5zYW1wbGVHcmlkID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgcDFUb1ggLypmbG9hdCovLCBwMVRvWSAvKmZsb2F0Ki8sIHAyVG9YIC8qZmxvYXQqLywgcDJUb1kgLypmbG9hdCovLCBwM1RvWCAvKmZsb2F0Ki8sIHAzVG9ZIC8qZmxvYXQqLywgcDRUb1ggLypmbG9hdCovLCBwNFRvWSAvKmZsb2F0Ki8sIHAxRnJvbVggLypmbG9hdCovLCBwMUZyb21ZIC8qZmxvYXQqLywgcDJGcm9tWCAvKmZsb2F0Ki8sIHAyRnJvbVkgLypmbG9hdCovLCBwM0Zyb21YIC8qZmxvYXQqLywgcDNGcm9tWSAvKmZsb2F0Ki8sIHA0RnJvbVggLypmbG9hdCovLCBwNEZyb21ZIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSQxLmRlZmF1bHQucXVhZHJpbGF0ZXJhbFRvUXVhZHJpbGF0ZXJhbChwMVRvWCwgcDFUb1ksIHAyVG9YLCBwMlRvWSwgcDNUb1gsIHAzVG9ZLCBwNFRvWCwgcDRUb1ksIHAxRnJvbVgsIHAxRnJvbVksIHAyRnJvbVgsIHAyRnJvbVksIHAzRnJvbVgsIHAzRnJvbVksIHA0RnJvbVgsIHA0RnJvbVkpOwoJICAgICAgICByZXR1cm4gdGhpcy5zYW1wbGVHcmlkV2l0aFRyYW5zZm9ybShpbWFnZSwgZGltZW5zaW9uWCwgZGltZW5zaW9uWSwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBEZWZhdWx0R3JpZFNhbXBsZXIucHJvdG90eXBlLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtID0gZnVuY3Rpb24gKGltYWdlLCBkaW1lbnNpb25YIC8qaW50Ki8sIGRpbWVuc2lvblkgLyppbnQqLywgdHJhbnNmb3JtKSB7CgkgICAgICAgIGlmIChkaW1lbnNpb25YIDw9IDAgfHwgZGltZW5zaW9uWSA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQ0LmRlZmF1bHQoKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMSQxLmRlZmF1bHQoZGltZW5zaW9uWCwgZGltZW5zaW9uWSk7CgkgICAgICAgIHZhciBwb2ludHMgPSBuZXcgRmxvYXQzMkFycmF5KDIgKiBkaW1lbnNpb25YKTsKCSAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBkaW1lbnNpb25ZOyB5KyspIHsKCSAgICAgICAgICAgIHZhciBtYXggPSBwb2ludHMubGVuZ3RoOwoJICAgICAgICAgICAgdmFyIGlWYWx1ZSA9IHkgKyAwLjU7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1heDsgeCArPSAyKSB7CgkgICAgICAgICAgICAgICAgcG9pbnRzW3hdID0gKHggLyAyKSArIDAuNTsKCSAgICAgICAgICAgICAgICBwb2ludHNbeCArIDFdID0gaVZhbHVlOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgdHJhbnNmb3JtLnRyYW5zZm9ybVBvaW50cyhwb2ludHMpOwoJICAgICAgICAgICAgLy8gUXVpY2sgY2hlY2sgdG8gc2VlIGlmIHBvaW50cyB0cmFuc2Zvcm1lZCB0byBzb21ldGhpbmcgaW5zaWRlIHRoZSBpbWFnZQoJICAgICAgICAgICAgLy8gc3VmZmljaWVudCB0byBjaGVjayB0aGUgZW5kcG9pbnRzCgkgICAgICAgICAgICBHcmlkU2FtcGxlcl8xLmRlZmF1bHQuY2hlY2tBbmROdWRnZVBvaW50cyhpbWFnZSwgcG9pbnRzKTsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBtYXg7IHggKz0gMikgewoJICAgICAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KE1hdGguZmxvb3IocG9pbnRzW3hdKSwgTWF0aC5mbG9vcihwb2ludHNbeCArIDFdKSkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEJsYWNrKC1pc2gpIHBpeGVsCgkgICAgICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4IC8gMiwgeSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoYWlvb2JlIC8qOiBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24qLykgewoJICAgICAgICAgICAgICAgIC8vIFRoaXMgZmVlbHMgd3JvbmcsIGJ1dCwgc29tZXRpbWVzIGlmIHRoZSBmaW5kZXIgcGF0dGVybnMgYXJlIG1pc2lkZW50aWZpZWQsIHRoZSByZXN1bHRpbmcKCSAgICAgICAgICAgICAgICAvLyB0cmFuc2Zvcm0gZ2V0cyAidHdpc3RlZCIgc3VjaCB0aGF0IGl0IG1hcHMgYSBzdHJhaWdodCBsaW5lIG9mIHBvaW50cyB0byBhIHNldCBvZiBwb2ludHMKCSAgICAgICAgICAgICAgICAvLyB3aG9zZSBlbmRwb2ludHMgYXJlIGluIGJvdW5kcywgYnV0IG90aGVycyBhcmUgbm90LiBUaGVyZSBpcyBwcm9iYWJseSBzb21lIG1hdGhlbWF0aWNhbAoJICAgICAgICAgICAgICAgIC8vIHdheSB0byBkZXRlY3QgdGhpcyBhYm91dCB0aGUgdHJhbnNmb3JtYXRpb24gdGhhdCBJIGRvbid0IGtub3cgeWV0LgoJICAgICAgICAgICAgICAgIC8vIFRoaXMgcmVzdWx0cyBpbiBhbiB1Z2x5IHJ1bnRpbWUgZXhjZXB0aW9uIGRlc3BpdGUgb3VyIGNsZXZlciBjaGVja3MgYWJvdmUgLS0gY2FuJ3QgaGF2ZQoJICAgICAgICAgICAgICAgIC8vIHRoYXQuIFdlIGNvdWxkIGNoZWNrIGVhY2ggcG9pbnQncyBjb29yZGluYXRlcyBidXQgdGhhdCBmZWVscyBkdXBsaWNhdGl2ZS4gV2Ugc2V0dGxlIGZvcgoJICAgICAgICAgICAgICAgIC8vIGNhdGNoaW5nIGFuZCB3cmFwcGluZyBBcnJheUluZGV4T3V0T2ZCb3VuZHNFeGNlcHRpb24uCgkgICAgICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkNC5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICByZXR1cm4gRGVmYXVsdEdyaWRTYW1wbGVyOwoJfShHcmlkU2FtcGxlcl8xLmRlZmF1bHQpKTsKCURlZmF1bHRHcmlkU2FtcGxlciQxLmRlZmF1bHQgPSBEZWZhdWx0R3JpZFNhbXBsZXI7CgoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEdyaWRTYW1wbGVySW5zdGFuY2UkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIERlZmF1bHRHcmlkU2FtcGxlcl8xID0gRGVmYXVsdEdyaWRTYW1wbGVyJDE7Cgl2YXIgR3JpZFNhbXBsZXJJbnN0YW5jZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBHcmlkU2FtcGxlckluc3RhbmNlKCkgewoJICAgIH0KCSAgICAvKioKCSAgICAgKiBTZXRzIHRoZSBpbXBsZW1lbnRhdGlvbiBvZiBHcmlkU2FtcGxlciB1c2VkIGJ5IHRoZSBsaWJyYXJ5LiBPbmUgZ2xvYmFsCgkgICAgICogaW5zdGFuY2UgaXMgc3RvcmVkLCB3aGljaCBtYXkgc291bmQgcHJvYmxlbWF0aWMuIEJ1dCwgdGhlIGltcGxlbWVudGF0aW9uIHByb3ZpZGVkCgkgICAgICogb3VnaHQgdG8gYmUgYXBwcm9wcmlhdGUgZm9yIHRoZSBlbnRpcmUgcGxhdGZvcm0sIGFuZCBhbGwgdXNlcyBvZiB0aGlzIGxpYnJhcnkKCSAgICAgKiBpbiB0aGUgd2hvbGUgbGlmZXRpbWUgb2YgdGhlIEpWTS4gRm9yIGluc3RhbmNlLCBhbiBBbmRyb2lkIGFjdGl2aXR5IGNhbiBzd2FwIGluCgkgICAgICogYW4gaW1wbGVtZW50YXRpb24gdGhhdCB0YWtlcyBhZHZhbnRhZ2Ugb2YgbmF0aXZlIHBsYXRmb3JtIGxpYnJhcmllcy4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBuZXdHcmlkU2FtcGxlciBUaGUgcGxhdGZvcm0tc3BlY2lmaWMgb2JqZWN0IHRvIGluc3RhbGwuCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5zZXRHcmlkU2FtcGxlciA9IGZ1bmN0aW9uIChuZXdHcmlkU2FtcGxlcikgewoJICAgICAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3R3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSBjdXJyZW50IGltcGxlbWVudGF0aW9uIG9mIEdyaWRTYW1wbGVyCgkgICAgICovCgkgICAgR3JpZFNhbXBsZXJJbnN0YW5jZS5nZXRJbnN0YW5jZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIEdyaWRTYW1wbGVySW5zdGFuY2UuZ3JpZFNhbXBsZXI7CgkgICAgfTsKCSAgICBHcmlkU2FtcGxlckluc3RhbmNlLmdyaWRTYW1wbGVyID0gbmV3IERlZmF1bHRHcmlkU2FtcGxlcl8xLmRlZmF1bHQoKTsKCSAgICByZXR1cm4gR3JpZFNhbXBsZXJJbnN0YW5jZTsKCX0oKSk7CglHcmlkU2FtcGxlckluc3RhbmNlJDEuZGVmYXVsdCA9IEdyaWRTYW1wbGVySW5zdGFuY2U7CgoJdmFyIFJlc3VsdFBvaW50JDEgPSB7fTsKCgl2YXIgRmxvYXQkMSA9IHt9OwoKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShGbG9hdCQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKioKCSAqIFBvbnlmaWxsIGZvciBKYXZhJ3MgRmxvYXQgY2xhc3MuCgkgKi8KCXZhciBGbG9hdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBGbG9hdCgpIHsKCSAgICB9CgkgICAgLyoqCgkgICAgICogU2luY1RTIGhhcyBubyBkaWZmZXJlbmNlIGJldHdlZW4gaW50IGFuZCBmbG9hdCwgdGhlcmUncyBhbGwgbnVtYmVycywKCSAgICAgKiB0aGlzIGlzIHVzZWQgb25seSB0byBwb2x5ZmlsbCBKYXZhIGNvZGUuCgkgICAgICovCgkgICAgRmxvYXQuZmxvYXRUb0ludEJpdHMgPSBmdW5jdGlvbiAoZikgewoJICAgICAgICByZXR1cm4gZjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFRoZSBmbG9hdCBtYXggdmFsdWUgaW4gSlMgaXMgdGhlIG51bWJlciBtYXggdmFsdWUuCgkgICAgICovCgkgICAgRmxvYXQuTUFYX1ZBTFVFID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVI7CgkgICAgcmV0dXJuIEZsb2F0OwoJfSgpKTsKCUZsb2F0JDEuZGVmYXVsdCA9IEZsb2F0OwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVzdWx0UG9pbnQkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZyB7Ki8KCXZhciBNYXRoVXRpbHNfMSQxID0gTWF0aFV0aWxzJDE7Cgl2YXIgRmxvYXRfMSA9IEZsb2F0JDE7CgkvKioKCSAqIDxwPkVuY2Fwc3VsYXRlcyBhIHBvaW50IG9mIGludGVyZXN0IGluIGFuIGltYWdlIGNvbnRhaW5pbmcgYSBiYXJjb2RlLiBUeXBpY2FsbHksIHRoaXMKCSAqIHdvdWxkIGJlIHRoZSBsb2NhdGlvbiBvZiBhIGZpbmRlciBwYXR0ZXJuIG9yIHRoZSBjb3JuZXIgb2YgdGhlIGJhcmNvZGUsIGZvciBleGFtcGxlLjwvcD4KCSAqCgkgKiBAYXV0aG9yIFNlYW4gT3dlbgoJICovCgl2YXIgUmVzdWx0UG9pbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgZnVuY3Rpb24gUmVzdWx0UG9pbnQoeCwgeSkgewoJICAgICAgICB0aGlzLnggPSB4OwoJICAgICAgICB0aGlzLnkgPSB5OwoJICAgIH0KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUuZ2V0WCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMueDsKCSAgICB9OwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5nZXRZID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy55OwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5lcXVhbHMgPSBmdW5jdGlvbiAob3RoZXIpIHsKCSAgICAgICAgaWYgKG90aGVyIGluc3RhbmNlb2YgUmVzdWx0UG9pbnQpIHsKCSAgICAgICAgICAgIHZhciBvdGhlclBvaW50ID0gb3RoZXI7CgkgICAgICAgICAgICByZXR1cm4gdGhpcy54ID09PSBvdGhlclBvaW50LnggJiYgdGhpcy55ID09PSBvdGhlclBvaW50Lnk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIFJlc3VsdFBvaW50LnByb3RvdHlwZS5oYXNoQ29kZSA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIDMxICogRmxvYXRfMS5kZWZhdWx0LmZsb2F0VG9JbnRCaXRzKHRoaXMueCkgKyBGbG9hdF8xLmRlZmF1bHQuZmxvYXRUb0ludEJpdHModGhpcy55KTsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBSZXN1bHRQb2ludC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiAnKCcgKyB0aGlzLnggKyAnLCcgKyB0aGlzLnkgKyAnKSc7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBPcmRlcnMgYW4gYXJyYXkgb2YgdGhyZWUgUmVzdWx0UG9pbnRzIGluIGFuIG9yZGVyIFtBLEIsQ10gc3VjaCB0aGF0IEFCIGlzIGxlc3MgdGhhbiBBQwoJICAgICAqIGFuZCBCQyBpcyBsZXNzIHRoYW4gQUMsIGFuZCB0aGUgYW5nbGUgYmV0d2VlbiBCQyBhbmQgQkEgaXMgbGVzcyB0aGFuIDE4MCBkZWdyZWVzLgoJICAgICAqCgkgICAgICogQHBhcmFtIHBhdHRlcm5zIGFycmF5IG9mIHRocmVlIHtAY29kZSBSZXN1bHRQb2ludH0gdG8gb3JkZXIKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5vcmRlckJlc3RQYXR0ZXJucyA9IGZ1bmN0aW9uIChwYXR0ZXJucykgewoJICAgICAgICAvLyBGaW5kIGRpc3RhbmNlcyBiZXR3ZWVuIHBhdHRlcm4gY2VudGVycwoJICAgICAgICB2YXIgemVyb09uZURpc3RhbmNlID0gdGhpcy5kaXN0YW5jZShwYXR0ZXJuc1swXSwgcGF0dGVybnNbMV0pOwoJICAgICAgICB2YXIgb25lVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzFdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciB6ZXJvVHdvRGlzdGFuY2UgPSB0aGlzLmRpc3RhbmNlKHBhdHRlcm5zWzBdLCBwYXR0ZXJuc1syXSk7CgkgICAgICAgIHZhciBwb2ludEE7CgkgICAgICAgIHZhciBwb2ludEI7CgkgICAgICAgIHZhciBwb2ludEM7CgkgICAgICAgIC8vIEFzc3VtZSBvbmUgY2xvc2VzdCB0byBvdGhlciB0d28gaXMgQjsgQSBhbmQgQyB3aWxsIGp1c3QgYmUgZ3Vlc3NlcyBhdCBmaXJzdAoJICAgICAgICBpZiAob25lVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlICYmIG9uZVR3b0Rpc3RhbmNlID49IHplcm9Ud29EaXN0YW5jZSkgewoJICAgICAgICAgICAgcG9pbnRCID0gcGF0dGVybnNbMF07CgkgICAgICAgICAgICBwb2ludEEgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QyA9IHBhdHRlcm5zWzJdOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgaWYgKHplcm9Ud29EaXN0YW5jZSA+PSBvbmVUd29EaXN0YW5jZSAmJiB6ZXJvVHdvRGlzdGFuY2UgPj0gemVyb09uZURpc3RhbmNlKSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1sxXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMl07CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICBwb2ludEIgPSBwYXR0ZXJuc1syXTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBhdHRlcm5zWzBdOwoJICAgICAgICAgICAgcG9pbnRDID0gcGF0dGVybnNbMV07CgkgICAgICAgIH0KCSAgICAgICAgLy8gVXNlIGNyb3NzIHByb2R1Y3QgdG8gZmlndXJlIG91dCB3aGV0aGVyIEEgYW5kIEMgYXJlIGNvcnJlY3Qgb3IgZmxpcHBlZC4KCSAgICAgICAgLy8gVGhpcyBhc2tzIHdoZXRoZXIgQkMgeCBCQSBoYXMgYSBwb3NpdGl2ZSB6IGNvbXBvbmVudCwgd2hpY2ggaXMgdGhlIGFycmFuZ2VtZW50CgkgICAgICAgIC8vIHdlIHdhbnQgZm9yIEEsIEIsIEMuIElmIGl0J3MgbmVnYXRpdmUsIHRoZW4gd2UndmUgZ290IGl0IGZsaXBwZWQgYXJvdW5kIGFuZAoJICAgICAgICAvLyBzaG91bGQgc3dhcCBBIGFuZCBDLgoJICAgICAgICBpZiAodGhpcy5jcm9zc1Byb2R1Y3RaKHBvaW50QSwgcG9pbnRCLCBwb2ludEMpIDwgMC4wKSB7CgkgICAgICAgICAgICB2YXIgdGVtcCA9IHBvaW50QTsKCSAgICAgICAgICAgIHBvaW50QSA9IHBvaW50QzsKCSAgICAgICAgICAgIHBvaW50QyA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgcGF0dGVybnNbMF0gPSBwb2ludEE7CgkgICAgICAgIHBhdHRlcm5zWzFdID0gcG9pbnRCOwoJICAgICAgICBwYXR0ZXJuc1syXSA9IHBvaW50QzsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEBwYXJhbSBwYXR0ZXJuMSBmaXJzdCBwYXR0ZXJuCgkgICAgICogQHBhcmFtIHBhdHRlcm4yIHNlY29uZCBwYXR0ZXJuCgkgICAgICogQHJldHVybiBkaXN0YW5jZSBiZXR3ZWVuIHR3byBwb2ludHMKCSAgICAgKi8KCSAgICBSZXN1bHRQb2ludC5kaXN0YW5jZSA9IGZ1bmN0aW9uIChwYXR0ZXJuMSwgcGF0dGVybjIpIHsKCSAgICAgICAgcmV0dXJuIE1hdGhVdGlsc18xJDEuZGVmYXVsdC5kaXN0YW5jZShwYXR0ZXJuMS54LCBwYXR0ZXJuMS55LCBwYXR0ZXJuMi54LCBwYXR0ZXJuMi55KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIFJldHVybnMgdGhlIHogY29tcG9uZW50IG9mIHRoZSBjcm9zcyBwcm9kdWN0IGJldHdlZW4gdmVjdG9ycyBCQyBhbmQgQkEuCgkgICAgICovCgkgICAgUmVzdWx0UG9pbnQuY3Jvc3NQcm9kdWN0WiA9IGZ1bmN0aW9uIChwb2ludEEsIHBvaW50QiwgcG9pbnRDKSB7CgkgICAgICAgIHZhciBiWCA9IHBvaW50Qi54OwoJICAgICAgICB2YXIgYlkgPSBwb2ludEIueTsKCSAgICAgICAgcmV0dXJuICgocG9pbnRDLnggLSBiWCkgKiAocG9pbnRBLnkgLSBiWSkpIC0gKChwb2ludEMueSAtIGJZKSAqIChwb2ludEEueCAtIGJYKSk7CgkgICAgfTsKCSAgICByZXR1cm4gUmVzdWx0UG9pbnQ7Cgl9KCkpOwoJUmVzdWx0UG9pbnQkMS5kZWZhdWx0ID0gUmVzdWx0UG9pbnQ7CgoJdmFyIEFsaWdubWVudFBhdHRlcm5GaW5kZXIkMSA9IHt9OwoKCXZhciBBbGlnbm1lbnRQYXR0ZXJuJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fZXh0ZW5kcyQxID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHsKCSAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwKCSAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHwKCSAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9OwoJICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTsKCSAgICB9OwoJICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikgewoJICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH0KCSAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpOwoJICAgIH07Cgl9KSgpOwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEFsaWdubWVudFBhdHRlcm4kMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgUmVzdWx0UG9pbnRfMSQzID0gUmVzdWx0UG9pbnQkMTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGFuIGFsaWdubWVudCBwYXR0ZXJuLCB3aGljaCBhcmUgdGhlIHNtYWxsZXIgc3F1YXJlIHBhdHRlcm5zIGZvdW5kIGluCgkgKiBhbGwgYnV0IHRoZSBzaW1wbGVzdCBRUiBDb2Rlcy48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEFsaWdubWVudFBhdHRlcm4gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7CgkgICAgX19leHRlbmRzJDEoQWxpZ25tZW50UGF0dGVybiwgX3N1cGVyKTsKCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIHJldHVybiBfdGhpczsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZXJtaW5lcyBpZiB0aGlzIGFsaWdubWVudCBwYXR0ZXJuICJhYm91dCBlcXVhbHMiIGFuIGFsaWdubWVudCBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhbiBhdmVyYWdlIG9mIHRoZSB0d28uCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybi5wcm90b3R5cGUuY29tYmluZUVzdGltYXRlID0gZnVuY3Rpb24gKGkgLypmbG9hdCovLCBqIC8qZmxvYXQqLywgbmV3TW9kdWxlU2l6ZSAvKmZsb2F0Ki8pIHsKCSAgICAgICAgdmFyIGNvbWJpbmVkWCA9ICh0aGlzLmdldFgoKSArIGopIC8gMi4wOwoJICAgICAgICB2YXIgY29tYmluZWRZID0gKHRoaXMuZ2V0WSgpICsgaSkgLyAyLjA7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplICsgbmV3TW9kdWxlU2l6ZSkgLyAyLjA7CgkgICAgICAgIHJldHVybiBuZXcgQWxpZ25tZW50UGF0dGVybihjb21iaW5lZFgsIGNvbWJpbmVkWSwgY29tYmluZWRNb2R1bGVTaXplKTsKCSAgICB9OwoJICAgIHJldHVybiBBbGlnbm1lbnRQYXR0ZXJuOwoJfShSZXN1bHRQb2ludF8xJDMuZGVmYXVsdCkpOwoJQWxpZ25tZW50UGF0dGVybiQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCgl2YXIgX192YWx1ZXMkMSA9IChjb21tb25qc0dsb2JhbCAmJiBjb21tb25qc0dsb2JhbC5fX3ZhbHVlcykgfHwgZnVuY3Rpb24obykgewoJICAgIHZhciBzID0gdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiBTeW1ib2wuaXRlcmF0b3IsIG0gPSBzICYmIG9bc10sIGkgPSAwOwoJICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pOwoJICAgIGlmIChvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gIm51bWJlciIpIHJldHVybiB7CgkgICAgICAgIG5leHQ6IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7CgkgICAgICAgICAgICByZXR1cm4geyB2YWx1ZTogbyAmJiBvW2krK10sIGRvbmU6ICFvIH07CgkgICAgICAgIH0KCSAgICB9OwoJICAgIHRocm93IG5ldyBUeXBlRXJyb3IocyA/ICJPYmplY3QgaXMgbm90IGl0ZXJhYmxlLiIgOiAiU3ltYm9sLml0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLiIpOwoJfTsKCU9iamVjdC5kZWZpbmVQcm9wZXJ0eShBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuXzEgPSBBbGlnbm1lbnRQYXR0ZXJuJDE7Cgl2YXIgTm90Rm91bmRFeGNlcHRpb25fMSQzID0gTm90Rm91bmRFeGNlcHRpb24kMTsKCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBhbGlnbm1lbnQgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBBbGlnbm1lbnQgcGF0dGVybnMgbG9vayBsaWtlIGZpbmRlcgoJICogcGF0dGVybnMgYnV0IGFyZSBzbWFsbGVyIGFuZCBhcHBlYXIgYXQgcmVndWxhciBpbnRlcnZhbHMgdGhyb3VnaG91dCB0aGUgaW1hZ2UuPC9wPgoJICoKCSAqIDxwPkF0IHRoZSBtb21lbnQgdGhpcyBvbmx5IGxvb2tzIGZvciB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAqCgkgKiA8cD5UaGlzIGlzIG1vc3RseSBhIHNpbXBsaWZpZWQgY29weSBvZiB7QGxpbmsgRmluZGVyUGF0dGVybkZpbmRlcn0uIEl0IGlzIGNvcGllZCwKCSAqIHBhc3RlZCBhbmQgc3RyaXBwZWQgZG93biBoZXJlIGZvciBtYXhpbXVtIHBlcmZvcm1hbmNlIGJ1dCBkb2VzIHVuZm9ydHVuYXRlbHkgZHVwbGljYXRlCgkgKiBzb21lIGNvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIC8qKgoJICAgICAqIDxwPkNyZWF0ZXMgYSBmaW5kZXIgdGhhdCB3aWxsIGxvb2sgaW4gYSBwb3J0aW9uIG9mIHRoZSB3aG9sZSBpbWFnZS48L3A+CgkgICAgICoKCSAgICAgKiBAcGFyYW0gaW1hZ2UgaW1hZ2UgdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIHN0YXJ0WCBsZWZ0IGNvbHVtbiBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSBzdGFydFkgdG9wIHJvdyBmcm9tIHdoaWNoIHRvIHN0YXJ0IHNlYXJjaGluZwoJICAgICAqIEBwYXJhbSB3aWR0aCB3aWR0aCBvZiByZWdpb24gdG8gc2VhcmNoCgkgICAgICogQHBhcmFtIGhlaWdodCBoZWlnaHQgb2YgcmVnaW9uIHRvIHNlYXJjaAoJICAgICAqIEBwYXJhbSBtb2R1bGVTaXplIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBzbyBmYXIKCSAgICAgKi8KCSAgICBmdW5jdGlvbiBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyKGltYWdlLCBzdGFydFggLyppbnQqLywgc3RhcnRZIC8qaW50Ki8sIHdpZHRoIC8qaW50Ki8sIGhlaWdodCAvKmludCovLCBtb2R1bGVTaXplIC8qZmxvYXQqLywgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMuc3RhcnRYID0gc3RhcnRYOwoJICAgICAgICB0aGlzLnN0YXJ0WSA9IHN0YXJ0WTsKCSAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoOwoJICAgICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDsKCSAgICAgICAgdGhpcy5tb2R1bGVTaXplID0gbW9kdWxlU2l6ZTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICAgICAgdGhpcy5wb3NzaWJsZUNlbnRlcnMgPSBbXTsgLy8gbmV3IEFycmF5PGFueT4oNSkpCgkgICAgICAgIC8vIFRZUEVTQ1JJUFRQT1JUOiBhcnJheSBpbml0aWFsaXphdGlvbiB3aXRob3V0IHNpemUgYXMgdGhlIGxlbmd0aCBpcyBjaGVja2VkIGJlbG93CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSgzKTsKCSAgICB9CgkgICAgLyoqCgkgICAgICogPHA+VGhpcyBtZXRob2QgYXR0ZW1wdHMgdG8gZmluZCB0aGUgYm90dG9tLXJpZ2h0IGFsaWdubWVudCBwYXR0ZXJuIGluIHRoZSBpbWFnZS4gSXQgaXMgYSBiaXQgbWVzc3kgc2luY2UKCSAgICAgKiBpdCdzIHByZXR0eSBwZXJmb3JtYW5jZS1jcml0aWNhbCBhbmQgc28gaXMgd3JpdHRlbiB0byBiZSBmYXN0IGZvcmVtb3N0LjwvcD4KCSAgICAgKgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBub3QgZm91bmQKCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgc3RhcnRYID0gdGhpcy5zdGFydFg7CgkgICAgICAgIHZhciBoZWlnaHQgPSB0aGlzLmhlaWdodDsKCSAgICAgICAgdmFyIHdpZHRoID0gdGhpcy53aWR0aDsKCSAgICAgICAgdmFyIG1heEogPSBzdGFydFggKyB3aWR0aDsKCSAgICAgICAgdmFyIG1pZGRsZUkgPSB0aGlzLnN0YXJ0WSArIChoZWlnaHQgLyAyKTsKCSAgICAgICAgLy8gV2UgYXJlIGxvb2tpbmcgZm9yIGJsYWNrL3doaXRlL2JsYWNrIG1vZHVsZXMgaW4gMToxOjEgcmF0aW8KCSAgICAgICAgLy8gdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIHNlZW4gc28gZmFyCgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoMyk7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIGZvciAodmFyIGlHZW4gPSAwOyBpR2VuIDwgaGVpZ2h0OyBpR2VuKyspIHsKCSAgICAgICAgICAgIC8vIFNlYXJjaCBmcm9tIG1pZGRsZSBvdXR3YXJkcwoJICAgICAgICAgICAgdmFyIGkgPSBtaWRkbGVJICsgKChpR2VuICYgMHgwMSkgPT09IDAgPyBNYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSA6IC1NYXRoLmZsb29yKChpR2VuICsgMSkgLyAyKSk7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICB2YXIgaiA9IHN0YXJ0WDsKCSAgICAgICAgICAgIC8vIEJ1cm4gb2ZmIGxlYWRpbmcgd2hpdGUgcGl4ZWxzIGJlZm9yZSBhbnl0aGluZyBlbHNlOyBpZiB3ZSBzdGFydCBpbiB0aGUgbWlkZGxlIG9mCgkgICAgICAgICAgICAvLyBhIHdoaXRlIHJ1biwgaXQgZG9lc24ndCBtYWtlIHNlbnNlIHRvIGNvdW50IGl0cyBsZW5ndGgsIHNpbmNlIHdlIGRvbid0IGtub3cgaWYgdGhlCgkgICAgICAgICAgICAvLyB3aGl0ZSBydW4gY29udGludWVkIHRvIHRoZSBsZWZ0IG9mIHRoZSBzdGFydCBwb2ludAoJICAgICAgICAgICAgd2hpbGUgKGogPCBtYXhKICYmICFpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB2YXIgY3VycmVudFN0YXRlID0gMDsKCSAgICAgICAgICAgIHdoaWxlIChqIDwgbWF4SikgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMV0rKzsKCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICBlbHNlIHsgLy8gQ291bnRpbmcgd2hpdGUgcGl4ZWxzCgkgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudFN0YXRlID09PSAyKSB7IC8vIEEgd2lubmVyPwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmZvdW5kUGF0dGVybkNyb3NzKHN0YXRlQ291bnQpKSB7IC8vIFllcwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBqKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCAhPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gc3RhdGVDb3VudFsyXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gMTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsrK2N1cnJlbnRTdGF0ZV0rKzsKCSAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gMSkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBqKys7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBpZiAodGhpcy5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSkgewoJICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIG1heEopOwoJICAgICAgICAgICAgICAgIGlmIChjb25maXJtZWQgIT09IG51bGwpIHsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpcm1lZDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgLy8gSG1tLCBub3RoaW5nIHdlIHNhdyB3YXMgb2JzZXJ2ZWQgYW5kIGNvbmZpcm1lZCB0d2ljZS4gSWYgd2UgaGFkCgkgICAgICAgIC8vIGFueSBndWVzcyBhdCBhbGwsIHJldHVybiBpdC4KCSAgICAgICAgaWYgKHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aCAhPT0gMCkgewoJICAgICAgICAgICAgcmV0dXJuIHRoaXMucG9zc2libGVDZW50ZXJzWzBdOwoJICAgICAgICB9CgkgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDMuZGVmYXVsdCgpOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogR2l2ZW4gYSBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCBzZWVuIGFuZCBhbiBlbmQgcG9zaXRpb24sCgkgICAgICogZmlndXJlcyB0aGUgbG9jYXRpb24gb2YgdGhlIGNlbnRlciBvZiB0aGlzIGJsYWNrL3doaXRlL2JsYWNrIHJ1bi4KCSAgICAgKi8KCSAgICBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCwgZW5kIC8qaW50Ki8pIHsKCSAgICAgICAgcmV0dXJuIChlbmQgLSBzdGF0ZUNvdW50WzJdKSAtIHN0YXRlQ291bnRbMV0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8xIHJhdGlvcwoJICAgICAqICAgICAgICAgdXNlZCBieSBhbGlnbm1lbnQgcGF0dGVybnMgdG8gYmUgY29uc2lkZXJlZCBhIG1hdGNoCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMubW9kdWxlU2l6ZTsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAzOyBpKyspIHsKCSAgICAgICAgICAgIGlmIChNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFtpXSkgPj0gbWF4VmFyaWFuY2UpIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5BZnRlciBhIGhvcml6b250YWwgc2NhbiBmaW5kcyBhIHBvdGVudGlhbCBhbGlnbm1lbnQgcGF0dGVybiwgdGhpcyBtZXRob2QKCSAgICAgKiAiY3Jvc3MtY2hlY2tzIiBieSBzY2FubmluZyBkb3duIHZlcnRpY2FsbHkgdGhyb3VnaCB0aGUgY2VudGVyIG9mIHRoZSBwb3NzaWJsZQoJICAgICAqIGFsaWdubWVudCBwYXR0ZXJuIHRvIHNlZSBpZiB0aGUgc2FtZSBwcm9wb3J0aW9uIGlzIGRldGVjdGVkLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGFydEkgcm93IHdoZXJlIGFuIGFsaWdubWVudCBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYW4gYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBhbGlnbm1lbnQgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgQWxpZ25tZW50UGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAvLyBTdGFydCBjb3VudGluZyB1cCBmcm9tIGNlbnRlcgoJICAgICAgICB2YXIgaSA9IHN0YXJ0STsKCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbMF0gPD0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMF0rKzsKCSAgICAgICAgICAgIGktLTsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFswXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIC8vIE5vdyBhbHNvIGNvdW50IGRvd24gZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IHN0YXJ0SSArIDE7CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbMV0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA8IG1heEkgJiYgIWltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzJdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzJdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMl0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSAyICogb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRoaXMuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkgPyBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaSkgOiBOYU47CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5UaGlzIGlzIGNhbGxlZCB3aGVuIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4uIEl0IHdpbGwKCSAgICAgKiBjcm9zcyBjaGVjayB3aXRoIGEgdmVydGljYWwgc2NhbiwgYW5kIGlmIHN1Y2Nlc3NmdWwsIHdpbGwgc2VlIGlmIHRoaXMgcGF0dGVybiBoYWQgYmVlbgoJICAgICAqIGZvdW5kIG9uIGEgcHJldmlvdXMgaG9yaXpvbnRhbCBzY2FuLiBJZiBzbywgd2UgY29uc2lkZXIgaXQgY29uZmlybWVkIGFuZCBjb25jbHVkZSB3ZSBoYXZlCgkgICAgICogZm91bmQgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBzdGF0ZUNvdW50IHJlYWRpbmcgc3RhdGUgbW9kdWxlIGNvdW50cyBmcm9tIGhvcml6b250YWwgc2NhbgoJICAgICAqIEBwYXJhbSBpIHJvdyB3aGVyZSBhbGlnbm1lbnQgcGF0dGVybiBtYXkgYmUgZm91bmQKCSAgICAgKiBAcGFyYW0gaiBlbmQgb2YgcG9zc2libGUgYWxpZ25tZW50IHBhdHRlcm4gaW4gcm93CgkgICAgICogQHJldHVybiB7QGxpbmsgQWxpZ25tZW50UGF0dGVybn0gaWYgd2UgaGF2ZSBmb3VuZCB0aGUgc2FtZSBwYXR0ZXJuIHR3aWNlLCBvciBudWxsIGlmIG5vdAoJICAgICAqLwoJICAgIEFsaWdubWVudFBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmhhbmRsZVBvc3NpYmxlQ2VudGVyID0gZnVuY3Rpb24gKHN0YXRlQ291bnQsIGkgLyppbnQqLywgaiAvKmludCovKSB7CgkgICAgICAgIHZhciBlXzEsIF9hOwoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdOwoJICAgICAgICB2YXIgY2VudGVySiA9IEFsaWdubWVudFBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKTsKCSAgICAgICAgdmFyIGNlbnRlckkgPSB0aGlzLmNyb3NzQ2hlY2tWZXJ0aWNhbChpLCAvKihpbnQpICovIGNlbnRlckosIDIgKiBzdGF0ZUNvdW50WzFdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IChzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0pIC8gMy4wOwoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBmb3IgKHZhciBfYiA9IF9fdmFsdWVzJDEodGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfYyA9IF9iLm5leHQoKTsgIV9jLmRvbmU7IF9jID0gX2IubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgICAgIHZhciBjZW50ZXIgPSBfYy52YWx1ZTsKCSAgICAgICAgICAgICAgICAgICAgLy8gTG9vayBmb3IgYWJvdXQgdGhlIHNhbWUgY2VudGVyIGFuZCBtb2R1bGUgc2l6ZToKCSAgICAgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5hYm91dEVxdWFscyhlc3RpbWF0ZWRNb2R1bGVTaXplLCBjZW50ZXJJLCBjZW50ZXJKKSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNlbnRlci5jb21iaW5lRXN0aW1hdGUoY2VudGVySSwgY2VudGVySiwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBjYXRjaCAoZV8xXzEpIHsgZV8xID0geyBlcnJvcjogZV8xXzEgfTsgfQoJICAgICAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKF9jICYmICFfYy5kb25lICYmIChfYSA9IF9iLnJldHVybikpIF9hLmNhbGwoX2IpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMSkgdGhyb3cgZV8xLmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICAvLyBIYWRuJ3QgZm91bmQgdGhpcyBiZWZvcmU7IHNhdmUgaXQKCSAgICAgICAgICAgIHZhciBwb2ludCA9IG5ldyBBbGlnbm1lbnRQYXR0ZXJuXzEuZGVmYXVsdChjZW50ZXJKLCBjZW50ZXJJLCBlc3RpbWF0ZWRNb2R1bGVTaXplKTsKCSAgICAgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzLnB1c2gocG9pbnQpOwoJICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjay5mb3VuZFBvc3NpYmxlUmVzdWx0UG9pbnQocG9pbnQpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBudWxsOwoJICAgIH07CgkgICAgcmV0dXJuIEFsaWdubWVudFBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJQWxpZ25tZW50UGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyOwoKCXZhciBGaW5kZXJQYXR0ZXJuRmluZGVyJDEgPSB7fTsKCgl2YXIgRmluZGVyUGF0dGVybiQxID0ge307CgoJLyoKCSAqIENvcHlyaWdodCAyMDA3IFpYaW5nIGF1dGhvcnMKCSAqCgkgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKCSAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4KCSAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdAoJICoKCSAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCgkgKgoJICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQoJICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKCSAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgoJICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAoJICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCgkgKi8KCXZhciBfX2V4dGVuZHMgPSAoY29tbW9uanNHbG9iYWwgJiYgY29tbW9uanNHbG9iYWwuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkgewoJICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKCSAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fAoJICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fAoJICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoYi5oYXNPd25Qcm9wZXJ0eShwKSkgZFtwXSA9IGJbcF07IH07CgkgICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpOwoJICAgIH07CgkgICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CgkgICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7CgkgICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfQoJICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CgkgICAgfTsKCX0pKCk7CglPYmplY3QuZGVmaW5lUHJvcGVydHkoRmluZGVyUGF0dGVybiQxLCAiX19lc01vZHVsZSIsIHsgdmFsdWU6IHRydWUgfSk7CgkvKm5hbWVzcGFjZSBjb20uZ29vZ2xlLnp4aW5nLnFyY29kZS5kZXRlY3RvciB7Ki8KCXZhciBSZXN1bHRQb2ludF8xJDIgPSBSZXN1bHRQb2ludCQxOwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgYSBmaW5kZXIgcGF0dGVybiwgd2hpY2ggYXJlIHRoZSB0aHJlZSBzcXVhcmUgcGF0dGVybnMgZm91bmQgaW4KCSAqIHRoZSBjb3JuZXJzIG9mIFFSIENvZGVzLiBJdCBhbHNvIGVuY2Fwc3VsYXRlcyBhIGNvdW50IG9mIHNpbWlsYXIgZmluZGVyIHBhdHRlcm5zLAoJICogYXMgYSBjb252ZW5pZW5jZSB0byB0aGUgZmluZGVyJ3MgYm9va2tlZXBpbmcuPC9wPgoJICoKCSAqIEBhdXRob3IgU2VhbiBPd2VuCgkgKi8KCXZhciBGaW5kZXJQYXR0ZXJuID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikgewoJICAgIF9fZXh0ZW5kcyhGaW5kZXJQYXR0ZXJuLCBfc3VwZXIpOwoJICAgIC8vIEZpbmRlclBhdHRlcm4ocG9zWDogbnVtYmVyLypmbG9hdCovLCBwb3NZOiBudW1iZXIvKmZsb2F0Ki8sIGVzdGltYXRlZE1vZHVsZVNpemU6IG51bWJlci8qZmxvYXQqLykgewoJICAgIC8vICAgdGhpcyhwb3NYLCBwb3NZLCBlc3RpbWF0ZWRNb2R1bGVTaXplLCAxKQoJICAgIC8vIH0KCSAgICBmdW5jdGlvbiBGaW5kZXJQYXR0ZXJuKHBvc1ggLypmbG9hdCovLCBwb3NZIC8qZmxvYXQqLywgZXN0aW1hdGVkTW9kdWxlU2l6ZSAvKmZsb2F0Ki8sIGNvdW50IC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcG9zWCwgcG9zWSkgfHwgdGhpczsKCSAgICAgICAgX3RoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IGVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIF90aGlzLmNvdW50ID0gY291bnQ7CgkgICAgICAgIGlmICh1bmRlZmluZWQgPT09IGNvdW50KSB7CgkgICAgICAgICAgICBfdGhpcy5jb3VudCA9IDE7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIF90aGlzOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5lc3RpbWF0ZWRNb2R1bGVTaXplOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybi5wcm90b3R5cGUuZ2V0Q291bnQgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmNvdW50OwoJICAgIH07CgkgICAgLyoKCSAgICB2b2lkIGluY3JlbWVudENvdW50KCkgewoJICAgICAgdGhpcy5jb3VudCsrCgkgICAgfQoJICAgICAqLwoJICAgIC8qKgoJICAgICAqIDxwPkRldGVybWluZXMgaWYgdGhpcyBmaW5kZXIgcGF0dGVybiAiYWJvdXQgZXF1YWxzIiBhIGZpbmRlciBwYXR0ZXJuIGF0IHRoZSBzdGF0ZWQKCSAgICAgKiBwb3NpdGlvbiBhbmQgc2l6ZSAtLSBtZWFuaW5nLCBpdCBpcyBhdCBuZWFybHkgdGhlIHNhbWUgY2VudGVyIHdpdGggbmVhcmx5IHRoZSBzYW1lIHNpemUuPC9wPgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm4ucHJvdG90eXBlLmFib3V0RXF1YWxzID0gZnVuY3Rpb24gKG1vZHVsZVNpemUgLypmbG9hdCovLCBpIC8qZmxvYXQqLywgaiAvKmZsb2F0Ki8pIHsKCSAgICAgICAgaWYgKE1hdGguYWJzKGkgLSB0aGlzLmdldFkoKSkgPD0gbW9kdWxlU2l6ZSAmJiBNYXRoLmFicyhqIC0gdGhpcy5nZXRYKCkpIDw9IG1vZHVsZVNpemUpIHsKCSAgICAgICAgICAgIHZhciBtb2R1bGVTaXplRGlmZiA9IE1hdGguYWJzKG1vZHVsZVNpemUgLSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgcmV0dXJuIG1vZHVsZVNpemVEaWZmIDw9IDEuMCB8fCBtb2R1bGVTaXplRGlmZiA8PSB0aGlzLmVzdGltYXRlZE1vZHVsZVNpemU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQ29tYmluZXMgdGhpcyBvYmplY3QncyBjdXJyZW50IGVzdGltYXRlIG9mIGEgZmluZGVyIHBhdHRlcm4gcG9zaXRpb24gYW5kIG1vZHVsZSBzaXplCgkgICAgICogd2l0aCBhIG5ldyBlc3RpbWF0ZS4gSXQgcmV0dXJucyBhIG5ldyB7QGNvZGUgRmluZGVyUGF0dGVybn0gY29udGFpbmluZyBhIHdlaWdodGVkIGF2ZXJhZ2UKCSAgICAgKiBiYXNlZCBvbiBjb3VudC4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuLnByb3RvdHlwZS5jb21iaW5lRXN0aW1hdGUgPSBmdW5jdGlvbiAoaSAvKmZsb2F0Ki8sIGogLypmbG9hdCovLCBuZXdNb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgY29tYmluZWRDb3VudCA9IHRoaXMuY291bnQgKyAxOwoJICAgICAgICB2YXIgY29tYmluZWRYID0gKHRoaXMuY291bnQgKiB0aGlzLmdldFgoKSArIGopIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgdmFyIGNvbWJpbmVkWSA9ICh0aGlzLmNvdW50ICogdGhpcy5nZXRZKCkgKyBpKSAvIGNvbWJpbmVkQ291bnQ7CgkgICAgICAgIHZhciBjb21iaW5lZE1vZHVsZVNpemUgPSAodGhpcy5jb3VudCAqIHRoaXMuZXN0aW1hdGVkTW9kdWxlU2l6ZSArIG5ld01vZHVsZVNpemUpIC8gY29tYmluZWRDb3VudDsKCSAgICAgICAgcmV0dXJuIG5ldyBGaW5kZXJQYXR0ZXJuKGNvbWJpbmVkWCwgY29tYmluZWRZLCBjb21iaW5lZE1vZHVsZVNpemUsIGNvbWJpbmVkQ291bnQpOwoJICAgIH07CgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm47Cgl9KFJlc3VsdFBvaW50XzEkMi5kZWZhdWx0KSk7CglGaW5kZXJQYXR0ZXJuJDEuZGVmYXVsdCA9IEZpbmRlclBhdHRlcm47CgoJdmFyIEZpbmRlclBhdHRlcm5JbmZvJDEgPSB7fTsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5JbmZvJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qKgoJICogPHA+RW5jYXBzdWxhdGVzIGluZm9ybWF0aW9uIGFib3V0IGZpbmRlciBwYXR0ZXJucyBpbiBhbiBpbWFnZSwgaW5jbHVkaW5nIHRoZSBsb2NhdGlvbiBvZgoJICogdGhlIHRocmVlIGZpbmRlciBwYXR0ZXJucywgYW5kIHRoZWlyIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5JbmZvID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIEZpbmRlclBhdHRlcm5JbmZvKHBhdHRlcm5DZW50ZXJzKSB7CgkgICAgICAgIHRoaXMuYm90dG9tTGVmdCA9IHBhdHRlcm5DZW50ZXJzWzBdOwoJICAgICAgICB0aGlzLnRvcExlZnQgPSBwYXR0ZXJuQ2VudGVyc1sxXTsKCSAgICAgICAgdGhpcy50b3BSaWdodCA9IHBhdHRlcm5DZW50ZXJzWzJdOwoJICAgIH0KCSAgICBGaW5kZXJQYXR0ZXJuSW5mby5wcm90b3R5cGUuZ2V0Qm90dG9tTGVmdCA9IGZ1bmN0aW9uICgpIHsKCSAgICAgICAgcmV0dXJuIHRoaXMuYm90dG9tTGVmdDsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5JbmZvLnByb3RvdHlwZS5nZXRUb3BMZWZ0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BMZWZ0OwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkluZm8ucHJvdG90eXBlLmdldFRvcFJpZ2h0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy50b3BSaWdodDsKCSAgICB9OwoJICAgIHJldHVybiBGaW5kZXJQYXR0ZXJuSW5mbzsKCX0oKSk7CglGaW5kZXJQYXR0ZXJuSW5mbyQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuSW5mbzsKCgkvKgoJICogQ29weXJpZ2h0IDIwMDcgWlhpbmcgYXV0aG9ycwoJICoKCSAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwoJICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgoJICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CgkgKgoJICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKCSAqCgkgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCgkgKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAoJICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCgkgKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCgkgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KCSAqLwoJdmFyIF9fdmFsdWVzID0gKGNvbW1vbmpzR2xvYmFsICYmIGNvbW1vbmpzR2xvYmFsLl9fdmFsdWVzKSB8fCBmdW5jdGlvbihvKSB7CgkgICAgdmFyIHMgPSB0eXBlb2YgU3ltYm9sID09PSAiZnVuY3Rpb24iICYmIFN5bWJvbC5pdGVyYXRvciwgbSA9IHMgJiYgb1tzXSwgaSA9IDA7CgkgICAgaWYgKG0pIHJldHVybiBtLmNhbGwobyk7CgkgICAgaWYgKG8gJiYgdHlwZW9mIG8ubGVuZ3RoID09PSAibnVtYmVyIikgcmV0dXJuIHsKCSAgICAgICAgbmV4dDogZnVuY3Rpb24gKCkgewoJICAgICAgICAgICAgaWYgKG8gJiYgaSA+PSBvLmxlbmd0aCkgbyA9IHZvaWQgMDsKCSAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTsKCSAgICAgICAgfQoJICAgIH07CgkgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihzID8gIk9iamVjdCBpcyBub3QgaXRlcmFibGUuIiA6ICJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIik7Cgl9OwoJT2JqZWN0LmRlZmluZVByb3BlcnR5KEZpbmRlclBhdHRlcm5GaW5kZXIkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJLypuYW1lc3BhY2UgY29tLmdvb2dsZS56eGluZy5xcmNvZGUuZGV0ZWN0b3IgeyovCgl2YXIgRGVjb2RlSGludFR5cGVfMSQyID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBSZXN1bHRQb2ludF8xJDEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIEZpbmRlclBhdHRlcm5fMSA9IEZpbmRlclBhdHRlcm4kMTsKCXZhciBGaW5kZXJQYXR0ZXJuSW5mb18xID0gRmluZGVyUGF0dGVybkluZm8kMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDIgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJLyppbXBvcnQgamF2YS5pby5TZXJpYWxpemFibGU7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5BcnJheUxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5Db2xsZWN0aW9uczsqLwoJLyppbXBvcnQgamF2YS51dGlsLkNvbXBhcmF0b3I7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5MaXN0OyovCgkvKmltcG9ydCBqYXZhLnV0aWwuTWFwOyovCgkvKioKCSAqIDxwPlRoaXMgY2xhc3MgYXR0ZW1wdHMgdG8gZmluZCBmaW5kZXIgcGF0dGVybnMgaW4gYSBRUiBDb2RlLiBGaW5kZXIgcGF0dGVybnMgYXJlIHRoZSBzcXVhcmUKCSAqIG1hcmtlcnMgYXQgdGhyZWUgY29ybmVycyBvZiBhIFFSIENvZGUuPC9wPgoJICoKCSAqIDxwPlRoaXMgY2xhc3MgaXMgdGhyZWFkLXNhZmUgYnV0IG5vdCByZWVudHJhbnQuIEVhY2ggdGhyZWFkIG11c3QgYWxsb2NhdGUgaXRzIG93biBvYmplY3QuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIEZpbmRlclBhdHRlcm5GaW5kZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7CgkgICAgLyoqCgkgICAgICogPHA+Q3JlYXRlcyBhIGZpbmRlciB0aGF0IHdpbGwgc2VhcmNoIHRoZSBpbWFnZSBmb3IgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBpbWFnZSBpbWFnZSB0byBzZWFyY2gKCSAgICAgKi8KCSAgICAvLyBwdWJsaWMgY29uc3RydWN0b3IoaW1hZ2U6IEJpdE1hdHJpeCkgewoJICAgIC8vICAgdGhpcyhpbWFnZSwgbnVsbCkKCSAgICAvLyB9CgkgICAgZnVuY3Rpb24gRmluZGVyUGF0dGVybkZpbmRlcihpbWFnZSwgcmVzdWx0UG9pbnRDYWxsYmFjaykgewoJICAgICAgICB0aGlzLmltYWdlID0gaW1hZ2U7CgkgICAgICAgIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayA9IHJlc3VsdFBvaW50Q2FsbGJhY2s7CgkgICAgICAgIHRoaXMucG9zc2libGVDZW50ZXJzID0gW107CgkgICAgICAgIHRoaXMuY3Jvc3NDaGVja1N0YXRlQ291bnQgPSBuZXcgSW50MzJBcnJheSg1KTsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gcmVzdWx0UG9pbnRDYWxsYmFjazsKCSAgICB9CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmltYWdlOwoJICAgIH07CgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuZ2V0UG9zc2libGVDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5maW5kID0gZnVuY3Rpb24gKGhpbnRzKSB7CgkgICAgICAgIHZhciB0cnlIYXJkZXIgPSAoaGludHMgIT09IG51bGwgJiYgaGludHMgIT09IHVuZGVmaW5lZCkgJiYgdW5kZWZpbmVkICE9PSBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQyLmRlZmF1bHQuVFJZX0hBUkRFUik7CgkgICAgICAgIHZhciBwdXJlQmFyY29kZSA9IChoaW50cyAhPT0gbnVsbCAmJiBoaW50cyAhPT0gdW5kZWZpbmVkKSAmJiB1bmRlZmluZWQgIT09IGhpbnRzLmdldChEZWNvZGVIaW50VHlwZV8xJDIuZGVmYXVsdC5QVVJFX0JBUkNPREUpOwoJICAgICAgICB2YXIgaW1hZ2UgPSB0aGlzLmltYWdlOwoJICAgICAgICB2YXIgbWF4SSA9IGltYWdlLmdldEhlaWdodCgpOwoJICAgICAgICB2YXIgbWF4SiA9IGltYWdlLmdldFdpZHRoKCk7CgkgICAgICAgIC8vIFdlIGFyZSBsb29raW5nIGZvciBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBtb2R1bGVzIGluCgkgICAgICAgIC8vIDE6MTozOjE6MSByYXRpbzsgdGhpcyB0cmFja3MgdGhlIG51bWJlciBvZiBzdWNoIG1vZHVsZXMgc2VlbiBzbyBmYXIKCSAgICAgICAgLy8gTGV0J3MgYXNzdW1lIHRoYXQgdGhlIG1heGltdW0gdmVyc2lvbiBRUiBDb2RlIHdlIHN1cHBvcnQgdGFrZXMgdXAgMS80IHRoZSBoZWlnaHQgb2YgdGhlCgkgICAgICAgIC8vIGltYWdlLCBhbmQgdGhlbiBhY2NvdW50IGZvciB0aGUgY2VudGVyIGJlaW5nIDMgbW9kdWxlcyBpbiBzaXplLiBUaGlzIGdpdmVzIHRoZSBzbWFsbGVzdAoJICAgICAgICAvLyBudW1iZXIgb2YgcGl4ZWxzIHRoZSBjZW50ZXIgY291bGQgYmUsIHNvIHNraXAgdGhpcyBvZnRlbi4gV2hlbiB0cnlpbmcgaGFyZGVyLCBsb29rIGZvciBhbGwKCSAgICAgICAgLy8gUVIgdmVyc2lvbnMgcmVnYXJkbGVzcyBvZiBob3cgZGVuc2UgdGhleSBhcmUuCgkgICAgICAgIHZhciBpU2tpcCA9IE1hdGguZmxvb3IoKDMgKiBtYXhJKSAvICg0ICogRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUykpOwoJICAgICAgICBpZiAoaVNraXAgPCBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQIHx8IHRyeUhhcmRlcikgewoJICAgICAgICAgICAgaVNraXAgPSBGaW5kZXJQYXR0ZXJuRmluZGVyLk1JTl9TS0lQOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkb25lID0gZmFsc2U7CgkgICAgICAgIHZhciBzdGF0ZUNvdW50ID0gbmV3IEludDMyQXJyYXkoNSk7CgkgICAgICAgIGZvciAodmFyIGkgPSBpU2tpcCAtIDE7IGkgPCBtYXhJICYmICFkb25lOyBpICs9IGlTa2lwKSB7CgkgICAgICAgICAgICAvLyBHZXQgYSByb3cgb2YgYmxhY2svd2hpdGUgdmFsdWVzCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMV0gPSAwOwoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IDA7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0gPSAwOwoJICAgICAgICAgICAgdmFyIGN1cnJlbnRTdGF0ZSA9IDA7CgkgICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IG1heEo7IGorKykgewoJICAgICAgICAgICAgICAgIGlmIChpbWFnZS5nZXQoaiwgaSkpIHsKCSAgICAgICAgICAgICAgICAgICAgLy8gQmxhY2sgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMSkgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTdGF0ZSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBlbHNlIHsgLy8gV2hpdGUgcGl4ZWwKCSAgICAgICAgICAgICAgICAgICAgaWYgKChjdXJyZW50U3RhdGUgJiAxKSA9PT0gMCkgeyAvLyBDb3VudGluZyBibGFjayBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50U3RhdGUgPT09IDQpIHsgLy8gQSB3aW5uZXI/CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsgLy8gWWVzCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb25maXJtZWQgPSB0aGlzLmhhbmRsZVBvc3NpYmxlQ2VudGVyKHN0YXRlQ291bnQsIGksIGosIHB1cmVCYXJjb2RlKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RhcnQgZXhhbWluaW5nIGV2ZXJ5IG90aGVyIGxpbmUuIENoZWNraW5nIGVhY2ggbGluZSB0dXJuZWQgb3V0IHRvIGJlIHRvbwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhwZW5zaXZlIGFuZCBkaWRuJ3QgaW1wcm92ZSBwZXJmb3JtYW5jZS4KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlTa2lwID0gMjsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQgPT09IHRydWUpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcm93U2tpcCA9IHRoaXMuZmluZFJvd1NraXAoKTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93U2tpcCA+IHN0YXRlQ291bnRbMl0pIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2tpcCByb3dzIGJldHdlZW4gcm93IG9mIGxvd2VyIGNvbmZpcm1lZCBjZW50ZXIKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRvcCBvZiBwcmVzdW1lZCB0aGlyZCBjb25maXJtZWQgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGJ1dCBiYWNrIHVwIGEgYml0IHRvIGdldCBhIGZ1bGwgY2hhbmNlIG9mIGRldGVjdGluZwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBpdCwgZW50aXJlIHdpZHRoIG9mIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTa2lwIGJ5IHJvd1NraXAsIGJ1dCBiYWNrIG9mZiBieSBzdGF0ZUNvdW50WzJdIChzaXplIG9mIGxhc3QgY2VudGVyCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9mIHBhdHRlcm4gd2Ugc2F3KSB0byBiZSBjb25zZXJ2YXRpdmUsIGFuZCBhbHNvIGJhY2sgb2ZmIGJ5IGlTa2lwIHdoaWNoCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlzIGFib3V0IHRvIGJlIHJlLWFkZGVkCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGkgKz0gcm93U2tpcCAtIHN0YXRlQ291bnRbMl0gLSBpU2tpcDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaiA9IG1heEogLSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IHN0YXRlQ291bnRbM107CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzJdID0gc3RhdGVDb3VudFs0XTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAzOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2xlYXIgc3RhdGUgdG8gc3RhcnQgbG9va2luZyBhZ2FpbgoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50U3RhdGUgPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzBdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsxXSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzNdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFs0XSA9IDA7CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBObywgc2hpZnQgY291bnRzIGJhY2sgYnkgdHdvCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbMF0gPSBzdGF0ZUNvdW50WzJdOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzFdID0gc3RhdGVDb3VudFszXTsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGVDb3VudFsyXSA9IHN0YXRlQ291bnRbNF07CgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPSAxOwoJICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFN0YXRlID0gMzsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZUNvdW50WysrY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIGVsc2UgeyAvLyBDb3VudGluZyB3aGl0ZSBwaXhlbHMKCSAgICAgICAgICAgICAgICAgICAgICAgIHN0YXRlQ291bnRbY3VycmVudFN0YXRlXSsrOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgaWYgKEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3Moc3RhdGVDb3VudCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY29uZmlybWVkID0gdGhpcy5oYW5kbGVQb3NzaWJsZUNlbnRlcihzdGF0ZUNvdW50LCBpLCBtYXhKLCBwdXJlQmFyY29kZSk7CgkgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm1lZCA9PT0gdHJ1ZSkgewoJICAgICAgICAgICAgICAgICAgICBpU2tpcCA9IHN0YXRlQ291bnRbMF07CgkgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhhc1NraXBwZWQpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZvdW5kIGEgdGhpcmQgb25lCgkgICAgICAgICAgICAgICAgICAgICAgICBkb25lID0gdGhpcy5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzKCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBhdHRlcm5JbmZvID0gdGhpcy5zZWxlY3RCZXN0UGF0dGVybnMoKTsKCSAgICAgICAgUmVzdWx0UG9pbnRfMSQxLmRlZmF1bHQub3JkZXJCZXN0UGF0dGVybnMocGF0dGVybkluZm8pOwoJICAgICAgICByZXR1cm4gbmV3IEZpbmRlclBhdHRlcm5JbmZvXzEuZGVmYXVsdChwYXR0ZXJuSW5mbyk7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBHaXZlbiBhIGNvdW50IG9mIGJsYWNrL3doaXRlL2JsYWNrL3doaXRlL2JsYWNrIHBpeGVscyBqdXN0IHNlZW4gYW5kIGFuIGVuZCBwb3NpdGlvbiwKCSAgICAgKiBmaWd1cmVzIHRoZSBsb2NhdGlvbiBvZiB0aGUgY2VudGVyIG9mIHRoaXMgcnVuLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZCA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBlbmQgLyppbnQqLykgewoJICAgICAgICByZXR1cm4gKGVuZCAtIHN0YXRlQ291bnRbNF0gLSBzdGF0ZUNvdW50WzNdKSAtIHN0YXRlQ291bnRbMl0gLyAyLjA7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcGFyYW0gc3RhdGVDb3VudCBjb3VudCBvZiBibGFjay93aGl0ZS9ibGFjay93aGl0ZS9ibGFjayBwaXhlbHMganVzdCByZWFkCgkgICAgICogQHJldHVybiB0cnVlIGlmZiB0aGUgcHJvcG9ydGlvbnMgb2YgdGhlIGNvdW50cyBpcyBjbG9zZSBlbm91Z2ggdG8gdGhlIDEvMS8zLzEvMSByYXRpb3MKCSAgICAgKiAgICAgICAgIHVzZWQgYnkgZmluZGVyIHBhdHRlcm5zIHRvIGJlIGNvbnNpZGVyZWQgYSBtYXRjaAoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuZm91bmRQYXR0ZXJuQ3Jvc3MgPSBmdW5jdGlvbiAoc3RhdGVDb3VudCkgewoJICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMDsKCSAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCA1OyBpKyspIHsKCSAgICAgICAgICAgIHZhciBjb3VudCA9IHN0YXRlQ291bnRbaV07CgkgICAgICAgICAgICBpZiAoY291bnQgPT09IDApIHsKCSAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gY291bnQ7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHRvdGFsTW9kdWxlU2l6ZSA8IDcpIHsKCSAgICAgICAgICAgIHJldHVybiBmYWxzZTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIDcuMDsKCSAgICAgICAgdmFyIG1heFZhcmlhbmNlID0gbW9kdWxlU2l6ZSAvIDIuMDsKCSAgICAgICAgLy8gQWxsb3cgbGVzcyB0aGFuIDUwJSB2YXJpYW5jZSBmcm9tIDEtMS0zLTEtMSBwcm9wb3J0aW9ucwoJICAgICAgICByZXR1cm4gTWF0aC5hYnMobW9kdWxlU2l6ZSAtIHN0YXRlQ291bnRbMF0pIDwgbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzFdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicygzLjAgKiBtb2R1bGVTaXplIC0gc3RhdGVDb3VudFsyXSkgPCAzICogbWF4VmFyaWFuY2UgJiYKCSAgICAgICAgICAgIE1hdGguYWJzKG1vZHVsZVNpemUgLSBzdGF0ZUNvdW50WzNdKSA8IG1heFZhcmlhbmNlICYmCgkgICAgICAgICAgICBNYXRoLmFicyhtb2R1bGVTaXplIC0gc3RhdGVDb3VudFs0XSkgPCBtYXhWYXJpYW5jZTsKCSAgICB9OwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgY3Jvc3NDaGVja1N0YXRlQ291bnQgPSB0aGlzLmNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFswXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzFdID0gMDsKCSAgICAgICAgY3Jvc3NDaGVja1N0YXRlQ291bnRbMl0gPSAwOwoJICAgICAgICBjcm9zc0NoZWNrU3RhdGVDb3VudFszXSA9IDA7CgkgICAgICAgIGNyb3NzQ2hlY2tTdGF0ZUNvdW50WzRdID0gMDsKCSAgICAgICAgcmV0dXJuIGNyb3NzQ2hlY2tTdGF0ZUNvdW50OwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQWZ0ZXIgYSB2ZXJ0aWNhbCBhbmQgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jcm9zcy1jcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gZGlhZ29uYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuCgkgICAgICoKCSAgICAgKiBAcGFyYW0gc3RhcnRJIHJvdyB3aGVyZSBhIGZpbmRlciBwYXR0ZXJuIHdhcyBkZXRlY3RlZAoJICAgICAqIEBwYXJhbSBjZW50ZXJKIGNlbnRlciBvZiB0aGUgc2VjdGlvbiB0aGF0IGFwcGVhcnMgdG8gY3Jvc3MgYSBmaW5kZXIgcGF0dGVybgoJICAgICAqIEBwYXJhbSBtYXhDb3VudCBtYXhpbXVtIHJlYXNvbmFibGUgbnVtYmVyIG9mIG1vZHVsZXMgdGhhdCBzaG91bGQgYmUKCSAgICAgKiAgb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcGFyYW0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgVGhlIG9yaWdpbmFsIHN0YXRlIGNvdW50IHRvdGFsLgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZiBwcm9wb3J0aW9ucyBhcmUgd2l0aGluZyBleHBlY3RlZCBsaW1pdHMKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrRGlhZ29uYWwgPSBmdW5jdGlvbiAoc3RhcnRJIC8qaW50Ki8sIGNlbnRlckogLyppbnQqLywgbWF4Q291bnQgLyppbnQqLywgb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwgLyppbnQqLykgewoJICAgICAgICB2YXIgc3RhdGVDb3VudCA9IHRoaXMuZ2V0Q3Jvc3NDaGVja1N0YXRlQ291bnQoKTsKCSAgICAgICAgLy8gU3RhcnQgY291bnRpbmcgdXAsIGxlZnQgZnJvbSBjZW50ZXIgZmluZGluZyBibGFjayBjZW50ZXIgbWFzcwoJICAgICAgICB2YXIgaSA9IDA7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHdoaWxlIChzdGFydEkgPj0gaSAmJiBjZW50ZXJKID49IGkgJiYgaW1hZ2UuZ2V0KGNlbnRlckogLSBpLCBzdGFydEkgLSBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgPCBpIHx8IGNlbnRlckogPCBpKSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyB3aGl0ZSBzcGFjZQoJICAgICAgICB3aGlsZSAoc3RhcnRJID49IGkgJiYgY2VudGVySiA+PSBpICYmICFpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzFdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgYWxyZWFkeSB0b28gbWFueSBtb2R1bGVzIGluIHRoaXMgc3RhdGUgb3IgcmFuIG9mZiB0aGUgZWRnZToKCSAgICAgICAgaWYgKHN0YXJ0SSA8IGkgfHwgY2VudGVySiA8IGkgfHwgc3RhdGVDb3VudFsxXSA+IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQ29udGludWUgdXAsIGxlZnQgZmluZGluZyBibGFjayBib3JkZXIKCSAgICAgICAgd2hpbGUgKHN0YXJ0SSA+PSBpICYmIGNlbnRlckogPj0gaSAmJiBpbWFnZS5nZXQoY2VudGVySiAtIGksIHN0YXJ0SSAtIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdIDw9IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzBdKys7CgkgICAgICAgICAgICBpKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbMF0gPiBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHZhciBtYXhJID0gaW1hZ2UuZ2V0SGVpZ2h0KCk7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biwgcmlnaHQgZnJvbSBjZW50ZXIKCSAgICAgICAgaSA9IDE7CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgaW1hZ2UuZ2V0KGNlbnRlckogKyBpLCBzdGFydEkgKyBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIC8vIFJhbiBvZmYgdGhlIGVkZ2U/CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChzdGFydEkgKyBpIDwgbWF4SSAmJiBjZW50ZXJKICsgaSA8IG1heEogJiYgIWltYWdlLmdldChjZW50ZXJKICsgaSwgc3RhcnRJICsgaSkgJiYKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGFydEkgKyBpID49IG1heEkgfHwgY2VudGVySiArIGkgPj0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gZmFsc2U7CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKHN0YXJ0SSArIGkgPCBtYXhJICYmIGNlbnRlckogKyBpIDwgbWF4SiAmJiBpbWFnZS5nZXQoY2VudGVySiArIGksIHN0YXJ0SSArIGkpICYmCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIHdlIGZvdW5kIGEgZmluZGVyLXBhdHRlcm4tbGlrZSBzZWN0aW9uLCBidXQgaXRzIHNpemUgaXMgbW9yZSB0aGFuIDEwMCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgcmV0dXJuIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA8IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAmJgoJICAgICAgICAgICAgRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkFmdGVyIGEgaG9yaXpvbnRhbCBzY2FuIGZpbmRzIGEgcG90ZW50aWFsIGZpbmRlciBwYXR0ZXJuLCB0aGlzIG1ldGhvZAoJICAgICAqICJjcm9zcy1jaGVja3MiIGJ5IHNjYW5uaW5nIGRvd24gdmVydGljYWxseSB0aHJvdWdoIHRoZSBjZW50ZXIgb2YgdGhlIHBvc3NpYmxlCgkgICAgICogZmluZGVyIHBhdHRlcm4gdG8gc2VlIGlmIHRoZSBzYW1lIHByb3BvcnRpb24gaXMgZGV0ZWN0ZWQuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXJ0SSByb3cgd2hlcmUgYSBmaW5kZXIgcGF0dGVybiB3YXMgZGV0ZWN0ZWQKCSAgICAgKiBAcGFyYW0gY2VudGVySiBjZW50ZXIgb2YgdGhlIHNlY3Rpb24gdGhhdCBhcHBlYXJzIHRvIGNyb3NzIGEgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gbWF4Q291bnQgbWF4aW11bSByZWFzb25hYmxlIG51bWJlciBvZiBtb2R1bGVzIHRoYXQgc2hvdWxkIGJlCgkgICAgICogb2JzZXJ2ZWQgaW4gYW55IHJlYWRpbmcgc3RhdGUsIGJhc2VkIG9uIHRoZSByZXN1bHRzIG9mIHRoZSBob3Jpem9udGFsIHNjYW4KCSAgICAgKiBAcmV0dXJuIHZlcnRpY2FsIGNlbnRlciBvZiBmaW5kZXIgcGF0dGVybiwgb3Ige0BsaW5rIEZsb2F0I05hTn0gaWYgbm90IGZvdW5kCgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuY3Jvc3NDaGVja1ZlcnRpY2FsID0gZnVuY3Rpb24gKHN0YXJ0SSAvKmludCovLCBjZW50ZXJKIC8qaW50Ki8sIG1heENvdW50IC8qaW50Ki8sIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGltYWdlID0gdGhpcy5pbWFnZTsKCSAgICAgICAgdmFyIG1heEkgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIC8vIFN0YXJ0IGNvdW50aW5nIHVwIGZyb20gY2VudGVyCgkgICAgICAgIHZhciBpID0gc3RhcnRJOwoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaSA+PSAwICYmICFpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIC8vIElmIGFscmVhZHkgdG9vIG1hbnkgbW9kdWxlcyBpbiB0aGlzIHN0YXRlIG9yIHJhbiBvZmYgdGhlIGVkZ2U6CgkgICAgICAgIGlmIChpIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPj0gMCAmJiBpbWFnZS5nZXQoY2VudGVySiwgaSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgaS0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gTm93IGFsc28gY291bnQgZG93biBmcm9tIGNlbnRlcgoJICAgICAgICBpID0gc3RhcnRJICsgMTsKCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJKSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChpIDwgbWF4SSAmJiAhaW1hZ2UuZ2V0KGNlbnRlckosIGkpICYmIHN0YXRlQ291bnRbM10gPCBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFszXSsrOwoJICAgICAgICAgICAgaSsrOwoJICAgICAgICB9CgkgICAgICAgIGlmIChpID09PSBtYXhJIHx8IHN0YXRlQ291bnRbM10gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGkgPCBtYXhJICYmIGltYWdlLmdldChjZW50ZXJKLCBpKSAmJiBzdGF0ZUNvdW50WzRdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF0rKzsKCSAgICAgICAgICAgIGkrKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoc3RhdGVDb3VudFs0XSA+PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB3ZSBmb3VuZCBhIGZpbmRlci1wYXR0ZXJuLWxpa2Ugc2VjdGlvbiwgYnV0IGl0cyBzaXplIGlzIG1vcmUgdGhhbiA0MCUgZGlmZmVyZW50IHRoYW4KCSAgICAgICAgLy8gdGhlIG9yaWdpbmFsLCBhc3N1bWUgaXQncyBhIGZhbHNlIHBvc2l0aXZlCgkgICAgICAgIHZhciBzdGF0ZUNvdW50VG90YWwgPSBzdGF0ZUNvdW50WzBdICsgc3RhdGVDb3VudFsxXSArIHN0YXRlQ291bnRbMl0gKyBzdGF0ZUNvdW50WzNdICsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbNF07CgkgICAgICAgIGlmICg1ICogTWF0aC5hYnMoc3RhdGVDb3VudFRvdGFsIC0gb3JpZ2luYWxTdGF0ZUNvdW50VG90YWwpID49IDIgKiBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBpKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkxpa2Uge0BsaW5rICNjcm9zc0NoZWNrVmVydGljYWwoaW50LCBpbnQsIGludCwgaW50KX0sIGFuZCBpbiBmYWN0IGlzIGJhc2ljYWxseSBpZGVudGljYWwsCgkgICAgICogZXhjZXB0IGl0IHJlYWRzIGhvcml6b250YWxseSBpbnN0ZWFkIG9mIHZlcnRpY2FsbHkuIFRoaXMgaXMgdXNlZCB0byBjcm9zcy1jcm9zcwoJICAgICAqIGNoZWNrIGEgdmVydGljYWwgY3Jvc3MgY2hlY2sgYW5kIGxvY2F0ZSB0aGUgcmVhbCBjZW50ZXIgb2YgdGhlIGFsaWdubWVudCBwYXR0ZXJuLjwvcD4KCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5jcm9zc0NoZWNrSG9yaXpvbnRhbCA9IGZ1bmN0aW9uIChzdGFydEogLyppbnQqLywgY2VudGVySSAvKmludCovLCBtYXhDb3VudCAvKmludCovLCBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCAvKmludCovKSB7CgkgICAgICAgIHZhciBpbWFnZSA9IHRoaXMuaW1hZ2U7CgkgICAgICAgIHZhciBtYXhKID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHN0YXRlQ291bnQgPSB0aGlzLmdldENyb3NzQ2hlY2tTdGF0ZUNvdW50KCk7CgkgICAgICAgIHZhciBqID0gc3RhcnRKOwoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmIGltYWdlLmdldChqLCBjZW50ZXJJKSkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsyXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA+PSAwICYmICFpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFsxXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFsxXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChqIDwgMCB8fCBzdGF0ZUNvdW50WzFdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgd2hpbGUgKGogPj0gMCAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFswXSA8PSBtYXhDb3VudCkgewoJICAgICAgICAgICAgc3RhdGVDb3VudFswXSsrOwoJICAgICAgICAgICAgai0tOwoJICAgICAgICB9CgkgICAgICAgIGlmIChzdGF0ZUNvdW50WzBdID4gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgaiA9IHN0YXJ0SiArIDE7CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbMl0rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SikgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICB3aGlsZSAoaiA8IG1heEogJiYgIWltYWdlLmdldChqLCBjZW50ZXJJKSAmJiBzdGF0ZUNvdW50WzNdIDwgbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHN0YXRlQ291bnRbM10rKzsKCSAgICAgICAgICAgIGorKzsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaiA9PT0gbWF4SiB8fCBzdGF0ZUNvdW50WzNdID49IG1heENvdW50KSB7CgkgICAgICAgICAgICByZXR1cm4gTmFOOwoJICAgICAgICB9CgkgICAgICAgIHdoaWxlIChqIDwgbWF4SiAmJiBpbWFnZS5nZXQoaiwgY2VudGVySSkgJiYgc3RhdGVDb3VudFs0XSA8IG1heENvdW50KSB7CgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdKys7CgkgICAgICAgICAgICBqKys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHN0YXRlQ291bnRbNF0gPj0gbWF4Q291bnQpIHsKCSAgICAgICAgICAgIHJldHVybiBOYU47CgkgICAgICAgIH0KCSAgICAgICAgLy8gSWYgd2UgZm91bmQgYSBmaW5kZXItcGF0dGVybi1saWtlIHNlY3Rpb24sIGJ1dCBpdHMgc2l6ZSBpcyBzaWduaWZpY2FudGx5IGRpZmZlcmVudCB0aGFuCgkgICAgICAgIC8vIHRoZSBvcmlnaW5hbCwgYXNzdW1lIGl0J3MgYSBmYWxzZSBwb3NpdGl2ZQoJICAgICAgICB2YXIgc3RhdGVDb3VudFRvdGFsID0gc3RhdGVDb3VudFswXSArIHN0YXRlQ291bnRbMV0gKyBzdGF0ZUNvdW50WzJdICsgc3RhdGVDb3VudFszXSArCgkgICAgICAgICAgICBzdGF0ZUNvdW50WzRdOwoJICAgICAgICBpZiAoNSAqIE1hdGguYWJzKHN0YXRlQ291bnRUb3RhbCAtIG9yaWdpbmFsU3RhdGVDb3VudFRvdGFsKSA+PSBvcmlnaW5hbFN0YXRlQ291bnRUb3RhbCkgewoJICAgICAgICAgICAgcmV0dXJuIE5hTjsKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gRmluZGVyUGF0dGVybkZpbmRlci5mb3VuZFBhdHRlcm5Dcm9zcyhzdGF0ZUNvdW50KSA/IEZpbmRlclBhdHRlcm5GaW5kZXIuY2VudGVyRnJvbUVuZChzdGF0ZUNvdW50LCBqKSA6IE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgaXMgY2FsbGVkIHdoZW4gYSBob3Jpem9udGFsIHNjYW4gZmluZHMgYSBwb3NzaWJsZSBhbGlnbm1lbnQgcGF0dGVybi4gSXQgd2lsbAoJICAgICAqIGNyb3NzIGNoZWNrIHdpdGggYSB2ZXJ0aWNhbCBzY2FuLCBhbmQgaWYgc3VjY2Vzc2Z1bCwgd2lsbCwgYWgsIGNyb3NzLWNyb3NzLWNoZWNrCgkgICAgICogd2l0aCBhbm90aGVyIGhvcml6b250YWwgc2Nhbi4gVGhpcyBpcyBuZWVkZWQgcHJpbWFyaWx5IHRvIGxvY2F0ZSB0aGUgcmVhbCBob3Jpem9udGFsCgkgICAgICogY2VudGVyIG9mIHRoZSBwYXR0ZXJuIGluIGNhc2VzIG9mIGV4dHJlbWUgc2tldy4KCSAgICAgKiBBbmQgdGhlbiB3ZSBjcm9zcy1jcm9zcy1jcm9zcyBjaGVjayB3aXRoIGFub3RoZXIgZGlhZ29uYWwgc2Nhbi48L3A+CgkgICAgICoKCSAgICAgKiA8cD5JZiB0aGF0IHN1Y2NlZWRzIHRoZSBmaW5kZXIgcGF0dGVybiBsb2NhdGlvbiBpcyBhZGRlZCB0byBhIGxpc3QgdGhhdCB0cmFja3MKCSAgICAgKiB0aGUgbnVtYmVyIG9mIHRpbWVzIGVhY2ggbG9jYXRpb24gaGFzIGJlZW4gbmVhcmx5LW1hdGNoZWQgYXMgYSBmaW5kZXIgcGF0dGVybi4KCSAgICAgKiBFYWNoIGFkZGl0aW9uYWwgZmluZCBpcyBtb3JlIGV2aWRlbmNlIHRoYXQgdGhlIGxvY2F0aW9uIGlzIGluIGZhY3QgYSBmaW5kZXIKCSAgICAgKiBwYXR0ZXJuIGNlbnRlcgoJICAgICAqCgkgICAgICogQHBhcmFtIHN0YXRlQ291bnQgcmVhZGluZyBzdGF0ZSBtb2R1bGUgY291bnRzIGZyb20gaG9yaXpvbnRhbCBzY2FuCgkgICAgICogQHBhcmFtIGkgcm93IHdoZXJlIGZpbmRlciBwYXR0ZXJuIG1heSBiZSBmb3VuZAoJICAgICAqIEBwYXJhbSBqIGVuZCBvZiBwb3NzaWJsZSBmaW5kZXIgcGF0dGVybiBpbiByb3cKCSAgICAgKiBAcGFyYW0gcHVyZUJhcmNvZGUgdHJ1ZSBpZiBpbiAicHVyZSBiYXJjb2RlIiBtb2RlCgkgICAgICogQHJldHVybiB0cnVlIGlmIGEgZmluZGVyIHBhdHRlcm4gY2FuZGlkYXRlIHdhcyBmb3VuZCB0aGlzIHRpbWUKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYW5kbGVQb3NzaWJsZUNlbnRlciA9IGZ1bmN0aW9uIChzdGF0ZUNvdW50LCBpIC8qaW50Ki8sIGogLyppbnQqLywgcHVyZUJhcmNvZGUpIHsKCSAgICAgICAgdmFyIHN0YXRlQ291bnRUb3RhbCA9IHN0YXRlQ291bnRbMF0gKyBzdGF0ZUNvdW50WzFdICsgc3RhdGVDb3VudFsyXSArIHN0YXRlQ291bnRbM10gKwoJICAgICAgICAgICAgc3RhdGVDb3VudFs0XTsKCSAgICAgICAgdmFyIGNlbnRlckogPSBGaW5kZXJQYXR0ZXJuRmluZGVyLmNlbnRlckZyb21FbmQoc3RhdGVDb3VudCwgaik7CgkgICAgICAgIHZhciBjZW50ZXJJID0gdGhpcy5jcm9zc0NoZWNrVmVydGljYWwoaSwgLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCBzdGF0ZUNvdW50WzJdLCBzdGF0ZUNvdW50VG90YWwpOwoJICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckkpKSB7CgkgICAgICAgICAgICAvLyBSZS1jcm9zcyBjaGVjawoJICAgICAgICAgICAgY2VudGVySiA9IHRoaXMuY3Jvc3NDaGVja0hvcml6b250YWwoLyooaW50KSAqLyBNYXRoLmZsb29yKGNlbnRlckopLCAvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIHN0YXRlQ291bnRbMl0sIHN0YXRlQ291bnRUb3RhbCk7CgkgICAgICAgICAgICBpZiAoIWlzTmFOKGNlbnRlckopICYmCgkgICAgICAgICAgICAgICAgKCFwdXJlQmFyY29kZSB8fCB0aGlzLmNyb3NzQ2hlY2tEaWFnb25hbCgvKihpbnQpICovIE1hdGguZmxvb3IoY2VudGVySSksIC8qKGludCkgKi8gTWF0aC5mbG9vcihjZW50ZXJKKSwgc3RhdGVDb3VudFsyXSwgc3RhdGVDb3VudFRvdGFsKSkpIHsKCSAgICAgICAgICAgICAgICB2YXIgZXN0aW1hdGVkTW9kdWxlU2l6ZSA9IHN0YXRlQ291bnRUb3RhbCAvIDcuMDsKCSAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTsKCSAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXJzID0gdGhpcy5wb3NzaWJsZUNlbnRlcnM7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwLCBsZW5ndGhfMSA9IHBvc3NpYmxlQ2VudGVycy5sZW5ndGg7IGluZGV4IDwgbGVuZ3RoXzE7IGluZGV4KyspIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IHBvc3NpYmxlQ2VudGVyc1tpbmRleF07CgkgICAgICAgICAgICAgICAgICAgIC8vIExvb2sgZm9yIGFib3V0IHRoZSBzYW1lIGNlbnRlciBhbmQgbW9kdWxlIHNpemU6CgkgICAgICAgICAgICAgICAgICAgIGlmIChjZW50ZXIuYWJvdXRFcXVhbHMoZXN0aW1hdGVkTW9kdWxlU2l6ZSwgY2VudGVySSwgY2VudGVySikpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVyc1tpbmRleF0gPSBjZW50ZXIuY29tYmluZUVzdGltYXRlKGNlbnRlckksIGNlbnRlckosIGVzdGltYXRlZE1vZHVsZVNpemUpOwoJICAgICAgICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwoJICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgaWYgKCFmb3VuZCkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBuZXcgRmluZGVyUGF0dGVybl8xLmRlZmF1bHQoY2VudGVySiwgY2VudGVySSwgZXN0aW1hdGVkTW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5wdXNoKHBvaW50KTsKCSAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayAhPT0gbnVsbCAmJiB0aGlzLnJlc3VsdFBvaW50Q2FsbGJhY2sgIT09IHVuZGVmaW5lZCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrLmZvdW5kUG9zc2libGVSZXN1bHRQb2ludChwb2ludCk7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogQHJldHVybiBudW1iZXIgb2Ygcm93cyB3ZSBjb3VsZCBzYWZlbHkgc2tpcCBkdXJpbmcgc2Nhbm5pbmcsIGJhc2VkIG9uIHRoZSBmaXJzdAoJICAgICAqICAgICAgICAgdHdvIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBsb2NhdGVkLiBJbiBzb21lIGNhc2VzIHRoZWlyIHBvc2l0aW9uIHdpbGwKCSAgICAgKiAgICAgICAgIGFsbG93IHVzIHRvIGluZmVyIHRoYXQgdGhlIHRoaXJkIHBhdHRlcm4gbXVzdCBsaWUgYmVsb3cgYSBjZXJ0YWluIHBvaW50IGZhcnRoZXIKCSAgICAgKiAgICAgICAgIGRvd24gaW4gdGhlIGltYWdlLgoJICAgICAqLwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIucHJvdG90eXBlLmZpbmRSb3dTa2lwID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8xLCBfYTsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKG1heCA8PSAxKSB7CgkgICAgICAgICAgICByZXR1cm4gMDsKCSAgICAgICAgfQoJICAgICAgICB2YXIgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBudWxsOwoJICAgICAgICB0cnkgewoJICAgICAgICAgICAgZm9yICh2YXIgX2IgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9jID0gX2IubmV4dCgpOyAhX2MuZG9uZTsgX2MgPSBfYi5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICB2YXIgY2VudGVyID0gX2MudmFsdWU7CgkgICAgICAgICAgICAgICAgaWYgKGNlbnRlci5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBpZiAoZmlyc3RDb25maXJtZWRDZW50ZXIgPT0gbnVsbCkgewoJICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3RDb25maXJtZWRDZW50ZXIgPSBjZW50ZXI7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBoYXZlIHR3byBjb25maXJtZWQgY2VudGVycwoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93IGZhciBkb3duIGNhbiB3ZSBza2lwIGJlZm9yZSByZXN1bWluZyBsb29raW5nIGZvciB0aGUgbmV4dAoJICAgICAgICAgICAgICAgICAgICAgICAgLy8gcGF0dGVybj8gSW4gdGhlIHdvcnN0IGNhc2UsIG9ubHkgdGhlIGRpZmZlcmVuY2UgYmV0d2VlbiB0aGUKCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpZmZlcmVuY2UgaW4gdGhlIHggLyB5IGNvb3JkaW5hdGVzIG9mIHRoZSB0d28gY2VudGVycy4KCSAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgdGhlIGNhc2Ugd2hlcmUgeW91IGZpbmQgdG9wIGxlZnQgbGFzdC4KCSAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzU2tpcHBlZCA9IHRydWU7CgkgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gLyooaW50KSAqLyBNYXRoLmZsb29yKChNYXRoLmFicyhmaXJzdENvbmZpcm1lZENlbnRlci5nZXRYKCkgLSBjZW50ZXIuZ2V0WCgpKSAtCgkgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWF0aC5hYnMoZmlyc3RDb25maXJtZWRDZW50ZXIuZ2V0WSgpIC0gY2VudGVyLmdldFkoKSkpIC8gMik7CgkgICAgICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgY2F0Y2ggKGVfMV8xKSB7IGVfMSA9IHsgZXJyb3I6IGVfMV8xIH07IH0KCSAgICAgICAgZmluYWxseSB7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGlmIChfYyAmJiAhX2MuZG9uZSAmJiAoX2EgPSBfYi5yZXR1cm4pKSBfYS5jYWxsKF9iKTsKCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGZpbmFsbHkgeyBpZiAoZV8xKSB0aHJvdyBlXzEuZXJyb3I7IH0KCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIEByZXR1cm4gdHJ1ZSBpZmYgd2UgaGF2ZSBmb3VuZCBhdCBsZWFzdCAzIGZpbmRlciBwYXR0ZXJucyB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZAoJICAgICAqICAgICAgICAgYXQgbGVhc3Qge0BsaW5rICNDRU5URVJfUVVPUlVNfSB0aW1lcyBlYWNoLCBhbmQsIHRoZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgb2YgdGhlCgkgICAgICogICAgICAgICBjYW5kaWRhdGVzIGlzICJwcmV0dHkgc2ltaWxhciIKCSAgICAgKi8KCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLnByb3RvdHlwZS5oYXZlTXVsdGlwbHlDb25maXJtZWRDZW50ZXJzID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV8yLCBfYSwgZV8zLCBfYjsKCSAgICAgICAgdmFyIGNvbmZpcm1lZENvdW50ID0gMDsKCSAgICAgICAgdmFyIHRvdGFsTW9kdWxlU2l6ZSA9IDAuMDsKCSAgICAgICAgdmFyIG1heCA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9jID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZCA9IF9jLm5leHQoKTsgIV9kLmRvbmU7IF9kID0gX2MubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZC52YWx1ZTsKCSAgICAgICAgICAgICAgICBpZiAocGF0dGVybi5nZXRDb3VudCgpID49IEZpbmRlclBhdHRlcm5GaW5kZXIuQ0VOVEVSX1FVT1JVTSkgewoJICAgICAgICAgICAgICAgICAgICBjb25maXJtZWRDb3VudCsrOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcGF0dGVybi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzJfMSkgeyBlXzIgPSB7IGVycm9yOiBlXzJfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2QgJiYgIV9kLmRvbmUgJiYgKF9hID0gX2MucmV0dXJuKSkgX2EuY2FsbChfYyk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMikgdGhyb3cgZV8yLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGNvbmZpcm1lZENvdW50IDwgMykgewoJICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwoJICAgICAgICB9CgkgICAgICAgIC8vIE9LLCB3ZSBoYXZlIGF0IGxlYXN0IDMgY29uZmlybWVkIGNlbnRlcnMsIGJ1dCwgaXQncyBwb3NzaWJsZSB0aGF0IG9uZSBpcyBhICJmYWxzZSBwb3NpdGl2ZSIKCSAgICAgICAgLy8gYW5kIHRoYXQgd2UgbmVlZCB0byBrZWVwIGxvb2tpbmcuIFdlIGRldGVjdCB0aGlzIGJ5IGFza2luZyBpZiB0aGUgZXN0aW1hdGVkIG1vZHVsZSBzaXplcwoJICAgICAgICAvLyB2YXJ5IHRvbyBtdWNoLiBXZSBhcmJpdHJhcmlseSBzYXkgdGhhdCB3aGVuIHRoZSB0b3RhbCBkZXZpYXRpb24gZnJvbSBhdmVyYWdlIGV4Y2VlZHMKCSAgICAgICAgLy8gNSUgb2YgdGhlIHRvdGFsIG1vZHVsZSBzaXplIGVzdGltYXRlcywgaXQncyB0b28gbXVjaC4KCSAgICAgICAgdmFyIGF2ZXJhZ2UgPSB0b3RhbE1vZHVsZVNpemUgLyBtYXg7CgkgICAgICAgIHZhciB0b3RhbERldmlhdGlvbiA9IDAuMDsKCSAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgIGZvciAodmFyIF9lID0gX192YWx1ZXModGhpcy5wb3NzaWJsZUNlbnRlcnMpLCBfZiA9IF9lLm5leHQoKTsgIV9mLmRvbmU7IF9mID0gX2UubmV4dCgpKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBfZi52YWx1ZTsKCSAgICAgICAgICAgICAgICB0b3RhbERldmlhdGlvbiArPSBNYXRoLmFicyhwYXR0ZXJuLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGNhdGNoIChlXzNfMSkgeyBlXzMgPSB7IGVycm9yOiBlXzNfMSB9OyB9CgkgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgdHJ5IHsKCSAgICAgICAgICAgICAgICBpZiAoX2YgJiYgIV9mLmRvbmUgJiYgKF9iID0gX2UucmV0dXJuKSkgX2IuY2FsbChfZSk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfMykgdGhyb3cgZV8zLmVycm9yOyB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHRvdGFsRGV2aWF0aW9uIDw9IDAuMDUgKiB0b3RhbE1vZHVsZVNpemU7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBAcmV0dXJuIHRoZSAzIGJlc3Qge0BsaW5rIEZpbmRlclBhdHRlcm59cyBmcm9tIG91ciBsaXN0IG9mIGNhbmRpZGF0ZXMuIFRoZSAiYmVzdCIgYXJlCgkgICAgICogICAgICAgICB0aG9zZSB0aGF0IGhhdmUgYmVlbiBkZXRlY3RlZCBhdCBsZWFzdCB7QGxpbmsgI0NFTlRFUl9RVU9SVU19IHRpbWVzLCBhbmQgd2hvc2UgbW9kdWxlCgkgICAgICogICAgICAgICBzaXplIGRpZmZlcnMgZnJvbSB0aGUgYXZlcmFnZSBhbW9uZyB0aG9zZSBwYXR0ZXJucyB0aGUgbGVhc3QKCSAgICAgKiBAdGhyb3dzIE5vdEZvdW5kRXhjZXB0aW9uIGlmIDMgc3VjaCBmaW5kZXIgcGF0dGVybnMgZG8gbm90IGV4aXN0CgkgICAgICovCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5wcm90b3R5cGUuc2VsZWN0QmVzdFBhdHRlcm5zID0gZnVuY3Rpb24gKCkgewoJICAgICAgICB2YXIgZV80LCBfYSwgZV81LCBfYjsKCSAgICAgICAgdmFyIHN0YXJ0U2l6ZSA9IHRoaXMucG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgaWYgKHN0YXJ0U2l6ZSA8IDMpIHsKCSAgICAgICAgICAgIC8vIENvdWxkbid0IGZpbmQgZW5vdWdoIGZpbmRlciBwYXR0ZXJucwoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMi5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIHBvc3NpYmxlQ2VudGVycyA9IHRoaXMucG9zc2libGVDZW50ZXJzOwoJICAgICAgICB2YXIgYXZlcmFnZTsKCSAgICAgICAgLy8gRmlsdGVyIG91dGxpZXIgcG9zc2liaWxpdGllcyB3aG9zZSBtb2R1bGUgc2l6ZSBpcyB0b28gZGlmZmVyZW50CgkgICAgICAgIGlmIChzdGFydFNpemUgPiAzKSB7CgkgICAgICAgICAgICAvLyBCdXQgd2UgY2FuIG9ubHkgYWZmb3JkIHRvIGRvIHNvIGlmIHdlIGhhdmUgYXQgbGVhc3QgNCBwb3NzaWJpbGl0aWVzIHRvIGNob29zZSBmcm9tCgkgICAgICAgICAgICB2YXIgdG90YWxNb2R1bGVTaXplID0gMC4wOwoJICAgICAgICAgICAgdmFyIHNxdWFyZSA9IDAuMDsKCSAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgZm9yICh2YXIgX2MgPSBfX3ZhbHVlcyh0aGlzLnBvc3NpYmxlQ2VudGVycyksIF9kID0gX2MubmV4dCgpOyAhX2QuZG9uZTsgX2QgPSBfYy5uZXh0KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGNlbnRlciA9IF9kLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB2YXIgc2l6ZSA9IGNlbnRlci5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCk7CgkgICAgICAgICAgICAgICAgICAgIHRvdGFsTW9kdWxlU2l6ZSArPSBzaXplOwoJICAgICAgICAgICAgICAgICAgICBzcXVhcmUgKz0gc2l6ZSAqIHNpemU7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgY2F0Y2ggKGVfNF8xKSB7IGVfNCA9IHsgZXJyb3I6IGVfNF8xIH07IH0KCSAgICAgICAgICAgIGZpbmFsbHkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGlmIChfZCAmJiAhX2QuZG9uZSAmJiAoX2EgPSBfYy5yZXR1cm4pKSBfYS5jYWxsKF9jKTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZmluYWxseSB7IGlmIChlXzQpIHRocm93IGVfNC5lcnJvcjsgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgYXZlcmFnZSA9IHRvdGFsTW9kdWxlU2l6ZSAvIHN0YXJ0U2l6ZTsKCSAgICAgICAgICAgIHZhciBzdGREZXYgPSBNYXRoLnNxcnQoc3F1YXJlIC8gc3RhcnRTaXplIC0gYXZlcmFnZSAqIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzLnNvcnQoCgkgICAgICAgICAgICAvKioKCSAgICAgICAgICAgICAqIDxwPk9yZGVycyBieSBmdXJ0aGVzdCBmcm9tIGF2ZXJhZ2U8L3A+CgkgICAgICAgICAgICAgKi8KCSAgICAgICAgICAgIC8vIEZ1cnRoZXN0RnJvbUF2ZXJhZ2VDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICB2YXIgZEEgPSBNYXRoLmFicyhjZW50ZXIyLmdldEVzdGltYXRlZE1vZHVsZVNpemUoKSAtIGF2ZXJhZ2UpOwoJICAgICAgICAgICAgICAgIHZhciBkQiA9IE1hdGguYWJzKGNlbnRlcjEuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSk7CgkgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAtMSA6IGRBID4gZEIgPyAxIDogMDsKCSAgICAgICAgICAgIH0pOwoJICAgICAgICAgICAgdmFyIGxpbWl0ID0gTWF0aC5tYXgoMC4yICogYXZlcmFnZSwgc3RkRGV2KTsKCSAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcG9zc2libGVDZW50ZXJzLmxlbmd0aCAmJiBwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMzsgaSsrKSB7CgkgICAgICAgICAgICAgICAgdmFyIHBhdHRlcm4gPSBwb3NzaWJsZUNlbnRlcnNbaV07CgkgICAgICAgICAgICAgICAgaWYgKE1hdGguYWJzKHBhdHRlcm4uZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpIC0gYXZlcmFnZSkgPiBsaW1pdCkgewoJICAgICAgICAgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKGksIDEpOwoJICAgICAgICAgICAgICAgICAgICBpLS07CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICB9CgkgICAgICAgIGlmIChwb3NzaWJsZUNlbnRlcnMubGVuZ3RoID4gMykgewoJICAgICAgICAgICAgLy8gVGhyb3cgYXdheSBhbGwgYnV0IHRob3NlIGZpcnN0IHNpemUgY2FuZGlkYXRlIHBvaW50cyB3ZSBmb3VuZC4KCSAgICAgICAgICAgIHZhciB0b3RhbE1vZHVsZVNpemUgPSAwLjA7CgkgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgIGZvciAodmFyIHBvc3NpYmxlQ2VudGVyc18xID0gX192YWx1ZXMocG9zc2libGVDZW50ZXJzKSwgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKTsgIXBvc3NpYmxlQ2VudGVyc18xXzEuZG9uZTsgcG9zc2libGVDZW50ZXJzXzFfMSA9IHBvc3NpYmxlQ2VudGVyc18xLm5leHQoKSkgewoJICAgICAgICAgICAgICAgICAgICB2YXIgcG9zc2libGVDZW50ZXIgPSBwb3NzaWJsZUNlbnRlcnNfMV8xLnZhbHVlOwoJICAgICAgICAgICAgICAgICAgICB0b3RhbE1vZHVsZVNpemUgKz0gcG9zc2libGVDZW50ZXIuZ2V0RXN0aW1hdGVkTW9kdWxlU2l6ZSgpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgIH0KCSAgICAgICAgICAgIGNhdGNoIChlXzVfMSkgeyBlXzUgPSB7IGVycm9yOiBlXzVfMSB9OyB9CgkgICAgICAgICAgICBmaW5hbGx5IHsKCSAgICAgICAgICAgICAgICB0cnkgewoJICAgICAgICAgICAgICAgICAgICBpZiAocG9zc2libGVDZW50ZXJzXzFfMSAmJiAhcG9zc2libGVDZW50ZXJzXzFfMS5kb25lICYmIChfYiA9IHBvc3NpYmxlQ2VudGVyc18xLnJldHVybikpIF9iLmNhbGwocG9zc2libGVDZW50ZXJzXzEpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBmaW5hbGx5IHsgaWYgKGVfNSkgdGhyb3cgZV81LmVycm9yOyB9CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBhdmVyYWdlID0gdG90YWxNb2R1bGVTaXplIC8gcG9zc2libGVDZW50ZXJzLmxlbmd0aDsKCSAgICAgICAgICAgIHBvc3NpYmxlQ2VudGVycy5zb3J0KAoJICAgICAgICAgICAgLyoqCgkgICAgICAgICAgICAgKiA8cD5PcmRlcnMgYnkge0BsaW5rIEZpbmRlclBhdHRlcm4jZ2V0Q291bnQoKX0sIGRlc2NlbmRpbmcuPC9wPgoJICAgICAgICAgICAgICovCgkgICAgICAgICAgICAvLyBDZW50ZXJDb21wYXJhdG9yIGltcGxlbWVudHMgQ29tcGFyYXRvcjxGaW5kZXJQYXR0ZXJuPgoJICAgICAgICAgICAgZnVuY3Rpb24gKGNlbnRlcjEsIGNlbnRlcjIpIHsKCSAgICAgICAgICAgICAgICBpZiAoY2VudGVyMi5nZXRDb3VudCgpID09PSBjZW50ZXIxLmdldENvdW50KCkpIHsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRBID0gTWF0aC5hYnMoY2VudGVyMi5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgdmFyIGRCID0gTWF0aC5hYnMoY2VudGVyMS5nZXRFc3RpbWF0ZWRNb2R1bGVTaXplKCkgLSBhdmVyYWdlKTsKCSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRBIDwgZEIgPyAxIDogZEEgPiBkQiA/IC0xIDogMDsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAgICAgICAgIHJldHVybiBjZW50ZXIyLmdldENvdW50KCkgLSBjZW50ZXIxLmdldENvdW50KCk7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfSk7CgkgICAgICAgICAgICBwb3NzaWJsZUNlbnRlcnMuc3BsaWNlKDMpOyAvLyB0aGlzIGlzIG5vdCByZWFseSBuZWNlc3NhcnkgYXMgd2Ugb25seSByZXR1cm4gZmlyc3QgMyBhbnl3YXkKCSAgICAgICAgfQoJICAgICAgICByZXR1cm4gWwoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzBdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzFdLAoJICAgICAgICAgICAgcG9zc2libGVDZW50ZXJzWzJdCgkgICAgICAgIF07CgkgICAgfTsKCSAgICBGaW5kZXJQYXR0ZXJuRmluZGVyLkNFTlRFUl9RVU9SVU0gPSAyOwoJICAgIEZpbmRlclBhdHRlcm5GaW5kZXIuTUlOX1NLSVAgPSAzOyAvLyAxIHBpeGVsL21vZHVsZSB0aW1lcyAzIG1vZHVsZXMvY2VudGVyCgkgICAgRmluZGVyUGF0dGVybkZpbmRlci5NQVhfTU9EVUxFUyA9IDU3OyAvLyBzdXBwb3J0IHVwIHRvIHZlcnNpb24gMTAgZm9yIG1vYmlsZSBjbGllbnRzCgkgICAgcmV0dXJuIEZpbmRlclBhdHRlcm5GaW5kZXI7Cgl9KCkpOwoJRmluZGVyUGF0dGVybkZpbmRlciQxLmRlZmF1bHQgPSBGaW5kZXJQYXR0ZXJuRmluZGVyOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoRGV0ZWN0b3IkMSwgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwoJdmFyIE1hdGhVdGlsc18xID0gTWF0aFV0aWxzJDE7Cgl2YXIgRGV0ZWN0b3JSZXN1bHRfMSA9IERldGVjdG9yUmVzdWx0JDE7CgkvLyBpbXBvcnQgR3JpZFNhbXBsZXIgZnJvbSAnLi4vLi4vY29tbW9uL0dyaWRTYW1wbGVyJzsKCXZhciBHcmlkU2FtcGxlckluc3RhbmNlXzEgPSBHcmlkU2FtcGxlckluc3RhbmNlJDE7Cgl2YXIgUGVyc3BlY3RpdmVUcmFuc2Zvcm1fMSA9IFBlcnNwZWN0aXZlVHJhbnNmb3JtJDE7Cgl2YXIgRGVjb2RlSGludFR5cGVfMSQxID0gRGVjb2RlSGludFR5cGUkMTsKCXZhciBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdFBvaW50XzEgPSBSZXN1bHRQb2ludCQxOwoJdmFyIFZlcnNpb25fMSA9IFZlcnNpb24kMTsKCXZhciBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyXzEgPSBBbGlnbm1lbnRQYXR0ZXJuRmluZGVyJDE7Cgl2YXIgRmluZGVyUGF0dGVybkZpbmRlcl8xID0gRmluZGVyUGF0dGVybkZpbmRlciQxOwoJLyppbXBvcnQgamF2YS51dGlsLk1hcDsqLwoJLyoqCgkgKiA8cD5FbmNhcHN1bGF0ZXMgbG9naWMgdGhhdCBjYW4gZGV0ZWN0IGEgUVIgQ29kZSBpbiBhbiBpbWFnZSwgZXZlbiBpZiB0aGUgUVIgQ29kZQoJICogaXMgcm90YXRlZCBvciBza2V3ZWQsIG9yIHBhcnRpYWxseSBvYnNjdXJlZC48L3A+CgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIERldGVjdG9yID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKCkgewoJICAgIGZ1bmN0aW9uIERldGVjdG9yKGltYWdlKSB7CgkgICAgICAgIHRoaXMuaW1hZ2UgPSBpbWFnZTsKCSAgICB9CgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLmdldEltYWdlID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5pbWFnZTsKCSAgICB9OwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5nZXRSZXN1bHRQb2ludENhbGxiYWNrID0gZnVuY3Rpb24gKCkgewoJICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIC8vIHB1YmxpYyBkZXRlY3QoKTogRGV0ZWN0b3JSZXN1bHQgLyp0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiovIHsKCSAgICAvLyAgIHJldHVybiBkZXRlY3QobnVsbCkKCSAgICAvLyB9CgkgICAgLyoqCgkgICAgICogPHA+RGV0ZWN0cyBhIFFSIENvZGUgaW4gYW4gaW1hZ2UuPC9wPgoJICAgICAqCgkgICAgICogQHBhcmFtIGhpbnRzIG9wdGlvbmFsIGhpbnRzIHRvIGRldGVjdG9yCgkgICAgICogQHJldHVybiB7QGxpbmsgRGV0ZWN0b3JSZXN1bHR9IGVuY2Fwc3VsYXRpbmcgcmVzdWx0cyBvZiBkZXRlY3RpbmcgYSBRUiBDb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBRUiBDb2RlIGNhbm5vdCBiZSBmb3VuZAoJICAgICAqIEB0aHJvd3MgRm9ybWF0RXhjZXB0aW9uIGlmIGEgUVIgQ29kZSBjYW5ub3QgYmUgZGVjb2RlZAoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5kZXRlY3QgPSBmdW5jdGlvbiAoaGludHMpIHsKCSAgICAgICAgdGhpcy5yZXN1bHRQb2ludENhbGxiYWNrID0gKGhpbnRzID09PSBudWxsIHx8IGhpbnRzID09PSB1bmRlZmluZWQpID8gbnVsbCA6CgkgICAgICAgICAgICAvKihSZXN1bHRQb2ludENhbGxiYWNrKSAqLyBoaW50cy5nZXQoRGVjb2RlSGludFR5cGVfMSQxLmRlZmF1bHQuTkVFRF9SRVNVTFRfUE9JTlRfQ0FMTEJBQ0spOwoJICAgICAgICB2YXIgZmluZGVyID0gbmV3IEZpbmRlclBhdHRlcm5GaW5kZXJfMS5kZWZhdWx0KHRoaXMuaW1hZ2UsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHZhciBpbmZvID0gZmluZGVyLmZpbmQoaGludHMpOwoJICAgICAgICByZXR1cm4gdGhpcy5wcm9jZXNzRmluZGVyUGF0dGVybkluZm8oaW5mbyk7CgkgICAgfTsKCSAgICBEZXRlY3Rvci5wcm90b3R5cGUucHJvY2Vzc0ZpbmRlclBhdHRlcm5JbmZvID0gZnVuY3Rpb24gKGluZm8pIHsKCSAgICAgICAgdmFyIHRvcExlZnQgPSBpbmZvLmdldFRvcExlZnQoKTsKCSAgICAgICAgdmFyIHRvcFJpZ2h0ID0gaW5mby5nZXRUb3BSaWdodCgpOwoJICAgICAgICB2YXIgYm90dG9tTGVmdCA9IGluZm8uZ2V0Qm90dG9tTGVmdCgpOwoJICAgICAgICB2YXIgbW9kdWxlU2l6ZSA9IHRoaXMuY2FsY3VsYXRlTW9kdWxlU2l6ZSh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCk7CgkgICAgICAgIGlmIChtb2R1bGVTaXplIDwgMS4wKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ05vIHBhdHRlcm4gZm91bmQgaW4gcHJvY2Nlc3MgZmluZGVyLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBkaW1lbnNpb24gPSBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHByb3Zpc2lvbmFsVmVyc2lvbiA9IFZlcnNpb25fMS5kZWZhdWx0LmdldFByb3Zpc2lvbmFsVmVyc2lvbkZvckRpbWVuc2lvbihkaW1lbnNpb24pOwoJICAgICAgICB2YXIgbW9kdWxlc0JldHdlZW5GUENlbnRlcnMgPSBwcm92aXNpb25hbFZlcnNpb24uZ2V0RGltZW5zaW9uRm9yVmVyc2lvbigpIC0gNzsKCSAgICAgICAgdmFyIGFsaWdubWVudFBhdHRlcm4gPSBudWxsOwoJICAgICAgICAvLyBBbnl0aGluZyBhYm92ZSB2ZXJzaW9uIDEgaGFzIGFuIGFsaWdubWVudCBwYXR0ZXJuCgkgICAgICAgIGlmIChwcm92aXNpb25hbFZlcnNpb24uZ2V0QWxpZ25tZW50UGF0dGVybkNlbnRlcnMoKS5sZW5ndGggPiAwKSB7CgkgICAgICAgICAgICAvLyBHdWVzcyB3aGVyZSBhICJib3R0b20gcmlnaHQiIGZpbmRlciBwYXR0ZXJuIHdvdWxkIGhhdmUgYmVlbgoJICAgICAgICAgICAgdmFyIGJvdHRvbVJpZ2h0WCA9IHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpICsgYm90dG9tTGVmdC5nZXRYKCk7CgkgICAgICAgICAgICB2YXIgYm90dG9tUmlnaHRZID0gdG9wUmlnaHQuZ2V0WSgpIC0gdG9wTGVmdC5nZXRZKCkgKyBib3R0b21MZWZ0LmdldFkoKTsKCSAgICAgICAgICAgIC8vIEVzdGltYXRlIHRoYXQgYWxpZ25tZW50IHBhdHRlcm4gaXMgY2xvc2VyIGJ5IDMgbW9kdWxlcwoJICAgICAgICAgICAgLy8gZnJvbSAiYm90dG9tIHJpZ2h0IiB0byBrbm93biB0b3AgbGVmdCBsb2NhdGlvbgoJICAgICAgICAgICAgdmFyIGNvcnJlY3Rpb25Ub1RvcExlZnQgPSAxLjAgLSAzLjAgLyBtb2R1bGVzQmV0d2VlbkZQQ2VudGVyczsKCSAgICAgICAgICAgIHZhciBlc3RBbGlnbm1lbnRYID0gLyooaW50KSAqLyBNYXRoLmZsb29yKHRvcExlZnQuZ2V0WCgpICsgY29ycmVjdGlvblRvVG9wTGVmdCAqIChib3R0b21SaWdodFggLSB0b3BMZWZ0LmdldFgoKSkpOwoJICAgICAgICAgICAgdmFyIGVzdEFsaWdubWVudFkgPSAvKihpbnQpICovIE1hdGguZmxvb3IodG9wTGVmdC5nZXRZKCkgKyBjb3JyZWN0aW9uVG9Ub3BMZWZ0ICogKGJvdHRvbVJpZ2h0WSAtIHRvcExlZnQuZ2V0WSgpKSk7CgkgICAgICAgICAgICAvLyBLaW5kIG9mIGFyYml0cmFyeSAtLSBleHBhbmQgc2VhcmNoIHJhZGl1cyBiZWZvcmUgZ2l2aW5nIHVwCgkgICAgICAgICAgICBmb3IgKHZhciBpID0gNDsgaSA8PSAxNjsgaSA8PD0gMSkgewoJICAgICAgICAgICAgICAgIHRyeSB7CgkgICAgICAgICAgICAgICAgICAgIGFsaWdubWVudFBhdHRlcm4gPSB0aGlzLmZpbmRBbGlnbm1lbnRJblJlZ2lvbihtb2R1bGVTaXplLCBlc3RBbGlnbm1lbnRYLCBlc3RBbGlnbm1lbnRZLCBpKTsKCSAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgICAgIGNhdGNoIChyZSAvKk5vdEZvdW5kRXhjZXB0aW9uKi8pIHsKCSAgICAgICAgICAgICAgICAgICAgaWYgKCEocmUgaW5zdGFuY2VvZiBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCkpIHsKCSAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IHJlOwoJICAgICAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgICAgIC8vIHRyeSBuZXh0IHJvdW5kCgkgICAgICAgICAgICAgICAgfQoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgLy8gSWYgd2UgZGlkbid0IGZpbmQgYWxpZ25tZW50IHBhdHRlcm4uLi4gd2VsbCB0cnkgYW55d2F5IHdpdGhvdXQgaXQKCSAgICAgICAgfQoJICAgICAgICB2YXIgdHJhbnNmb3JtID0gRGV0ZWN0b3IuY3JlYXRlVHJhbnNmb3JtKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBhbGlnbm1lbnRQYXR0ZXJuLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgYml0cyA9IERldGVjdG9yLnNhbXBsZUdyaWQodGhpcy5pbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24pOwoJICAgICAgICB2YXIgcG9pbnRzOwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiA9PT0gbnVsbCkgewoJICAgICAgICAgICAgcG9pbnRzID0gW2JvdHRvbUxlZnQsIHRvcExlZnQsIHRvcFJpZ2h0XTsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIHsKCSAgICAgICAgICAgIHBvaW50cyA9IFtib3R0b21MZWZ0LCB0b3BMZWZ0LCB0b3BSaWdodCwgYWxpZ25tZW50UGF0dGVybl07CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIG5ldyBEZXRlY3RvclJlc3VsdF8xLmRlZmF1bHQoYml0cywgcG9pbnRzKTsKCSAgICB9OwoJICAgIERldGVjdG9yLmNyZWF0ZVRyYW5zZm9ybSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCwgYWxpZ25tZW50UGF0dGVybiwgZGltZW5zaW9uIC8qaW50Ki8pIHsKCSAgICAgICAgdmFyIGRpbU1pbnVzVGhyZWUgPSBkaW1lbnNpb24gLSAzLjU7CgkgICAgICAgIHZhciBib3R0b21SaWdodFg7IC8qZmxvYXQqLwoJICAgICAgICB2YXIgYm90dG9tUmlnaHRZOyAvKmZsb2F0Ki8KCSAgICAgICAgdmFyIHNvdXJjZUJvdHRvbVJpZ2h0WDsgLypmbG9hdCovCgkgICAgICAgIHZhciBzb3VyY2VCb3R0b21SaWdodFk7IC8qZmxvYXQqLwoJICAgICAgICBpZiAoYWxpZ25tZW50UGF0dGVybiAhPT0gbnVsbCkgewoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gYWxpZ25tZW50UGF0dGVybi5nZXRYKCk7CgkgICAgICAgICAgICBib3R0b21SaWdodFkgPSBhbGlnbm1lbnRQYXR0ZXJuLmdldFkoKTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WCA9IGRpbU1pbnVzVGhyZWUgLSAzLjA7CgkgICAgICAgICAgICBzb3VyY2VCb3R0b21SaWdodFkgPSBzb3VyY2VCb3R0b21SaWdodFg7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBEb24ndCBoYXZlIGFuIGFsaWdubWVudCBwYXR0ZXJuLCBqdXN0IG1ha2UgdXAgdGhlIGJvdHRvbS1yaWdodCBwb2ludAoJICAgICAgICAgICAgYm90dG9tUmlnaHRYID0gKHRvcFJpZ2h0LmdldFgoKSAtIHRvcExlZnQuZ2V0WCgpKSArIGJvdHRvbUxlZnQuZ2V0WCgpOwoJICAgICAgICAgICAgYm90dG9tUmlnaHRZID0gKHRvcFJpZ2h0LmdldFkoKSAtIHRvcExlZnQuZ2V0WSgpKSArIGJvdHRvbUxlZnQuZ2V0WSgpOwoJICAgICAgICAgICAgc291cmNlQm90dG9tUmlnaHRYID0gZGltTWludXNUaHJlZTsKCSAgICAgICAgICAgIHNvdXJjZUJvdHRvbVJpZ2h0WSA9IGRpbU1pbnVzVGhyZWU7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIFBlcnNwZWN0aXZlVHJhbnNmb3JtXzEuZGVmYXVsdC5xdWFkcmlsYXRlcmFsVG9RdWFkcmlsYXRlcmFsKDMuNSwgMy41LCBkaW1NaW51c1RocmVlLCAzLjUsIHNvdXJjZUJvdHRvbVJpZ2h0WCwgc291cmNlQm90dG9tUmlnaHRZLCAzLjUsIGRpbU1pbnVzVGhyZWUsIHRvcExlZnQuZ2V0WCgpLCB0b3BMZWZ0LmdldFkoKSwgdG9wUmlnaHQuZ2V0WCgpLCB0b3BSaWdodC5nZXRZKCksIGJvdHRvbVJpZ2h0WCwgYm90dG9tUmlnaHRZLCBib3R0b21MZWZ0LmdldFgoKSwgYm90dG9tTGVmdC5nZXRZKCkpOwoJICAgIH07CgkgICAgRGV0ZWN0b3Iuc2FtcGxlR3JpZCA9IGZ1bmN0aW9uIChpbWFnZSwgdHJhbnNmb3JtLCBkaW1lbnNpb24gLyppbnQqLykgewoJICAgICAgICB2YXIgc2FtcGxlciA9IEdyaWRTYW1wbGVySW5zdGFuY2VfMS5kZWZhdWx0LmdldEluc3RhbmNlKCk7CgkgICAgICAgIHJldHVybiBzYW1wbGVyLnNhbXBsZUdyaWRXaXRoVHJhbnNmb3JtKGltYWdlLCBkaW1lbnNpb24sIGRpbWVuc2lvbiwgdHJhbnNmb3JtKTsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkNvbXB1dGVzIHRoZSBkaW1lbnNpb24gKG51bWJlciBvZiBtb2R1bGVzIG9uIGEgc2l6ZSkgb2YgdGhlIFFSIENvZGUgYmFzZWQgb24gdGhlIHBvc2l0aW9uCgkgICAgICogb2YgdGhlIGZpbmRlciBwYXR0ZXJucyBhbmQgZXN0aW1hdGVkIG1vZHVsZSBzaXplLjwvcD4KCSAgICAgKi8KCSAgICBEZXRlY3Rvci5jb21wdXRlRGltZW5zaW9uID0gZnVuY3Rpb24gKHRvcExlZnQsIHRvcFJpZ2h0LCBib3R0b21MZWZ0LCBtb2R1bGVTaXplIC8qZmxvYXQqLykgewoJICAgICAgICB2YXIgdGx0ckNlbnRlcnNEaW1lbnNpb24gPSBNYXRoVXRpbHNfMS5kZWZhdWx0LnJvdW5kKFJlc3VsdFBvaW50XzEuZGVmYXVsdC5kaXN0YW5jZSh0b3BMZWZ0LCB0b3BSaWdodCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIHRsYmxDZW50ZXJzRGltZW5zaW9uID0gTWF0aFV0aWxzXzEuZGVmYXVsdC5yb3VuZChSZXN1bHRQb2ludF8xLmRlZmF1bHQuZGlzdGFuY2UodG9wTGVmdCwgYm90dG9tTGVmdCkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIGRpbWVuc2lvbiA9IE1hdGguZmxvb3IoKHRsdHJDZW50ZXJzRGltZW5zaW9uICsgdGxibENlbnRlcnNEaW1lbnNpb24pIC8gMikgKyA3OwoJICAgICAgICBzd2l0Y2ggKGRpbWVuc2lvbiAmIDB4MDMpIHsgLy8gbW9kIDQKCSAgICAgICAgICAgIGNhc2UgMDoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24rKzsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIC8vIDE/IGRvIG5vdGhpbmcKCSAgICAgICAgICAgIGNhc2UgMjoKCSAgICAgICAgICAgICAgICBkaW1lbnNpb24tLTsKCSAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgIGNhc2UgMzoKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMSQxLmRlZmF1bHQoJ0RpbWVuc2lvbnMgY291bGQgYmUgbm90IGZvdW5kLicpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiBkaW1lbnNpb247CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiA8cD5Db21wdXRlcyBhbiBhdmVyYWdlIGVzdGltYXRlZCBtb2R1bGUgc2l6ZSBiYXNlZCBvbiBlc3RpbWF0ZWQgZGVyaXZlZCBmcm9tIHRoZSBwb3NpdGlvbnMKCSAgICAgKiBvZiB0aGUgdGhyZWUgZmluZGVyIHBhdHRlcm5zLjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSB0b3BMZWZ0IGRldGVjdGVkIHRvcC1sZWZ0IGZpbmRlciBwYXR0ZXJuIGNlbnRlcgoJICAgICAqIEBwYXJhbSB0b3BSaWdodCBkZXRlY3RlZCB0b3AtcmlnaHQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHBhcmFtIGJvdHRvbUxlZnQgZGV0ZWN0ZWQgYm90dG9tLWxlZnQgZmluZGVyIHBhdHRlcm4gY2VudGVyCgkgICAgICogQHJldHVybiBlc3RpbWF0ZWQgbW9kdWxlIHNpemUKCSAgICAgKi8KCSAgICBEZXRlY3Rvci5wcm90b3R5cGUuY2FsY3VsYXRlTW9kdWxlU2l6ZSA9IGZ1bmN0aW9uICh0b3BMZWZ0LCB0b3BSaWdodCwgYm90dG9tTGVmdCkgewoJICAgICAgICAvLyBUYWtlIHRoZSBhdmVyYWdlCgkgICAgICAgIHJldHVybiAodGhpcy5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5KHRvcExlZnQsIHRvcFJpZ2h0KSArCgkgICAgICAgICAgICB0aGlzLmNhbGN1bGF0ZU1vZHVsZVNpemVPbmVXYXkodG9wTGVmdCwgYm90dG9tTGVmdCkpIC8gMi4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogPHA+RXN0aW1hdGVzIG1vZHVsZSBzaXplIGJhc2VkIG9uIHR3byBmaW5kZXIgcGF0dGVybnMgLS0gaXQgdXNlcwoJICAgICAqIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuQm90aFdheXMoaW50LCBpbnQsIGludCwgaW50KX0gdG8gZmlndXJlIHRoZQoJICAgICAqIHdpZHRoIG9mIGVhY2gsIG1lYXN1cmluZyBhbG9uZyB0aGUgYXhpcyBiZXR3ZWVuIHRoZWlyIGNlbnRlcnMuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5jYWxjdWxhdGVNb2R1bGVTaXplT25lV2F5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIG90aGVyUGF0dGVybikgewoJICAgICAgICB2YXIgbW9kdWxlU2l6ZUVzdDEgPSB0aGlzLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzKC8qKGludCkgKi8gTWF0aC5mbG9vcihwYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRZKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKG90aGVyUGF0dGVybi5nZXRZKCkpKTsKCSAgICAgICAgdmFyIG1vZHVsZVNpemVFc3QyID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW5Cb3RoV2F5cygvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFgoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3Iob3RoZXJQYXR0ZXJuLmdldFkoKSksIAoJICAgICAgICAvKihpbnQpICovIE1hdGguZmxvb3IocGF0dGVybi5nZXRYKCkpLCAKCSAgICAgICAgLyooaW50KSAqLyBNYXRoLmZsb29yKHBhdHRlcm4uZ2V0WSgpKSk7CgkgICAgICAgIGlmIChpc05hTihtb2R1bGVTaXplRXN0MSkpIHsKCSAgICAgICAgICAgIHJldHVybiBtb2R1bGVTaXplRXN0MiAvIDcuMDsKCSAgICAgICAgfQoJICAgICAgICBpZiAoaXNOYU4obW9kdWxlU2l6ZUVzdDIpKSB7CgkgICAgICAgICAgICByZXR1cm4gbW9kdWxlU2l6ZUVzdDEgLyA3LjA7CgkgICAgICAgIH0KCSAgICAgICAgLy8gQXZlcmFnZSB0aGVtLCBhbmQgZGl2aWRlIGJ5IDcgc2luY2Ugd2UndmUgY291bnRlZCB0aGUgd2lkdGggb2YgMyBibGFjayBtb2R1bGVzLAoJICAgICAgICAvLyBhbmQgMSB3aGl0ZSBhbmQgMSBibGFjayBtb2R1bGUgb24gZWl0aGVyIHNpZGUuIEVyZ28sIGRpdmlkZSBzdW0gYnkgMTQuCgkgICAgICAgIHJldHVybiAobW9kdWxlU2l6ZUVzdDEgKyBtb2R1bGVTaXplRXN0MikgLyAxNC4wOwoJICAgIH07CgkgICAgLyoqCgkgICAgICogU2VlIHtAbGluayAjc2l6ZU9mQmxhY2tXaGl0ZUJsYWNrUnVuKGludCwgaW50LCBpbnQsIGludCl9OyBjb21wdXRlcyB0aGUgdG90YWwgd2lkdGggb2YKCSAgICAgKiBhIGZpbmRlciBwYXR0ZXJuIGJ5IGxvb2tpbmcgZm9yIGEgYmxhY2std2hpdGUtYmxhY2sgcnVuIGZyb20gdGhlIGNlbnRlciBpbiB0aGUgZGlyZWN0aW9uCgkgICAgICogb2YgYW5vdGhlciBwb2ludCAoYW5vdGhlciBmaW5kZXIgcGF0dGVybiBjZW50ZXIpLCBhbmQgaW4gdGhlIG9wcG9zaXRlIGRpcmVjdGlvbiB0b28uCgkgICAgICovCgkgICAgRGV0ZWN0b3IucHJvdG90eXBlLnNpemVPZkJsYWNrV2hpdGVCbGFja1J1bkJvdGhXYXlzID0gZnVuY3Rpb24gKGZyb21YIC8qaW50Ki8sIGZyb21ZIC8qaW50Ki8sIHRvWCAvKmludCovLCB0b1kgLyppbnQqLykgewoJICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCB0b1gsIHRvWSk7CgkgICAgICAgIC8vIE5vdyBjb3VudCBvdGhlciB3YXkgLS0gZG9uJ3QgcnVuIG9mZiBpbWFnZSB0aG91Z2ggb2YgY291cnNlCgkgICAgICAgIHZhciBzY2FsZSA9IDEuMDsKCSAgICAgICAgdmFyIG90aGVyVG9YID0gZnJvbVggLSAodG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAob3RoZXJUb1ggPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21YIC8gLyooZmxvYXQpICovIChmcm9tWCAtIG90aGVyVG9YKTsKCSAgICAgICAgICAgIG90aGVyVG9YID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWCA+PSB0aGlzLmltYWdlLmdldFdpZHRoKCkpIHsKCSAgICAgICAgICAgIHNjYWxlID0gKHRoaXMuaW1hZ2UuZ2V0V2lkdGgoKSAtIDEgLSBmcm9tWCkgLyAvKihmbG9hdCkgKi8gKG90aGVyVG9YIC0gZnJvbVgpOwoJICAgICAgICAgICAgb3RoZXJUb1ggPSB0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIHZhciBvdGhlclRvWSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihmcm9tWSAtICh0b1kgLSBmcm9tWSkgKiBzY2FsZSk7CgkgICAgICAgIHNjYWxlID0gMS4wOwoJICAgICAgICBpZiAob3RoZXJUb1kgPCAwKSB7CgkgICAgICAgICAgICBzY2FsZSA9IGZyb21ZIC8gLyooZmxvYXQpICovIChmcm9tWSAtIG90aGVyVG9ZKTsKCSAgICAgICAgICAgIG90aGVyVG9ZID0gMDsKCSAgICAgICAgfQoJICAgICAgICBlbHNlIGlmIChvdGhlclRvWSA+PSB0aGlzLmltYWdlLmdldEhlaWdodCgpKSB7CgkgICAgICAgICAgICBzY2FsZSA9ICh0aGlzLmltYWdlLmdldEhlaWdodCgpIC0gMSAtIGZyb21ZKSAvIC8qKGZsb2F0KSAqLyAob3RoZXJUb1kgLSBmcm9tWSk7CgkgICAgICAgICAgICBvdGhlclRvWSA9IHRoaXMuaW1hZ2UuZ2V0SGVpZ2h0KCkgLSAxOwoJICAgICAgICB9CgkgICAgICAgIG90aGVyVG9YID0gLyooaW50KSAqLyBNYXRoLmZsb29yKGZyb21YICsgKG90aGVyVG9YIC0gZnJvbVgpICogc2NhbGUpOwoJICAgICAgICByZXN1bHQgKz0gdGhpcy5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4oZnJvbVgsIGZyb21ZLCBvdGhlclRvWCwgb3RoZXJUb1kpOwoJICAgICAgICAvLyBNaWRkbGUgcGl4ZWwgaXMgZG91YmxlLWNvdW50ZWQgdGhpcyB3YXk7IHN1YnRyYWN0IDEKCSAgICAgICAgcmV0dXJuIHJlc3VsdCAtIDEuMDsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPlRoaXMgbWV0aG9kIHRyYWNlcyBhIGxpbmUgZnJvbSBhIHBvaW50IGluIHRoZSBpbWFnZSwgaW4gdGhlIGRpcmVjdGlvbiB0b3dhcmRzIGFub3RoZXIgcG9pbnQuCgkgICAgICogSXQgYmVnaW5zIGluIGEgYmxhY2sgcmVnaW9uLCBhbmQga2VlcHMgZ29pbmcgdW50aWwgaXQgZmluZHMgd2hpdGUsIHRoZW4gYmxhY2ssIHRoZW4gd2hpdGUgYWdhaW4uCgkgICAgICogSXQgcmVwb3J0cyB0aGUgZGlzdGFuY2UgZnJvbSB0aGUgc3RhcnQgdG8gdGhpcyBwb2ludC48L3A+CgkgICAgICoKCSAgICAgKiA8cD5UaGlzIGlzIHVzZWQgd2hlbiBmaWd1cmluZyBvdXQgaG93IHdpZGUgYSBmaW5kZXIgcGF0dGVybiBpcywgd2hlbiB0aGUgZmluZGVyIHBhdHRlcm4KCSAgICAgKiBtYXkgYmUgc2tld2VkIG9yIHJvdGF0ZWQuPC9wPgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5zaXplT2ZCbGFja1doaXRlQmxhY2tSdW4gPSBmdW5jdGlvbiAoZnJvbVggLyppbnQqLywgZnJvbVkgLyppbnQqLywgdG9YIC8qaW50Ki8sIHRvWSAvKmludCovKSB7CgkgICAgICAgIC8vIE1pbGQgdmFyaWFudCBvZiBCcmVzZW5oYW0ncyBhbGdvcml0aG0KCSAgICAgICAgLy8gc2VlIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvQnJlc2VuaGFtJ3NfbGluZV9hbGdvcml0aG0KCSAgICAgICAgdmFyIHN0ZWVwID0gTWF0aC5hYnModG9ZIC0gZnJvbVkpID4gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICBpZiAoc3RlZXApIHsKCSAgICAgICAgICAgIHZhciB0ZW1wID0gZnJvbVg7CgkgICAgICAgICAgICBmcm9tWCA9IGZyb21ZOwoJICAgICAgICAgICAgZnJvbVkgPSB0ZW1wOwoJICAgICAgICAgICAgdGVtcCA9IHRvWDsKCSAgICAgICAgICAgIHRvWCA9IHRvWTsKCSAgICAgICAgICAgIHRvWSA9IHRlbXA7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGR4ID0gTWF0aC5hYnModG9YIC0gZnJvbVgpOwoJICAgICAgICB2YXIgZHkgPSBNYXRoLmFicyh0b1kgLSBmcm9tWSk7CgkgICAgICAgIHZhciBlcnJvciA9IC1keCAvIDI7CgkgICAgICAgIHZhciB4c3RlcCA9IGZyb21YIDwgdG9YID8gMSA6IC0xOwoJICAgICAgICB2YXIgeXN0ZXAgPSBmcm9tWSA8IHRvWSA/IDEgOiAtMTsKCSAgICAgICAgLy8gSW4gYmxhY2sgcGl4ZWxzLCBsb29raW5nIGZvciB3aGl0ZSwgZmlyc3Qgb3Igc2Vjb25kIHRpbWUuCgkgICAgICAgIHZhciBzdGF0ZSA9IDA7CgkgICAgICAgIC8vIExvb3AgdXAgdW50aWwgeCA9PSB0b1gsIGJ1dCBub3QgYmV5b25kCgkgICAgICAgIHZhciB4TGltaXQgPSB0b1ggKyB4c3RlcDsKCSAgICAgICAgZm9yICh2YXIgeCA9IGZyb21YLCB5ID0gZnJvbVk7IHggIT09IHhMaW1pdDsgeCArPSB4c3RlcCkgewoJICAgICAgICAgICAgdmFyIHJlYWxYID0gc3RlZXAgPyB5IDogeDsKCSAgICAgICAgICAgIHZhciByZWFsWSA9IHN0ZWVwID8geCA6IHk7CgkgICAgICAgICAgICAvLyBEb2VzIGN1cnJlbnQgcGl4ZWwgbWVhbiB3ZSBoYXZlIG1vdmVkIHdoaXRlIHRvIGJsYWNrIG9yIHZpY2UgdmVyc2E/CgkgICAgICAgICAgICAvLyBTY2FubmluZyBibGFjayBpbiBzdGF0ZSAwLDIgYW5kIHdoaXRlIGluIHN0YXRlIDEsIHNvIGlmIHdlIGZpbmQgdGhlIHdyb25nCgkgICAgICAgICAgICAvLyBjb2xvciwgYWR2YW5jZSB0byBuZXh0IHN0YXRlIG9yIGVuZCBpZiB3ZSBhcmUgaW4gc3RhdGUgMiBhbHJlYWR5CgkgICAgICAgICAgICBpZiAoKHN0YXRlID09PSAxKSA9PT0gdGhpcy5pbWFnZS5nZXQocmVhbFgsIHJlYWxZKSkgewoJICAgICAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gMikgewoJICAgICAgICAgICAgICAgICAgICByZXR1cm4gTWF0aFV0aWxzXzEuZGVmYXVsdC5kaXN0YW5jZSh4LCB5LCBmcm9tWCwgZnJvbVkpOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBzdGF0ZSsrOwoJICAgICAgICAgICAgfQoJICAgICAgICAgICAgZXJyb3IgKz0gZHk7CgkgICAgICAgICAgICBpZiAoZXJyb3IgPiAwKSB7CgkgICAgICAgICAgICAgICAgaWYgKHkgPT09IHRvWSkgewoJICAgICAgICAgICAgICAgICAgICBicmVhazsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICAgICAgeSArPSB5c3RlcDsKCSAgICAgICAgICAgICAgICBlcnJvciAtPSBkeDsKCSAgICAgICAgICAgIH0KCSAgICAgICAgfQoJICAgICAgICAvLyBGb3VuZCBibGFjay13aGl0ZS1ibGFjazsgZ2l2ZSB0aGUgYmVuZWZpdCBvZiB0aGUgZG91YnQgdGhhdCB0aGUgbmV4dCBwaXhlbCBvdXRzaWRlIHRoZSBpbWFnZQoJICAgICAgICAvLyBpcyAid2hpdGUiIHNvIHRoaXMgbGFzdCBwb2ludCBhdCAodG9YK3hTdGVwLHRvWSkgaXMgdGhlIHJpZ2h0IGVuZGluZy4gVGhpcyBpcyByZWFsbHkgYQoJICAgICAgICAvLyBzbWFsbCBhcHByb3hpbWF0aW9uOyAodG9YK3hTdGVwLHRvWSt5U3RlcCkgbWlnaHQgYmUgcmVhbGx5IGNvcnJlY3QuIElnbm9yZSB0aGlzLgoJICAgICAgICBpZiAoc3RhdGUgPT09IDIpIHsKCSAgICAgICAgICAgIHJldHVybiBNYXRoVXRpbHNfMS5kZWZhdWx0LmRpc3RhbmNlKHRvWCArIHhzdGVwLCB0b1ksIGZyb21YLCBmcm9tWSk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gZWxzZSB3ZSBkaWRuJ3QgZmluZCBldmVuIGJsYWNrLXdoaXRlLWJsYWNrOyBubyBlc3RpbWF0ZSBpcyByZWFsbHkgcG9zc2libGUKCSAgICAgICAgcmV0dXJuIE5hTjsKCSAgICB9OwoJICAgIC8qKgoJICAgICAqIDxwPkF0dGVtcHRzIHRvIGxvY2F0ZSBhbiBhbGlnbm1lbnQgcGF0dGVybiBpbiBhIGxpbWl0ZWQgcmVnaW9uIG9mIHRoZSBpbWFnZSwgd2hpY2ggaXMKCSAgICAgKiBndWVzc2VkIHRvIGNvbnRhaW4gaXQuIFRoaXMgbWV0aG9kIHVzZXMge0BsaW5rIEFsaWdubWVudFBhdHRlcm59LjwvcD4KCSAgICAgKgoJICAgICAqIEBwYXJhbSBvdmVyYWxsRXN0TW9kdWxlU2l6ZSBlc3RpbWF0ZWQgbW9kdWxlIHNpemUgc28gZmFyCgkgICAgICogQHBhcmFtIGVzdEFsaWdubWVudFggeCBjb29yZGluYXRlIG9mIGNlbnRlciBvZiBhcmVhIHByb2JhYmx5IGNvbnRhaW5pbmcgYWxpZ25tZW50IHBhdHRlcm4KCSAgICAgKiBAcGFyYW0gZXN0QWxpZ25tZW50WSB5IGNvb3JkaW5hdGUgb2YgYWJvdmUKCSAgICAgKiBAcGFyYW0gYWxsb3dhbmNlRmFjdG9yIG51bWJlciBvZiBwaXhlbHMgaW4gYWxsIGRpcmVjdGlvbnMgdG8gc2VhcmNoIGZyb20gdGhlIGNlbnRlcgoJICAgICAqIEByZXR1cm4ge0BsaW5rIEFsaWdubWVudFBhdHRlcm59IGlmIGZvdW5kLCBvciBudWxsIG90aGVyd2lzZQoJICAgICAqIEB0aHJvd3MgTm90Rm91bmRFeGNlcHRpb24gaWYgYW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnMgZHVyaW5nIGRldGVjdGlvbgoJICAgICAqLwoJICAgIERldGVjdG9yLnByb3RvdHlwZS5maW5kQWxpZ25tZW50SW5SZWdpb24gPSBmdW5jdGlvbiAob3ZlcmFsbEVzdE1vZHVsZVNpemUgLypmbG9hdCovLCBlc3RBbGlnbm1lbnRYIC8qaW50Ki8sIGVzdEFsaWdubWVudFkgLyppbnQqLywgYWxsb3dhbmNlRmFjdG9yIC8qZmxvYXQqLykgewoJICAgICAgICAvLyBMb29rIGZvciBhbiBhbGlnbm1lbnQgcGF0dGVybiAoMyBtb2R1bGVzIGluIHNpemUpIGFyb3VuZCB3aGVyZSBpdAoJICAgICAgICAvLyBzaG91bGQgYmUKCSAgICAgICAgdmFyIGFsbG93YW5jZSA9IC8qKGludCkgKi8gTWF0aC5mbG9vcihhbGxvd2FuY2VGYWN0b3IgKiBvdmVyYWxsRXN0TW9kdWxlU2l6ZSk7CgkgICAgICAgIHZhciBhbGlnbm1lbnRBcmVhTGVmdFggPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRYIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFSaWdodFggPSBNYXRoLm1pbih0aGlzLmltYWdlLmdldFdpZHRoKCkgLSAxLCBlc3RBbGlnbm1lbnRYICsgYWxsb3dhbmNlKTsKCSAgICAgICAgaWYgKGFsaWdubWVudEFyZWFSaWdodFggLSBhbGlnbm1lbnRBcmVhTGVmdFggPCBvdmVyYWxsRXN0TW9kdWxlU2l6ZSAqIDMpIHsKCSAgICAgICAgICAgIHRocm93IG5ldyBOb3RGb3VuZEV4Y2VwdGlvbl8xJDEuZGVmYXVsdCgnQWxpZ25tZW50IHRvcCBleGNlZWRzIGVzdGltYXRlZCBtb2R1bGUgc2l6ZS4nKTsKCSAgICAgICAgfQoJICAgICAgICB2YXIgYWxpZ25tZW50QXJlYVRvcFkgPSBNYXRoLm1heCgwLCBlc3RBbGlnbm1lbnRZIC0gYWxsb3dhbmNlKTsKCSAgICAgICAgdmFyIGFsaWdubWVudEFyZWFCb3R0b21ZID0gTWF0aC5taW4odGhpcy5pbWFnZS5nZXRIZWlnaHQoKSAtIDEsIGVzdEFsaWdubWVudFkgKyBhbGxvd2FuY2UpOwoJICAgICAgICBpZiAoYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSA8IG92ZXJhbGxFc3RNb2R1bGVTaXplICogMykgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEkMS5kZWZhdWx0KCdBbGlnbm1lbnQgYm90dG9tIGV4Y2VlZHMgZXN0aW1hdGVkIG1vZHVsZSBzaXplLicpOwoJICAgICAgICB9CgkgICAgICAgIHZhciBhbGlnbm1lbnRGaW5kZXIgPSBuZXcgQWxpZ25tZW50UGF0dGVybkZpbmRlcl8xLmRlZmF1bHQodGhpcy5pbWFnZSwgYWxpZ25tZW50QXJlYUxlZnRYLCBhbGlnbm1lbnRBcmVhVG9wWSwgYWxpZ25tZW50QXJlYVJpZ2h0WCAtIGFsaWdubWVudEFyZWFMZWZ0WCwgYWxpZ25tZW50QXJlYUJvdHRvbVkgLSBhbGlnbm1lbnRBcmVhVG9wWSwgb3ZlcmFsbEVzdE1vZHVsZVNpemUsIHRoaXMucmVzdWx0UG9pbnRDYWxsYmFjayk7CgkgICAgICAgIHJldHVybiBhbGlnbm1lbnRGaW5kZXIuZmluZCgpOwoJICAgIH07CgkgICAgcmV0dXJuIERldGVjdG9yOwoJfSgpKTsKCURldGVjdG9yJDEuZGVmYXVsdCA9IERldGVjdG9yOwoKCS8qCgkgKiBDb3B5cmlnaHQgMjAwNyBaWGluZyBhdXRob3JzCgkgKgoJICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CgkgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCgkgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKCSAqCgkgKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMAoJICoKCSAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKCSAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsCgkgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4KCSAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKCSAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLgoJICovCglPYmplY3QuZGVmaW5lUHJvcGVydHkoUVJDb2RlUmVhZGVyJDEsICJfX2VzTW9kdWxlIiwgeyB2YWx1ZTogdHJ1ZSB9KTsKCS8qbmFtZXNwYWNlIGNvbS5nb29nbGUuenhpbmcucXJjb2RlIHsqLwoJdmFyIEJhcmNvZGVGb3JtYXRfMSA9IEJhcmNvZGVGb3JtYXQkMTsKCXZhciBCaXRNYXRyaXhfMSA9IEJpdE1hdHJpeCQxOwoJdmFyIERlY29kZUhpbnRUeXBlXzEgPSBEZWNvZGVIaW50VHlwZSQxOwoJdmFyIE5vdEZvdW5kRXhjZXB0aW9uXzEgPSBOb3RGb3VuZEV4Y2VwdGlvbiQxOwoJdmFyIFJlc3VsdF8xID0gUmVzdWx0JDE7Cgl2YXIgUmVzdWx0TWV0YWRhdGFUeXBlXzEgPSBSZXN1bHRNZXRhZGF0YVR5cGUkMTsKCS8vIGltcG9ydCBEZXRlY3RvclJlc3VsdCBmcm9tICcuLi9jb21tb24vRGV0ZWN0b3JSZXN1bHQnOwoJdmFyIERlY29kZXJfMSA9IERlY29kZXIkMTsKCXZhciBRUkNvZGVEZWNvZGVyTWV0YURhdGFfMSA9IFFSQ29kZURlY29kZXJNZXRhRGF0YSQxOwoJdmFyIERldGVjdG9yXzEgPSBEZXRlY3RvciQxOwoJLyppbXBvcnQgamF2YS51dGlsLkxpc3Q7Ki8KCS8qaW1wb3J0IGphdmEudXRpbC5NYXA7Ki8KCS8qKgoJICogVGhpcyBpbXBsZW1lbnRhdGlvbiBjYW4gZGV0ZWN0IGFuZCBkZWNvZGUgUVIgQ29kZXMgaW4gYW4gaW1hZ2UuCgkgKgoJICogQGF1dGhvciBTZWFuIE93ZW4KCSAqLwoJdmFyIFFSQ29kZVJlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHsKCSAgICBmdW5jdGlvbiBRUkNvZGVSZWFkZXIoKSB7CgkgICAgICAgIHRoaXMuZGVjb2RlciA9IG5ldyBEZWNvZGVyXzEuZGVmYXVsdCgpOwoJICAgIH0KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmdldERlY29kZXIgPSBmdW5jdGlvbiAoKSB7CgkgICAgICAgIHJldHVybiB0aGlzLmRlY29kZXI7CgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBMb2NhdGVzIGFuZCBkZWNvZGVzIGEgUVIgY29kZSBpbiBhbiBpbWFnZS4KCSAgICAgKgoJICAgICAqIEByZXR1cm4gYSByZXByZXNlbnRpbmc6IHN0cmluZyB0aGUgY29udGVudCBlbmNvZGVkIGJ5IHRoZSBRUiBjb2RlCgkgICAgICogQHRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiBpZiBhIFFSIGNvZGUgY2Fubm90IGJlIGZvdW5kCgkgICAgICogQHRocm93cyBGb3JtYXRFeGNlcHRpb24gaWYgYSBRUiBjb2RlIGNhbm5vdCBiZSBkZWNvZGVkCgkgICAgICogQHRocm93cyBDaGVja3N1bUV4Y2VwdGlvbiBpZiBlcnJvciBjb3JyZWN0aW9uIGZhaWxzCgkgICAgICovCgkgICAgLypAT3ZlcnJpZGUqLwoJICAgIC8vIHB1YmxpYyBkZWNvZGUoaW1hZ2U6IEJpbmFyeUJpdG1hcCk6IFJlc3VsdCAvKnRocm93cyBOb3RGb3VuZEV4Y2VwdGlvbiwgQ2hlY2tzdW1FeGNlcHRpb24sIEZvcm1hdEV4Y2VwdGlvbiAqLyB7CgkgICAgLy8gICByZXR1cm4gdGhpcy5kZWNvZGUoaW1hZ2UsIG51bGwpCgkgICAgLy8gfQoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLmRlY29kZSA9IGZ1bmN0aW9uIChpbWFnZSwgaGludHMpIHsKCSAgICAgICAgdmFyIGRlY29kZXJSZXN1bHQ7CgkgICAgICAgIHZhciBwb2ludHM7CgkgICAgICAgIGlmIChoaW50cyAhPT0gdW5kZWZpbmVkICYmIGhpbnRzICE9PSBudWxsICYmIHVuZGVmaW5lZCAhPT0gaGludHMuZ2V0KERlY29kZUhpbnRUeXBlXzEuZGVmYXVsdC5QVVJFX0JBUkNPREUpKSB7CgkgICAgICAgICAgICB2YXIgYml0cyA9IFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMoaW1hZ2UuZ2V0QmxhY2tNYXRyaXgoKSk7CgkgICAgICAgICAgICBkZWNvZGVyUmVzdWx0ID0gdGhpcy5kZWNvZGVyLmRlY29kZUJpdE1hdHJpeChiaXRzLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTOwoJICAgICAgICB9CgkgICAgICAgIGVsc2UgewoJICAgICAgICAgICAgdmFyIGRldGVjdG9yUmVzdWx0ID0gbmV3IERldGVjdG9yXzEuZGVmYXVsdChpbWFnZS5nZXRCbGFja01hdHJpeCgpKS5kZXRlY3QoaGludHMpOwoJICAgICAgICAgICAgZGVjb2RlclJlc3VsdCA9IHRoaXMuZGVjb2Rlci5kZWNvZGVCaXRNYXRyaXgoZGV0ZWN0b3JSZXN1bHQuZ2V0Qml0cygpLCBoaW50cyk7CgkgICAgICAgICAgICBwb2ludHMgPSBkZXRlY3RvclJlc3VsdC5nZXRQb2ludHMoKTsKCSAgICAgICAgfQoJICAgICAgICAvLyBJZiB0aGUgY29kZSB3YXMgbWlycm9yZWQ6IHN3YXAgdGhlIGJvdHRvbS1sZWZ0IGFuZCB0aGUgdG9wLXJpZ2h0IHBvaW50cy4KCSAgICAgICAgaWYgKGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKSBpbnN0YW5jZW9mIFFSQ29kZURlY29kZXJNZXRhRGF0YV8xLmRlZmF1bHQpIHsKCSAgICAgICAgICAgIGRlY29kZXJSZXN1bHQuZ2V0T3RoZXIoKS5hcHBseU1pcnJvcmVkQ29ycmVjdGlvbihwb2ludHMpOwoJICAgICAgICB9CgkgICAgICAgIHZhciByZXN1bHQgPSBuZXcgUmVzdWx0XzEuZGVmYXVsdChkZWNvZGVyUmVzdWx0LmdldFRleHQoKSwgZGVjb2RlclJlc3VsdC5nZXRSYXdCeXRlcygpLCB1bmRlZmluZWQsIHBvaW50cywgQmFyY29kZUZvcm1hdF8xLmRlZmF1bHQuUVJfQ09ERSwgdW5kZWZpbmVkKTsKCSAgICAgICAgdmFyIGJ5dGVTZWdtZW50cyA9IGRlY29kZXJSZXN1bHQuZ2V0Qnl0ZVNlZ21lbnRzKCk7CgkgICAgICAgIGlmIChieXRlU2VnbWVudHMgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkJZVEVfU0VHTUVOVFMsIGJ5dGVTZWdtZW50cyk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIGVjTGV2ZWwgPSBkZWNvZGVyUmVzdWx0LmdldEVDTGV2ZWwoKTsKCSAgICAgICAgaWYgKGVjTGV2ZWwgIT09IG51bGwpIHsKCSAgICAgICAgICAgIHJlc3VsdC5wdXRNZXRhZGF0YShSZXN1bHRNZXRhZGF0YVR5cGVfMS5kZWZhdWx0LkVSUk9SX0NPUlJFQ1RJT05fTEVWRUwsIGVjTGV2ZWwpOwoJICAgICAgICB9CgkgICAgICAgIGlmIChkZWNvZGVyUmVzdWx0Lmhhc1N0cnVjdHVyZWRBcHBlbmQoKSkgewoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfU0VRVUVOQ0UsIGRlY29kZXJSZXN1bHQuZ2V0U3RydWN0dXJlZEFwcGVuZFNlcXVlbmNlTnVtYmVyKCkpOwoJICAgICAgICAgICAgcmVzdWx0LnB1dE1ldGFkYXRhKFJlc3VsdE1ldGFkYXRhVHlwZV8xLmRlZmF1bHQuU1RSVUNUVVJFRF9BUFBFTkRfUEFSSVRZLCBkZWNvZGVyUmVzdWx0LmdldFN0cnVjdHVyZWRBcHBlbmRQYXJpdHkoKSk7CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIHJlc3VsdDsKCSAgICB9OwoJICAgIC8qQE92ZXJyaWRlKi8KCSAgICBRUkNvZGVSZWFkZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkgewoJICAgICAgICAvLyBkbyBub3RoaW5nCgkgICAgfTsKCSAgICAvKioKCSAgICAgKiBUaGlzIG1ldGhvZCBkZXRlY3RzIGEgY29kZSBpbiBhICJwdXJlIiBpbWFnZSAtLSB0aGF0IGlzLCBwdXJlIG1vbm9jaHJvbWUgaW1hZ2UKCSAgICAgKiB3aGljaCBjb250YWlucyBvbmx5IGFuIHVucm90YXRlZCwgdW5za2V3ZWQsIGltYWdlIG9mIGEgY29kZSwgd2l0aCBzb21lIHdoaXRlIGJvcmRlcgoJICAgICAqIGFyb3VuZCBpdC4gVGhpcyBpcyBhIHNwZWNpYWxpemVkIG1ldGhvZCB0aGF0IHdvcmtzIGV4Y2VwdGlvbmFsbHkgZmFzdCBpbiB0aGlzIHNwZWNpYWwKCSAgICAgKiBjYXNlLgoJICAgICAqCgkgICAgICogQHNlZSBjb20uZ29vZ2xlLnp4aW5nLmRhdGFtYXRyaXguRGF0YU1hdHJpeFJlYWRlciNleHRyYWN0UHVyZUJpdHMoQml0TWF0cml4KQoJICAgICAqLwoJICAgIFFSQ29kZVJlYWRlci5leHRyYWN0UHVyZUJpdHMgPSBmdW5jdGlvbiAoaW1hZ2UpIHsKCSAgICAgICAgdmFyIGxlZnRUb3BCbGFjayA9IGltYWdlLmdldFRvcExlZnRPbkJpdCgpOwoJICAgICAgICB2YXIgcmlnaHRCb3R0b21CbGFjayA9IGltYWdlLmdldEJvdHRvbVJpZ2h0T25CaXQoKTsKCSAgICAgICAgaWYgKGxlZnRUb3BCbGFjayA9PT0gbnVsbCB8fCByaWdodEJvdHRvbUJsYWNrID09PSBudWxsKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1vZHVsZVNpemUgPSB0aGlzLm1vZHVsZVNpemUobGVmdFRvcEJsYWNrLCBpbWFnZSk7CgkgICAgICAgIHZhciB0b3AgPSBsZWZ0VG9wQmxhY2tbMV07CgkgICAgICAgIHZhciBib3R0b20gPSByaWdodEJvdHRvbUJsYWNrWzFdOwoJICAgICAgICB2YXIgbGVmdCA9IGxlZnRUb3BCbGFja1swXTsKCSAgICAgICAgdmFyIHJpZ2h0ID0gcmlnaHRCb3R0b21CbGFja1swXTsKCSAgICAgICAgLy8gU2FuaXR5IGNoZWNrIQoJICAgICAgICBpZiAobGVmdCA+PSByaWdodCB8fCB0b3AgPj0gYm90dG9tKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKGJvdHRvbSAtIHRvcCAhPT0gcmlnaHQgLSBsZWZ0KSB7CgkgICAgICAgICAgICAvLyBTcGVjaWFsIGNhc2UsIHdoZXJlIGJvdHRvbS1yaWdodCBtb2R1bGUgd2Fzbid0IGJsYWNrIHNvIHdlIGZvdW5kIHNvbWV0aGluZyBlbHNlIGluIHRoZSBsYXN0IHJvdwoJICAgICAgICAgICAgLy8gQXNzdW1lIGl0J3MgYSBzcXVhcmUsIHNvIHVzZSBoZWlnaHQgYXMgdGhlIHdpZHRoCgkgICAgICAgICAgICByaWdodCA9IGxlZnQgKyAoYm90dG9tIC0gdG9wKTsKCSAgICAgICAgICAgIGlmIChyaWdodCA+PSBpbWFnZS5nZXRXaWR0aCgpKSB7CgkgICAgICAgICAgICAgICAgLy8gQWJvcnQgaWYgdGhhdCB3b3VsZCBub3QgbWFrZSBzZW5zZSAtLSBvZmYgaW1hZ2UKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgdmFyIG1hdHJpeFdpZHRoID0gTWF0aC5yb3VuZCgocmlnaHQgLSBsZWZ0ICsgMSkgLyBtb2R1bGVTaXplKTsKCSAgICAgICAgdmFyIG1hdHJpeEhlaWdodCA9IE1hdGgucm91bmQoKGJvdHRvbSAtIHRvcCArIDEpIC8gbW9kdWxlU2l6ZSk7CgkgICAgICAgIGlmIChtYXRyaXhXaWR0aCA8PSAwIHx8IG1hdHJpeEhlaWdodCA8PSAwKSB7CgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKG1hdHJpeEhlaWdodCAhPT0gbWF0cml4V2lkdGgpIHsKCSAgICAgICAgICAgIC8vIE9ubHkgcG9zc2libHkgZGVjb2RlIHNxdWFyZSByZWdpb25zCgkgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgIH0KCSAgICAgICAgLy8gUHVzaCBpbiB0aGUgImJvcmRlciIgYnkgaGFsZiB0aGUgbW9kdWxlIHdpZHRoIHNvIHRoYXQgd2Ugc3RhcnQKCSAgICAgICAgLy8gc2FtcGxpbmcgaW4gdGhlIG1pZGRsZSBvZiB0aGUgbW9kdWxlLiBKdXN0IGluIGNhc2UgdGhlIGltYWdlIGlzIGEKCSAgICAgICAgLy8gbGl0dGxlIG9mZiwgdGhpcyB3aWxsIGhlbHAgcmVjb3Zlci4KCSAgICAgICAgdmFyIG51ZGdlID0gLyooaW50KSAqLyBNYXRoLmZsb29yKG1vZHVsZVNpemUgLyAyLjApOwoJICAgICAgICB0b3AgKz0gbnVkZ2U7CgkgICAgICAgIGxlZnQgKz0gbnVkZ2U7CgkgICAgICAgIC8vIEJ1dCBjYXJlZnVsIHRoYXQgdGhpcyBkb2VzIG5vdCBzYW1wbGUgb2ZmIHRoZSBlZGdlCgkgICAgICAgIC8vICJyaWdodCIgaXMgdGhlIGZhcnRoZXN0LXJpZ2h0IHZhbGlkIHBpeGVsIGxvY2F0aW9uIC0tIHJpZ2h0KzEgaXMgbm90IG5lY2Vzc2FyaWx5CgkgICAgICAgIC8vIFRoaXMgaXMgcG9zaXRpdmUgYnkgaG93IG11Y2ggdGhlIGlubmVyIHggbG9vcCBiZWxvdyB3b3VsZCBiZSB0b28gbGFyZ2UKCSAgICAgICAgdmFyIG51ZGdlZFRvb0ZhclJpZ2h0ID0gbGVmdCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4V2lkdGggLSAxKSAqIG1vZHVsZVNpemUpIC0gcmlnaHQ7CgkgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IDApIHsKCSAgICAgICAgICAgIGlmIChudWRnZWRUb29GYXJSaWdodCA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBsZWZ0IC09IG51ZGdlZFRvb0ZhclJpZ2h0OwoJICAgICAgICB9CgkgICAgICAgIC8vIFNlZSBsb2dpYyBhYm92ZQoJICAgICAgICB2YXIgbnVkZ2VkVG9vRmFyRG93biA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcigobWF0cml4SGVpZ2h0IC0gMSkgKiBtb2R1bGVTaXplKSAtIGJvdHRvbTsKCSAgICAgICAgaWYgKG51ZGdlZFRvb0ZhckRvd24gPiAwKSB7CgkgICAgICAgICAgICBpZiAobnVkZ2VkVG9vRmFyRG93biA+IG51ZGdlKSB7CgkgICAgICAgICAgICAgICAgLy8gTmVpdGhlciB3YXkgZml0czsgYWJvcnQKCSAgICAgICAgICAgICAgICB0aHJvdyBuZXcgTm90Rm91bmRFeGNlcHRpb25fMS5kZWZhdWx0KCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB0b3AgLT0gbnVkZ2VkVG9vRmFyRG93bjsKCSAgICAgICAgfQoJICAgICAgICAvLyBOb3cganVzdCByZWFkIG9mZiB0aGUgYml0cwoJICAgICAgICB2YXIgYml0cyA9IG5ldyBCaXRNYXRyaXhfMS5kZWZhdWx0KG1hdHJpeFdpZHRoLCBtYXRyaXhIZWlnaHQpOwoJICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IG1hdHJpeEhlaWdodDsgeSsrKSB7CgkgICAgICAgICAgICB2YXIgaU9mZnNldCA9IHRvcCArIC8qKGludCkgKi8gTWF0aC5mbG9vcih5ICogbW9kdWxlU2l6ZSk7CgkgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IG1hdHJpeFdpZHRoOyB4KyspIHsKCSAgICAgICAgICAgICAgICBpZiAoaW1hZ2UuZ2V0KGxlZnQgKyAvKihpbnQpICovIE1hdGguZmxvb3IoeCAqIG1vZHVsZVNpemUpLCBpT2Zmc2V0KSkgewoJICAgICAgICAgICAgICAgICAgICBiaXRzLnNldCh4LCB5KTsKCSAgICAgICAgICAgICAgICB9CgkgICAgICAgICAgICB9CgkgICAgICAgIH0KCSAgICAgICAgcmV0dXJuIGJpdHM7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIubW9kdWxlU2l6ZSA9IGZ1bmN0aW9uIChsZWZ0VG9wQmxhY2ssIGltYWdlKSB7CgkgICAgICAgIHZhciBoZWlnaHQgPSBpbWFnZS5nZXRIZWlnaHQoKTsKCSAgICAgICAgdmFyIHdpZHRoID0gaW1hZ2UuZ2V0V2lkdGgoKTsKCSAgICAgICAgdmFyIHggPSBsZWZ0VG9wQmxhY2tbMF07CgkgICAgICAgIHZhciB5ID0gbGVmdFRvcEJsYWNrWzFdOwoJICAgICAgICB2YXIgaW5CbGFjayA9IHRydWU7CgkgICAgICAgIHZhciB0cmFuc2l0aW9ucyA9IDA7CgkgICAgICAgIHdoaWxlICh4IDwgd2lkdGggJiYgeSA8IGhlaWdodCkgewoJICAgICAgICAgICAgaWYgKGluQmxhY2sgIT09IGltYWdlLmdldCh4LCB5KSkgewoJICAgICAgICAgICAgICAgIGlmICgrK3RyYW5zaXRpb25zID09PSA1KSB7CgkgICAgICAgICAgICAgICAgICAgIGJyZWFrOwoJICAgICAgICAgICAgICAgIH0KCSAgICAgICAgICAgICAgICBpbkJsYWNrID0gIWluQmxhY2s7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICB4Kys7CgkgICAgICAgICAgICB5Kys7CgkgICAgICAgIH0KCSAgICAgICAgaWYgKHggPT09IHdpZHRoIHx8IHkgPT09IGhlaWdodCkgewoJICAgICAgICAgICAgdGhyb3cgbmV3IE5vdEZvdW5kRXhjZXB0aW9uXzEuZGVmYXVsdCgpOwoJICAgICAgICB9CgkgICAgICAgIHJldHVybiAoeCAtIGxlZnRUb3BCbGFja1swXSkgLyA3LjA7CgkgICAgfTsKCSAgICBRUkNvZGVSZWFkZXIuTk9fUE9JTlRTID0gbmV3IEFycmF5KCk7CgkgICAgcmV0dXJuIFFSQ29kZVJlYWRlcjsKCX0oKSk7Cgl2YXIgX2RlZmF1bHQgPSBRUkNvZGVSZWFkZXIkMS5kZWZhdWx0ID0gUVJDb2RlUmVhZGVyOwoKCXZhciB0b0dyYXlzY2FsZUJ1ZmZlciA9IGZ1bmN0aW9uIHRvR3JheXNjYWxlQnVmZmVyKGltYWdlQnVmZmVyLCB3aWR0aCwgaGVpZ2h0KSB7CgkgIHZhciBncmF5c2NhbGVCdWZmZXIgPSBuZXcgVWludDhDbGFtcGVkQXJyYXkod2lkdGggKiBoZWlnaHQpOwoKCSAgZm9yICh2YXIgaSA9IDAsIGogPSAwLCBsZW5ndGhfMSA9IGltYWdlQnVmZmVyLmxlbmd0aDsgaSA8IGxlbmd0aF8xOyBpICs9IDQsIGorKykgewoJICAgIHZhciBncmF5ID0gdm9pZCAwOwoJICAgIHZhciBhbHBoYSA9IGltYWdlQnVmZmVyW2kgKyAzXTsgLy8gVGhlIGNvbG9yIG9mIGZ1bGx5LXRyYW5zcGFyZW50IHBpeGVscyBpcyBpcnJlbGV2YW50LiBUaGV5IGFyZSBvZnRlbiwgdGVjaG5pY2FsbHksIGZ1bGx5LXRyYW5zcGFyZW50CgkgICAgLy8gYmxhY2sgKDAgYWxwaGEsIGFuZCB0aGVuIDAgUkdCKS4gVGhleSBhcmUgb2Z0ZW4gdXNlZCwgb2YgY291cnNlIGFzIHRoZSAid2hpdGUiIGFyZWEgaW4gYQoJICAgIC8vIGJhcmNvZGUgaW1hZ2UuIEZvcmNlIGFueSBzdWNoIHBpeGVsIHRvIGJlIHdoaXRlOgoKCSAgICBpZiAoYWxwaGEgPT09IDApIHsKCSAgICAgIGdyYXkgPSAweEZGOwoJICAgIH0gZWxzZSB7CgkgICAgICB2YXIgcGl4ZWxSID0gaW1hZ2VCdWZmZXJbaV07CgkgICAgICB2YXIgcGl4ZWxHID0gaW1hZ2VCdWZmZXJbaSArIDFdOwoJICAgICAgdmFyIHBpeGVsQiA9IGltYWdlQnVmZmVyW2kgKyAyXTsgLy8gLjI5OVIgKyAwLjU4N0cgKyAwLjExNEIgKFlVVi9ZSVEgZm9yIFBBTCBhbmQgTlRTQyksCgkgICAgICAvLyAoMzA2KlIpID4+IDEwIGlzIGFwcHJveGltYXRlbHkgZXF1YWwgdG8gUiowLjI5OSwgYW5kIHNvIG9uLgoJICAgICAgLy8gMHgyMDAgPj4gMTAgaXMgMC41LCBpdCBpbXBsZW1lbnRzIHJvdW5kaW5nLgoKCSAgICAgIGdyYXkgPSAzMDYgKiBwaXhlbFIgKyA2MDEgKiBwaXhlbEcgKyAxMTcgKiBwaXhlbEIgKyAweDIwMCA+PiAxMDsKCSAgICB9CgoJICAgIGdyYXlzY2FsZUJ1ZmZlcltqXSA9IGdyYXk7CgkgIH0KCgkgIHJldHVybiBncmF5c2NhbGVCdWZmZXI7Cgl9OwoKCXZhciByZWFkZXIgPSBuZXcgX2RlZmF1bHQoKTsKCXNlbGYuYWRkRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIGZ1bmN0aW9uIChlKSB7CgkgIC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCgkgIHRyeSB7CgkgICAgdmFyIGx1bWluYW5jZXMgPSB0b0dyYXlzY2FsZUJ1ZmZlcihlLmRhdGEuZGF0YSwgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgbHVtaW5hbmNlU291cmNlID0gbmV3IF9kZWZhdWx0JDEobHVtaW5hbmNlcywgZS5kYXRhLndpZHRoLCBlLmRhdGEuaGVpZ2h0KTsKCSAgICB2YXIgaHlicmlkQmluYXJpemVyID0gbmV3IF9kZWZhdWx0JDIobHVtaW5hbmNlU291cmNlKTsKCSAgICB2YXIgYmluYXJ5Qml0bWFwID0gbmV3IF9kZWZhdWx0JDMoaHlicmlkQmluYXJpemVyKTsKCSAgICB2YXIgZGVjb2RlZCA9IHJlYWRlci5kZWNvZGUoYmluYXJ5Qml0bWFwKTsKCSAgICBwb3N0TWVzc2FnZShkZWNvZGVkKTsKCSAgfSBjYXRjaCAoZXJyKSB7CgkgICAgcG9zdE1lc3NhZ2UobnVsbCk7CgkgIH0KCX0pOwoKfSkoKTsKCg==",null,!1),P=["constraints","onError","onLoad","onScan","resolution","qrArea"];function O(e,g){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);g&&(n=n.filter((function(g){return Object.getOwnPropertyDescriptor(e,g).enumerable}))),t.push.apply(t,n)}return t}function _(e){for(var g=1;g<arguments.length;g++){var t=null!=arguments[g]?arguments[g]:{};g%2?O(Object(t),!0).forEach((function(g){I(e,g,t[g])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(g){Object.defineProperty(e,g,Object.getOwnPropertyDescriptor(t,g))}))}return e}var q=function(){return new j},$=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().forEach((function(g){e.removeTrack(g),g.stop()})),e.getAudioTracks().forEach((function(g){e.removeTrack(g),g.stop()}))):e.stop())},ee=function(e){var g=e.constraints,I=e.onError,r=e.onLoad,C=e.onScan,l=e.resolution,a=e.qrArea,o=u(e,P),c=t.useRef(null),s=t.useRef(null),A=t.useRef(document.createElement("canvas")),d=t.useRef(null),m=t.useRef(),h=i(t.useState(null),2),b=h[0],Z=h[1],p=t.useRef(!1),y=t.useRef();t.useEffect((function(){y.current=q();var e=y.current;return e.onmessage=function(e){C&&C(e.data?_(_({},e.data),{},{canvas:A.current}):null),p.current=!1},function(){e.terminate()}}),[C]);var G=JSON.stringify(a),f=t.useCallback((function(){var e=JSON.parse(G),g=y.current,t=s.current&&s.current.readyState===s.current.HAVE_ENOUGH_DATA;if(!p.current&&t){p.current=!0;var n,I=s.current.videoWidth,r=s.current.videoHeight,C=I>r?I:r,a=Math.floor(l/C*100)/100;r=Math.floor(a*r),I=Math.floor(a*I),A.current.width=I,A.current.height=r,d.current=A.current.getContext("2d"),d.current.drawImage(s.current,0,0,I,r),n=e&&2===e.length&&e[0]>0&&e[1]>0?d.current.getImageData(Math.floor((I-e[0])/2),Math.floor((r-e[1])/2),e[0],e[1]):d.current.getImageData(0,0,I,r),g.postMessage(n)}m.current=requestAnimationFrame(f)}),[l,G]),B=JSON.stringify(g);return t.useEffect((function(){var e=JSON.parse(B),g=!0;return navigator.mediaDevices.getUserMedia(e).then((function(e){if(g){c.current=e;try{s.current&&(s.current.srcObject=e,s.current.setAttribute("playsinline",!0))}catch(t){Z(window.URL.createObjectURL(e))}r&&r(),m.current=requestAnimationFrame(f)}else $(e)})).catch((function(e){return g?I(e):null})),function(){cancelAnimationFrame(m.current),g=!1,$(c.current),b&&window.URL.revokeObjectURL(b)}}),[f,B,I,r,b]),t.createElement("video",n({autoPlay:!0,playsInline:!0,src:b,ref:s},o))};return ee.propTypes={constraints:Q.object,onError:Q.func.isRequired,onLoad:Q.func,onScan:Q.func.isRequired,resolution:Q.number,qrArea:Q.array},ee.defaultProps={constraints:{audio:!1,video:!0},resolution:640,qrArea:[]},ee}(t(2791))},6374:function(e,g,t){"use strict";var n=t(2791),I=Symbol.for("react.element"),r=Symbol.for("react.fragment"),C=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(e,g,t){var n,r={},o=null,i=null;for(n in void 0!==t&&(o=""+t),void 0!==g.key&&(o=""+g.key),void 0!==g.ref&&(i=g.ref),g)C.call(g,n)&&!a.hasOwnProperty(n)&&(r[n]=g[n]);if(e&&e.defaultProps)for(n in g=e.defaultProps)void 0===r[n]&&(r[n]=g[n]);return{$$typeof:I,type:e,key:o,ref:i,props:r,_owner:l.current}}g.Fragment=r,g.jsx=o,g.jsxs=o},9117:function(e,g){"use strict";var t=Symbol.for("react.element"),n=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),i=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),s=Symbol.iterator;var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},d=Object.assign,m={};function h(e,g,t){this.props=e,this.context=g,this.refs=m,this.updater=t||A}function b(){}function Z(e,g,t){this.props=e,this.context=g,this.refs=m,this.updater=t||A}h.prototype.isReactComponent={},h.prototype.setState=function(e,g){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,g,"setState")},h.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=h.prototype;var p=Z.prototype=new b;p.constructor=Z,d(p,h.prototype),p.isPureReactComponent=!0;var y=Array.isArray,G=Object.prototype.hasOwnProperty,f={current:null},B={key:!0,ref:!0,__self:!0,__source:!0};function v(e,g,n){var I,r={},C=null,l=null;if(null!=g)for(I in void 0!==g.ref&&(l=g.ref),void 0!==g.key&&(C=""+g.key),g)G.call(g,I)&&!B.hasOwnProperty(I)&&(r[I]=g[I]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var o=Array(a),i=0;i<a;i++)o[i]=arguments[i+2];r.children=o}if(e&&e.defaultProps)for(I in a=e.defaultProps)void 0===r[I]&&(r[I]=a[I]);return{$$typeof:t,type:e,key:C,ref:l,props:r,_owner:f.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===t}var W=/\/+/g;function V(e,g){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var g={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return g[e]}))}(""+e.key):g.toString(36)}function k(e,g,I,r,C){var l=typeof e;"undefined"!==l&&"boolean"!==l||(e=null);var a=!1;if(null===e)a=!0;else switch(l){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case t:case n:a=!0}}if(a)return C=C(a=e),e=""===r?"."+V(a,0):r,y(C)?(I="",null!=e&&(I=e.replace(W,"$&/")+"/"),k(C,g,I,"",(function(e){return e}))):null!=C&&(S(C)&&(C=function(e,g){return{$$typeof:t,type:e.type,key:g,ref:e.ref,props:e.props,_owner:e._owner}}(C,I+(!C.key||a&&a.key===C.key?"":(""+C.key).replace(W,"$&/")+"/")+e)),g.push(C)),1;if(a=0,r=""===r?".":r+":",y(e))for(var o=0;o<e.length;o++){var i=r+V(l=e[o],o);a+=k(l,g,I,i,C)}else if(i=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=s&&e[s]||e["@@iterator"])?e:null}(e),"function"===typeof i)for(e=i.call(e),o=0;!(l=e.next()).done;)a+=k(l=l.value,g,I,i=r+V(l,o++),C);else if("object"===l)throw g=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===g?"object with keys {"+Object.keys(e).join(", ")+"}":g)+"). If you meant to render a collection of children, use an array instead.");return a}function R(e,g,t){if(null==e)return e;var n=[],I=0;return k(e,n,"","",(function(e){return g.call(t,e,I++)})),n}function X(e){if(-1===e._status){var g=e._result;(g=g()).then((function(g){0!==e._status&&-1!==e._status||(e._status=1,e._result=g)}),(function(g){0!==e._status&&-1!==e._status||(e._status=2,e._result=g)})),-1===e._status&&(e._status=0,e._result=g)}if(1===e._status)return e._result.default;throw e._result}var J={current:null},Y={transition:null},w={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:Y,ReactCurrentOwner:f};g.Children={map:R,forEach:function(e,g,t){R(e,(function(){g.apply(this,arguments)}),t)},count:function(e){var g=0;return R(e,(function(){g++})),g},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},g.Component=h,g.Fragment=I,g.Profiler=C,g.PureComponent=Z,g.StrictMode=r,g.Suspense=i,g.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w,g.cloneElement=function(e,g,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var I=d({},e.props),r=e.key,C=e.ref,l=e._owner;if(null!=g){if(void 0!==g.ref&&(C=g.ref,l=f.current),void 0!==g.key&&(r=""+g.key),e.type&&e.type.defaultProps)var a=e.type.defaultProps;for(o in g)G.call(g,o)&&!B.hasOwnProperty(o)&&(I[o]=void 0===g[o]&&void 0!==a?a[o]:g[o])}var o=arguments.length-2;if(1===o)I.children=n;else if(1<o){a=Array(o);for(var i=0;i<o;i++)a[i]=arguments[i+2];I.children=a}return{$$typeof:t,type:e.type,key:r,ref:C,props:I,_owner:l}},g.createContext=function(e){return(e={$$typeof:a,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},g.createElement=v,g.createFactory=function(e){var g=v.bind(null,e);return g.type=e,g},g.createRef=function(){return{current:null}},g.forwardRef=function(e){return{$$typeof:o,render:e}},g.isValidElement=S,g.lazy=function(e){return{$$typeof:u,_payload:{_status:-1,_result:e},_init:X}},g.memo=function(e,g){return{$$typeof:c,type:e,compare:void 0===g?null:g}},g.startTransition=function(e){var g=Y.transition;Y.transition={};try{e()}finally{Y.transition=g}},g.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},g.useCallback=function(e,g){return J.current.useCallback(e,g)},g.useContext=function(e){return J.current.useContext(e)},g.useDebugValue=function(){},g.useDeferredValue=function(e){return J.current.useDeferredValue(e)},g.useEffect=function(e,g){return J.current.useEffect(e,g)},g.useId=function(){return J.current.useId()},g.useImperativeHandle=function(e,g,t){return J.current.useImperativeHandle(e,g,t)},g.useInsertionEffect=function(e,g){return J.current.useInsertionEffect(e,g)},g.useLayoutEffect=function(e,g){return J.current.useLayoutEffect(e,g)},g.useMemo=function(e,g){return J.current.useMemo(e,g)},g.useReducer=function(e,g,t){return J.current.useReducer(e,g,t)},g.useRef=function(e){return J.current.useRef(e)},g.useState=function(e){return J.current.useState(e)},g.useSyncExternalStore=function(e,g,t){return J.current.useSyncExternalStore(e,g,t)},g.useTransition=function(){return J.current.useTransition()},g.version="18.2.0"},2791:function(e,g,t){"use strict";e.exports=t(9117)},184:function(e,g,t){"use strict";e.exports=t(6374)},6813:function(e,g){"use strict";function t(e,g){var t=e.length;e.push(g);e:for(;0<t;){var n=t-1>>>1,I=e[n];if(!(0<r(I,g)))break e;e[n]=g,e[t]=I,t=n}}function n(e){return 0===e.length?null:e[0]}function I(e){if(0===e.length)return null;var g=e[0],t=e.pop();if(t!==g){e[0]=t;e:for(var n=0,I=e.length,C=I>>>1;n<C;){var l=2*(n+1)-1,a=e[l],o=l+1,i=e[o];if(0>r(a,t))o<I&&0>r(i,a)?(e[n]=i,e[o]=t,n=o):(e[n]=a,e[l]=t,n=l);else{if(!(o<I&&0>r(i,t)))break e;e[n]=i,e[o]=t,n=o}}}return g}function r(e,g){var t=e.sortIndex-g.sortIndex;return 0!==t?t:e.id-g.id}if("object"===typeof performance&&"function"===typeof performance.now){var C=performance;g.unstable_now=function(){return C.now()}}else{var l=Date,a=l.now();g.unstable_now=function(){return l.now()-a}}var o=[],i=[],c=1,u=null,s=3,A=!1,d=!1,m=!1,h="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,Z="undefined"!==typeof setImmediate?setImmediate:null;function p(e){for(var g=n(i);null!==g;){if(null===g.callback)I(i);else{if(!(g.startTime<=e))break;I(i),g.sortIndex=g.expirationTime,t(o,g)}g=n(i)}}function y(e){if(m=!1,p(e),!d)if(null!==n(o))d=!0,Y(G);else{var g=n(i);null!==g&&w(y,g.startTime-e)}}function G(e,t){d=!1,m&&(m=!1,b(S),S=-1),A=!0;var r=s;try{for(p(t),u=n(o);null!==u&&(!(u.expirationTime>t)||e&&!k());){var C=u.callback;if("function"===typeof C){u.callback=null,s=u.priorityLevel;var l=C(u.expirationTime<=t);t=g.unstable_now(),"function"===typeof l?u.callback=l:u===n(o)&&I(o),p(t)}else I(o);u=n(o)}if(null!==u)var a=!0;else{var c=n(i);null!==c&&w(y,c.startTime-t),a=!1}return a}finally{u=null,s=r,A=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var f,B=!1,v=null,S=-1,W=5,V=-1;function k(){return!(g.unstable_now()-V<W)}function R(){if(null!==v){var e=g.unstable_now();V=e;var t=!0;try{t=v(!0,e)}finally{t?f():(B=!1,v=null)}}else B=!1}if("function"===typeof Z)f=function(){Z(R)};else if("undefined"!==typeof MessageChannel){var X=new MessageChannel,J=X.port2;X.port1.onmessage=R,f=function(){J.postMessage(null)}}else f=function(){h(R,0)};function Y(e){v=e,B||(B=!0,f())}function w(e,t){S=h((function(){e(g.unstable_now())}),t)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(e){e.callback=null},g.unstable_continueExecution=function(){d||A||(d=!0,Y(G))},g.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<e?Math.floor(1e3/e):5},g.unstable_getCurrentPriorityLevel=function(){return s},g.unstable_getFirstCallbackNode=function(){return n(o)},g.unstable_next=function(e){switch(s){case 1:case 2:case 3:var g=3;break;default:g=s}var t=s;s=g;try{return e()}finally{s=t}},g.unstable_pauseExecution=function(){},g.unstable_requestPaint=function(){},g.unstable_runWithPriority=function(e,g){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var t=s;s=e;try{return g()}finally{s=t}},g.unstable_scheduleCallback=function(e,I,r){var C=g.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?C+r:C:r=C,e){case 1:var l=-1;break;case 2:l=250;break;case 5:l=1073741823;break;case 4:l=1e4;break;default:l=5e3}return e={id:c++,callback:I,priorityLevel:e,startTime:r,expirationTime:l=r+l,sortIndex:-1},r>C?(e.sortIndex=r,t(i,e),null===n(o)&&e===n(i)&&(m?(b(S),S=-1):m=!0,w(y,r-C))):(e.sortIndex=l,t(o,e),d||A||(d=!0,Y(G))),e},g.unstable_shouldYield=k,g.unstable_wrapCallback=function(e){var g=s;return function(){var t=s;s=g;try{return e.apply(this,arguments)}finally{s=t}}}},5296:function(e,g,t){"use strict";e.exports=t(6813)},1564:function(e){var g=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['\u2019](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['\u2019](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['\u2019](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,t=function(e){return e.match(g)||[]},n=function(e){return e[0].toUpperCase()+e.slice(1)},I=function(e,g){return t(e).join(g).toLowerCase()},r=function(e){return t(e).reduce((function(e,g){return"".concat(e).concat(e?g[0].toUpperCase()+g.slice(1).toLowerCase():g.toLowerCase())}),"")};e.exports={words:t,upperFirst:n,camelCase:r,pascalCase:function(e){return n(r(e))},snakeCase:function(e){return I(e,"_")},kebabCase:function(e){return I(e,"-")},sentenceCase:function(e){return n(I(e," "))},titleCase:function(e){return t(e).map(n).join(" ")}}},6514:function(e){function g(e,g){var t=e.length,n=new Array(t),I={},r=t,C=function(e){for(var g=new Map,t=0,n=e.length;t<n;t++){var I=e[t];g.has(I[0])||g.set(I[0],new Set),g.has(I[1])||g.set(I[1],new Set),g.get(I[0]).add(I[1])}return g}(g),l=function(e){for(var g=new Map,t=0,n=e.length;t<n;t++)g.set(e[t],t);return g}(e);for(g.forEach((function(e){if(!l.has(e[0])||!l.has(e[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")}));r--;)I[r]||a(e[r],r,new Set);return n;function a(e,g,r){if(r.has(e)){var o;try{o=", node was:"+JSON.stringify(e)}catch(u){o=""}throw new Error("Cyclic dependency"+o)}if(!l.has(e))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(e));if(!I[g]){I[g]=!0;var i=C.get(e)||new Set;if(g=(i=Array.from(i)).length){r.add(e);do{var c=i[--g];a(c,l.get(c),r)}while(g);r.delete(e)}n[--t]=e}}}e.exports=function(e){return g(function(e){for(var g=new Set,t=0,n=e.length;t<n;t++){var I=e[t];g.add(I[0]),g.add(I[1])}return Array.from(g)}(e),e)},e.exports.array=g},2391:function(e){"use strict";var g=function(){};e.exports=g},2074:function(e,g,t){"use strict";e.exports=t.p+"static/media/logo jovi.f2a7f5342b9aac68cd0c.png"},6601:function(){}},g={};function t(n){var I=g[n];if(void 0!==I)return I.exports;var r=g[n]={id:n,loaded:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.loaded=!0,r.exports}t.m=e,t.amdO={},t.n=function(e){var g=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(g,{a:g}),g},function(){var e,g=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};t.t=function(n,I){if(1&I&&(n=this(n)),8&I)return n;if("object"===typeof n&&n){if(4&I&&n.__esModule)return n;if(16&I&&"function"===typeof n.then)return n}var r=Object.create(null);t.r(r);var C={};e=e||[null,g({}),g([]),g(g)];for(var l=2&I&&n;"object"==typeof l&&!~e.indexOf(l);l=g(l))Object.getOwnPropertyNames(l).forEach((function(e){C[e]=function(){return n[e]}}));return C.default=function(){return n},t.d(r,C),r}}(),t.d=function(e,g){for(var n in g)t.o(g,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:g[n]})},t.f={},t.e=function(e){return Promise.all(Object.keys(t.f).reduce((function(g,n){return t.f[n](e,g),g}),[]))},t.u=function(e){return"static/js/"+e+".c4e7f8f9.chunk.js"},t.miniCssF=function(e){},t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),t.o=function(e,g){return Object.prototype.hasOwnProperty.call(e,g)},function(){var e={},g="client:";t.l=function(n,I,r,C){if(e[n])e[n].push(I);else{var l,a;if(void 0!==r)for(var o=document.getElementsByTagName("script"),i=0;i<o.length;i++){var c=o[i];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==g+r){l=c;break}}l||(a=!0,(l=document.createElement("script")).charset="utf-8",l.timeout=120,t.nc&&l.setAttribute("nonce",t.nc),l.setAttribute("data-webpack",g+r),l.src=n),e[n]=[I];var u=function(g,t){l.onerror=l.onload=null,clearTimeout(s);var I=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),I&&I.forEach((function(e){return e(t)})),g)return g(t)},s=setTimeout(u.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=u.bind(null,l.onerror),l.onload=u.bind(null,l.onload),a&&document.head.appendChild(l)}}}(),t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},t.p="/Shiptory/",function(){var e={179:0};t.f.j=function(g,n){var I=t.o(e,g)?e[g]:void 0;if(0!==I)if(I)n.push(I[2]);else{var r=new Promise((function(t,n){I=e[g]=[t,n]}));n.push(I[2]=r);var C=t.p+t.u(g),l=new Error;t.l(C,(function(n){if(t.o(e,g)&&(0!==(I=e[g])&&(e[g]=void 0),I)){var r=n&&("load"===n.type?"missing":n.type),C=n&&n.target&&n.target.src;l.message="Loading chunk "+g+" failed.\n("+r+": "+C+")",l.name="ChunkLoadError",l.type=r,l.request=C,I[1](l)}}),"chunk-"+g,g)}};var g=function(g,n){var I,r,C=n[0],l=n[1],a=n[2],o=0;if(C.some((function(g){return 0!==e[g]}))){for(I in l)t.o(l,I)&&(t.m[I]=l[I]);if(a)a(t)}for(g&&g(n);o<C.length;o++)r=C[o],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0},n=self.webpackChunkclient=self.webpackChunkclient||[];n.forEach(g.bind(null,0)),n.push=g.bind(null,n.push.bind(n))}(),function(){"use strict";var e=t(2791),g=t.t(e,2),n=t(1250);function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function r(e){var g=function(e,g){if("object"!==I(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,g||"default");if("object"!==I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===g?String:Number)(e)}(e,"string");return"symbol"===I(g)?g:String(g)}function C(e,g,t){return(g=r(g))in e?Object.defineProperty(e,g,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[g]=t,e}function l(e){if(Array.isArray(e))return e}function a(e,g){(null==g||g>e.length)&&(g=e.length);for(var t=0,n=new Array(g);t<g;t++)n[t]=e[t];return n}function o(e,g){if(e){if("string"===typeof e)return a(e,g);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?a(e,g):void 0}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,g){return l(e)||function(e,g){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,I,r,C,l=[],a=!0,o=!1;try{if(r=(t=t.call(e)).next,0===g){if(Object(t)!==t)return;a=!1}else for(;!(a=(n=r.call(t)).done)&&(l.push(n.value),l.length!==g);a=!0);}catch(i){o=!0,I=i}finally{try{if(!a&&null!=t.return&&(C=t.return(),Object(C)!==C))return}finally{if(o)throw I}}return l}}(e,g)||o(e,g)||i()}function u(e,g){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);g&&(n=n.filter((function(g){return Object.getOwnPropertyDescriptor(e,g).enumerable}))),t.push.apply(t,n)}return t}function s(e){for(var g=1;g<arguments.length;g++){var t=null!=arguments[g]?arguments[g]:{};g%2?u(Object(t),!0).forEach((function(g){C(e,g,t[g])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):u(Object(t)).forEach((function(g){Object.defineProperty(e,g,Object.getOwnPropertyDescriptor(t,g))}))}return e}function A(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}function d(e,g){if(null==e)return{};var t,n,I=A(e,g);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(I[t]=e[t])}return I}function m(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function h(e){return function(e){if(Array.isArray(e))return a(e)}(e)||m(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){var g,t,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(g=0;g<e.length;g++)e[g]&&(t=b(e[g]))&&(n&&(n+=" "),n+=t);else for(g in e)e[g]&&(n&&(n+=" "),n+=g);return n}var Z=function(){for(var e,g,t=0,n="";t<arguments.length;)(e=arguments[t++])&&(g=b(e))&&(n&&(n+=" "),n+=g);return n},p=["theme","type"],y=["delay","staleId"],G=function(e){return"number"==typeof e&&!isNaN(e)},f=function(e){return"string"==typeof e},B=function(e){return"function"==typeof e},v=function(e){return f(e)||B(e)?e:null},S=function(g){return(0,e.isValidElement)(g)||f(g)||B(g)||G(g)};function W(g){var t=g.enter,n=g.exit,I=g.appendPosition,r=void 0!==I&&I,C=g.collapse,l=void 0===C||C,a=g.collapseDuration,o=void 0===a?300:a;return function(g){var I=g.children,C=g.position,a=g.preventExitTransition,i=g.done,c=g.nodeRef,u=g.isIn,s=r?"".concat(t,"--").concat(C):t,A=r?"".concat(n,"--").concat(C):n,d=(0,e.useRef)(0);return(0,e.useLayoutEffect)((function(){var e,g=c.current,t=s.split(" "),n=function e(n){var I;n.target===c.current&&(g.dispatchEvent(new Event("d")),g.removeEventListener("animationend",e),g.removeEventListener("animationcancel",e),0===d.current&&"animationcancel"!==n.type&&(I=g.classList).remove.apply(I,h(t)))};(e=g.classList).add.apply(e,h(t)),g.addEventListener("animationend",n),g.addEventListener("animationcancel",n)}),[]),(0,e.useEffect)((function(){var e=c.current,g=function g(){e.removeEventListener("animationend",g),l?function(e,g,t){void 0===t&&(t=300);var n=e.scrollHeight,I=e.style;requestAnimationFrame((function(){I.minHeight="initial",I.height=n+"px",I.transition="all ".concat(t,"ms"),requestAnimationFrame((function(){I.height="0",I.padding="0",I.margin="0",setTimeout(g,t)}))}))}(e,i,o):i()};u||(a?g():(d.current=1,e.className+=" ".concat(A),e.addEventListener("animationend",g)))}),[u]),e.createElement(e.Fragment,null,I)}}function V(e,g){return null!=e?{content:e.content,containerId:e.props.containerId,id:e.props.toastId,theme:e.props.theme,type:e.props.type,data:e.props.data||{},isLoading:e.props.isLoading,icon:e.props.icon,status:g}:{}}var k={list:new Map,emitQueue:new Map,on:function(e,g){return this.list.has(e)||this.list.set(e,[]),this.list.get(e).push(g),this},off:function(e,g){if(g){var t=this.list.get(e).filter((function(e){return e!==g}));return this.list.set(e,t),this}return this.list.delete(e),this},cancelEmit:function(e){var g=this.emitQueue.get(e);return g&&(g.forEach(clearTimeout),this.emitQueue.delete(e)),this},emit:function(e){var g=arguments,t=this;this.list.has(e)&&this.list.get(e).forEach((function(n){var I=setTimeout((function(){n.apply(void 0,h([].slice.call(g,1)))}),0);t.emitQueue.has(e)||t.emitQueue.set(e,[]),t.emitQueue.get(e).push(I)}))}},R=function(g){var t=g.theme,n=g.type,I=d(g,p);return e.createElement("svg",s({viewBox:"0 0 24 24",width:"100%",height:"100%",fill:"colored"===t?"currentColor":"var(--toastify-icon-color-".concat(n,")")},I))},X={info:function(g){return e.createElement(R,s({},g),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(g){return e.createElement(R,s({},g),e.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(g){return e.createElement(R,s({},g),e.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(g){return e.createElement(R,s({},g),e.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return e.createElement("div",{className:"Toastify__spinner"})}};function J(g){var t=(0,e.useReducer)((function(e){return e+1}),0),n=c(t,2)[1],I=c((0,e.useState)([]),2),r=I[0],C=I[1],l=(0,e.useRef)(null),a=(0,e.useRef)(new Map).current,o=function(e){return-1!==r.indexOf(e)},i=(0,e.useRef)({toastKey:1,displayedToast:0,count:0,queue:[],props:g,containerId:null,isToastActive:o,getToast:function(e){return a.get(e)}}).current;function u(e){var g=e.containerId;!i.props.limit||g&&i.containerId!==g||(i.count-=i.queue.length,i.queue=[])}function A(e){C((function(g){return null==e?[]:g.filter((function(g){return g!==e}))}))}function m(){var e=i.queue.shift();Z(e.toastContent,e.toastProps,e.staleId)}function b(g,t){var I=t.delay,r=t.staleId,C=d(t,y);if(S(g)&&!function(e){return!l.current||i.props.enableMultiContainer&&e.containerId!==i.props.containerId||a.has(e.toastId)&&null==e.updateId}(C)){var o=C.toastId,u=C.updateId,h=C.data,b=i.props,p=function(){return A(o)},W=null==u;W&&i.count++;var R,J,Y=s(s(s({},b),{},{style:b.toastStyle,key:i.toastKey++},Object.fromEntries(Object.entries(C).filter((function(e){var g=c(e,2);g[0];return null!=g[1]})))),{},{toastId:o,updateId:u,data:h,closeToast:p,isIn:!1,className:v(C.className||b.toastClassName),bodyClassName:v(C.bodyClassName||b.bodyClassName),progressClassName:v(C.progressClassName||b.progressClassName),autoClose:!C.isLoading&&(R=C.autoClose,J=b.autoClose,!1===R||G(R)&&R>0?R:J),deleteToast:function(){var e=V(a.get(o),"removed");a.delete(o),k.emit(4,e);var g=i.queue.length;if(i.count=null==o?i.count-i.displayedToast:i.count-1,i.count<0&&(i.count=0),g>0){var t=null==o?i.props.limit:1;if(1===g||1===t)i.displayedToast++,m();else{var I=t>g?g:t;i.displayedToast=I;for(var r=0;r<I;r++)m()}}else n()}});Y.iconOut=function(g){var t=g.theme,n=g.type,I=g.isLoading,r=g.icon,C=null,l={theme:t,type:n};return!1===r||(B(r)?C=r(l):(0,e.isValidElement)(r)?C=(0,e.cloneElement)(r,l):f(r)||G(r)?C=r:I?C=X.spinner():function(e){return e in X}(n)&&(C=X[n](l))),C}(Y),B(C.onOpen)&&(Y.onOpen=C.onOpen),B(C.onClose)&&(Y.onClose=C.onClose),Y.closeButton=b.closeButton,!1===C.closeButton||S(C.closeButton)?Y.closeButton=C.closeButton:!0===C.closeButton&&(Y.closeButton=!S(b.closeButton)||b.closeButton);var w=g;(0,e.isValidElement)(g)&&!f(g.type)?w=(0,e.cloneElement)(g,{closeToast:p,toastProps:Y,data:h}):B(g)&&(w=g({closeToast:p,toastProps:Y,data:h})),b.limit&&b.limit>0&&i.count>b.limit&&W?i.queue.push({toastContent:w,toastProps:Y,staleId:r}):G(I)?setTimeout((function(){Z(w,Y,r)}),I):Z(w,Y,r)}}function Z(e,g,t){var n=g.toastId;t&&a.delete(t);var I={content:e,props:g};a.set(n,I),C((function(e){return[].concat(h(e),[n]).filter((function(e){return e!==t}))})),k.emit(4,V(I,null==I.props.updateId?"added":"updated"))}return(0,e.useEffect)((function(){return i.containerId=g.containerId,k.cancelEmit(3).on(0,b).on(1,(function(e){return l.current&&A(e)})).on(5,u).emit(2,i),function(){a.clear(),k.emit(3,i)}}),[]),(0,e.useEffect)((function(){i.props=g,i.isToastActive=o,i.displayedToast=r.length})),{getToastToRender:function(e){var t=new Map,n=Array.from(a.values());return g.newestOnTop&&n.reverse(),n.forEach((function(e){var g=e.props.position;t.has(g)||t.set(g,[]),t.get(g).push(e)})),Array.from(t,(function(g){return e(g[0],g[1])}))},containerRef:l,isToastActive:o}}function Y(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientX:e.clientX}function w(e){return e.targetTouches&&e.targetTouches.length>=1?e.targetTouches[0].clientY:e.clientY}function H(g){var t=c((0,e.useState)(!1),2),n=t[0],I=t[1],r=c((0,e.useState)(!1),2),C=r[0],l=r[1],a=(0,e.useRef)(null),o=(0,e.useRef)({start:0,x:0,y:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,boundingRect:null,didMove:!1}).current,i=(0,e.useRef)(g),u=g.autoClose,s=g.pauseOnHover,A=g.closeToast,d=g.onClick,m=g.closeOnClick;function h(e){if(g.draggable){"touchstart"===e.nativeEvent.type&&e.nativeEvent.preventDefault(),o.didMove=!1,document.addEventListener("mousemove",y),document.addEventListener("mouseup",G),document.addEventListener("touchmove",y),document.addEventListener("touchend",G);var t=a.current;o.canCloseOnClick=!0,o.canDrag=!0,o.boundingRect=t.getBoundingClientRect(),t.style.transition="",o.x=Y(e.nativeEvent),o.y=w(e.nativeEvent),"x"===g.draggableDirection?(o.start=o.x,o.removalDistance=t.offsetWidth*(g.draggablePercent/100)):(o.start=o.y,o.removalDistance=t.offsetHeight*(80===g.draggablePercent?1.5*g.draggablePercent:g.draggablePercent/100))}}function b(e){if(o.boundingRect){var t=o.boundingRect,n=t.top,I=t.bottom,r=t.left,C=t.right;"touchend"!==e.nativeEvent.type&&g.pauseOnHover&&o.x>=r&&o.x<=C&&o.y>=n&&o.y<=I?p():Z()}}function Z(){I(!0)}function p(){I(!1)}function y(e){var t=a.current;o.canDrag&&t&&(o.didMove=!0,n&&p(),o.x=Y(e),o.y=w(e),o.delta="x"===g.draggableDirection?o.x-o.start:o.y-o.start,o.start!==o.x&&(o.canCloseOnClick=!1),t.style.transform="translate".concat(g.draggableDirection,"(").concat(o.delta,"px)"),t.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function G(){document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",G),document.removeEventListener("touchmove",y),document.removeEventListener("touchend",G);var e=a.current;if(o.canDrag&&o.didMove&&e){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return l(!0),void g.closeToast();e.style.transition="transform 0.2s, opacity 0.2s",e.style.transform="translate".concat(g.draggableDirection,"(0)"),e.style.opacity="1"}}(0,e.useEffect)((function(){i.current=g})),(0,e.useEffect)((function(){return a.current&&a.current.addEventListener("d",Z,{once:!0}),B(g.onOpen)&&g.onOpen((0,e.isValidElement)(g.children)&&g.children.props),function(){var g=i.current;B(g.onClose)&&g.onClose((0,e.isValidElement)(g.children)&&g.children.props)}}),[]),(0,e.useEffect)((function(){return g.pauseOnFocusLoss&&(document.hasFocus()||p(),window.addEventListener("focus",Z),window.addEventListener("blur",p)),function(){g.pauseOnFocusLoss&&(window.removeEventListener("focus",Z),window.removeEventListener("blur",p))}}),[g.pauseOnFocusLoss]);var f={onMouseDown:h,onTouchStart:h,onMouseUp:b,onTouchEnd:b};return u&&s&&(f.onMouseEnter=p,f.onMouseLeave=Z),m&&(f.onClick=function(e){d&&d(e),o.canCloseOnClick&&A()}),{playToast:Z,pauseToast:p,isRunning:n,preventExitTransition:C,toastRef:a,eventHandlers:f}}function N(g){var t=g.closeToast,n=g.theme,I=g.ariaLabel,r=void 0===I?"close":I;return e.createElement("button",{className:"Toastify__close-button Toastify__close-button--".concat(n),type:"button",onClick:function(e){e.stopPropagation(),t(e)},"aria-label":r},e.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},e.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function F(g){var t=g.delay,n=g.isRunning,I=g.closeToast,r=g.type,l=void 0===r?"default":r,a=g.hide,o=g.className,i=g.style,c=g.controlledProgress,u=g.progress,A=g.rtl,d=g.isIn,m=g.theme,h=a||c&&0===u,b=s(s({},i),{},{animationDuration:"".concat(t,"ms"),animationPlayState:n?"running":"paused",opacity:h?0:1});c&&(b.transform="scaleX(".concat(u,")"));var p=Z("Toastify__progress-bar",c?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated","Toastify__progress-bar-theme--".concat(m),"Toastify__progress-bar--".concat(l),{"Toastify__progress-bar--rtl":A}),y=B(o)?o({rtl:A,type:l,defaultClassName:p}):Z(p,o);return e.createElement("div",C({role:"progressbar","aria-hidden":h?"true":"false","aria-label":"notification timer",className:y,style:b},c&&u>=1?"onTransitionEnd":"onAnimationEnd",c&&u<1?null:function(){d&&I()}))}var K=function(g){var t=H(g),n=t.isRunning,I=t.preventExitTransition,r=t.toastRef,C=t.eventHandlers,l=g.closeButton,a=g.children,o=g.autoClose,i=g.onClick,c=g.type,u=g.hideProgressBar,A=g.closeToast,d=g.transition,m=g.position,h=g.className,b=g.style,p=g.bodyClassName,y=g.bodyStyle,G=g.progressClassName,f=g.progressStyle,v=g.updateId,S=g.role,W=g.progress,V=g.rtl,k=g.toastId,R=g.deleteToast,X=g.isIn,J=g.isLoading,Y=g.iconOut,w=g.closeOnClick,K=g.theme,x=Z("Toastify__toast","Toastify__toast-theme--".concat(K),"Toastify__toast--".concat(c),{"Toastify__toast--rtl":V},{"Toastify__toast--close-on-click":w}),E=B(h)?h({rtl:V,position:m,type:c,defaultClassName:x}):Z(x,h),M=!!W||!o,z={closeToast:A,type:c,theme:K},U=null;return!1===l||(U=B(l)?l(z):(0,e.isValidElement)(l)?(0,e.cloneElement)(l,z):N(z)),e.createElement(d,{isIn:X,done:R,position:m,preventExitTransition:I,nodeRef:r},e.createElement("div",s(s({id:k,onClick:i,className:E},C),{},{style:b,ref:r}),e.createElement("div",s(s({},X&&{role:S}),{},{className:B(p)?p({type:c}):Z("Toastify__toast-body",p),style:y}),null!=Y&&e.createElement("div",{className:Z("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!J})},Y),e.createElement("div",null,a)),U,e.createElement(F,s(s({},v&&!M?{key:"pb-".concat(v)}:{}),{},{rtl:V,theme:K,delay:o,isRunning:n,isIn:X,closeToast:A,hide:u,type:c,style:f,className:G,controlledProgress:M,progress:W||0}))))},x=function(e,g){return void 0===g&&(g=!1),{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:g}},E=W(x("bounce",!0)),M=(W(x("slide",!0)),W(x("zoom")),W(x("flip")),(0,e.forwardRef)((function(g,t){var n=J(g),I=n.getToastToRender,r=n.containerRef,C=n.isToastActive,l=g.className,a=g.style,o=g.rtl,i=g.containerId;function c(e){var g=Z("Toastify__toast-container","Toastify__toast-container--".concat(e),{"Toastify__toast-container--rtl":o});return B(l)?l({position:e,rtl:o,defaultClassName:g}):Z(g,v(l))}return(0,e.useEffect)((function(){t&&(t.current=r.current)}),[]),e.createElement("div",{ref:r,className:"Toastify",id:i},I((function(g,t){var n=t.length?s({},a):s(s({},a),{},{pointerEvents:"none"});return e.createElement("div",{className:c(g),style:n,key:"container-".concat(g)},t.map((function(g,n){var I=g.content,r=g.props;return e.createElement(K,s(s({},r),{},{isIn:C(r.toastId),style:s(s({},r.style),{},{"--nth":n+1,"--len":t.length}),key:"toast-".concat(r.key)}),I)})))})))})));M.displayName="ToastContainer",M.defaultProps={position:"top-right",transition:E,autoClose:5e3,closeButton:N,pauseOnHover:!0,pauseOnFocusLoss:!0,closeOnClick:!0,draggable:!0,draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};var z,U=new Map,Q=[],L=1;function T(){return""+L++}function D(e){return e&&(f(e.toastId)||G(e.toastId))?e.toastId:T()}function j(e,g){return U.size>0?k.emit(0,e,g):Q.push({content:e,options:g}),g.toastId}function P(e,g){return s(s({},g),{},{type:g&&g.type||e,toastId:D(g)})}function O(e){return function(g,t){return j(g,P(e,t))}}function _(e,g){return j(e,P("default",g))}_.loading=function(e,g){return j(e,P("default",s({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},g)))},_.promise=function(e,g,t){var n,I=g.pending,r=g.error,C=g.success;I&&(n=f(I)?_.loading(I,t):_.loading(I.render,s(s({},t),I)));var l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},a=function(e,g,I){if(null!=g){var r=s(s(s({type:e},l),t),{},{data:I}),C=f(g)?{render:g}:g;return n?_.update(n,s(s({},r),C)):_(C.render,s(s({},r),C)),I}_.dismiss(n)},o=B(e)?e():e;return o.then((function(e){return a("success",C,e)})).catch((function(e){return a("error",r,e)})),o},_.success=O("success"),_.info=O("info"),_.error=O("error"),_.warning=O("warning"),_.warn=_.warning,_.dark=function(e,g){return j(e,P("default",s({theme:"dark"},g)))},_.dismiss=function(e){U.size>0?k.emit(1,e):Q=Q.filter((function(g){return null!=e&&g.options.toastId!==e}))},_.clearWaitingQueue=function(e){return void 0===e&&(e={}),k.emit(5,e)},_.isActive=function(e){var g=!1;return U.forEach((function(t){t.isToastActive&&t.isToastActive(e)&&(g=!0)})),g},_.update=function(e,g){void 0===g&&(g={}),setTimeout((function(){var t=function(e,g){var t=g.containerId,n=U.get(t||z);return n&&n.getToast(e)}(e,g);if(t){var n=t.props,I=t.content,r=s(s(s({delay:100},n),g),{},{toastId:g.toastId||e,updateId:T()});r.toastId!==e&&(r.staleId=e);var C=r.render||I;delete r.render,j(C,r)}}),0)},_.done=function(e){_.update(e,{progress:1})},_.onChange=function(e){return k.on(4,e),function(){k.off(4,e)}},_.POSITION={TOP_LEFT:"top-left",TOP_RIGHT:"top-right",TOP_CENTER:"top-center",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",BOTTOM_CENTER:"bottom-center"},_.TYPE={INFO:"info",SUCCESS:"success",WARNING:"warning",ERROR:"error",DEFAULT:"default"},k.on(2,(function(e){z=e.containerId||e,U.set(z,e),Q.forEach((function(e){k.emit(0,e.content,e.options)})),Q=[]})).on(3,(function(e){U.delete(e.containerId||e),0===U.size&&k.off(0).off(1).off(5)}));t(2074);var q=t(184),$=function(){return(0,q.jsx)("div",{style:{display:"flex",paddingLeft:"0px",justifyContent:"left",backgroundColor:"white",color:"white"},children:(0,q.jsx)("header",{style:{paddingLeft:"50px"},class:"py-3 my-4 header",children:(0,q.jsx)("img",{style:{width:"400px",marginTop:"-50px",marginRight:"-20px",marginBottom:"-50px"},src:t(2074),alt:"logo"})})})},ee=t(1694),ge=t.n(ee);t(3573);function te(){return te=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},te.apply(this,arguments)}t(2176);function ne(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function Ie(e){var g=function(e,g){if("object"!==typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,g||"default");if("object"!==typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===g?String:Number)(e)}(e,"string");return"symbol"===typeof g?g:String(g)}function re(g,t){return Object.keys(t).reduce((function(n,I){var r,C=n,l=C[ne(I)],a=C[I],o=A(C,[ne(I),I].map(Ie)),i=t[I],c=function(g,t,n){var I=(0,e.useRef)(void 0!==g),r=(0,e.useState)(t),C=r[0],l=r[1],a=void 0!==g,o=I.current;return I.current=a,!a&&o&&C!==t&&l(t),[a?g:C,(0,e.useCallback)((function(e){for(var g=arguments.length,t=new Array(g>1?g-1:0),I=1;I<g;I++)t[I-1]=arguments[I];n&&n.apply(void 0,[e].concat(t)),l(e)}),[n])]}(a,l,g[i]),u=c[0],s=c[1];return te({},o,((r={})[I]=u,r[i]=s,r))}),g)}function Ce(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);null!==e&&void 0!==e&&this.setState(e)}function le(e){this.setState(function(g){var t=this.constructor.getDerivedStateFromProps(e,g);return null!==t&&void 0!==t?t:null}.bind(this))}function ae(e,g){try{var t=this.props,n=this.state;this.props=e,this.state=g,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,n)}finally{this.props=t,this.state=n}}Ce.__suppressDeprecationWarning=!0,le.__suppressDeprecationWarning=!0,ae.__suppressDeprecationWarning=!0;var oe=Function.prototype.bind.call(Function.prototype.call,[].slice);function ie(e,g){return oe(e.querySelectorAll(g))}var ce=function(e){return e&&"function"!==typeof e?function(g){e.current=g}:e};var ue=function(g,t){return(0,e.useMemo)((function(){return function(e,g){var t=ce(e),n=ce(g);return function(e){t&&t(e),n&&n(e)}}(g,t)}),[g,t])},se=e.createContext(null);se.displayName="NavContext";var Ae=se,de=function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return null!=e?String(e):g||null},me=e.createContext(null),he=e.createContext(null),be="data-rr-ui-";function Ze(e){return"".concat(be).concat(e)}var pe=function(g){var t=(0,e.useRef)(g);return(0,e.useEffect)((function(){t.current=g}),[g]),t};function ye(g){var t=pe(g);return(0,e.useCallback)((function(){return t.current&&t.current.apply(t,arguments)}),[t])}var Ge=["as","disabled"];function fe(e){var g=e.tagName,t=e.disabled,n=e.href,I=e.target,r=e.rel,C=e.role,l=e.onClick,a=e.tabIndex,o=void 0===a?0:a,i=e.type;g||(g=null!=n||null!=I||null!=r?"a":"button");var c={tagName:g};if("button"===g)return[{type:i||"button",disabled:t},c];var u=function(e){(t||"a"===g&&function(e){return!e||"#"===e.trim()}(n))&&e.preventDefault(),t?e.stopPropagation():null==l||l(e)};return"a"===g&&(n||(n="#"),t&&(n=void 0)),[{role:null!=C?C:"button",disabled:void 0,tabIndex:t?void 0:o,href:n,target:"a"===g?I:void 0,"aria-disabled":t||void 0,rel:"a"===g?r:void 0,onClick:u,onKeyDown:function(e){" "===e.key&&(e.preventDefault(),u(e))}},c]}var Be=e.forwardRef((function(e,g){var t=e.as,n=e.disabled,I=function(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}(e,Ge),r=c(fe(Object.assign({tagName:t,disabled:n},I)),2),C=r[0],l=r[1].tagName;return(0,q.jsx)(l,Object.assign({},I,C,{ref:g}))}));Be.displayName="Button";var ve=Be,Se=["as","active","eventKey"];function We(g){var t=g.key,n=g.onClick,I=g.active,r=g.id,C=g.role,l=g.disabled,a=(0,e.useContext)(me),o=(0,e.useContext)(Ae),i=(0,e.useContext)(he),c=I,u={role:C};if(o){C||"tablist"!==o.role||(u.role="tab");var s=o.getControllerId(null!=t?t:null),A=o.getControlledId(null!=t?t:null);u[Ze("event-key")]=t,u.id=s||r,!(c=null==I&&null!=t?o.activeKey===t:I)&&(null!=i&&i.unmountOnExit||null!=i&&i.mountOnEnter)||(u["aria-controls"]=A)}return"tab"===u.role&&(u["aria-selected"]=c,c||(u.tabIndex=-1),l&&(u.tabIndex=-1,u["aria-disabled"]=!0)),u.onClick=ye((function(e){l||(null==n||n(e),null!=t&&a&&!e.isPropagationStopped()&&a(t,e))})),[u,{isActive:c}]}var Ve=e.forwardRef((function(e,g){var t=e.as,n=void 0===t?ve:t,I=e.active,r=e.eventKey,C=function(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}(e,Se),l=c(We(Object.assign({key:de(r,C.href),active:I},C)),2),a=l[0],o=l[1];return a[Ze("active")]=o.isActive,(0,q.jsx)(n,Object.assign({},C,a,{ref:g}))}));Ve.displayName="NavItem";var ke=Ve,Re=["as","onSelect","activeKey","role","onKeyDown"];var Xe=function(){},Je=Ze("event-key"),Ye=e.forwardRef((function(g,t){var n,I,r=g.as,C=void 0===r?"div":r,l=g.onSelect,a=g.activeKey,o=g.role,i=g.onKeyDown,c=function(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}(g,Re),u=(0,e.useReducer)((function(e){return!e}),!1)[1],s=(0,e.useRef)(!1),A=(0,e.useContext)(me),d=(0,e.useContext)(he);d&&(o=o||"tablist",a=d.activeKey,n=d.getControlledId,I=d.getControllerId);var m=(0,e.useRef)(null),h=function(e){var g=m.current;if(!g)return null;var t=ie(g,"[".concat(Je,"]:not([aria-disabled=true])")),n=g.querySelector("[aria-selected=true]");if(!n||n!==document.activeElement)return null;var I=t.indexOf(n);if(-1===I)return null;var r=I+e;return r>=t.length&&(r=0),r<0&&(r=t.length-1),t[r]},b=function(e,g){null!=e&&(null==l||l(e,g),null==A||A(e,g))};(0,e.useEffect)((function(){if(m.current&&s.current){var e=m.current.querySelector("[".concat(Je,"][aria-selected=true]"));null==e||e.focus()}s.current=!1}));var Z=ue(t,m);return(0,q.jsx)(me.Provider,{value:b,children:(0,q.jsx)(Ae.Provider,{value:{role:o,activeKey:de(a),getControlledId:n||Xe,getControllerId:I||Xe},children:(0,q.jsx)(C,Object.assign({},c,{onKeyDown:function(e){if(null==i||i(e),d){var g,t;switch(e.key){case"ArrowLeft":case"ArrowUp":g=h(-1);break;case"ArrowRight":case"ArrowDown":g=h(1);break;default:return}if(g)e.preventDefault(),b(g.dataset[(t="EventKey","".concat("rrUi").concat(t))]||null,e),s.current=!0,u()}},ref:Z,role:o}))})})}));Ye.displayName="Nav";var we=Object.assign(Ye,{Item:ke}),He=["xxl","xl","lg","md","sm","xs"],Ne=e.createContext({prefixes:{},breakpoints:He,minBreakpoint:"xs"});Ne.Consumer,Ne.Provider;function Fe(g,t){var n=(0,e.useContext)(Ne).prefixes;return g||n[t]||t}function Ke(){return(0,e.useContext)(Ne).breakpoints}function xe(){return(0,e.useContext)(Ne).minBreakpoint}var Ee=e.createContext(null);Ee.displayName="NavbarContext";var Me=Ee,ze=e.createContext(null);ze.displayName="CardHeaderContext";var Ue=ze,Qe=/-(.)/g;var Le=["className","bsPrefix","as"],Te=function(e){return e[0].toUpperCase()+function(e){return e.replace(Qe,(function(e,g){return g.toUpperCase()}))}(e).slice(1)};function De(g){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.displayName,I=void 0===n?Te(g):n,r=t.Component,C=t.defaultProps,l=e.forwardRef((function(e,t){var n=e.className,I=e.bsPrefix,l=e.as,a=void 0===l?r||"div":l,o=d(e,Le),i=s(s({},C),o),c=Fe(I,g);return(0,q.jsx)(a,s({ref:t,className:ge()(n,c)},i))}));return l.displayName=I,l}var je=De("nav-item");var Pe="undefined"!==typeof t.g&&t.g.navigator&&"ReactNative"===t.g.navigator.product,Oe="undefined"!==typeof document||Pe?e.useLayoutEffect:e.useEffect;new WeakMap;var _e=["onKeyDown"];var qe=e.forwardRef((function(e,g){var t,n=e.onKeyDown,I=function(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}(e,_e),r=c(fe(Object.assign({tagName:"a"},I)),1)[0],C=ye((function(e){r.onKeyDown(e),null==n||n(e)}));return(t=I.href)&&"#"!==t.trim()&&"button"!==I.role?(0,q.jsx)("a",Object.assign({ref:g},I,{onKeyDown:n})):(0,q.jsx)("a",Object.assign({ref:g},I,r,{onKeyDown:C}))}));qe.displayName="Anchor";var $e=qe,eg=["bsPrefix","className","as","active","eventKey","disabled"],gg=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.as,r=void 0===I?$e:I,C=e.active,l=e.eventKey,a=e.disabled,o=void 0!==a&&a,i=d(e,eg);t=Fe(t,"nav-link");var u=c(We(s({key:de(l,i.href),active:C,disabled:o},i)),2),A=u[0],m=u[1];return(0,q.jsx)(r,s(s(s({},i),A),{},{ref:g,disabled:o,className:ge()(n,t,o&&"disabled",m.isActive&&"active")}))}));gg.displayName="NavLink";var tg=gg,ng=["as","bsPrefix","variant","fill","justify","navbar","navbarScroll","className","activeKey"],Ig=e.forwardRef((function(g,t){var n,I,r,l=re(g,{activeKey:"onSelect"}),a=l.as,o=void 0===a?"div":a,i=l.bsPrefix,c=l.variant,u=l.fill,A=void 0!==u&&u,m=l.justify,h=void 0!==m&&m,b=l.navbar,Z=l.navbarScroll,p=l.className,y=l.activeKey,G=d(l,ng),f=Fe(i,"nav"),B=!1,v=(0,e.useContext)(Me),S=(0,e.useContext)(Ue);return v?(I=v.bsPrefix,B=null==b||b):S&&(r=S.cardHeaderBsPrefix),(0,q.jsx)(we,s({as:o,ref:t,activeKey:y,className:ge()(p,(n={},C(n,f,!B),C(n,"".concat(I,"-nav"),B),C(n,"".concat(I,"-nav-scroll"),B&&Z),C(n,"".concat(r,"-").concat(c),!!r),C(n,"".concat(f,"-").concat(c),!!c),C(n,"".concat(f,"-fill"),A),C(n,"".concat(f,"-justified"),h),n))},G))}));Ig.displayName="Nav";var rg=Object.assign(Ig,{Item:je,Link:tg}),Cg=["bsPrefix","className","as"],lg=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.as,r=d(e,Cg);t=Fe(t,"navbar-brand");var C=I||(r.href?"a":"span");return(0,q.jsx)(C,s(s({},r),{},{ref:g,className:ge()(n,t)}))}));lg.displayName="NavbarBrand";var ag=lg;function og(e){return e&&e.ownerDocument||document}function ig(e,g){return function(e){var g=og(e);return g&&g.defaultView||window}(e).getComputedStyle(e,g)}var cg=/([A-Z])/g;var ug=/^ms-/;function sg(e){return function(e){return e.replace(cg,"-$1").toLowerCase()}(e).replace(ug,"-ms-")}var Ag=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;var dg=function(e,g){var t="",n="";if("string"===typeof g)return e.style.getPropertyValue(sg(g))||ig(e).getPropertyValue(sg(g));Object.keys(g).forEach((function(I){var r=g[I];r||0===r?!function(e){return!(!e||!Ag.test(e))}(I)?t+=sg(I)+": "+r+";":n+=I+"("+r+") ":e.style.removeProperty(sg(I))})),n&&(t+="transform: "+n+";"),e.style.cssText+=";"+t};function mg(e,g){return mg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,g){return e.__proto__=g,e},mg(e,g)}var hg=t(4164),bg=!1,Zg=e.createContext(null),pg="unmounted",yg="exited",Gg="entering",fg="entered",Bg="exiting",vg=function(g){var t,n;function I(e,t){var n;n=g.call(this,e,t)||this;var I,r=t&&!t.isMounting?e.enter:e.appear;return n.appearStatus=null,e.in?r?(I=yg,n.appearStatus=Gg):I=fg:I=e.unmountOnExit||e.mountOnEnter?pg:yg,n.state={status:I},n.nextCallback=null,n}n=g,(t=I).prototype=Object.create(n.prototype),t.prototype.constructor=t,mg(t,n),I.getDerivedStateFromProps=function(e,g){return e.in&&g.status===pg?{status:yg}:null};var r=I.prototype;return r.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},r.componentDidUpdate=function(e){var g=null;if(e!==this.props){var t=this.state.status;this.props.in?t!==Gg&&t!==fg&&(g=Gg):t!==Gg&&t!==fg||(g=Bg)}this.updateStatus(!1,g)},r.componentWillUnmount=function(){this.cancelNextCallback()},r.getTimeouts=function(){var e,g,t,n=this.props.timeout;return e=g=t=n,null!=n&&"number"!==typeof n&&(e=n.exit,g=n.enter,t=void 0!==n.appear?n.appear:g),{exit:e,enter:g,appear:t}},r.updateStatus=function(e,g){if(void 0===e&&(e=!1),null!==g)if(this.cancelNextCallback(),g===Gg){if(this.props.unmountOnExit||this.props.mountOnEnter){var t=this.props.nodeRef?this.props.nodeRef.current:hg.findDOMNode(this);t&&function(e){e.scrollTop}(t)}this.performEnter(e)}else this.performExit();else this.props.unmountOnExit&&this.state.status===yg&&this.setState({status:pg})},r.performEnter=function(e){var g=this,t=this.props.enter,n=this.context?this.context.isMounting:e,I=this.props.nodeRef?[n]:[hg.findDOMNode(this),n],r=I[0],C=I[1],l=this.getTimeouts(),a=n?l.appear:l.enter;!e&&!t||bg?this.safeSetState({status:fg},(function(){g.props.onEntered(r)})):(this.props.onEnter(r,C),this.safeSetState({status:Gg},(function(){g.props.onEntering(r,C),g.onTransitionEnd(a,(function(){g.safeSetState({status:fg},(function(){g.props.onEntered(r,C)}))}))})))},r.performExit=function(){var e=this,g=this.props.exit,t=this.getTimeouts(),n=this.props.nodeRef?void 0:hg.findDOMNode(this);g&&!bg?(this.props.onExit(n),this.safeSetState({status:Bg},(function(){e.props.onExiting(n),e.onTransitionEnd(t.exit,(function(){e.safeSetState({status:yg},(function(){e.props.onExited(n)}))}))}))):this.safeSetState({status:yg},(function(){e.props.onExited(n)}))},r.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},r.safeSetState=function(e,g){g=this.setNextCallback(g),this.setState(e,g)},r.setNextCallback=function(e){var g=this,t=!0;return this.nextCallback=function(n){t&&(t=!1,g.nextCallback=null,e(n))},this.nextCallback.cancel=function(){t=!1},this.nextCallback},r.onTransitionEnd=function(e,g){this.setNextCallback(g);var t=this.props.nodeRef?this.props.nodeRef.current:hg.findDOMNode(this),n=null==e&&!this.props.addEndListener;if(t&&!n){if(this.props.addEndListener){var I=this.props.nodeRef?[this.nextCallback]:[t,this.nextCallback],r=I[0],C=I[1];this.props.addEndListener(r,C)}null!=e&&setTimeout(this.nextCallback,e)}else setTimeout(this.nextCallback,0)},r.render=function(){var g=this.state.status;if(g===pg)return null;var t=this.props,n=t.children,I=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,A(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return e.createElement(Zg.Provider,{value:null},"function"===typeof n?n(g,I):e.cloneElement(e.Children.only(n),I))},I}(e.Component);function Sg(){}vg.contextType=Zg,vg.propTypes={},vg.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:Sg,onEntering:Sg,onEntered:Sg,onExit:Sg,onExiting:Sg,onExited:Sg},vg.UNMOUNTED=pg,vg.EXITED=yg,vg.ENTERING=Gg,vg.ENTERED=fg,vg.EXITING=Bg;var Wg=vg,Vg=!("undefined"===typeof window||!window.document||!window.document.createElement),kg=!1,Rg=!1;try{var Xg={get passive(){return kg=!0},get once(){return Rg=kg=!0}};Vg&&(window.addEventListener("test",Xg,Xg),window.removeEventListener("test",Xg,!0))}catch(Hb){}var Jg=function(e,g,t,n){if(n&&"boolean"!==typeof n&&!Rg){var I=n.once,r=n.capture,C=t;!Rg&&I&&(C=t.__once||function e(n){this.removeEventListener(g,e,r),t.call(this,n)},t.__once=C),e.addEventListener(g,C,kg?n:r)}e.addEventListener(g,t,n)};var Yg=function(e,g,t,n){var I=n&&"boolean"!==typeof n?n.capture:n;e.removeEventListener(g,t,I),t.__once&&e.removeEventListener(g,t.__once,I)};var wg=function(e,g,t,n){return Jg(e,g,t,n),function(){Yg(e,g,t,n)}};function Hg(e,g,t){void 0===t&&(t=5);var n=!1,I=setTimeout((function(){n||function(e,g,t,n){if(void 0===t&&(t=!1),void 0===n&&(n=!0),e){var I=document.createEvent("HTMLEvents");I.initEvent(g,t,n),e.dispatchEvent(I)}}(e,"transitionend",!0)}),g+t),r=wg(e,"transitionend",(function(){n=!0}),{once:!0});return function(){clearTimeout(I),r()}}function Ng(e,g,t,n){null==t&&(t=function(e){var g=dg(e,"transitionDuration")||"",t=-1===g.indexOf("ms")?1e3:1;return parseFloat(g)*t}(e)||0);var I=Hg(e,t,n),r=wg(e,"transitionend",g);return function(){I(),r()}}function Fg(e,g){var t=dg(e,g)||"",n=-1===t.indexOf("ms")?1e3:1;return parseFloat(t)*n}function Kg(e,g){var t=Fg(e,"transitionDuration"),n=Fg(e,"transitionDelay"),I=Ng(e,(function(t){t.target===e&&(I(),g(t))}),t+n)}var xg=function(){for(var e=arguments.length,g=new Array(e),t=0;t<e;t++)g[t]=arguments[t];return g.filter((function(e){return null!=e})).reduce((function(e,g){if("function"!==typeof g)throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return null===e?g:function(){for(var t=arguments.length,n=new Array(t),I=0;I<t;I++)n[I]=arguments[I];e.apply(this,n),g.apply(this,n)}}),null)};function Eg(e){e.offsetHeight}var Mg,zg=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children","childRef"],Ug=e.forwardRef((function(g,t){var n=g.onEnter,I=g.onEntering,r=g.onEntered,C=g.onExit,l=g.onExiting,a=g.onExited,o=g.addEndListener,i=g.children,c=g.childRef,u=d(g,zg),A=(0,e.useRef)(null),m=ue(A,c),h=function(e){var g;m((g=e)&&"setState"in g?hg.findDOMNode(g):null!=g?g:null)},b=function(e){return function(g){e&&A.current&&e(A.current,g)}},Z=(0,e.useCallback)(b(n),[n]),p=(0,e.useCallback)(b(I),[I]),y=(0,e.useCallback)(b(r),[r]),G=(0,e.useCallback)(b(C),[C]),f=(0,e.useCallback)(b(l),[l]),B=(0,e.useCallback)(b(a),[a]),v=(0,e.useCallback)(b(o),[o]);return(0,q.jsx)(Wg,s(s({ref:t},u),{},{onEnter:Z,onEntered:y,onEntering:p,onExit:G,onExited:B,onExiting:f,addEndListener:v,nodeRef:A,children:"function"===typeof i?function(e,g){return i(e,s(s({},g),{},{ref:h}))}:e.cloneElement(i,{ref:h})}))})),Qg=Ug,Lg=["onEnter","onEntering","onEntered","onExit","onExiting","className","children","dimension","in","timeout","mountOnEnter","unmountOnExit","appear","getDimensionValue"],Tg={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function Dg(e,g){var t=g["offset".concat(e[0].toUpperCase()).concat(e.slice(1))],n=Tg[e];return t+parseInt(dg(g,n[0]),10)+parseInt(dg(g,n[1]),10)}var jg=(C(Mg={},yg,"collapse"),C(Mg,Bg,"collapsing"),C(Mg,Gg,"collapsing"),C(Mg,fg,"collapse show"),Mg),Pg=e.forwardRef((function(g,t){var n=g.onEnter,I=g.onEntering,r=g.onEntered,C=g.onExit,l=g.onExiting,a=g.className,o=g.children,i=g.dimension,c=void 0===i?"height":i,u=g.in,A=void 0!==u&&u,m=g.timeout,h=void 0===m?300:m,b=g.mountOnEnter,Z=void 0!==b&&b,p=g.unmountOnExit,y=void 0!==p&&p,G=g.appear,f=void 0!==G&&G,B=g.getDimensionValue,v=void 0===B?Dg:B,S=d(g,Lg),W="function"===typeof c?c():c,V=(0,e.useMemo)((function(){return xg((function(e){e.style[W]="0"}),n)}),[W,n]),k=(0,e.useMemo)((function(){return xg((function(e){var g="scroll".concat(W[0].toUpperCase()).concat(W.slice(1));e.style[W]="".concat(e[g],"px")}),I)}),[W,I]),R=(0,e.useMemo)((function(){return xg((function(e){e.style[W]=null}),r)}),[W,r]),X=(0,e.useMemo)((function(){return xg((function(e){e.style[W]="".concat(v(W,e),"px"),Eg(e)}),C)}),[C,v,W]),J=(0,e.useMemo)((function(){return xg((function(e){e.style[W]=null}),l)}),[W,l]);return(0,q.jsx)(Qg,s(s({ref:t,addEndListener:Kg},S),{},{"aria-expanded":S.role?A:null,onEnter:V,onEntering:k,onEntered:R,onExit:X,onExiting:J,childRef:o.ref,in:A,timeout:h,mountOnEnter:Z,unmountOnExit:y,appear:f,children:function(g,t){return e.cloneElement(o,s(s({},t),{},{className:ge()(a,o.props.className,jg[g],"width"===W&&"collapse-horizontal")}))}}))})),Og=["children","bsPrefix"],_g=e.forwardRef((function(g,t){var n=g.children,I=g.bsPrefix,r=d(g,Og);I=Fe(I,"navbar-collapse");var C=(0,e.useContext)(Me);return(0,q.jsx)(Pg,s(s({in:!(!C||!C.expanded)},r),{},{children:(0,q.jsx)("div",{ref:t,className:I,children:n})}))}));_g.displayName="NavbarCollapse";var qg=_g,$g=["bsPrefix","className","children","label","as","onClick"],et=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.children,C=g.label,l=void 0===C?"Toggle navigation":C,a=g.as,o=void 0===a?"button":a,i=g.onClick,c=d(g,$g);n=Fe(n,"navbar-toggler");var u=(0,e.useContext)(Me)||{},A=u.onToggle,m=u.expanded,h=ye((function(e){i&&i(e),A&&A()}));return"button"===o&&(c.type="button"),(0,q.jsx)(o,s(s({},c),{},{ref:t,onClick:h,"aria-label":l,className:ge()(I,n,!m&&"collapsed"),children:r||(0,q.jsx)("span",{className:"".concat(n,"-icon")})}))}));et.displayName="NavbarToggle";var gt=et,tt=new WeakMap,nt=function(e,g){if(e&&g){var t=tt.get(g)||new Map;tt.set(g,t);var n=t.get(e);return n||((n=g.matchMedia(e)).refCount=0,t.set(n.media,n)),n}};function It(g,t){void 0===t&&(t="undefined"===typeof window?void 0:window);var n=nt(g,t),I=(0,e.useState)((function(){return!!n&&n.matches})),r=I[0],C=I[1];return Oe((function(){var e=nt(g,t);if(!e)return C(!1);var n=tt.get(t),I=function(){C(e.matches)};return e.refCount++,e.addListener(I),I(),function(){e.removeListener(I),e.refCount--,e.refCount<=0&&(null==n||n.delete(e.media)),e=void 0}}),[g]),r}var rt=function(g){var t=Object.keys(g);function n(e,g){return e===g?g:e?e+" and "+g:g}function I(e){var n=function(e){return t[Math.min(t.indexOf(e)+1,t.length-1)]}(e),I=g[n];return"(max-width: "+(I="number"===typeof I?I-.2+"px":"calc("+I+" - 0.2px)")+")"}return function(t,r,C){var l,a;"object"===typeof t?(l=t,C=r,r=!0):((a={})[t]=r=r||!0,l=a);var o=(0,e.useMemo)((function(){return Object.entries(l).reduce((function(e,t){var r=t[0],C=t[1];return"up"!==C&&!0!==C||(e=n(e,function(e){var t=g[e];return"number"===typeof t&&(t+="px"),"(min-width: "+t+")"}(r))),"down"!==C&&!0!==C||(e=n(e,I(r))),e}),"")}),[JSON.stringify(l)]);return It(o,C)}}({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),Ct=rt;function lt(e){void 0===e&&(e=og());try{var g=e.activeElement;return g&&g.nodeName?g:null}catch(Hb){return e.body}}function at(e,g){return e.contains?e.contains(g):e.compareDocumentPosition?e===g||!!(16&e.compareDocumentPosition(g)):void 0}function ot(g){var t=function(g){var t=(0,e.useRef)(g);return t.current=g,t}(g);(0,e.useEffect)((function(){return function(){return t.current()}}),[])}function it(e,g){if(!(e instanceof g))throw new TypeError("Cannot call a class as a function")}function ct(e,g){for(var t=0;t<g.length;t++){var n=g[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function ut(e,g,t){return g&&ct(e.prototype,g),t&&ct(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}var st=Ze("modal-open"),At=function(){function e(){var g=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=g.ownerDocument,n=g.handleContainerOverflow,I=void 0===n||n,r=g.isRTL,C=void 0!==r&&r;it(this,e),this.handleContainerOverflow=I,this.isRTL=C,this.modals=[],this.ownerDocument=t}return ut(e,[{key:"getScrollbarWidth",value:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,g=e.defaultView;return Math.abs(g.innerWidth-e.documentElement.clientWidth)}(this.ownerDocument)}},{key:"getElement",value:function(){return(this.ownerDocument||document).body}},{key:"setModalAttributes",value:function(e){}},{key:"removeModalAttributes",value:function(e){}},{key:"setContainerStyle",value:function(e){var g={overflow:"hidden"},t=this.isRTL?"paddingLeft":"paddingRight",n=this.getElement();e.style=C({overflow:n.style.overflow},t,n.style[t]),e.scrollBarWidth&&(g[t]="".concat(parseInt(dg(n,t)||"0",10)+e.scrollBarWidth,"px")),n.setAttribute(st,""),dg(n,g)}},{key:"reset",value:function(){var e=this;h(this.modals).forEach((function(g){return e.remove(g)}))}},{key:"removeContainerStyle",value:function(e){var g=this.getElement();g.removeAttribute(st),Object.assign(g.style,e.style)}},{key:"add",value:function(e){var g=this.modals.indexOf(e);return-1!==g?g:(g=this.modals.length,this.modals.push(e),this.setModalAttributes(e),0!==g||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),g)}},{key:"remove",value:function(e){var g=this.modals.indexOf(e);-1!==g&&(this.modals.splice(g,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(e))}},{key:"isTopModal",value:function(e){return!!this.modals.length&&this.modals[this.modals.length-1]===e}}]),e}(),dt=At,mt=(0,e.createContext)(Vg?window:void 0);mt.Provider;function ht(){return(0,e.useContext)(mt)}var bt=function(e,g){return Vg?null==e?(g||og()).body:("function"===typeof e&&(e=e()),e&&"current"in e&&(e=e.current),e&&("nodeType"in e||e.getBoundingClientRect)?e:null):null};var Zt=function(g){var t=g.children,n=g.in,I=g.onExited,r=g.mountOnEnter,C=g.unmountOnExit,l=(0,e.useRef)(null),a=(0,e.useRef)(n),o=ye(I);(0,e.useEffect)((function(){n?a.current=!0:o(l.current)}),[n,o]);var i=ue(l,t.ref),c=(0,e.cloneElement)(t,{ref:i});return n?c:C||!a.current&&r?null:c};function pt(g){var t=g.children,n=g.in,I=g.onExited,r=g.onEntered,C=g.transition,l=c((0,e.useState)(!n),2),a=l[0],o=l[1];n&&a&&o(!1);var i=function(g){var t=g.in,n=g.onTransition,I=(0,e.useRef)(null),r=(0,e.useRef)(!0),C=ye(n);return Oe((function(){if(I.current){var e=!1;return C({in:t,element:I.current,initial:r.current,isStale:function(){return e}}),function(){e=!0}}}),[t,C]),Oe((function(){return r.current=!1,function(){r.current=!0}}),[]),I}({in:!!n,onTransition:function(e){Promise.resolve(C(e)).then((function(){e.isStale()||(e.in?null==r||r(e.element,e.initial):(o(!0),null==I||I(e.element)))}),(function(g){throw e.in||o(!0),g}))}}),u=ue(i,t.ref);return a&&!n?null:(0,e.cloneElement)(t,{ref:u})}function yt(e,g,t){return e?(0,q.jsx)(e,Object.assign({},t)):g?(0,q.jsx)(pt,Object.assign({},t,{transition:g})):(0,q.jsx)(Zt,Object.assign({},t))}var Gt,ft=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function Bt(g){var t=ht(),n=g||function(e){return Gt||(Gt=new dt({ownerDocument:null==e?void 0:e.document})),Gt}(t),I=(0,e.useRef)({dialog:null,backdrop:null});return Object.assign(I.current,{add:function(){return n.add(I.current)},remove:function(){return n.remove(I.current)},isTopModal:function(){return n.isTopModal(I.current)},setDialogRef:(0,e.useCallback)((function(e){I.current.dialog=e}),[]),setBackdropRef:(0,e.useCallback)((function(e){I.current.backdrop=e}),[])})}var vt=(0,e.forwardRef)((function(g,t){var n=g.show,I=void 0!==n&&n,r=g.role,C=void 0===r?"dialog":r,l=g.className,a=g.style,o=g.children,i=g.backdrop,u=void 0===i||i,s=g.keyboard,A=void 0===s||s,d=g.onBackdropClick,m=g.onEscapeKeyDown,h=g.transition,b=g.runTransition,Z=g.backdropTransition,p=g.runBackdropTransition,y=g.autoFocus,G=void 0===y||y,f=g.enforceFocus,B=void 0===f||f,v=g.restoreFocus,S=void 0===v||v,W=g.restoreFocusOptions,V=g.renderDialog,k=g.renderBackdrop,R=void 0===k?function(e){return(0,q.jsx)("div",Object.assign({},e))}:k,X=g.manager,J=g.container,Y=g.onShow,w=g.onHide,H=void 0===w?function(){}:w,N=g.onExit,F=g.onExited,K=g.onExiting,x=g.onEnter,E=g.onEntering,M=g.onEntered,z=function(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}(g,ft),U=ht(),Q=function(g,t){var n=ht(),I=c((0,e.useState)((function(){return bt(g,null==n?void 0:n.document)})),2),r=I[0],C=I[1];if(!r){var l=bt(g);l&&C(l)}return(0,e.useEffect)((function(){t&&r&&t(r)}),[t,r]),(0,e.useEffect)((function(){var e=bt(g);e!==r&&C(e)}),[g,r]),r}(J),L=Bt(X),T=function(){var g=(0,e.useRef)(!0),t=(0,e.useRef)((function(){return g.current}));return(0,e.useEffect)((function(){return g.current=!0,function(){g.current=!1}}),[]),t.current}(),D=function(g){var t=(0,e.useRef)(null);return(0,e.useEffect)((function(){t.current=g})),t.current}(I),j=c((0,e.useState)(!I),2),P=j[0],O=j[1],_=(0,e.useRef)(null);(0,e.useImperativeHandle)(t,(function(){return L}),[L]),Vg&&!D&&I&&(_.current=lt(null==U?void 0:U.document)),I&&P&&O(!1);var $=ye((function(){if(L.add(),re.current=wg(document,"keydown",ne),Ie.current=wg(document,"focus",(function(){return setTimeout(ge)}),!0),Y&&Y(),G){var e,g,t=lt(null!=(e=null==(g=L.dialog)?void 0:g.ownerDocument)?e:null==U?void 0:U.document);L.dialog&&t&&!at(L.dialog,t)&&(_.current=t,L.dialog.focus())}})),ee=ye((function(){var e;(L.remove(),null==re.current||re.current(),null==Ie.current||Ie.current(),S)&&(null==(e=_.current)||null==e.focus||e.focus(W),_.current=null)}));(0,e.useEffect)((function(){I&&Q&&$()}),[I,Q,$]),(0,e.useEffect)((function(){P&&ee()}),[P,ee]),ot((function(){ee()}));var ge=ye((function(){if(B&&T()&&L.isTopModal()){var e=lt(null==U?void 0:U.document);L.dialog&&e&&!at(L.dialog,e)&&L.dialog.focus()}})),te=ye((function(e){e.target===e.currentTarget&&(null==d||d(e),!0===u&&H())})),ne=ye((function(e){A&&function(e){return"Escape"===e.code||27===e.keyCode}(e)&&L.isTopModal()&&(null==m||m(e),e.defaultPrevented||H())})),Ie=(0,e.useRef)(),re=(0,e.useRef)();if(!Q)return null;var Ce=Object.assign({role:C,ref:L.setDialogRef,"aria-modal":"dialog"===C||void 0},z,{style:a,className:l,tabIndex:-1}),le=V?V(Ce):(0,q.jsx)("div",Object.assign({},Ce,{children:e.cloneElement(o,{role:"document"})}));le=yt(h,b,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!I,onExit:N,onExiting:K,onExited:function(){O(!0),null==F||F.apply(void 0,arguments)},onEnter:x,onEntering:E,onEntered:M,children:le});var ae=null;return u&&(ae=R({ref:L.setBackdropRef,onClick:te}),ae=yt(Z,p,{in:!!I,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:ae})),(0,q.jsx)(q.Fragment,{children:hg.createPortal((0,q.jsxs)(q.Fragment,{children:[ae,le]}),Q)})}));vt.displayName="Modal";var St,Wt=Object.assign(vt,{Manager:dt}),Vt=["className","children","transitionClasses","onEnter"],kt=(C(St={},Gg,"show"),C(St,fg,"show"),St),Rt=e.forwardRef((function(g,t){var n=g.className,I=g.children,r=g.transitionClasses,C=void 0===r?{}:r,l=g.onEnter,a=s({in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1},d(g,Vt)),o=(0,e.useCallback)((function(e,g){Eg(e),null==l||l(e,g)}),[l]);return(0,q.jsx)(Qg,s(s({ref:t,addEndListener:Kg},a),{},{onEnter:o,childRef:I.ref,children:function(g,t){return e.cloneElement(I,s(s({},t),{},{className:ge()("fade",n,I.props.className,kt[g],C[g])}))}}))}));Rt.displayName="Fade";var Xt,Jt=Rt,Yt=De("offcanvas-body"),wt=["bsPrefix","className","children","in","mountOnEnter","unmountOnExit","appear"],Ht=(C(Xt={},Gg,"show"),C(Xt,fg,"show"),Xt),Nt=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.children,C=g.in,l=void 0!==C&&C,a=g.mountOnEnter,o=void 0!==a&&a,i=g.unmountOnExit,c=void 0!==i&&i,u=g.appear,A=void 0!==u&&u,m=d(g,wt);return n=Fe(n,"offcanvas"),(0,q.jsx)(Qg,s(s({ref:t,addEndListener:Kg,in:l,mountOnEnter:o,unmountOnExit:c,appear:A},m),{},{childRef:r.ref,children:function(g,t){return e.cloneElement(r,s(s({},t),{},{className:ge()(I,r.props.className,(g===Gg||g===Bg)&&"".concat(n,"-toggling"),Ht[g])}))}}))}));Nt.displayName="OffcanvasToggling";var Ft=Nt,Kt=e.createContext({onHide:function(){}}),xt=t(2007),Et=t.n(xt),Mt=["className","variant","aria-label"],zt={"aria-label":Et().string,onClick:Et().func,variant:Et().oneOf(["white"])},Ut=e.forwardRef((function(e,g){var t=e.className,n=e.variant,I=e["aria-label"],r=void 0===I?"Close":I,C=d(e,Mt);return(0,q.jsx)("button",s({ref:g,type:"button",className:ge()("btn-close",n&&"btn-close-".concat(n),t),"aria-label":r},C))}));Ut.displayName="CloseButton",Ut.propTypes=zt;var Qt=Ut,Lt=["closeLabel","closeVariant","closeButton","onHide","children"],Tt=e.forwardRef((function(g,t){var n=g.closeLabel,I=void 0===n?"Close":n,r=g.closeVariant,C=g.closeButton,l=void 0!==C&&C,a=g.onHide,o=g.children,i=d(g,Lt),c=(0,e.useContext)(Kt),u=ye((function(){null==c||c.onHide(),null==a||a()}));return(0,q.jsxs)("div",s(s({ref:t},i),{},{children:[o,l&&(0,q.jsx)(Qt,{"aria-label":I,variant:r,onClick:u})]}))})),Dt=Tt,jt=["bsPrefix","className","closeLabel","closeButton"],Pt=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.closeLabel,r=void 0===I?"Close":I,C=e.closeButton,l=void 0!==C&&C,a=d(e,jt);return t=Fe(t,"offcanvas-header"),(0,q.jsx)(Dt,s(s({ref:g},a),{},{className:ge()(n,t),closeLabel:r,closeButton:l}))}));Pt.displayName="OffcanvasHeader";var Ot=Pt,_t=function(g){return e.forwardRef((function(e,t){return(0,q.jsx)("div",s(s({},e),{},{ref:t,className:ge()(e.className,g)}))}))},qt=De("offcanvas-title",{Component:_t("h5")});function $t(e){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$t(e)}function en(){return en="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,g,t){var n=function(e,g){for(;!Object.prototype.hasOwnProperty.call(e,g)&&null!==(e=$t(e)););return e}(e,g);if(n){var I=Object.getOwnPropertyDescriptor(n,g);return I.get?I.get.call(arguments.length<3?e:t):I.value}},en.apply(this,arguments)}function gn(e,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(g&&g.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),g&&mg(e,g)}function tn(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(Hb){return!1}}function nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function In(e){var g=tn();return function(){var t,n=$t(e);if(g){var r=$t(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,g){if(g&&("object"===I(g)||"function"===typeof g))return g;if(void 0!==g)throw new TypeError("Derived constructors may only return object or undefined");return nn(e)}(this,t)}}function rn(e,g){return e.replace(new RegExp("(^|\\s)"+g+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var Cn,ln=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",an=".sticky-top",on=".navbar-toggler",cn=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"adjustAndStore",value:function(e,g,t){var n=g.style[e];g.dataset[e]=n,dg(g,C({},e,"".concat(parseFloat(dg(g,e))+t,"px")))}},{key:"restore",value:function(e,g){var t=g.dataset[e];void 0!==t&&(delete g.dataset[e],dg(g,C({},e,t)))}},{key:"setContainerStyle",value:function(e){var g=this;en($t(t.prototype),"setContainerStyle",this).call(this,e);var n,I,r=this.getElement();if(I="modal-open",(n=r).classList?n.classList.add(I):function(e,g){return e.classList?!!g&&e.classList.contains(g):-1!==(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+g+" ")}(n,I)||("string"===typeof n.className?n.className=n.className+" "+I:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+I)),e.scrollBarWidth){var C=this.isRTL?"paddingLeft":"paddingRight",l=this.isRTL?"marginLeft":"marginRight";ie(r,ln).forEach((function(t){return g.adjustAndStore(C,t,e.scrollBarWidth)})),ie(r,an).forEach((function(t){return g.adjustAndStore(l,t,-e.scrollBarWidth)})),ie(r,on).forEach((function(t){return g.adjustAndStore(l,t,e.scrollBarWidth)}))}}},{key:"removeContainerStyle",value:function(e){var g=this;en($t(t.prototype),"removeContainerStyle",this).call(this,e);var n,I,r=this.getElement();I="modal-open",(n=r).classList?n.classList.remove(I):"string"===typeof n.className?n.className=rn(n.className,I):n.setAttribute("class",rn(n.className&&n.className.baseVal||"",I));var C=this.isRTL?"paddingLeft":"paddingRight",l=this.isRTL?"marginLeft":"marginRight";ie(r,ln).forEach((function(e){return g.restore(C,e)})),ie(r,an).forEach((function(e){return g.restore(l,e)})),ie(r,on).forEach((function(e){return g.restore(l,e)}))}}]),t}(dt);function un(e){return Cn||(Cn=new cn(e)),Cn}var sn=cn,An=["bsPrefix","className","children","aria-labelledby","placement","responsive","show","backdrop","keyboard","scroll","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager","renderStaticNode"];function dn(e){return(0,q.jsx)(Ft,s({},e))}function mn(e){return(0,q.jsx)(Jt,s({},e))}var hn=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.children,C=g["aria-labelledby"],l=g.placement,a=void 0===l?"start":l,o=g.responsive,i=g.show,u=void 0!==i&&i,A=g.backdrop,m=void 0===A||A,h=g.keyboard,b=void 0===h||h,Z=g.scroll,p=void 0!==Z&&Z,y=g.onEscapeKeyDown,G=g.onShow,f=g.onHide,B=g.container,v=g.autoFocus,S=void 0===v||v,W=g.enforceFocus,V=void 0===W||W,k=g.restoreFocus,R=void 0===k||k,X=g.restoreFocusOptions,J=g.onEntered,Y=g.onExit,w=g.onExiting,H=g.onEnter,N=g.onEntering,F=g.onExited,K=g.backdropClassName,x=g.manager,E=g.renderStaticNode,M=void 0!==E&&E,z=d(g,An),U=(0,e.useRef)();n=Fe(n,"offcanvas");var Q=((0,e.useContext)(Me)||{}).onToggle,L=c((0,e.useState)(!1),2),T=L[0],D=L[1],j=Ct(o||"xs","up");(0,e.useEffect)((function(){D(o?u&&!j:u)}),[u,o,j]);var P=ye((function(){null==Q||Q(),null==f||f()})),O=(0,e.useMemo)((function(){return{onHide:P}}),[P]);var _=(0,e.useCallback)((function(e){return(0,q.jsx)("div",s(s({},e),{},{className:ge()("".concat(n,"-backdrop"),K)}))}),[K,n]),$=function(e){return(0,q.jsx)("div",s(s(s({},e),z),{},{className:ge()(I,o?"".concat(n,"-").concat(o):n,"".concat(n,"-").concat(a)),"aria-labelledby":C,children:r}))};return(0,q.jsxs)(q.Fragment,{children:[!T&&(o||M)&&$({}),(0,q.jsx)(Kt.Provider,{value:O,children:(0,q.jsx)(Wt,{show:T,ref:t,backdrop:m,container:B,keyboard:b,autoFocus:S,enforceFocus:V&&!p,restoreFocus:R,restoreFocusOptions:X,onEscapeKeyDown:y,onShow:G,onHide:P,onEnter:function(e){e&&(e.style.visibility="visible");for(var g=arguments.length,t=new Array(g>1?g-1:0),n=1;n<g;n++)t[n-1]=arguments[n];null==H||H.apply(void 0,[e].concat(t))},onEntering:N,onEntered:J,onExit:Y,onExiting:w,onExited:function(e){e&&(e.style.visibility="");for(var g=arguments.length,t=new Array(g>1?g-1:0),n=1;n<g;n++)t[n-1]=arguments[n];null==F||F.apply(void 0,t)},manager:x||(p?(U.current||(U.current=new sn({handleContainerOverflow:!1})),U.current):un()),transition:dn,backdropTransition:mn,renderBackdrop:_,renderDialog:$})})]})}));hn.displayName="Offcanvas";var bn=Object.assign(hn,{Body:Yt,Header:Ot,Title:qt}),Zn=e.forwardRef((function(g,t){var n=(0,e.useContext)(Me);return(0,q.jsx)(bn,s(s({ref:t,show:!(null==n||!n.expanded)},g),{},{renderStaticNode:!0}))}));Zn.displayName="NavbarOffcanvas";var pn=Zn,yn=["bsPrefix","expand","variant","bg","fixed","sticky","className","as","expanded","onToggle","onSelect","collapseOnSelect"],Gn=De("navbar-text",{Component:"span"}),fn=e.forwardRef((function(g,t){var n=re(g,{expanded:"onToggle"}),I=n.bsPrefix,r=n.expand,C=void 0===r||r,l=n.variant,a=void 0===l?"light":l,o=n.bg,i=n.fixed,c=n.sticky,u=n.className,A=n.as,m=void 0===A?"nav":A,h=n.expanded,b=n.onToggle,Z=n.onSelect,p=n.collapseOnSelect,y=void 0!==p&&p,G=d(n,yn),f=Fe(I,"navbar"),B=(0,e.useCallback)((function(){null==Z||Z.apply(void 0,arguments),y&&h&&(null==b||b(!1))}),[Z,y,h,b]);void 0===G.role&&"nav"!==m&&(G.role="navigation");var v="".concat(f,"-expand");"string"===typeof C&&(v="".concat(v,"-").concat(C));var S=(0,e.useMemo)((function(){return{onToggle:function(){return null==b?void 0:b(!h)},bsPrefix:f,expanded:!!h,expand:C}}),[f,h,C,b]);return(0,q.jsx)(Me.Provider,{value:S,children:(0,q.jsx)(me.Provider,{value:B,children:(0,q.jsx)(m,s(s({ref:t},G),{},{className:ge()(u,f,C&&v,a&&"".concat(f,"-").concat(a),o&&"bg-".concat(o),c&&"sticky-".concat(c),i&&"fixed-".concat(i))}))})})}));fn.displayName="Navbar";var Bn,vn=Object.assign(fn,{Brand:ag,Collapse:qg,Offcanvas:pn,Text:Gn,Toggle:gt});function Sn(e,g,t){return Sn=tn()?Reflect.construct.bind():function(e,g,t){var n=[null];n.push.apply(n,g);var I=new(Function.bind.apply(e,n));return t&&mg(I,t.prototype),I},Sn.apply(null,arguments)}function Wn(e){var g="function"===typeof Map?new Map:void 0;return Wn=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof g){if(g.has(e))return g.get(e);g.set(e,n)}function n(){return Sn(e,arguments,$t(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),mg(n,e)},Wn(e)}function Vn(e,g){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=o(e))||g&&e&&"number"===typeof e.length){t&&(e=t);var n=0,I=function(){};return{s:I,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:I}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,C=!0,l=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return C=e.done,e},e:function(e){l=!0,r=e},f:function(){try{C||null==t.return||t.return()}finally{if(l)throw r}}}}function kn(){return kn=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},kn.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(Bn||(Bn={}));var Rn,Xn="popstate";function Jn(e,g){if(!1===e||null===e||"undefined"===typeof e)throw new Error(g)}function Yn(e,g){if(!e){"undefined"!==typeof console&&console.warn(g);try{throw new Error(g)}catch(Hb){}}}function wn(e,g){return{usr:e.state,key:e.key,idx:g}}function Hn(e,g,t,n){return void 0===t&&(t=null),kn({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof g?Fn(g):g,{state:t,key:g&&g.key||n||Math.random().toString(36).substr(2,8)})}function Nn(e){var g=e.pathname,t=void 0===g?"/":g,n=e.search,I=void 0===n?"":n,r=e.hash,C=void 0===r?"":r;return I&&"?"!==I&&(t+="?"===I.charAt(0)?I:"?"+I),C&&"#"!==C&&(t+="#"===C.charAt(0)?C:"#"+C),t}function Fn(e){var g={};if(e){var t=e.indexOf("#");t>=0&&(g.hash=e.substr(t),e=e.substr(0,t));var n=e.indexOf("?");n>=0&&(g.search=e.substr(n),e=e.substr(0,n)),e&&(g.pathname=e)}return g}function Kn(e,g,t,n){void 0===n&&(n={});var I=n,r=I.window,C=void 0===r?document.defaultView:r,l=I.v5Compat,a=void 0!==l&&l,o=C.history,i=Bn.Pop,c=null,u=s();function s(){return(o.state||{idx:null}).idx}function A(){i=Bn.Pop;var e=s(),g=null==e?null:e-u;u=e,c&&c({action:i,location:m.location,delta:g})}function d(e){var g="null"!==C.location.origin?C.location.origin:C.location.href,t="string"===typeof e?e:Nn(e);return Jn(g,"No window.location.(origin|href) available to create URL for href: "+t),new URL(t,g)}null==u&&(u=0,o.replaceState(kn({},o.state,{idx:u}),""));var m={get action(){return i},get location(){return e(C,o)},listen:function(e){if(c)throw new Error("A history only accepts one active listener");return C.addEventListener(Xn,A),c=e,function(){C.removeEventListener(Xn,A),c=null}},createHref:function(e){return g(C,e)},createURL:d,encodeLocation:function(e){var g=d(e);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:function(e,g){i=Bn.Push;var n=Hn(m.location,e,g);t&&t(n,e);var I=wn(n,u=s()+1),r=m.createHref(n);try{o.pushState(I,"",r)}catch(l){if(l instanceof DOMException&&"DataCloneError"===l.name)throw l;C.location.assign(r)}a&&c&&c({action:i,location:m.location,delta:1})},replace:function(e,g){i=Bn.Replace;var n=Hn(m.location,e,g);t&&t(n,e);var I=wn(n,u=s()),r=m.createHref(n);o.replaceState(I,"",r),a&&c&&c({action:i,location:m.location,delta:0})},go:function(e){return o.go(e)}};return m}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(Rn||(Rn={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function xn(e,g,t){void 0===t&&(t="/");var n=$n(("string"===typeof g?Fn(g):g).pathname||"/",t);if(null==n)return null;var I=En(e);!function(e){e.sort((function(e,g){return e.score!==g.score?g.score-e.score:function(e,g){var t=e.length===g.length&&e.slice(0,-1).every((function(e,t){return e===g[t]}));return t?e[e.length-1]-g[g.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),g.routesMeta.map((function(e){return e.childrenIndex})))}))}(I);for(var r=null,C=0;null==r&&C<I.length;++C)r=On(I[C],qn(n));return r}function En(e,g,t,n){void 0===g&&(g=[]),void 0===t&&(t=[]),void 0===n&&(n="");var I=function(e,I,r){var C={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:I,route:e};C.relativePath.startsWith("/")&&(Jn(C.relativePath.startsWith(n),'Absolute route path "'+C.relativePath+'" nested under path "'+n+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),C.relativePath=C.relativePath.slice(n.length));var l=nI([n,C.relativePath]),a=t.concat(C);e.children&&e.children.length>0&&(Jn(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+l+'".'),En(e.children,g,a,l)),(null!=e.path||e.index)&&g.push({path:l,score:Pn(l,e.index),routesMeta:a})};return e.forEach((function(e,g){var t;if(""!==e.path&&null!=(t=e.path)&&t.includes("?")){var n,r=Vn(Mn(e.path));try{for(r.s();!(n=r.n()).done;){var C=n.value;I(e,g,C)}}catch(l){r.e(l)}finally{r.f()}}else I(e,g)})),g}function Mn(e){var g=e.split("/");if(0===g.length)return[];var t,n=l(t=g)||m(t)||o(t)||i(),I=n[0],r=n.slice(1),C=I.endsWith("?"),a=I.replace(/\?$/,"");if(0===r.length)return C?[a,""]:[a];var c=Mn(r.join("/")),u=[];return u.push.apply(u,h(c.map((function(e){return""===e?a:[a,e].join("/")})))),C&&u.push.apply(u,h(c)),u.map((function(g){return e.startsWith("/")&&""===g?"/":g}))}var zn=/^:\w+$/,Un=3,Qn=2,Ln=1,Tn=10,Dn=-2,jn=function(e){return"*"===e};function Pn(e,g){var t=e.split("/"),n=t.length;return t.some(jn)&&(n+=Dn),g&&(n+=Qn),t.filter((function(e){return!jn(e)})).reduce((function(e,g){return e+(zn.test(g)?Un:""===g?Ln:Tn)}),n)}function On(e,g){for(var t=e.routesMeta,n={},I="/",r=[],C=0;C<t.length;++C){var l=t[C],a=C===t.length-1,o="/"===I?g:g.slice(I.length)||"/",i=_n({path:l.relativePath,caseSensitive:l.caseSensitive,end:a},o);if(!i)return null;Object.assign(n,i.params);var c=l.route;r.push({params:n,pathname:nI([I,i.pathname]),pathnameBase:II(nI([I,i.pathnameBase])),route:c}),"/"!==i.pathnameBase&&(I=nI([I,i.pathnameBase]))}return r}function _n(e,g){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var t=function(e,g,t){void 0===g&&(g=!1);void 0===t&&(t=!0);Yn("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var n=[],I="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,g){return n.push(g),"/([^\\/]+)"}));e.endsWith("*")?(n.push("*"),I+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?I+="\\/*$":""!==e&&"/"!==e&&(I+="(?:(?=\\/|$))");var r=new RegExp(I,g?void 0:"i");return[r,n]}(e.path,e.caseSensitive,e.end),n=c(t,2),I=n[0],r=n[1],C=g.match(I);if(!C)return null;var l=C[0],a=l.replace(/(.)\/+$/,"$1"),o=C.slice(1);return{params:r.reduce((function(e,g,t){if("*"===g){var n=o[t]||"";a=l.slice(0,l.length-n.length).replace(/(.)\/+$/,"$1")}return e[g]=function(e,g){try{return decodeURIComponent(e)}catch(t){return Yn(!1,'The value for the URL param "'+g+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}(o[t]||"",g),e}),{}),pathname:l,pathnameBase:a,pattern:e}}function qn(e){try{return decodeURI(e)}catch(g){return Yn(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+g+")."),e}}function $n(e,g){if("/"===g)return e;if(!e.toLowerCase().startsWith(g.toLowerCase()))return null;var t=g.endsWith("/")?g.length-1:g.length,n=e.charAt(t);return n&&"/"!==n?null:e.slice(t)||"/"}function eI(e,g,t,n){return"Cannot include a '"+e+"' character in a manually specified `to."+g+"` field ["+JSON.stringify(n)+"].  Please separate it out to the `to."+t+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function gI(e){return e.filter((function(e,g){return 0===g||e.route.path&&e.route.path.length>0}))}function tI(e,g,t,n){var I;void 0===n&&(n=!1),"string"===typeof e?I=Fn(e):(Jn(!(I=kn({},e)).pathname||!I.pathname.includes("?"),eI("?","pathname","search",I)),Jn(!I.pathname||!I.pathname.includes("#"),eI("#","pathname","hash",I)),Jn(!I.search||!I.search.includes("#"),eI("#","search","hash",I)));var r,C=""===e||""===I.pathname,l=C?"/":I.pathname;if(n||null==l)r=t;else{var a=g.length-1;if(l.startsWith("..")){for(var o=l.split("/");".."===o[0];)o.shift(),a-=1;I.pathname=o.join("/")}r=a>=0?g[a]:"/"}var i=function(e,g){void 0===g&&(g="/");var t="string"===typeof e?Fn(e):e,n=t.pathname,I=t.search,r=void 0===I?"":I,C=t.hash,l=void 0===C?"":C,a=n?n.startsWith("/")?n:function(e,g){var t=g.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?t.length>1&&t.pop():"."!==e&&t.push(e)})),t.length>1?t.join("/"):"/"}(n,g):g;return{pathname:a,search:rI(r),hash:CI(l)}}(I,r),c=l&&"/"!==l&&l.endsWith("/"),u=(C||"."===l)&&t.endsWith("/");return i.pathname.endsWith("/")||!c&&!u||(i.pathname+="/"),i}var nI=function(e){return e.join("/").replace(/\/\/+/g,"/")},II=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},rI=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},CI=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},lI=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t)}(Wn(Error));function aI(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var oI=["post","put","patch","delete"],iI=(new Set(oI),["get"].concat(oI));new Set(iI),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function cI(){return cI=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},cI.apply(this,arguments)}var uI=g.startTransition,sI=e.createContext(null);var AI=e.createContext(null);var dI=e.createContext(null);var mI=e.createContext(null);var hI=e.createContext(null);var bI=e.createContext({outlet:null,matches:[],isDataRoute:!1});var ZI=e.createContext(null);function pI(){return null!=e.useContext(hI)}function yI(){return pI()||Jn(!1),e.useContext(hI).location}function GI(g){e.useContext(mI).static||e.useLayoutEffect(g)}function fI(){return e.useContext(bI).isDataRoute?function(){var g=YI(WI.UseNavigateStable).router,t=HI(VI.UseNavigateStable),n=e.useRef(!1);GI((function(){n.current=!0}));var I=e.useCallback((function(e,I){void 0===I&&(I={}),n.current&&("number"===typeof e?g.navigate(e):g.navigate(e,cI({fromRouteId:t},I)))}),[g,t]);return I}():function(){pI()||Jn(!1);var g=e.useContext(sI),t=e.useContext(mI),n=t.basename,I=t.navigator,r=e.useContext(bI).matches,C=yI().pathname,l=JSON.stringify(gI(r).map((function(e){return e.pathnameBase}))),a=e.useRef(!1);GI((function(){a.current=!0}));var o=e.useCallback((function(e,t){if(void 0===t&&(t={}),a.current)if("number"!==typeof e){var r=tI(e,JSON.parse(l),C,"path"===t.relative);null==g&&"/"!==n&&(r.pathname="/"===r.pathname?n:nI([n,r.pathname])),(t.replace?I.replace:I.push)(r,t.state,t)}else I.go(e)}),[n,I,l,C,g]);return o}()}function BI(g,t){var n=(void 0===t?{}:t).relative,I=e.useContext(bI).matches,r=yI().pathname,C=JSON.stringify(gI(I).map((function(e){return e.pathnameBase})));return e.useMemo((function(){return tI(g,JSON.parse(C),r,"path"===n)}),[g,C,r,n])}function vI(g,t,n){pI()||Jn(!1);var I,r=e.useContext(mI).navigator,C=e.useContext(bI).matches,l=C[C.length-1],a=l?l.params:{},o=(l&&l.pathname,l?l.pathnameBase:"/"),i=(l&&l.route,yI());if(t){var c,u="string"===typeof t?Fn(t):t;"/"===o||(null==(c=u.pathname)?void 0:c.startsWith(o))||Jn(!1),I=u}else I=i;var s=I.pathname||"/",A=xn(g,{pathname:"/"===o?s:s.slice(o.length)||"/"});var d=JI(A&&A.map((function(e){return Object.assign({},e,{params:Object.assign({},a,e.params),pathname:nI([o,r.encodeLocation?r.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?o:nI([o,r.encodeLocation?r.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),C,n);return t&&d?e.createElement(hI.Provider,{value:{location:cI({pathname:"/",search:"",hash:"",state:null,key:"default"},I),navigationType:Bn.Pop}},d):d}function SI(){var g=function(){var g,t=e.useContext(ZI),n=wI(VI.UseRouteError),I=HI(VI.UseRouteError);if(t)return t;return null==(g=n.errors)?void 0:g[I]}(),t=aI(g)?g.status+" "+g.statusText:g instanceof Error?g.message:JSON.stringify(g),n=g instanceof Error?g.stack:null,I="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:I};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},t),n?e.createElement("pre",{style:r},n):null,null)}var WI,VI,kI=e.createElement(SI,null),RI=function(g){gn(n,g);var t=In(n);function n(e){var g;return it(this,n),(g=t.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},g}return ut(n,[{key:"componentDidCatch",value:function(e,g){console.error("React Router caught the following error during render",e,g)}},{key:"render",value:function(){return this.state.error?e.createElement(bI.Provider,{value:this.props.routeContext},e.createElement(ZI.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,g){return g.location!==e.location||"idle"!==g.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||g.error,location:g.location,revalidation:e.revalidation||g.revalidation}}}]),n}(e.Component);function XI(g){var t=g.routeContext,n=g.match,I=g.children,r=e.useContext(sI);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),e.createElement(bI.Provider,{value:t},I)}function JI(g,t,n){var I;if(void 0===t&&(t=[]),void 0===n&&(n=null),null==g){var r;if(null==(r=n)||!r.errors)return null;g=n.matches}var C=g,l=null==(I=n)?void 0:I.errors;if(null!=l){var a=C.findIndex((function(e){return e.route.id&&(null==l?void 0:l[e.route.id])}));a>=0||Jn(!1),C=C.slice(0,Math.min(C.length,a+1))}return C.reduceRight((function(g,I,r){var a=I.route.id?null==l?void 0:l[I.route.id]:null,o=null;n&&(o=I.route.errorElement||kI);var i=t.concat(C.slice(0,r+1)),c=function(){var t;return t=a?o:I.route.Component?e.createElement(I.route.Component,null):I.route.element?I.route.element:g,e.createElement(XI,{match:I,routeContext:{outlet:g,matches:i,isDataRoute:null!=n},children:t})};return n&&(I.route.ErrorBoundary||I.route.errorElement||0===r)?e.createElement(RI,{location:n.location,revalidation:n.revalidation,component:o,error:a,children:c(),routeContext:{outlet:null,matches:i,isDataRoute:!0}}):c()}),null)}function YI(g){var t=e.useContext(sI);return t||Jn(!1),t}function wI(g){var t=e.useContext(AI);return t||Jn(!1),t}function HI(g){var t=function(g){var t=e.useContext(bI);return t||Jn(!1),t}(),n=t.matches[t.matches.length-1];return n.route.id||Jn(!1),n.route.id}!function(e){e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate"}(WI||(WI={})),function(e){e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId"}(VI||(VI={}));var NI;function FI(g){var t=g.to,n=g.replace,I=g.state,r=g.relative;pI()||Jn(!1);var C=e.useContext(bI).matches,l=yI().pathname,a=fI(),o=tI(t,gI(C).map((function(e){return e.pathnameBase})),l,"path"===r),i=JSON.stringify(o);return e.useEffect((function(){return a(JSON.parse(i),{replace:n,state:I,relative:r})}),[a,i,r,n,I]),null}function KI(e){Jn(!1)}function xI(g){var t=g.basename,n=void 0===t?"/":t,I=g.children,r=void 0===I?null:I,C=g.location,l=g.navigationType,a=void 0===l?Bn.Pop:l,o=g.navigator,i=g.static,c=void 0!==i&&i;pI()&&Jn(!1);var u=n.replace(/^\/*/,"/"),s=e.useMemo((function(){return{basename:u,navigator:o,static:c}}),[u,o,c]);"string"===typeof C&&(C=Fn(C));var A=C,d=A.pathname,m=void 0===d?"/":d,h=A.search,b=void 0===h?"":h,Z=A.hash,p=void 0===Z?"":Z,y=A.state,G=void 0===y?null:y,f=A.key,B=void 0===f?"default":f,v=e.useMemo((function(){var e=$n(m,u);return null==e?null:{location:{pathname:e,search:b,hash:p,state:G,key:B},navigationType:a}}),[u,m,b,p,G,B,a]);return null==v?null:e.createElement(mI.Provider,{value:s},e.createElement(hI.Provider,{children:r,value:v}))}function EI(e){var g=e.children,t=e.location;return vI(zI(g),t)}!function(e){e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error"}(NI||(NI={}));var MI=new Promise((function(){}));e.Component;function zI(g,t){void 0===t&&(t=[]);var n=[];return e.Children.forEach(g,(function(g,I){if(e.isValidElement(g)){var r=[].concat(h(t),[I]);if(g.type!==e.Fragment){g.type!==KI&&Jn(!1),g.props.index&&g.props.children&&Jn(!1);var C={id:g.props.id||r.join("-"),caseSensitive:g.props.caseSensitive,element:g.props.element,Component:g.props.Component,index:g.props.index,path:g.props.path,loader:g.props.loader,action:g.props.action,errorElement:g.props.errorElement,ErrorBoundary:g.props.ErrorBoundary,hasErrorBoundary:null!=g.props.ErrorBoundary||null!=g.props.errorElement,shouldRevalidate:g.props.shouldRevalidate,handle:g.props.handle,lazy:g.props.lazy};g.props.children&&(C.children=zI(g.props.children,r)),n.push(C)}else n.push.apply(n,zI(g.props.children,r))}})),n}function UI(){return UI=Object.assign?Object.assign.bind():function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},UI.apply(this,arguments)}function QI(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}var LI=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"],TI=["aria-current","caseSensitive","className","end","style","to","children"];function DI(g){var t=g.basename,n=g.children,I=g.future,r=g.window,C=e.useRef();null==C.current&&(C.current=function(e){return void 0===e&&(e={}),Kn((function(e,g){var t=e.location;return Hn("",{pathname:t.pathname,search:t.search,hash:t.hash},g.state&&g.state.usr||null,g.state&&g.state.key||"default")}),(function(e,g){return"string"===typeof g?g:Nn(g)}),null,e)}({window:r,v5Compat:!0}));var l=C.current,a=c(e.useState({action:l.action,location:l.location}),2),o=a[0],i=a[1],u=(I||{}).v7_startTransition,s=e.useCallback((function(e){u&&uI?uI((function(){return i(e)})):i(e)}),[i,u]);return e.useLayoutEffect((function(){return l.listen(s)}),[l,s]),e.createElement(xI,{basename:t,children:n,location:o.location,navigationType:o.action,navigator:l})}var jI="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,PI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,OI=e.forwardRef((function(g,t){var n,I=g.onClick,r=g.relative,C=g.reloadDocument,l=g.replace,a=g.state,o=g.target,i=g.to,c=g.preventScrollReset,u=QI(g,LI),s=e.useContext(mI).basename,A=!1;if("string"===typeof i&&PI.test(i)&&(n=i,jI))try{var d=new URL(window.location.href),m=i.startsWith("//")?new URL(d.protocol+i):new URL(i),h=$n(m.pathname,s);m.origin===d.origin&&null!=h?i=h+m.search+m.hash:A=!0}catch(Hb){}var b=function(g,t){var n=(void 0===t?{}:t).relative;pI()||Jn(!1);var I=e.useContext(mI),r=I.basename,C=I.navigator,l=BI(g,{relative:n}),a=l.hash,o=l.pathname,i=l.search,c=o;return"/"!==r&&(c="/"===o?r:nI([r,o])),C.createHref({pathname:c,search:i,hash:a})}(i,{relative:r}),Z=function(g,t){var n=void 0===t?{}:t,I=n.target,r=n.replace,C=n.state,l=n.preventScrollReset,a=n.relative,o=fI(),i=yI(),c=BI(g,{relative:a});return e.useCallback((function(e){if(function(e,g){return 0===e.button&&(!g||"_self"===g)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(e,I)){e.preventDefault();var t=void 0!==r?r:Nn(i)===Nn(c);o(g,{replace:t,state:C,preventScrollReset:l,relative:a})}}),[i,o,c,r,C,I,g,l,a])}(i,{replace:l,state:a,target:o,preventScrollReset:c,relative:r});return e.createElement("a",UI({},u,{href:n||b,onClick:A||C?I:function(e){I&&I(e),e.defaultPrevented||Z(e)},ref:t,target:o}))}));var _I=e.forwardRef((function(g,t){var n=g["aria-current"],I=void 0===n?"page":n,r=g.caseSensitive,C=void 0!==r&&r,l=g.className,a=void 0===l?"":l,o=g.end,i=void 0!==o&&o,c=g.style,u=g.to,s=g.children,A=QI(g,TI),d=BI(u,{relative:A.relative}),m=yI(),h=e.useContext(AI),b=e.useContext(mI).navigator,Z=b.encodeLocation?b.encodeLocation(d).pathname:d.pathname,p=m.pathname,y=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;C||(p=p.toLowerCase(),y=y?y.toLowerCase():null,Z=Z.toLowerCase());var G,f=p===Z||!i&&p.startsWith(Z)&&"/"===p.charAt(Z.length),B=null!=y&&(y===Z||!i&&y.startsWith(Z)&&"/"===y.charAt(Z.length)),v=f?I:void 0;G="function"===typeof a?a({isActive:f,isPending:B}):[a,f?"active":null,B?"pending":null].filter(Boolean).join(" ");var S="function"===typeof c?c({isActive:f,isPending:B}):c;return e.createElement(OI,UI({},A,{"aria-current":v,className:G,ref:t,style:S,to:u}),"function"===typeof s?s({isActive:f,isPending:B}):s)}));var qI,$I;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmitImpl="useSubmitImpl",e.UseFetcher="useFetcher"})(qI||(qI={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}($I||($I={}));var er=function(){return(0,q.jsxs)(vn,{style:{marginTop:"100px",position:"absolute",paddingLeft:"115px",paddingRight:"1039px"},bg:"dark","data-bs-theme":"dark",children:[(0,q.jsx)(vn.Toggle,{"aria-controls":"basic-navbar-nav",className:"ms-auto"}),(0,q.jsx)(vn.Collapse,{id:"basic-navbar-nav",children:(0,q.jsxs)(rg,{className:"me-auto",children:[(0,q.jsx)(_I,{to:"/products",className:function(e){return e.isActive?"nav-link active":"nav-link"},children:"Products"}),(0,q.jsx)(_I,{to:"/shipments",className:function(e){return e.isActive?"nav-link active":"nav-link"},children:"Shipments"}),(0,q.jsx)(_I,{to:"/traceProduct",className:function(e){return e.isActive?"nav-link active":"nav-link"},children:"Assign Shipment to Product"})]})})]})},gr=["bsPrefix","fluid","as","className"],tr=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.fluid,I=void 0!==n&&n,r=e.as,C=void 0===r?"div":r,l=e.className,a=d(e,gr),o=Fe(t,"container"),i="string"===typeof I?"-".concat(I):"-fluid";return(0,q.jsx)(C,s(s({ref:g},a),{},{className:ge()(l,I?"".concat(o).concat(i):o)}))}));tr.displayName="Container";var nr=tr;function Ir(){Ir=function(){return e};var e={},g=Object.prototype,t=g.hasOwnProperty,n=Object.defineProperty||function(e,g,t){e[g]=t.value},r="function"==typeof Symbol?Symbol:{},C=r.iterator||"@@iterator",l=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function o(e,g,t){return Object.defineProperty(e,g,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[g]}try{o({},"")}catch(k){o=function(e,g,t){return e[g]=t}}function i(e,g,t,I){var r=g&&g.prototype instanceof s?g:s,C=Object.create(r.prototype),l=new S(I||[]);return n(C,"_invoke",{value:G(e,t,l)}),C}function c(e,g,t){try{return{type:"normal",arg:e.call(g,t)}}catch(k){return{type:"throw",arg:k}}}e.wrap=i;var u={};function s(){}function A(){}function d(){}var m={};o(m,C,(function(){return this}));var h=Object.getPrototypeOf,b=h&&h(h(W([])));b&&b!==g&&t.call(b,C)&&(m=b);var Z=d.prototype=s.prototype=Object.create(m);function p(e){["next","throw","return"].forEach((function(g){o(e,g,(function(e){return this._invoke(g,e)}))}))}function y(e,g){function r(n,C,l,a){var o=c(e[n],e,C);if("throw"!==o.type){var i=o.arg,u=i.value;return u&&"object"==I(u)&&t.call(u,"__await")?g.resolve(u.__await).then((function(e){r("next",e,l,a)}),(function(e){r("throw",e,l,a)})):g.resolve(u).then((function(e){i.value=e,l(i)}),(function(e){return r("throw",e,l,a)}))}a(o.arg)}var C;n(this,"_invoke",{value:function(e,t){function n(){return new g((function(g,n){r(e,t,g,n)}))}return C=C?C.then(n,n):n()}})}function G(e,g,t){var n="suspendedStart";return function(I,r){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===I)throw r;return V()}for(t.method=I,t.arg=r;;){var C=t.delegate;if(C){var l=f(C,t);if(l){if(l===u)continue;return l}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===n)throw n="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);n="executing";var a=c(e,g,t);if("normal"===a.type){if(n=t.done?"completed":"suspendedYield",a.arg===u)continue;return{value:a.arg,done:t.done}}"throw"===a.type&&(n="completed",t.method="throw",t.arg=a.arg)}}}function f(e,g){var t=g.method,n=e.iterator[t];if(void 0===n)return g.delegate=null,"throw"===t&&e.iterator.return&&(g.method="return",g.arg=void 0,f(e,g),"throw"===g.method)||"return"!==t&&(g.method="throw",g.arg=new TypeError("The iterator does not provide a '"+t+"' method")),u;var I=c(n,e.iterator,g.arg);if("throw"===I.type)return g.method="throw",g.arg=I.arg,g.delegate=null,u;var r=I.arg;return r?r.done?(g[e.resultName]=r.value,g.next=e.nextLoc,"return"!==g.method&&(g.method="next",g.arg=void 0),g.delegate=null,u):r:(g.method="throw",g.arg=new TypeError("iterator result is not an object"),g.delegate=null,u)}function B(e){var g={tryLoc:e[0]};1 in e&&(g.catchLoc=e[1]),2 in e&&(g.finallyLoc=e[2],g.afterLoc=e[3]),this.tryEntries.push(g)}function v(e){var g=e.completion||{};g.type="normal",delete g.arg,e.completion=g}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(B,this),this.reset(!0)}function W(e){if(e){var g=e[C];if(g)return g.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,I=function g(){for(;++n<e.length;)if(t.call(e,n))return g.value=e[n],g.done=!1,g;return g.value=void 0,g.done=!0,g};return I.next=I}}return{next:V}}function V(){return{value:void 0,done:!0}}return A.prototype=d,n(Z,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:A,configurable:!0}),A.displayName=o(d,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var g="function"==typeof e&&e.constructor;return!!g&&(g===A||"GeneratorFunction"===(g.displayName||g.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,o(e,a,"GeneratorFunction")),e.prototype=Object.create(Z),e},e.awrap=function(e){return{__await:e}},p(y.prototype),o(y.prototype,l,(function(){return this})),e.AsyncIterator=y,e.async=function(g,t,n,I,r){void 0===r&&(r=Promise);var C=new y(i(g,t,n,I),r);return e.isGeneratorFunction(t)?C:C.next().then((function(e){return e.done?e.value:C.next()}))},p(Z),o(Z,a,"Generator"),o(Z,C,(function(){return this})),o(Z,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var g=Object(e),t=[];for(var n in g)t.push(n);return t.reverse(),function e(){for(;t.length;){var n=t.pop();if(n in g)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=W,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(v),!e)for(var g in this)"t"===g.charAt(0)&&t.call(this,g)&&!isNaN(+g.slice(1))&&(this[g]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var g=this;function n(t,n){return C.type="throw",C.arg=e,g.next=t,n&&(g.method="next",g.arg=void 0),!!n}for(var I=this.tryEntries.length-1;I>=0;--I){var r=this.tryEntries[I],C=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var l=t.call(r,"catchLoc"),a=t.call(r,"finallyLoc");if(l&&a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!a)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(e,g){for(var n=this.tryEntries.length-1;n>=0;--n){var I=this.tryEntries[n];if(I.tryLoc<=this.prev&&t.call(I,"finallyLoc")&&this.prev<I.finallyLoc){var r=I;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=g&&g<=r.finallyLoc&&(r=null);var C=r?r.completion:{};return C.type=e,C.arg=g,r?(this.method="next",this.next=r.finallyLoc,u):this.complete(C)},complete:function(e,g){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&g&&(this.next=g),u},finish:function(e){for(var g=this.tryEntries.length-1;g>=0;--g){var t=this.tryEntries[g];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),v(t),u}},catch:function(e){for(var g=this.tryEntries.length-1;g>=0;--g){var t=this.tryEntries[g];if(t.tryLoc===e){var n=t.completion;if("throw"===n.type){var I=n.arg;v(t)}return I}}throw new Error("illegal catch attempt")},delegateYield:function(e,g,t){return this.delegate={iterator:W(e),resultName:g,nextLoc:t},"next"===this.method&&(this.arg=void 0),u}},e}function rr(e,g,t,n,I,r,C){try{var l=e[r](C),a=l.value}catch(o){return void t(o)}l.done?g(a):Promise.resolve(a).then(n,I)}function Cr(e){return function(){var g=this,t=arguments;return new Promise((function(n,I){var r=e.apply(g,t);function C(e){rr(r,n,I,C,l,"next",e)}function l(e){rr(r,n,I,C,l,"throw",e)}C(void 0)}))}}var lr=["as","bsPrefix","variant","size","active","disabled","className"],ar=e.forwardRef((function(e,g){var t=e.as,n=e.bsPrefix,I=e.variant,r=void 0===I?"primary":I,C=e.size,l=e.active,a=void 0!==l&&l,o=e.disabled,i=void 0!==o&&o,u=e.className,A=d(e,lr),m=Fe(n,"btn"),h=c(fe(s({tagName:t,disabled:i},A)),2),b=h[0],Z=h[1].tagName;return(0,q.jsx)(Z,s(s(s({},b),A),{},{ref:g,disabled:i,className:ge()(u,m,a&&"active",r&&"".concat(m,"-").concat(r),C&&"".concat(m,"-").concat(C),A.href&&i&&"disabled")}))}));ar.displayName="Button";var or=ar,ir=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],cr=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.striped,r=e.bordered,C=e.borderless,l=e.hover,a=e.size,o=e.variant,i=e.responsive,c=d(e,ir),u=Fe(t,"table"),A=ge()(n,u,o&&"".concat(u,"-").concat(o),a&&"".concat(u,"-").concat(a),I&&"".concat(u,"-").concat("string"===typeof I?"striped-".concat(I):"striped"),r&&"".concat(u,"-bordered"),C&&"".concat(u,"-borderless"),l&&"".concat(u,"-hover")),m=(0,q.jsx)("table",s(s({},c),{},{className:A,ref:g}));if(i){var h="".concat(u,"-responsive");return"string"===typeof i&&(h="".concat(h,"-").concat(i)),(0,q.jsx)("div",{className:h,children:m})}return m})),ur=cr,sr=!1,Ar=!1,dr={debug:1,default:2,info:2,warning:3,error:4,off:5},mr=dr.default,hr=null;var br,Zr,pr=function(){try{var e=[];if(["NFD","NFC","NFKD","NFKC"].forEach((function(g){try{if("test"!=="test".normalize(g))throw new Error("bad normalize")}catch(t){e.push(g)}})),e.length)throw new Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(g){return g.message}return null}();!function(e){e.DEBUG="DEBUG",e.INFO="INFO",e.WARNING="WARNING",e.ERROR="ERROR",e.OFF="OFF"}(br||(br={})),function(e){e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.NOT_IMPLEMENTED="NOT_IMPLEMENTED",e.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.TIMEOUT="TIMEOUT",e.BUFFER_OVERRUN="BUFFER_OVERRUN",e.NUMERIC_FAULT="NUMERIC_FAULT",e.MISSING_NEW="MISSING_NEW",e.INVALID_ARGUMENT="INVALID_ARGUMENT",e.MISSING_ARGUMENT="MISSING_ARGUMENT",e.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",e.CALL_EXCEPTION="CALL_EXCEPTION",e.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",e.NONCE_EXPIRED="NONCE_EXPIRED",e.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",e.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",e.TRANSACTION_REPLACED="TRANSACTION_REPLACED",e.ACTION_REJECTED="ACTION_REJECTED"}(Zr||(Zr={}));var yr="0123456789abcdef",Gr=function(){function e(g){it(this,e),Object.defineProperty(this,"version",{enumerable:!0,value:g,writable:!1})}return ut(e,[{key:"_log",value:function(e,g){var t=e.toLowerCase();null==dr[t]&&this.throwArgumentError("invalid log level name","logLevel",e),mr>dr[t]||console.log.apply(console,g)}},{key:"debug",value:function(){for(var g=arguments.length,t=new Array(g),n=0;n<g;n++)t[n]=arguments[n];this._log(e.levels.DEBUG,t)}},{key:"info",value:function(){for(var g=arguments.length,t=new Array(g),n=0;n<g;n++)t[n]=arguments[n];this._log(e.levels.INFO,t)}},{key:"warn",value:function(){for(var g=arguments.length,t=new Array(g),n=0;n<g;n++)t[n]=arguments[n];this._log(e.levels.WARNING,t)}},{key:"makeError",value:function(g,t,n){if(Ar)return this.makeError("censored error",t,{});t||(t=e.errors.UNKNOWN_ERROR),n||(n={});var I=[];Object.keys(n).forEach((function(e){var g=n[e];try{if(g instanceof Uint8Array){for(var t="",r=0;r<g.length;r++)t+=yr[g[r]>>4],t+=yr[15&g[r]];I.push(e+"=Uint8Array(0x"+t+")")}else I.push(e+"="+JSON.stringify(g))}catch(a){I.push(e+"="+JSON.stringify(n[e].toString()))}})),I.push("code=".concat(t)),I.push("version=".concat(this.version));var r=g,C="";switch(t){case Zr.NUMERIC_FAULT:C="NUMERIC_FAULT";var l=g;switch(l){case"overflow":case"underflow":case"division-by-zero":C+="-"+l;break;case"negative-power":case"negative-width":C+="-unsupported";break;case"unbound-bitwise-result":C+="-unbound-result"}break;case Zr.CALL_EXCEPTION:case Zr.INSUFFICIENT_FUNDS:case Zr.MISSING_NEW:case Zr.NONCE_EXPIRED:case Zr.REPLACEMENT_UNDERPRICED:case Zr.TRANSACTION_REPLACED:case Zr.UNPREDICTABLE_GAS_LIMIT:C=t}C&&(g+=" [ See: https://links.ethers.org/v5-errors-"+C+" ]"),I.length&&(g+=" ("+I.join(", ")+")");var a=new Error(g);return a.reason=r,a.code=t,Object.keys(n).forEach((function(e){a[e]=n[e]})),a}},{key:"throwError",value:function(e,g,t){throw this.makeError(e,g,t)}},{key:"throwArgumentError",value:function(g,t,n){return this.throwError(g,e.errors.INVALID_ARGUMENT,{argument:t,value:n})}},{key:"assert",value:function(e,g,t,n){e||this.throwError(g,t,n)}},{key:"assertArgument",value:function(e,g,t,n){e||this.throwArgumentError(g,t,n)}},{key:"checkNormalize",value:function(g){null==g&&(g="platform missing String.prototype.normalize"),pr&&this.throwError("platform missing String.prototype.normalize",e.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:pr})}},{key:"checkSafeUint53",value:function(g,t){"number"===typeof g&&(null==t&&(t="value not safe"),(g<0||g>=9007199254740991)&&this.throwError(t,e.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:g}),g%1&&this.throwError(t,e.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:g}))}},{key:"checkArgumentCount",value:function(g,t,n){n=n?": "+n:"",g<t&&this.throwError("missing argument"+n,e.errors.MISSING_ARGUMENT,{count:g,expectedCount:t}),g>t&&this.throwError("too many arguments"+n,e.errors.UNEXPECTED_ARGUMENT,{count:g,expectedCount:t})}},{key:"checkNew",value:function(g,t){g!==Object&&null!=g||this.throwError("missing new",e.errors.MISSING_NEW,{name:t.name})}},{key:"checkAbstract",value:function(g,t){g===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",e.errors.UNSUPPORTED_OPERATION,{name:g.name,operation:"new"}):g!==Object&&null!=g||this.throwError("missing new",e.errors.MISSING_NEW,{name:t.name})}}],[{key:"globalLogger",value:function(){return hr||(hr=new e("logger/5.7.0")),hr}},{key:"setCensorship",value:function(g,t){if(!g&&t&&this.globalLogger().throwError("cannot permanently disable censorship",e.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),sr){if(!g)return;this.globalLogger().throwError("error censorship permanent",e.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Ar=!!g,sr=!!t}},{key:"setLogLevel",value:function(g){var t=dr[g.toLowerCase()];null!=t?mr=t:e.globalLogger().warn("invalid log level - "+g)}},{key:"from",value:function(g){return new e(g)}}]),e}();Gr.errors=Zr,Gr.levels=br;var fr=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},Br=new Gr("properties/5.7.0");function vr(e,g,t){Object.defineProperty(e,g,{enumerable:!0,value:t,writable:!1})}function Sr(e,g){for(var t=0;t<32;t++){if(e[g])return e[g];if(!e.prototype||"object"!==typeof e.prototype)break;e=Object.getPrototypeOf(e.prototype).constructor}return null}function Wr(e){return fr(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=Object.keys(e).map((function(g){var t=e[g];return Promise.resolve(t).then((function(e){return{key:g,value:e}}))})),g.next=3,Promise.all(t);case 3:return n=g.sent,g.abrupt("return",n.reduce((function(e,g){return e[g.key]=g.value,e}),{}));case 5:case"end":return g.stop()}}),g)})))}function Vr(e){var g={};for(var t in e)g[t]=e[t];return g}var kr={bigint:!0,boolean:!0,function:!0,number:!0,string:!0};function Rr(e){if(void 0===e||null===e||kr[typeof e])return!0;if(Array.isArray(e)||"object"===typeof e){if(!Object.isFrozen(e))return!1;for(var g=Object.keys(e),t=0;t<g.length;t++){var n=null;try{n=e[g[t]]}catch(I){continue}if(!Rr(n))return!1}return!0}return Br.throwArgumentError("Cannot deepCopy ".concat(typeof e),"object",e)}function Xr(e){if(Rr(e))return e;if(Array.isArray(e))return Object.freeze(e.map((function(e){return Jr(e)})));if("object"===typeof e){var g={};for(var t in e){var n=e[t];void 0!==n&&vr(g,t,Jr(n))}return g}return Br.throwArgumentError("Cannot deepCopy ".concat(typeof e),"object",e)}function Jr(e){return Xr(e)}var Yr=ut((function e(g){for(var t in it(this,e),g)this[t]=Jr(g[t])})),wr="providers/5.7.2",Hr=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},Nr=new Gr("abstract-signer/5.7.0"),Fr=["accessList","ccipReadEnabled","chainId","customData","data","from","gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","nonce","to","type","value"],Kr=[Gr.errors.INSUFFICIENT_FUNDS,Gr.errors.NONCE_EXPIRED,Gr.errors.REPLACEMENT_UNDERPRICED],xr=function(){function e(){it(this,e),Nr.checkAbstract(this instanceof e?this.constructor:void 0,e),vr(this,"_isSigner",!0)}return ut(e,[{key:"getBalance",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this._checkProvider("getBalance"),g.next=3,this.provider.getBalance(this.getAddress(),e);case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}}),g,this)})))}},{key:"getTransactionCount",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this._checkProvider("getTransactionCount"),g.next=3,this.provider.getTransactionCount(this.getAddress(),e);case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}}),g,this)})))}},{key:"estimateGas",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this._checkProvider("estimateGas"),g.next=3,Wr(this.checkTransaction(e));case 3:return t=g.sent,g.next=6,this.provider.estimateGas(t);case 6:return g.abrupt("return",g.sent);case 7:case"end":return g.stop()}}),g,this)})))}},{key:"call",value:function(e,g){return Hr(this,void 0,void 0,Ir().mark((function t(){var n;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._checkProvider("call"),t.next=3,Wr(this.checkTransaction(e));case 3:return n=t.sent,t.next=6,this.provider.call(n,g);case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"sendTransaction",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this._checkProvider("sendTransaction"),g.next=3,this.populateTransaction(e);case 3:return t=g.sent,g.next=6,this.signTransaction(t);case 6:return n=g.sent,g.next=9,this.provider.sendTransaction(n);case 9:return g.abrupt("return",g.sent);case 10:case"end":return g.stop()}}),g,this)})))}},{key:"getChainId",value:function(){return Hr(this,void 0,void 0,Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProvider("getChainId"),e.next=3,this.provider.getNetwork();case 3:return g=e.sent,e.abrupt("return",g.chainId);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getGasPrice",value:function(){return Hr(this,void 0,void 0,Ir().mark((function e(){return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProvider("getGasPrice"),e.next=3,this.provider.getGasPrice();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getFeeData",value:function(){return Hr(this,void 0,void 0,Ir().mark((function e(){return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._checkProvider("getFeeData"),e.next=3,this.provider.getFeeData();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"resolveName",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return this._checkProvider("resolveName"),g.next=3,this.provider.resolveName(e);case 3:return g.abrupt("return",g.sent);case 4:case"end":return g.stop()}}),g,this)})))}},{key:"checkTransaction",value:function(e){for(var g in e)-1===Fr.indexOf(g)&&Nr.throwArgumentError("invalid transaction key: "+g,"transaction",e);var t=Vr(e);return null==t.from?t.from=this.getAddress():t.from=Promise.all([Promise.resolve(t.from),this.getAddress()]).then((function(g){return g[0].toLowerCase()!==g[1].toLowerCase()&&Nr.throwArgumentError("from address mismatch","transaction",e),g[0]})),t}},{key:"populateTransaction",value:function(e){return Hr(this,void 0,void 0,Ir().mark((function g(){var t,n,I,r,C=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,Wr(this.checkTransaction(e));case 2:if(null!=(t=g.sent).to&&(t.to=Promise.resolve(t.to).then((function(e){return Hr(C,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null!=e){g.next=2;break}return g.abrupt("return",null);case 2:return g.next=4,this.resolveName(e);case 4:return null==(t=g.sent)&&Nr.throwArgumentError("provided ENS name resolves to null","tx.to",e),g.abrupt("return",t);case 7:case"end":return g.stop()}}),g,this)})))})),t.to.catch((function(e){}))),n=null!=t.maxFeePerGas||null!=t.maxPriorityFeePerGas,null==t.gasPrice||2!==t.type&&!n?0!==t.type&&1!==t.type||!n||Nr.throwArgumentError("pre-eip-1559 transaction do not support maxFeePerGas/maxPriorityFeePerGas","transaction",e):Nr.throwArgumentError("eip-1559 transaction do not support gasPrice","transaction",e),2!==t.type&&null!=t.type||null==t.maxFeePerGas||null==t.maxPriorityFeePerGas){g.next=10;break}t.type=2,g.next=18;break;case 10:if(0!==t.type&&1!==t.type){g.next=14;break}null==t.gasPrice&&(t.gasPrice=this.getGasPrice()),g.next=18;break;case 14:return g.next=16,this.getFeeData();case 16:I=g.sent,null==t.type?null!=I.maxFeePerGas&&null!=I.maxPriorityFeePerGas?(t.type=2,null!=t.gasPrice?(r=t.gasPrice,delete t.gasPrice,t.maxFeePerGas=r,t.maxPriorityFeePerGas=r):(null==t.maxFeePerGas&&(t.maxFeePerGas=I.maxFeePerGas),null==t.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=I.maxPriorityFeePerGas))):null!=I.gasPrice?(n&&Nr.throwError("network does not support EIP-1559",Gr.errors.UNSUPPORTED_OPERATION,{operation:"populateTransaction"}),null==t.gasPrice&&(t.gasPrice=I.gasPrice),t.type=0):Nr.throwError("failed to get consistent fee data",Gr.errors.UNSUPPORTED_OPERATION,{operation:"signer.getFeeData"}):2===t.type&&(null==t.maxFeePerGas&&(t.maxFeePerGas=I.maxFeePerGas),null==t.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=I.maxPriorityFeePerGas));case 18:return null==t.nonce&&(t.nonce=this.getTransactionCount("pending")),null==t.gasLimit&&(t.gasLimit=this.estimateGas(t).catch((function(e){if(Kr.indexOf(e.code)>=0)throw e;return Nr.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Gr.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,tx:t})}))),null==t.chainId?t.chainId=this.getChainId():t.chainId=Promise.all([Promise.resolve(t.chainId),this.getChainId()]).then((function(g){return 0!==g[1]&&g[0]!==g[1]&&Nr.throwArgumentError("chainId address mismatch","transaction",e),g[0]})),g.next=23,Wr(t);case 23:return g.abrupt("return",g.sent);case 24:case"end":return g.stop()}}),g,this)})))}},{key:"_checkProvider",value:function(e){this.provider||Nr.throwError("missing provider",Gr.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})}}],[{key:"isSigner",value:function(e){return!(!e||!e._isSigner)}}]),e}(),Er=function(e){gn(t,e);var g=In(t);function t(e,n){var I;return it(this,t),vr(nn(I=g.call(this)),"address",e),vr(nn(I),"provider",n||null),I}return ut(t,[{key:"getAddress",value:function(){return Promise.resolve(this.address)}},{key:"_fail",value:function(e,g){return Promise.resolve().then((function(){Nr.throwError(e,Gr.errors.UNSUPPORTED_OPERATION,{operation:g})}))}},{key:"signMessage",value:function(e){return this._fail("VoidSigner cannot sign messages","signMessage")}},{key:"signTransaction",value:function(e){return this._fail("VoidSigner cannot sign transactions","signTransaction")}},{key:"_signTypedData",value:function(e,g,t){return this._fail("VoidSigner cannot sign typed data","signTypedData")}},{key:"connect",value:function(e){return new t(this.address,e)}}]),t}(xr),Mr=t(518),zr=t.n(Mr),Ur=new Gr("bytes/5.7.0");function Qr(e){return!!e.toHexString}function Lr(e){return e.slice||(e.slice=function(){var g=Array.prototype.slice.call(arguments);return Lr(new Uint8Array(Array.prototype.slice.apply(e,g)))}),e}function Tr(e){return qr(e)&&!(e.length%2)||jr(e)}function Dr(e){return"number"===typeof e&&e==e&&e%1===0}function jr(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"===typeof e)return!1;if(!Dr(e.length)||e.length<0)return!1;for(var g=0;g<e.length;g++){var t=e[g];if(!Dr(t)||t<0||t>=256)return!1}return!0}function Pr(e,g){if(g||(g={}),"number"===typeof e){Ur.checkSafeUint53(e,"invalid arrayify value");for(var t=[];e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),Lr(new Uint8Array(t))}if(g.allowMissingPrefix&&"string"===typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),Qr(e)&&(e=e.toHexString()),qr(e)){var n=e.substring(2);n.length%2&&("left"===g.hexPad?n="0"+n:"right"===g.hexPad?n+="0":Ur.throwArgumentError("hex data is odd-length","value",e));for(var I=[],r=0;r<n.length;r+=2)I.push(parseInt(n.substring(r,r+2),16));return Lr(new Uint8Array(I))}return jr(e)?Lr(new Uint8Array(e)):Ur.throwArgumentError("invalid arrayify value","value",e)}function Or(e){var g=e.map((function(e){return Pr(e)})),t=g.reduce((function(e,g){return e+g.length}),0),n=new Uint8Array(t);return g.reduce((function(e,g){return n.set(g,e),e+g.length}),0),Lr(n)}function _r(e){var g=Pr(e);if(0===g.length)return g;for(var t=0;t<g.length&&0===g[t];)t++;return t&&(g=g.slice(t)),g}function qr(e,g){return!("string"!==typeof e||!e.match(/^0x[0-9A-Fa-f]*$/))&&(!g||e.length===2+2*g)}var $r="0123456789abcdef";function eC(e,g){if(g||(g={}),"number"===typeof e){Ur.checkSafeUint53(e,"invalid hexlify value");for(var t="";e;)t=$r[15&e]+t,e=Math.floor(e/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if("bigint"===typeof e)return(e=e.toString(16)).length%2?"0x0"+e:"0x"+e;if(g.allowMissingPrefix&&"string"===typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),Qr(e))return e.toHexString();if(qr(e))return e.length%2&&("left"===g.hexPad?e="0x0"+e.substring(2):"right"===g.hexPad?e+="0":Ur.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(jr(e)){for(var n="0x",I=0;I<e.length;I++){var r=e[I];n+=$r[(240&r)>>4]+$r[15&r]}return n}return Ur.throwArgumentError("invalid hexlify value","value",e)}function gC(e){if("string"!==typeof e)e=eC(e);else if(!qr(e)||e.length%2)return null;return(e.length-2)/2}function tC(e,g,t){return"string"!==typeof e?e=eC(e):(!qr(e)||e.length%2)&&Ur.throwArgumentError("invalid hexData","value",e),g=2+2*g,null!=t?"0x"+e.substring(g,2+2*t):"0x"+e.substring(g)}function nC(e){var g="0x";return e.forEach((function(e){g+=eC(e).substring(2)})),g}function IC(e){var g=function(e){"string"!==typeof e&&(e=eC(e));qr(e)||Ur.throwArgumentError("invalid hex string","value",e);e=e.substring(2);var g=0;for(;g<e.length&&"0"===e[g];)g++;return"0x"+e.substring(g)}(eC(e,{hexPad:"left"}));return"0x"===g?"0x0":g}function rC(e,g){for("string"!==typeof e?e=eC(e):qr(e)||Ur.throwArgumentError("invalid hex string","value",e),e.length>2*g+2&&Ur.throwArgumentError("value out of range","value",arguments[1]);e.length<2*g+2;)e="0x0"+e.substring(2);return e}function CC(e){var g={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(Tr(e)){var t=Pr(e);64===t.length?(g.v=27+(t[32]>>7),t[32]&=127,g.r=eC(t.slice(0,32)),g.s=eC(t.slice(32,64))):65===t.length?(g.r=eC(t.slice(0,32)),g.s=eC(t.slice(32,64)),g.v=t[64]):Ur.throwArgumentError("invalid signature string","signature",e),g.v<27&&(0===g.v||1===g.v?g.v+=27:Ur.throwArgumentError("signature invalid v byte","signature",e)),g.recoveryParam=1-g.v%2,g.recoveryParam&&(t[32]|=128),g._vs=eC(t.slice(32,64))}else{if(g.r=e.r,g.s=e.s,g.v=e.v,g.recoveryParam=e.recoveryParam,g._vs=e._vs,null!=g._vs){var n=function(e,g){(e=Pr(e)).length>g&&Ur.throwArgumentError("value out of range","value",arguments[0]);var t=new Uint8Array(g);return t.set(e,g-e.length),Lr(t)}(Pr(g._vs),32);g._vs=eC(n);var I=n[0]>=128?1:0;null==g.recoveryParam?g.recoveryParam=I:g.recoveryParam!==I&&Ur.throwArgumentError("signature recoveryParam mismatch _vs","signature",e),n[0]&=127;var r=eC(n);null==g.s?g.s=r:g.s!==r&&Ur.throwArgumentError("signature v mismatch _vs","signature",e)}if(null==g.recoveryParam)null==g.v?Ur.throwArgumentError("signature missing v and recoveryParam","signature",e):0===g.v||1===g.v?g.recoveryParam=g.v:g.recoveryParam=1-g.v%2;else if(null==g.v)g.v=27+g.recoveryParam;else{var C=0===g.v||1===g.v?g.v:1-g.v%2;g.recoveryParam!==C&&Ur.throwArgumentError("signature recoveryParam mismatch v","signature",e)}null!=g.r&&qr(g.r)?g.r=rC(g.r,32):Ur.throwArgumentError("signature missing or invalid r","signature",e),null!=g.s&&qr(g.s)?g.s=rC(g.s,32):Ur.throwArgumentError("signature missing or invalid s","signature",e);var l=Pr(g.s);l[0]>=128&&Ur.throwArgumentError("signature s out of range","signature",e),g.recoveryParam&&(l[0]|=128);var a=eC(l);g._vs&&(qr(g._vs)||Ur.throwArgumentError("signature invalid _vs","signature",e),g._vs=rC(g._vs,32)),null==g._vs?g._vs=a:g._vs!==a&&Ur.throwArgumentError("signature _vs mismatch v and s","signature",e)}return g.yParityAndS=g._vs,g.compact=g.r+g.yParityAndS.substring(2),g}var lC=zr().BN,aC=new Gr("bignumber/5.7.0"),oC={},iC=9007199254740991;var cC=!1,uC=function(){function e(g,t){it(this,e),g!==oC&&aC.throwError("cannot call constructor directly; use BigNumber.from",Gr.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}return ut(e,[{key:"fromTwos",value:function(e){return AC(dC(this).fromTwos(e))}},{key:"toTwos",value:function(e){return AC(dC(this).toTwos(e))}},{key:"abs",value:function(){return"-"===this._hex[0]?e.from(this._hex.substring(1)):this}},{key:"add",value:function(e){return AC(dC(this).add(dC(e)))}},{key:"sub",value:function(e){return AC(dC(this).sub(dC(e)))}},{key:"div",value:function(g){return e.from(g).isZero()&&mC("division-by-zero","div"),AC(dC(this).div(dC(g)))}},{key:"mul",value:function(e){return AC(dC(this).mul(dC(e)))}},{key:"mod",value:function(e){var g=dC(e);return g.isNeg()&&mC("division-by-zero","mod"),AC(dC(this).umod(g))}},{key:"pow",value:function(e){var g=dC(e);return g.isNeg()&&mC("negative-power","pow"),AC(dC(this).pow(g))}},{key:"and",value:function(e){var g=dC(e);return(this.isNegative()||g.isNeg())&&mC("unbound-bitwise-result","and"),AC(dC(this).and(g))}},{key:"or",value:function(e){var g=dC(e);return(this.isNegative()||g.isNeg())&&mC("unbound-bitwise-result","or"),AC(dC(this).or(g))}},{key:"xor",value:function(e){var g=dC(e);return(this.isNegative()||g.isNeg())&&mC("unbound-bitwise-result","xor"),AC(dC(this).xor(g))}},{key:"mask",value:function(e){return(this.isNegative()||e<0)&&mC("negative-width","mask"),AC(dC(this).maskn(e))}},{key:"shl",value:function(e){return(this.isNegative()||e<0)&&mC("negative-width","shl"),AC(dC(this).shln(e))}},{key:"shr",value:function(e){return(this.isNegative()||e<0)&&mC("negative-width","shr"),AC(dC(this).shrn(e))}},{key:"eq",value:function(e){return dC(this).eq(dC(e))}},{key:"lt",value:function(e){return dC(this).lt(dC(e))}},{key:"lte",value:function(e){return dC(this).lte(dC(e))}},{key:"gt",value:function(e){return dC(this).gt(dC(e))}},{key:"gte",value:function(e){return dC(this).gte(dC(e))}},{key:"isNegative",value:function(){return"-"===this._hex[0]}},{key:"isZero",value:function(){return dC(this).isZero()}},{key:"toNumber",value:function(){try{return dC(this).toNumber()}catch(e){mC("overflow","toNumber",this.toString())}return null}},{key:"toBigInt",value:function(){try{return BigInt(this.toString())}catch(Hb){}return aC.throwError("this platform does not support BigInt",Gr.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}},{key:"toString",value:function(){return arguments.length>0&&(10===arguments[0]?cC||(cC=!0,aC.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?aC.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",Gr.errors.UNEXPECTED_ARGUMENT,{}):aC.throwError("BigNumber.toString does not accept parameters",Gr.errors.UNEXPECTED_ARGUMENT,{})),dC(this).toString(10)}},{key:"toHexString",value:function(){return this._hex}},{key:"toJSON",value:function(e){return{type:"BigNumber",hex:this.toHexString()}}}],[{key:"from",value:function(g){if(g instanceof e)return g;if("string"===typeof g)return g.match(/^-?0x[0-9a-f]+$/i)?new e(oC,sC(g)):g.match(/^-?[0-9]+$/)?new e(oC,sC(new lC(g))):aC.throwArgumentError("invalid BigNumber string","value",g);if("number"===typeof g)return g%1&&mC("underflow","BigNumber.from",g),(g>=iC||g<=-iC)&&mC("overflow","BigNumber.from",g),e.from(String(g));var t=g;if("bigint"===typeof t)return e.from(t.toString());if(jr(t))return e.from(eC(t));if(t)if(t.toHexString){var n=t.toHexString();if("string"===typeof n)return e.from(n)}else{var I=t._hex;if(null==I&&"BigNumber"===t.type&&(I=t.hex),"string"===typeof I&&(qr(I)||"-"===I[0]&&qr(I.substring(1))))return e.from(I)}return aC.throwArgumentError("invalid BigNumber value","value",g)}},{key:"isBigNumber",value:function(e){return!(!e||!e._isBigNumber)}}]),e}();function sC(e){if("string"!==typeof e)return sC(e.toString(16));if("-"===e[0])return"-"===(e=e.substring(1))[0]&&aC.throwArgumentError("invalid hex","value",e),"0x00"===(e=sC(e))?e:"-"+e;if("0x"!==e.substring(0,2)&&(e="0x"+e),"0x"===e)return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&"0x00"===e.substring(0,4);)e="0x"+e.substring(4);return e}function AC(e){return uC.from(sC(e))}function dC(e){var g=uC.from(e).toHexString();return"-"===g[0]?new lC("-"+g.substring(3),16):new lC(g.substring(2),16)}function mC(e,g,t){var n={fault:e,operation:g};return null!=t&&(n.value=t),aC.throwError(e,Gr.errors.NUMERIC_FAULT,n)}var hC=t(7898),bC=t.n(hC);function ZC(e){return"0x"+bC().keccak_256(Pr(e))}var pC=new Gr("rlp/5.7.0");function yC(e){for(var g=[];e;)g.unshift(255&e),e>>=8;return g}function GC(e,g,t){for(var n=0,I=0;I<t;I++)n=256*n+e[g+I];return n}function fC(e){if(Array.isArray(e)){var g=[];if(e.forEach((function(e){g=g.concat(fC(e))})),g.length<=55)return g.unshift(192+g.length),g;var t=yC(g.length);return t.unshift(247+t.length),t.concat(g)}Tr(e)||pC.throwArgumentError("RLP object must be BytesLike","object",e);var n=Array.prototype.slice.call(Pr(e));if(1===n.length&&n[0]<=127)return n;if(n.length<=55)return n.unshift(128+n.length),n;var I=yC(n.length);return I.unshift(183+I.length),I.concat(n)}function BC(e){return eC(fC(e))}function vC(e,g,t,n){for(var I=[];t<g+1+n;){var r=SC(e,t);I.push(r.result),(t+=r.consumed)>g+1+n&&pC.throwError("child data too short",Gr.errors.BUFFER_OVERRUN,{})}return{consumed:1+n,result:I}}function SC(e,g){if(0===e.length&&pC.throwError("data too short",Gr.errors.BUFFER_OVERRUN,{}),e[g]>=248){var t=e[g]-247;g+1+t>e.length&&pC.throwError("data short segment too short",Gr.errors.BUFFER_OVERRUN,{});var n=GC(e,g+1,t);return g+1+t+n>e.length&&pC.throwError("data long segment too short",Gr.errors.BUFFER_OVERRUN,{}),vC(e,g,g+1+t,t+n)}if(e[g]>=192){var I=e[g]-192;return g+1+I>e.length&&pC.throwError("data array too short",Gr.errors.BUFFER_OVERRUN,{}),vC(e,g,g+1,I)}if(e[g]>=184){var r=e[g]-183;g+1+r>e.length&&pC.throwError("data array too short",Gr.errors.BUFFER_OVERRUN,{});var C=GC(e,g+1,r);return g+1+r+C>e.length&&pC.throwError("data array too short",Gr.errors.BUFFER_OVERRUN,{}),{consumed:1+r+C,result:eC(e.slice(g+1+r,g+1+r+C))}}if(e[g]>=128){var l=e[g]-128;return g+1+l>e.length&&pC.throwError("data too short",Gr.errors.BUFFER_OVERRUN,{}),{consumed:1+l,result:eC(e.slice(g+1,g+1+l))}}return{consumed:1,result:eC(e[g])}}function WC(e){var g=Pr(e),t=SC(g,0);return t.consumed!==g.length&&pC.throwArgumentError("invalid rlp data","data",e),t.result}var VC=new Gr("address/5.7.0");function kC(e){qr(e,20)||VC.throwArgumentError("invalid address","address",e);for(var g=(e=e.toLowerCase()).substring(2).split(""),t=new Uint8Array(40),n=0;n<40;n++)t[n]=g[n].charCodeAt(0);for(var I=Pr(ZC(t)),r=0;r<40;r+=2)I[r>>1]>>4>=8&&(g[r]=g[r].toUpperCase()),(15&I[r>>1])>=8&&(g[r+1]=g[r+1].toUpperCase());return"0x"+g.join("")}for(var RC={},XC=0;XC<10;XC++)RC[String(XC)]=String(XC);for(var JC=0;JC<26;JC++)RC[String.fromCharCode(65+JC)]=String(10+JC);var YC=Math.floor(function(e){return Math.log10?Math.log10(e):Math.log(e)/Math.LN10}(9007199254740991));function wC(e){for(var g=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map((function(e){return RC[e]})).join("");g.length>=YC;){var t=g.substring(0,YC);g=parseInt(t,10)%97+g.substring(t.length)}for(var n=String(98-parseInt(g,10)%97);n.length<2;)n="0"+n;return n}function HC(e){var g,t=null;if("string"!==typeof e&&VC.throwArgumentError("invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==e.substring(0,2)&&(e="0x"+e),t=kC(e),e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==e&&VC.throwArgumentError("bad address checksum","address",e);else if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(e.substring(2,4)!==wC(e)&&VC.throwArgumentError("bad icap checksum","address",e),g=e.substring(4),t=new lC(g,36).toString(16);t.length<40;)t="0"+t;t=kC("0x"+t)}else VC.throwArgumentError("invalid address","address",e);return t}function NC(e){var g=null;try{g=HC(e.from)}catch(t){VC.throwArgumentError("missing from address","transaction",e)}return HC(tC(ZC(BC([g,_r(Pr(uC.from(e.nonce).toHexString()))])),12))}var FC,KC,xC="hash/5.7.0",EC=new Gr("strings/5.7.0");function MC(e,g,t,n,I){if(e===KC.BAD_PREFIX||e===KC.UNEXPECTED_CONTINUE){for(var r=0,C=g+1;C<t.length&&t[C]>>6===2;C++)r++;return r}return e===KC.OVERRUN?t.length-g-1:0}!function(e){e.current="",e.NFC="NFC",e.NFD="NFD",e.NFKC="NFKC",e.NFKD="NFKD"}(FC||(FC={})),function(e){e.UNEXPECTED_CONTINUE="unexpected continuation byte",e.BAD_PREFIX="bad codepoint prefix",e.OVERRUN="string overrun",e.MISSING_CONTINUE="missing continuation byte",e.OUT_OF_RANGE="out of UTF-8 range",e.UTF16_SURROGATE="UTF-16 surrogate",e.OVERLONG="overlong representation"}(KC||(KC={}));var zC=Object.freeze({error:function(e,g,t,n,I){return EC.throwArgumentError("invalid codepoint at offset ".concat(g,"; ").concat(e),"bytes",t)},ignore:MC,replace:function(e,g,t,n,I){return e===KC.OVERLONG?(n.push(I),0):(n.push(65533),MC(e,g,t))}});function UC(e,g){null==g&&(g=zC.error),e=Pr(e);for(var t=[],n=0;n<e.length;){var I=e[n++];if(I>>7!==0){var r=null,C=null;if(192===(224&I))r=1,C=127;else if(224===(240&I))r=2,C=2047;else{if(240!==(248&I)){n+=g(128===(192&I)?KC.UNEXPECTED_CONTINUE:KC.BAD_PREFIX,n-1,e,t);continue}r=3,C=65535}if(n-1+r>=e.length)n+=g(KC.OVERRUN,n-1,e,t);else{for(var l=I&(1<<8-r-1)-1,a=0;a<r;a++){var o=e[n];if(128!=(192&o)){n+=g(KC.MISSING_CONTINUE,n,e,t),l=null;break}l=l<<6|63&o,n++}null!==l&&(l>1114111?n+=g(KC.OUT_OF_RANGE,n-1-r,e,t,l):l>=55296&&l<=57343?n+=g(KC.UTF16_SURROGATE,n-1-r,e,t,l):l<=C?n+=g(KC.OVERLONG,n-1-r,e,t,l):t.push(l))}}else t.push(I)}return t}function QC(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:FC.current;g!=FC.current&&(EC.checkNormalize(),e=e.normalize(g));for(var t=[],n=0;n<e.length;n++){var I=e.charCodeAt(n);if(I<128)t.push(I);else if(I<2048)t.push(I>>6|192),t.push(63&I|128);else if(55296==(64512&I)){n++;var r=e.charCodeAt(n);if(n>=e.length||56320!==(64512&r))throw new Error("invalid utf-8 string");var C=65536+((1023&I)<<10)+(1023&r);t.push(C>>18|240),t.push(C>>12&63|128),t.push(C>>6&63|128),t.push(63&C|128)}else t.push(I>>12|224),t.push(I>>6&63|128),t.push(63&I|128)}return Pr(t)}function LC(e,g){return UC(e,g).map((function(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode(55296+(e>>10&1023),56320+(1023&e)))})).join("")}function TC(e){return ZC(QC(e))}var DC=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},jC=new Gr(xC),PC=new Uint8Array(32);PC.fill(0);var OC=uC.from(-1),_C=uC.from(0),qC=uC.from(1),$C=uC.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var el=rC(qC.toHexString(),32),gl=rC(_C.toHexString(),32),tl={name:"string",version:"string",chainId:"uint256",verifyingContract:"address",salt:"bytes32"},nl=["name","version","chainId","verifyingContract","salt"];function Il(e){return function(g){return"string"!==typeof g&&jC.throwArgumentError("invalid domain value for ".concat(JSON.stringify(e)),"domain.".concat(e),g),g}}var rl={name:Il("name"),version:Il("version"),chainId:function(e){try{return uC.from(e).toString()}catch(g){}return jC.throwArgumentError('invalid domain value for "chainId"',"domain.chainId",e)},verifyingContract:function(e){try{return HC(e).toLowerCase()}catch(g){}return jC.throwArgumentError('invalid domain value "verifyingContract"',"domain.verifyingContract",e)},salt:function(e){try{var g=Pr(e);if(32!==g.length)throw new Error("bad length");return eC(g)}catch(t){}return jC.throwArgumentError('invalid domain value "salt"',"domain.salt",e)}};function Cl(e){var g=e.match(/^(u?)int(\d*)$/);if(g){var t=""===g[1],n=parseInt(g[2]||"256");(n%8!==0||n>256||g[2]&&g[2]!==String(n))&&jC.throwArgumentError("invalid numeric width","type",e);var I=$C.mask(t?n-1:n),r=t?I.add(qC).mul(OC):_C;return function(g){var t=uC.from(g);return(t.lt(r)||t.gt(I))&&jC.throwArgumentError("value out-of-bounds for ".concat(e),"value",g),rC(t.toTwos(256).toHexString(),32)}}var C=e.match(/^bytes(\d+)$/);if(C){var l=parseInt(C[1]);return(0===l||l>32||C[1]!==String(l))&&jC.throwArgumentError("invalid bytes width","type",e),function(g){return Pr(g).length!==l&&jC.throwArgumentError("invalid length for ".concat(e),"value",g),function(e){var g=Pr(e),t=g.length%32;return t?nC([g,PC.slice(t)]):eC(g)}(g)}}switch(e){case"address":return function(e){return rC(HC(e),32)};case"bool":return function(e){return e?el:gl};case"bytes":return function(e){return ZC(e)};case"string":return function(e){return TC(e)}}return null}function ll(e,g){return"".concat(e,"(").concat(g.map((function(e){var g=e.name;return e.type+" "+g})).join(","),")")}var al=function(){function e(g){it(this,e),vr(this,"types",Object.freeze(Jr(g))),vr(this,"_encoderCache",{}),vr(this,"_types",{});var t={},n={},I={};Object.keys(g).forEach((function(e){t[e]={},n[e]=[],I[e]={}}));var r=function(e){var I={};g[e].forEach((function(r){I[r.name]&&jC.throwArgumentError("duplicate variable name ".concat(JSON.stringify(r.name)," in ").concat(JSON.stringify(e)),"types",g),I[r.name]=!0;var C=r.type.match(/^([^\x5b]*)(\x5b|$)/)[1];C===e&&jC.throwArgumentError("circular type reference to ".concat(JSON.stringify(C)),"types",g),Cl(C)||(n[C]||jC.throwArgumentError("unknown type ".concat(JSON.stringify(C)),"types",g),n[C].push(e),t[e][C]=!0)}))};for(var C in g)r(C);var l=Object.keys(n).filter((function(e){return 0===n[e].length}));for(var a in 0===l.length?jC.throwArgumentError("missing primary type","types",g):l.length>1&&jC.throwArgumentError("ambiguous primary types or unused types: ".concat(l.map((function(e){return JSON.stringify(e)})).join(", ")),"types",g),vr(this,"primaryType",l[0]),function e(r,C){C[r]&&jC.throwArgumentError("circular type reference to ".concat(JSON.stringify(r)),"types",g),C[r]=!0,Object.keys(t[r]).forEach((function(g){n[g]&&(e(g,C),Object.keys(C).forEach((function(e){I[e][g]=!0})))})),delete C[r]}(this.primaryType,{}),I){var o=Object.keys(I[a]);o.sort(),this._types[a]=ll(a,g[a])+o.map((function(e){return ll(e,g[e])})).join("")}}return ut(e,[{key:"getEncoder",value:function(e){var g=this._encoderCache[e];return g||(g=this._encoderCache[e]=this._getEncoder(e)),g}},{key:"_getEncoder",value:function(e){var g=this,t=Cl(e);if(t)return t;var n=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(n){var I=n[1],r=this.getEncoder(I),C=parseInt(n[3]);return function(e){C>=0&&e.length!==C&&jC.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",e);var t=e.map(r);return g._types[I]&&(t=t.map(ZC)),ZC(nC(t))}}var l=this.types[e];if(l){var a=TC(this._types[e]);return function(e){var t=l.map((function(t){var n=t.name,I=t.type,r=g.getEncoder(I)(e[n]);return g._types[I]?ZC(r):r}));return t.unshift(a),nC(t)}}return jC.throwArgumentError("unknown type: ".concat(e),"type",e)}},{key:"encodeType",value:function(e){var g=this._types[e];return g||jC.throwArgumentError("unknown type: ".concat(JSON.stringify(e)),"name",e),g}},{key:"encodeData",value:function(e,g){return this.getEncoder(e)(g)}},{key:"hashStruct",value:function(e,g){return ZC(this.encodeData(e,g))}},{key:"encode",value:function(e){return this.encodeData(this.primaryType,e)}},{key:"hash",value:function(e){return this.hashStruct(this.primaryType,e)}},{key:"_visit",value:function(e,g,t){var n=this;if(Cl(e))return t(e,g);var I=e.match(/^(.*)(\x5b(\d*)\x5d)$/);if(I){var r=I[1],C=parseInt(I[3]);return C>=0&&g.length!==C&&jC.throwArgumentError("array length mismatch; expected length ${ arrayLength }","value",g),g.map((function(e){return n._visit(r,e,t)}))}var l=this.types[e];return l?l.reduce((function(e,I){var r=I.name,C=I.type;return e[r]=n._visit(C,g[r],t),e}),{}):jC.throwArgumentError("unknown type: ".concat(e),"type",e)}},{key:"visit",value:function(e,g){return this._visit(this.primaryType,e,g)}}],[{key:"from",value:function(g){return new e(g)}},{key:"getPrimaryType",value:function(g){return e.from(g).primaryType}},{key:"hashStruct",value:function(g,t,n){return e.from(t).hashStruct(g,n)}},{key:"hashDomain",value:function(g){var t=[];for(var n in g){var I=tl[n];I||jC.throwArgumentError("invalid typed-data domain key: ".concat(JSON.stringify(n)),"domain",g),t.push({name:n,type:I})}return t.sort((function(e,g){return nl.indexOf(e.name)-nl.indexOf(g.name)})),e.hashStruct("EIP712Domain",{EIP712Domain:t},g)}},{key:"encode",value:function(g,t,n){return nC(["0x1901",e.hashDomain(g),e.from(t).hash(n)])}},{key:"hash",value:function(g,t,n){return ZC(e.encode(g,t,n))}},{key:"resolveNames",value:function(g,t,n,I){return DC(this,void 0,void 0,Ir().mark((function r(){var C,l,a;return Ir().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:g=Vr(g),C={},g.verifyingContract&&!qr(g.verifyingContract,20)&&(C[g.verifyingContract]="0x"),(l=e.from(t)).visit(n,(function(e,g){return"address"!==e||qr(g,20)||(C[g]="0x"),g})),r.t0=Ir().keys(C);case 6:if((r.t1=r.t0()).done){r.next=13;break}return a=r.t1.value,r.next=10,I(a);case 10:C[a]=r.sent,r.next=6;break;case 13:return g.verifyingContract&&C[g.verifyingContract]&&(g.verifyingContract=C[g.verifyingContract]),n=l.visit(n,(function(e,g){return"address"===e&&C[g]?C[g]:g})),r.abrupt("return",{domain:g,value:n});case 16:case"end":return r.stop()}}),r)})))}},{key:"getPayload",value:function(g,t,n){e.hashDomain(g);var I={},r=[];nl.forEach((function(e){var t=g[e];null!=t&&(I[e]=rl[e](t),r.push({name:e,type:tl[e]}))}));var C=e.from(t),l=Vr(t);return l.EIP712Domain?jC.throwArgumentError("types must not contain EIP712Domain type","types.EIP712Domain",t):l.EIP712Domain=r,C.encode(n),{types:l,domain:I,primaryType:C.primaryType,message:C.visit(n,(function(e,g){if(e.match(/^bytes(\d*)/))return eC(Pr(g));if(e.match(/^u?int/))return uC.from(g).toString();switch(e){case"address":return g.toLowerCase();case"bool":return!!g;case"string":return"string"!==typeof g&&jC.throwArgumentError("invalid string","value",g),g}return jC.throwArgumentError("unsupported type","type",e)}))}}}]),e}(),ol=uC.from(-1),il=uC.from(0),cl=uC.from(1),ul=uC.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),sl=t(3125),Al=t.n(sl);"undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof t.g?t.g:"undefined"!==typeof self&&self;function dl(e,g,t){return t={path:g,exports:{},require:function(e,g){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}((void 0===g||null===g)&&t.path)}},e(t,t.exports),t.exports}var ml=hl;function hl(e,g){if(!e)throw new Error(g||"Assertion failed")}hl.equal=function(e,g,t){if(e!=g)throw new Error(t||"Assertion failed: "+e+" != "+g)};var bl=dl((function(e,g){var t=g;function n(e){return 1===e.length?"0"+e:e}function I(e){for(var g="",t=0;t<e.length;t++)g+=n(e[t].toString(16));return g}t.toArray=function(e,g){if(Array.isArray(e))return e.slice();if(!e)return[];var t=[];if("string"!==typeof e){for(var n=0;n<e.length;n++)t[n]=0|e[n];return t}if("hex"===g){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!==0&&(e="0"+e);for(n=0;n<e.length;n+=2)t.push(parseInt(e[n]+e[n+1],16))}else for(n=0;n<e.length;n++){var I=e.charCodeAt(n),r=I>>8,C=255&I;r?t.push(r,C):t.push(C)}return t},t.zero2=n,t.toHex=I,t.encode=function(e,g){return"hex"===g?I(e):e}})),Zl=dl((function(e,g){var t=g;t.assert=ml,t.toArray=bl.toArray,t.zero2=bl.zero2,t.toHex=bl.toHex,t.encode=bl.encode,t.getNAF=function(e,g,t){var n=new Array(Math.max(e.bitLength(),t)+1);n.fill(0);for(var I=1<<g+1,r=e.clone(),C=0;C<n.length;C++){var l,a=r.andln(I-1);r.isOdd()?(l=a>(I>>1)-1?(I>>1)-a:a,r.isubn(l)):l=0,n[C]=l,r.iushrn(1)}return n},t.getJSF=function(e,g){var t=[[],[]];e=e.clone(),g=g.clone();for(var n,I=0,r=0;e.cmpn(-I)>0||g.cmpn(-r)>0;){var C,l,a=e.andln(3)+I&3,o=g.andln(3)+r&3;3===a&&(a=-1),3===o&&(o=-1),C=0===(1&a)?0:3!==(n=e.andln(7)+I&7)&&5!==n||2!==o?a:-a,t[0].push(C),l=0===(1&o)?0:3!==(n=g.andln(7)+r&7)&&5!==n||2!==a?o:-o,t[1].push(l),2*I===C+1&&(I=1-I),2*r===l+1&&(r=1-r),e.iushrn(1),g.iushrn(1)}return t},t.cachedProperty=function(e,g,t){var n="_"+g;e.prototype[g]=function(){return void 0!==this[n]?this[n]:this[n]=t.call(this)}},t.parseBytes=function(e){return"string"===typeof e?t.toArray(e,"hex"):e},t.intFromLE=function(e){return new(zr())(e,"hex","le")}})),pl=Zl.getNAF,yl=Zl.getJSF,Gl=Zl.assert;function fl(e,g){this.type=e,this.p=new(zr())(g.p,16),this.red=g.prime?zr().red(g.prime):zr().mont(this.p),this.zero=new(zr())(0).toRed(this.red),this.one=new(zr())(1).toRed(this.red),this.two=new(zr())(2).toRed(this.red),this.n=g.n&&new(zr())(g.n,16),this.g=g.g&&this.pointFromJSON(g.g,g.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var t=this.n&&this.p.div(this.n);!t||t.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Bl=fl;function vl(e,g){this.curve=e,this.type=g,this.precomputed=null}fl.prototype.point=function(){throw new Error("Not implemented")},fl.prototype.validate=function(){throw new Error("Not implemented")},fl.prototype._fixedNafMul=function(e,g){Gl(e.precomputed);var t=e._getDoubles(),n=pl(g,1,this._bitLength),I=(1<<t.step+1)-(t.step%2===0?2:1);I/=3;var r,C,l=[];for(r=0;r<n.length;r+=t.step){C=0;for(var a=r+t.step-1;a>=r;a--)C=(C<<1)+n[a];l.push(C)}for(var o=this.jpoint(null,null,null),i=this.jpoint(null,null,null),c=I;c>0;c--){for(r=0;r<l.length;r++)(C=l[r])===c?i=i.mixedAdd(t.points[r]):C===-c&&(i=i.mixedAdd(t.points[r].neg()));o=o.add(i)}return o.toP()},fl.prototype._wnafMul=function(e,g){var t=4,n=e._getNAFPoints(t);t=n.wnd;for(var I=n.points,r=pl(g,t,this._bitLength),C=this.jpoint(null,null,null),l=r.length-1;l>=0;l--){for(var a=0;l>=0&&0===r[l];l--)a++;if(l>=0&&a++,C=C.dblp(a),l<0)break;var o=r[l];Gl(0!==o),C="affine"===e.type?o>0?C.mixedAdd(I[o-1>>1]):C.mixedAdd(I[-o-1>>1].neg()):o>0?C.add(I[o-1>>1]):C.add(I[-o-1>>1].neg())}return"affine"===e.type?C.toP():C},fl.prototype._wnafMulAdd=function(e,g,t,n,I){var r,C,l,a=this._wnafT1,o=this._wnafT2,i=this._wnafT3,c=0;for(r=0;r<n;r++){var u=(l=g[r])._getNAFPoints(e);a[r]=u.wnd,o[r]=u.points}for(r=n-1;r>=1;r-=2){var s=r-1,A=r;if(1===a[s]&&1===a[A]){var d=[g[s],null,null,g[A]];0===g[s].y.cmp(g[A].y)?(d[1]=g[s].add(g[A]),d[2]=g[s].toJ().mixedAdd(g[A].neg())):0===g[s].y.cmp(g[A].y.redNeg())?(d[1]=g[s].toJ().mixedAdd(g[A]),d[2]=g[s].add(g[A].neg())):(d[1]=g[s].toJ().mixedAdd(g[A]),d[2]=g[s].toJ().mixedAdd(g[A].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],h=yl(t[s],t[A]);for(c=Math.max(h[0].length,c),i[s]=new Array(c),i[A]=new Array(c),C=0;C<c;C++){var b=0|h[0][C],Z=0|h[1][C];i[s][C]=m[3*(b+1)+(Z+1)],i[A][C]=0,o[s]=d}}else i[s]=pl(t[s],a[s],this._bitLength),i[A]=pl(t[A],a[A],this._bitLength),c=Math.max(i[s].length,c),c=Math.max(i[A].length,c)}var p=this.jpoint(null,null,null),y=this._wnafT4;for(r=c;r>=0;r--){for(var G=0;r>=0;){var f=!0;for(C=0;C<n;C++)y[C]=0|i[C][r],0!==y[C]&&(f=!1);if(!f)break;G++,r--}if(r>=0&&G++,p=p.dblp(G),r<0)break;for(C=0;C<n;C++){var B=y[C];0!==B&&(B>0?l=o[C][B-1>>1]:B<0&&(l=o[C][-B-1>>1].neg()),p="affine"===l.type?p.mixedAdd(l):p.add(l))}}for(r=0;r<n;r++)o[r]=null;return I?p:p.toP()},fl.BasePoint=vl,vl.prototype.eq=function(){throw new Error("Not implemented")},vl.prototype.validate=function(){return this.curve.validate(this)},fl.prototype.decodePoint=function(e,g){e=Zl.toArray(e,g);var t=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1===2*t)return 6===e[0]?Gl(e[e.length-1]%2===0):7===e[0]&&Gl(e[e.length-1]%2===1),this.point(e.slice(1,1+t),e.slice(1+t,1+2*t));if((2===e[0]||3===e[0])&&e.length-1===t)return this.pointFromX(e.slice(1,1+t),3===e[0]);throw new Error("Unknown point format")},vl.prototype.encodeCompressed=function(e){return this.encode(e,!0)},vl.prototype._encode=function(e){var g=this.curve.p.byteLength(),t=this.getX().toArray("be",g);return e?[this.getY().isEven()?2:3].concat(t):[4].concat(t,this.getY().toArray("be",g))},vl.prototype.encode=function(e,g){return Zl.encode(this._encode(g),e)},vl.prototype.precompute=function(e){if(this.precomputed)return this;var g={doubles:null,naf:null,beta:null};return g.naf=this._getNAFPoints(8),g.doubles=this._getDoubles(4,e),g.beta=this._getBeta(),this.precomputed=g,this},vl.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var g=this.precomputed.doubles;return!!g&&g.points.length>=Math.ceil((e.bitLength()+1)/g.step)},vl.prototype._getDoubles=function(e,g){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var t=[this],n=this,I=0;I<g;I+=e){for(var r=0;r<e;r++)n=n.dbl();t.push(n)}return{step:e,points:t}},vl.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var g=[this],t=(1<<e)-1,n=1===t?null:this.dbl(),I=1;I<t;I++)g[I]=g[I-1].add(n);return{wnd:e,points:g}},vl.prototype._getBeta=function(){return null},vl.prototype.dblp=function(e){for(var g=this,t=0;t<e;t++)g=g.dbl();return g};var Sl=dl((function(e){"function"===typeof Object.create?e.exports=function(e,g){g&&(e.super_=g,e.prototype=Object.create(g.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,g){if(g){e.super_=g;var t=function(){};t.prototype=g.prototype,e.prototype=new t,e.prototype.constructor=e}}})),Wl=Zl.assert;function Vl(e){Bl.call(this,"short",e),this.a=new(zr())(e.a,16).toRed(this.red),this.b=new(zr())(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Sl(Vl,Bl);var kl=Vl;function Rl(e,g,t,n){Bl.BasePoint.call(this,e,"affine"),null===g&&null===t?(this.x=null,this.y=null,this.inf=!0):(this.x=new(zr())(g,16),this.y=new(zr())(t,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function Xl(e,g,t,n){Bl.BasePoint.call(this,e,"jacobian"),null===g&&null===t&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new(zr())(0)):(this.x=new(zr())(g,16),this.y=new(zr())(t,16),this.z=new(zr())(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Vl.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var g,t;if(e.beta)g=new(zr())(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);g=(g=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)t=new(zr())(e.lambda,16);else{var I=this._getEndoRoots(this.n);0===this.g.mul(I[0]).x.cmp(this.g.x.redMul(g))?t=I[0]:(t=I[1],Wl(0===this.g.mul(t).x.cmp(this.g.x.redMul(g))))}return{beta:g,lambda:t,basis:e.basis?e.basis.map((function(e){return{a:new(zr())(e.a,16),b:new(zr())(e.b,16)}})):this._getEndoBasis(t)}}},Vl.prototype._getEndoRoots=function(e){var g=e===this.p?this.red:zr().mont(e),t=new(zr())(2).toRed(g).redInvm(),n=t.redNeg(),I=new(zr())(3).toRed(g).redNeg().redSqrt().redMul(t);return[n.redAdd(I).fromRed(),n.redSub(I).fromRed()]},Vl.prototype._getEndoBasis=function(e){for(var g,t,n,I,r,C,l,a,o,i=this.n.ushrn(Math.floor(this.n.bitLength()/2)),c=e,u=this.n.clone(),s=new(zr())(1),A=new(zr())(0),d=new(zr())(0),m=new(zr())(1),h=0;0!==c.cmpn(0);){var b=u.div(c);a=u.sub(b.mul(c)),o=d.sub(b.mul(s));var Z=m.sub(b.mul(A));if(!n&&a.cmp(i)<0)g=l.neg(),t=s,n=a.neg(),I=o;else if(n&&2===++h)break;l=a,u=c,c=a,d=s,s=o,m=A,A=Z}r=a.neg(),C=o;var p=n.sqr().add(I.sqr());return r.sqr().add(C.sqr()).cmp(p)>=0&&(r=g,C=t),n.negative&&(n=n.neg(),I=I.neg()),r.negative&&(r=r.neg(),C=C.neg()),[{a:n,b:I},{a:r,b:C}]},Vl.prototype._endoSplit=function(e){var g=this.endo.basis,t=g[0],n=g[1],I=n.b.mul(e).divRound(this.n),r=t.b.neg().mul(e).divRound(this.n),C=I.mul(t.a),l=r.mul(n.a),a=I.mul(t.b),o=r.mul(n.b);return{k1:e.sub(C).sub(l),k2:a.add(o).neg()}},Vl.prototype.pointFromX=function(e,g){(e=new(zr())(e,16)).red||(e=e.toRed(this.red));var t=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=t.redSqrt();if(0!==n.redSqr().redSub(t).cmp(this.zero))throw new Error("invalid point");var I=n.fromRed().isOdd();return(g&&!I||!g&&I)&&(n=n.redNeg()),this.point(e,n)},Vl.prototype.validate=function(e){if(e.inf)return!0;var g=e.x,t=e.y,n=this.a.redMul(g),I=g.redSqr().redMul(g).redIAdd(n).redIAdd(this.b);return 0===t.redSqr().redISub(I).cmpn(0)},Vl.prototype._endoWnafMulAdd=function(e,g,t){for(var n=this._endoWnafT1,I=this._endoWnafT2,r=0;r<e.length;r++){var C=this._endoSplit(g[r]),l=e[r],a=l._getBeta();C.k1.negative&&(C.k1.ineg(),l=l.neg(!0)),C.k2.negative&&(C.k2.ineg(),a=a.neg(!0)),n[2*r]=l,n[2*r+1]=a,I[2*r]=C.k1,I[2*r+1]=C.k2}for(var o=this._wnafMulAdd(1,n,I,2*r,t),i=0;i<2*r;i++)n[i]=null,I[i]=null;return o},Sl(Rl,Bl.BasePoint),Vl.prototype.point=function(e,g,t){return new Rl(this,e,g,t)},Vl.prototype.pointFromJSON=function(e,g){return Rl.fromJSON(this,e,g)},Rl.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var g=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var t=this.curve,n=function(e){return t.point(e.x.redMul(t.endo.beta),e.y)};e.beta=g,g.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return g}},Rl.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Rl.fromJSON=function(e,g,t){"string"===typeof g&&(g=JSON.parse(g));var n=e.point(g[0],g[1],t);if(!g[2])return n;function I(g){return e.point(g[0],g[1],t)}var r=g[2];return n.precomputed={beta:null,doubles:r.doubles&&{step:r.doubles.step,points:[n].concat(r.doubles.points.map(I))},naf:r.naf&&{wnd:r.naf.wnd,points:[n].concat(r.naf.points.map(I))}},n},Rl.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Rl.prototype.isInfinity=function(){return this.inf},Rl.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var g=this.y.redSub(e.y);0!==g.cmpn(0)&&(g=g.redMul(this.x.redSub(e.x).redInvm()));var t=g.redSqr().redISub(this.x).redISub(e.x),n=g.redMul(this.x.redSub(t)).redISub(this.y);return this.curve.point(t,n)},Rl.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var g=this.curve.a,t=this.x.redSqr(),n=e.redInvm(),I=t.redAdd(t).redIAdd(t).redIAdd(g).redMul(n),r=I.redSqr().redISub(this.x.redAdd(this.x)),C=I.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,C)},Rl.prototype.getX=function(){return this.x.fromRed()},Rl.prototype.getY=function(){return this.y.fromRed()},Rl.prototype.mul=function(e){return e=new(zr())(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},Rl.prototype.mulAdd=function(e,g,t){var n=[this,g],I=[e,t];return this.curve.endo?this.curve._endoWnafMulAdd(n,I):this.curve._wnafMulAdd(1,n,I,2)},Rl.prototype.jmulAdd=function(e,g,t){var n=[this,g],I=[e,t];return this.curve.endo?this.curve._endoWnafMulAdd(n,I,!0):this.curve._wnafMulAdd(1,n,I,2,!0)},Rl.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},Rl.prototype.neg=function(e){if(this.inf)return this;var g=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var t=this.precomputed,n=function(e){return e.neg()};g.precomputed={naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(n)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(n)}}}return g},Rl.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},Sl(Xl,Bl.BasePoint),Vl.prototype.jpoint=function(e,g,t){return new Xl(this,e,g,t)},Xl.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),g=e.redSqr(),t=this.x.redMul(g),n=this.y.redMul(g).redMul(e);return this.curve.point(t,n)},Xl.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},Xl.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var g=e.z.redSqr(),t=this.z.redSqr(),n=this.x.redMul(g),I=e.x.redMul(t),r=this.y.redMul(g.redMul(e.z)),C=e.y.redMul(t.redMul(this.z)),l=n.redSub(I),a=r.redSub(C);if(0===l.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var o=l.redSqr(),i=o.redMul(l),c=n.redMul(o),u=a.redSqr().redIAdd(i).redISub(c).redISub(c),s=a.redMul(c.redISub(u)).redISub(r.redMul(i)),A=this.z.redMul(e.z).redMul(l);return this.curve.jpoint(u,s,A)},Xl.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var g=this.z.redSqr(),t=this.x,n=e.x.redMul(g),I=this.y,r=e.y.redMul(g).redMul(this.z),C=t.redSub(n),l=I.redSub(r);if(0===C.cmpn(0))return 0!==l.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var a=C.redSqr(),o=a.redMul(C),i=t.redMul(a),c=l.redSqr().redIAdd(o).redISub(i).redISub(i),u=l.redMul(i.redISub(c)).redISub(I.redMul(o)),s=this.z.redMul(C);return this.curve.jpoint(c,u,s)},Xl.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var g;if(this.curve.zeroA||this.curve.threeA){var t=this;for(g=0;g<e;g++)t=t.dbl();return t}var n=this.curve.a,I=this.curve.tinv,r=this.x,C=this.y,l=this.z,a=l.redSqr().redSqr(),o=C.redAdd(C);for(g=0;g<e;g++){var i=r.redSqr(),c=o.redSqr(),u=c.redSqr(),s=i.redAdd(i).redIAdd(i).redIAdd(n.redMul(a)),A=r.redMul(c),d=s.redSqr().redISub(A.redAdd(A)),m=A.redISub(d),h=s.redMul(m);h=h.redIAdd(h).redISub(u);var b=o.redMul(l);g+1<e&&(a=a.redMul(u)),r=d,l=b,o=h}return this.curve.jpoint(r,o.redMul(I),l)},Xl.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},Xl.prototype._zeroDbl=function(){var e,g,t;if(this.zOne){var n=this.x.redSqr(),I=this.y.redSqr(),r=I.redSqr(),C=this.x.redAdd(I).redSqr().redISub(n).redISub(r);C=C.redIAdd(C);var l=n.redAdd(n).redIAdd(n),a=l.redSqr().redISub(C).redISub(C),o=r.redIAdd(r);o=(o=o.redIAdd(o)).redIAdd(o),e=a,g=l.redMul(C.redISub(a)).redISub(o),t=this.y.redAdd(this.y)}else{var i=this.x.redSqr(),c=this.y.redSqr(),u=c.redSqr(),s=this.x.redAdd(c).redSqr().redISub(i).redISub(u);s=s.redIAdd(s);var A=i.redAdd(i).redIAdd(i),d=A.redSqr(),m=u.redIAdd(u);m=(m=m.redIAdd(m)).redIAdd(m),e=d.redISub(s).redISub(s),g=A.redMul(s.redISub(e)).redISub(m),t=(t=this.y.redMul(this.z)).redIAdd(t)}return this.curve.jpoint(e,g,t)},Xl.prototype._threeDbl=function(){var e,g,t;if(this.zOne){var n=this.x.redSqr(),I=this.y.redSqr(),r=I.redSqr(),C=this.x.redAdd(I).redSqr().redISub(n).redISub(r);C=C.redIAdd(C);var l=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),a=l.redSqr().redISub(C).redISub(C);e=a;var o=r.redIAdd(r);o=(o=o.redIAdd(o)).redIAdd(o),g=l.redMul(C.redISub(a)).redISub(o),t=this.y.redAdd(this.y)}else{var i=this.z.redSqr(),c=this.y.redSqr(),u=this.x.redMul(c),s=this.x.redSub(i).redMul(this.x.redAdd(i));s=s.redAdd(s).redIAdd(s);var A=u.redIAdd(u),d=(A=A.redIAdd(A)).redAdd(A);e=s.redSqr().redISub(d),t=this.y.redAdd(this.z).redSqr().redISub(c).redISub(i);var m=c.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),g=s.redMul(A.redISub(e)).redISub(m)}return this.curve.jpoint(e,g,t)},Xl.prototype._dbl=function(){var e=this.curve.a,g=this.x,t=this.y,n=this.z,I=n.redSqr().redSqr(),r=g.redSqr(),C=t.redSqr(),l=r.redAdd(r).redIAdd(r).redIAdd(e.redMul(I)),a=g.redAdd(g),o=(a=a.redIAdd(a)).redMul(C),i=l.redSqr().redISub(o.redAdd(o)),c=o.redISub(i),u=C.redSqr();u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var s=l.redMul(c).redISub(u),A=t.redAdd(t).redMul(n);return this.curve.jpoint(i,s,A)},Xl.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),g=this.y.redSqr(),t=this.z.redSqr(),n=g.redSqr(),I=e.redAdd(e).redIAdd(e),r=I.redSqr(),C=this.x.redAdd(g).redSqr().redISub(e).redISub(n),l=(C=(C=(C=C.redIAdd(C)).redAdd(C).redIAdd(C)).redISub(r)).redSqr(),a=n.redIAdd(n);a=(a=(a=a.redIAdd(a)).redIAdd(a)).redIAdd(a);var o=I.redIAdd(C).redSqr().redISub(r).redISub(l).redISub(a),i=g.redMul(o);i=(i=i.redIAdd(i)).redIAdd(i);var c=this.x.redMul(l).redISub(i);c=(c=c.redIAdd(c)).redIAdd(c);var u=this.y.redMul(o.redMul(a.redISub(o)).redISub(C.redMul(l)));u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var s=this.z.redAdd(C).redSqr().redISub(t).redISub(l);return this.curve.jpoint(c,u,s)},Xl.prototype.mul=function(e,g){return e=new(zr())(e,g),this.curve._wnafMul(this,e)},Xl.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var g=this.z.redSqr(),t=e.z.redSqr();if(0!==this.x.redMul(t).redISub(e.x.redMul(g)).cmpn(0))return!1;var n=g.redMul(this.z),I=t.redMul(e.z);return 0===this.y.redMul(I).redISub(e.y.redMul(n)).cmpn(0)},Xl.prototype.eqXToP=function(e){var g=this.z.redSqr(),t=e.toRed(this.curve.red).redMul(g);if(0===this.x.cmp(t))return!0;for(var n=e.clone(),I=this.curve.redN.redMul(g);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(I),0===this.x.cmp(t))return!0}},Xl.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},Xl.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};var Jl=dl((function(e,g){var t=g;t.base=Bl,t.short=kl,t.mont=null,t.edwards=null})),Yl=dl((function(e,g){var t,n=g,I=Zl.assert;function r(e){"short"===e.type?this.curve=new Jl.short(e):"edwards"===e.type?this.curve=new Jl.edwards(e):this.curve=new Jl.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,I(this.g.validate(),"Invalid curve"),I(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function C(e,g){Object.defineProperty(n,e,{configurable:!0,enumerable:!0,get:function(){var t=new r(g);return Object.defineProperty(n,e,{configurable:!0,enumerable:!0,value:t}),t}})}n.PresetCurve=r,C("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Al().sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),C("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Al().sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),C("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Al().sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),C("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Al().sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),C("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Al().sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),C("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Al().sha256,gRed:!1,g:["9"]}),C("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Al().sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{t=null.crash()}catch(Hb){t=void 0}C("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Al().sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",t]})}));function wl(e){if(!(this instanceof wl))return new wl(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var g=bl.toArray(e.entropy,e.entropyEnc||"hex"),t=bl.toArray(e.nonce,e.nonceEnc||"hex"),n=bl.toArray(e.pers,e.persEnc||"hex");ml(g.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(g,t,n)}var Hl=wl;wl.prototype._init=function(e,g,t){var n=e.concat(g).concat(t);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var I=0;I<this.V.length;I++)this.K[I]=0,this.V[I]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},wl.prototype._hmac=function(){return new(Al().hmac)(this.hash,this.K)},wl.prototype._update=function(e){var g=this._hmac().update(this.V).update([0]);e&&(g=g.update(e)),this.K=g.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},wl.prototype.reseed=function(e,g,t,n){"string"!==typeof g&&(n=t,t=g,g=null),e=bl.toArray(e,g),t=bl.toArray(t,n),ml(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(t||[])),this._reseed=1},wl.prototype.generate=function(e,g,t,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!==typeof g&&(n=t,t=g,g=null),t&&(t=bl.toArray(t,n||"hex"),this._update(t));for(var I=[];I.length<e;)this.V=this._hmac().update(this.V).digest(),I=I.concat(this.V);var r=I.slice(0,e);return this._update(t),this._reseed++,bl.encode(r,g)};var Nl=Zl.assert;function Fl(e,g){this.ec=e,this.priv=null,this.pub=null,g.priv&&this._importPrivate(g.priv,g.privEnc),g.pub&&this._importPublic(g.pub,g.pubEnc)}var Kl=Fl;Fl.fromPublic=function(e,g,t){return g instanceof Fl?g:new Fl(e,{pub:g,pubEnc:t})},Fl.fromPrivate=function(e,g,t){return g instanceof Fl?g:new Fl(e,{priv:g,privEnc:t})},Fl.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},Fl.prototype.getPublic=function(e,g){return"string"===typeof e&&(g=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),g?this.pub.encode(g,e):this.pub},Fl.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},Fl.prototype._importPrivate=function(e,g){this.priv=new(zr())(e,g||16),this.priv=this.priv.umod(this.ec.curve.n)},Fl.prototype._importPublic=function(e,g){if(e.x||e.y)return"mont"===this.ec.curve.type?Nl(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||Nl(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,g)},Fl.prototype.derive=function(e){return e.validate()||Nl(e.validate(),"public point not validated"),e.mul(this.priv).getX()},Fl.prototype.sign=function(e,g,t){return this.ec.sign(e,this,g,t)},Fl.prototype.verify=function(e,g){return this.ec.verify(e,g,this)},Fl.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var xl=Zl.assert;function El(e,g){if(e instanceof El)return e;this._importDER(e,g)||(xl(e.r&&e.s,"Signature without r or s"),this.r=new(zr())(e.r,16),this.s=new(zr())(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}var Ml=El;function zl(){this.place=0}function Ul(e,g){var t=e[g.place++];if(!(128&t))return t;var n=15&t;if(0===n||n>4)return!1;for(var I=0,r=0,C=g.place;r<n;r++,C++)I<<=8,I|=e[C],I>>>=0;return!(I<=127)&&(g.place=C,I)}function Ql(e){for(var g=0,t=e.length-1;!e[g]&&!(128&e[g+1])&&g<t;)g++;return 0===g?e:e.slice(g)}function Ll(e,g){if(g<128)e.push(g);else{var t=1+(Math.log(g)/Math.LN2>>>3);for(e.push(128|t);--t;)e.push(g>>>(t<<3)&255);e.push(g)}}El.prototype._importDER=function(e,g){e=Zl.toArray(e,g);var t=new zl;if(48!==e[t.place++])return!1;var n=Ul(e,t);if(!1===n)return!1;if(n+t.place!==e.length)return!1;if(2!==e[t.place++])return!1;var I=Ul(e,t);if(!1===I)return!1;var r=e.slice(t.place,I+t.place);if(t.place+=I,2!==e[t.place++])return!1;var C=Ul(e,t);if(!1===C)return!1;if(e.length!==C+t.place)return!1;var l=e.slice(t.place,C+t.place);if(0===r[0]){if(!(128&r[1]))return!1;r=r.slice(1)}if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}return this.r=new(zr())(r),this.s=new(zr())(l),this.recoveryParam=null,!0},El.prototype.toDER=function(e){var g=this.r.toArray(),t=this.s.toArray();for(128&g[0]&&(g=[0].concat(g)),128&t[0]&&(t=[0].concat(t)),g=Ql(g),t=Ql(t);!t[0]&&!(128&t[1]);)t=t.slice(1);var n=[2];Ll(n,g.length),(n=n.concat(g)).push(2),Ll(n,t.length);var I=n.concat(t),r=[48];return Ll(r,I.length),r=r.concat(I),Zl.encode(r,e)};var Tl=function(){throw new Error("unsupported")},Dl=Zl.assert;function jl(e){if(!(this instanceof jl))return new jl(e);"string"===typeof e&&(Dl(Object.prototype.hasOwnProperty.call(Yl,e),"Unknown curve "+e),e=Yl[e]),e instanceof Yl.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}var Pl=jl;jl.prototype.keyPair=function(e){return new Kl(this,e)},jl.prototype.keyFromPrivate=function(e,g){return Kl.fromPrivate(this,e,g)},jl.prototype.keyFromPublic=function(e,g){return Kl.fromPublic(this,e,g)},jl.prototype.genKeyPair=function(e){e||(e={});for(var g=new Hl({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||Tl(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),t=this.n.byteLength(),n=this.n.sub(new(zr())(2));;){var I=new(zr())(g.generate(t));if(!(I.cmp(n)>0))return I.iaddn(1),this.keyFromPrivate(I)}},jl.prototype._truncateToN=function(e,g){var t=8*e.byteLength()-this.n.bitLength();return t>0&&(e=e.ushrn(t)),!g&&e.cmp(this.n)>=0?e.sub(this.n):e},jl.prototype.sign=function(e,g,t,n){"object"===typeof t&&(n=t,t=null),n||(n={}),g=this.keyFromPrivate(g,t),e=this._truncateToN(new(zr())(e,16));for(var I=this.n.byteLength(),r=g.getPrivate().toArray("be",I),C=e.toArray("be",I),l=new Hl({hash:this.hash,entropy:r,nonce:C,pers:n.pers,persEnc:n.persEnc||"utf8"}),a=this.n.sub(new(zr())(1)),o=0;;o++){var i=n.k?n.k(o):new(zr())(l.generate(this.n.byteLength()));if(!((i=this._truncateToN(i,!0)).cmpn(1)<=0||i.cmp(a)>=0)){var c=this.g.mul(i);if(!c.isInfinity()){var u=c.getX(),s=u.umod(this.n);if(0!==s.cmpn(0)){var A=i.invm(this.n).mul(s.mul(g.getPrivate()).iadd(e));if(0!==(A=A.umod(this.n)).cmpn(0)){var d=(c.getY().isOdd()?1:0)|(0!==u.cmp(s)?2:0);return n.canonical&&A.cmp(this.nh)>0&&(A=this.n.sub(A),d^=1),new Ml({r:s,s:A,recoveryParam:d})}}}}}},jl.prototype.verify=function(e,g,t,n){e=this._truncateToN(new(zr())(e,16)),t=this.keyFromPublic(t,n);var I=(g=new Ml(g,"hex")).r,r=g.s;if(I.cmpn(1)<0||I.cmp(this.n)>=0)return!1;if(r.cmpn(1)<0||r.cmp(this.n)>=0)return!1;var C,l=r.invm(this.n),a=l.mul(e).umod(this.n),o=l.mul(I).umod(this.n);return this.curve._maxwellTrick?!(C=this.g.jmulAdd(a,t.getPublic(),o)).isInfinity()&&C.eqXToP(I):!(C=this.g.mulAdd(a,t.getPublic(),o)).isInfinity()&&0===C.getX().umod(this.n).cmp(I)},jl.prototype.recoverPubKey=function(e,g,t,n){Dl((3&t)===t,"The recovery param is more than two bits"),g=new Ml(g,n);var I=this.n,r=new(zr())(e),C=g.r,l=g.s,a=1&t,o=t>>1;if(C.cmp(this.curve.p.umod(this.curve.n))>=0&&o)throw new Error("Unable to find sencond key candinate");C=o?this.curve.pointFromX(C.add(this.curve.n),a):this.curve.pointFromX(C,a);var i=g.r.invm(I),c=I.sub(r).mul(i).umod(I),u=l.mul(i).umod(I);return this.g.mulAdd(c,C,u)},jl.prototype.getKeyRecoveryParam=function(e,g,t,n){if(null!==(g=new Ml(g,n)).recoveryParam)return g.recoveryParam;for(var I=0;I<4;I++){var r;try{r=this.recoverPubKey(e,g,I)}catch(e){continue}if(r.eq(t))return I}throw new Error("Unable to find valid recovery factor")};var Ol=dl((function(e,g){var t=g;t.version="6.5.4",t.utils=Zl,t.rand=function(){throw new Error("unsupported")},t.curve=Jl,t.curves=Yl,t.ec=Pl,t.eddsa=null})).ec,_l=new Gr("signing-key/5.7.0"),ql=null;function $l(){return ql||(ql=new Ol("secp256k1")),ql}var ea=function(){function e(g){it(this,e),vr(this,"curve","secp256k1"),vr(this,"privateKey",eC(g)),32!==gC(this.privateKey)&&_l.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");var t=$l().keyFromPrivate(Pr(this.privateKey));vr(this,"publicKey","0x"+t.getPublic(!1,"hex")),vr(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),vr(this,"_isSigningKey",!0)}return ut(e,[{key:"_addPoint",value:function(e){var g=$l().keyFromPublic(Pr(this.publicKey)),t=$l().keyFromPublic(Pr(e));return"0x"+g.pub.add(t.pub).encodeCompressed("hex")}},{key:"signDigest",value:function(e){var g=$l().keyFromPrivate(Pr(this.privateKey)),t=Pr(e);32!==t.length&&_l.throwArgumentError("bad digest length","digest",e);var n=g.sign(t,{canonical:!0});return CC({recoveryParam:n.recoveryParam,r:rC("0x"+n.r.toString(16),32),s:rC("0x"+n.s.toString(16),32)})}},{key:"computeSharedSecret",value:function(e){var g=$l().keyFromPrivate(Pr(this.privateKey)),t=$l().keyFromPublic(Pr(ga(e)));return rC("0x"+g.derive(t.getPublic()).toString(16),32)}}],[{key:"isSigningKey",value:function(e){return!(!e||!e._isSigningKey)}}]),e}();function ga(e,g){var t=Pr(e);if(32===t.length){var n=new ea(t);return g?"0x"+$l().keyFromPrivate(t).getPublic(!0,"hex"):n.publicKey}return 33===t.length?g?eC(t):"0x"+$l().keyFromPublic(t).getPublic(!1,"hex"):65===t.length?g?"0x"+$l().keyFromPublic(t).getPublic(!0,"hex"):eC(t):_l.throwArgumentError("invalid public or private key","key","[REDACTED]")}var ta,na=new Gr("transactions/5.7.0");function Ia(e){return"0x"===e?null:HC(e)}function ra(e){return"0x"===e?il:uC.from(e)}!function(e){e[e.legacy=0]="legacy",e[e.eip2930=1]="eip2930",e[e.eip1559=2]="eip1559"}(ta||(ta={}));function Ca(e,g){return function(e){return HC(tC(ZC(tC(ga(e),1)),12))}(function(e,g){var t=CC(g),n={r:Pr(t.r),s:Pr(t.s)};return"0x"+$l().recoverPubKey(Pr(e),n,t.recoveryParam).encode("hex",!1)}(Pr(e),g))}function la(e,g){var t=_r(uC.from(e).toHexString());return t.length>32&&na.throwArgumentError("invalid length for "+g,"transaction:"+g,e),t}function aa(e,g){return{address:HC(e),storageKeys:(g||[]).map((function(g,t){return 32!==gC(g)&&na.throwArgumentError("invalid access list storageKey","accessList[".concat(e,":").concat(t,"]"),g),g.toLowerCase()}))}}function oa(e){if(Array.isArray(e))return e.map((function(e,g){return Array.isArray(e)?(e.length>2&&na.throwArgumentError("access list expected to be [ address, storageKeys[] ]","value[".concat(g,"]"),e),aa(e[0],e[1])):aa(e.address,e.storageKeys)}));var g=Object.keys(e).map((function(g){var t=e[g].reduce((function(e,g){return e[g]=!0,e}),{});return aa(g,Object.keys(t).sort())}));return g.sort((function(e,g){return e.address.localeCompare(g.address)})),g}function ia(e){return oa(e).map((function(e){return[e.address,e.storageKeys]}))}function ca(e,g){if(null!=e.gasPrice){var t=uC.from(e.gasPrice),n=uC.from(e.maxFeePerGas||0);t.eq(n)||na.throwArgumentError("mismatch EIP-1559 gasPrice != maxFeePerGas","tx",{gasPrice:t,maxFeePerGas:n})}var I=[la(e.chainId||0,"chainId"),la(e.nonce||0,"nonce"),la(e.maxPriorityFeePerGas||0,"maxPriorityFeePerGas"),la(e.maxFeePerGas||0,"maxFeePerGas"),la(e.gasLimit||0,"gasLimit"),null!=e.to?HC(e.to):"0x",la(e.value||0,"value"),e.data||"0x",ia(e.accessList||[])];if(g){var r=CC(g);I.push(la(r.recoveryParam,"recoveryParam")),I.push(_r(r.r)),I.push(_r(r.s))}return nC(["0x02",BC(I)])}function ua(e,g){var t=[la(e.chainId||0,"chainId"),la(e.nonce||0,"nonce"),la(e.gasPrice||0,"gasPrice"),la(e.gasLimit||0,"gasLimit"),null!=e.to?HC(e.to):"0x",la(e.value||0,"value"),e.data||"0x",ia(e.accessList||[])];if(g){var n=CC(g);t.push(la(n.recoveryParam,"recoveryParam")),t.push(_r(n.r)),t.push(_r(n.s))}return nC(["0x01",BC(t)])}function sa(e,g,t){try{var n=ra(g[0]).toNumber();if(0!==n&&1!==n)throw new Error("bad recid");e.v=n}catch(r){na.throwArgumentError("invalid v for transaction type: 1","v",g[0])}e.r=rC(g[1],32),e.s=rC(g[2],32);try{var I=ZC(t(e));e.from=Ca(I,{r:e.r,s:e.s,recoveryParam:e.v})}catch(r){}}function Aa(e){var g=Pr(e);if(g[0]>127)return function(e){var g=WC(e);9!==g.length&&6!==g.length&&na.throwArgumentError("invalid raw transaction","rawTransaction",e);var t={nonce:ra(g[0]).toNumber(),gasPrice:ra(g[1]),gasLimit:ra(g[2]),to:Ia(g[3]),value:ra(g[4]),data:g[5],chainId:0};if(6===g.length)return t;try{t.v=uC.from(g[6]).toNumber()}catch(C){return t}if(t.r=rC(g[7],32),t.s=rC(g[8],32),uC.from(t.r).isZero()&&uC.from(t.s).isZero())t.chainId=t.v,t.v=0;else{t.chainId=Math.floor((t.v-35)/2),t.chainId<0&&(t.chainId=0);var n=t.v-27,I=g.slice(0,6);0!==t.chainId&&(I.push(eC(t.chainId)),I.push("0x"),I.push("0x"),n-=2*t.chainId+8);var r=ZC(BC(I));try{t.from=Ca(r,{r:eC(t.r),s:eC(t.s),recoveryParam:n})}catch(C){}t.hash=ZC(e)}return t.type=null,t}(g);switch(g[0]){case 1:return function(e){var g=WC(e.slice(1));8!==g.length&&11!==g.length&&na.throwArgumentError("invalid component count for transaction type: 1","payload",eC(e));var t={type:1,chainId:ra(g[0]).toNumber(),nonce:ra(g[1]).toNumber(),gasPrice:ra(g[2]),gasLimit:ra(g[3]),to:Ia(g[4]),value:ra(g[5]),data:g[6],accessList:oa(g[7])};return 8===g.length||(t.hash=ZC(e),sa(t,g.slice(8),ua)),t}(g);case 2:return function(e){var g=WC(e.slice(1));9!==g.length&&12!==g.length&&na.throwArgumentError("invalid component count for transaction type: 2","payload",eC(e));var t=ra(g[2]),n=ra(g[3]),I={type:2,chainId:ra(g[0]).toNumber(),nonce:ra(g[1]).toNumber(),maxPriorityFeePerGas:t,maxFeePerGas:n,gasPrice:null,gasLimit:ra(g[4]),to:Ia(g[5]),value:ra(g[6]),data:g[7],accessList:oa(g[8])};return 9===g.length||(I.hash=ZC(e),sa(I,g.slice(9),ca)),I}(g)}return na.throwError("unsupported transaction type: ".concat(g[0]),Gr.errors.UNSUPPORTED_OPERATION,{operation:"parseTransaction",transactionType:g[0]})}function da(e){e=atob(e);for(var g=[],t=0;t<e.length;t++)g.push(e.charCodeAt(t));return Pr(g)}function ma(e){e=Pr(e);for(var g="",t=0;t<e.length;t++)g+=String.fromCharCode(e[t]);return btoa(g)}var ha=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))};function ba(e,g){return ha(this,void 0,void 0,Ir().mark((function t(){var n,I,r,C,l;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==g&&(g={}),n={method:g.method||"GET",headers:g.headers||{},body:g.body||void 0},!0!==g.skipFetchSetup&&(n.mode="cors",n.cache="no-cache",n.credentials="same-origin",n.redirect="follow",n.referrer="client"),null!=g.fetchOptions&&((I=g.fetchOptions).mode&&(n.mode=I.mode),I.cache&&(n.cache=I.cache),I.credentials&&(n.credentials=I.credentials),I.redirect&&(n.redirect=I.redirect),I.referrer&&(n.referrer=I.referrer)),t.next=7,fetch(e,n);case 7:return r=t.sent,t.next=10,r.arrayBuffer();case 10:return C=t.sent,l={},r.headers.forEach?r.headers.forEach((function(e,g){l[g.toLowerCase()]=e})):r.headers.keys().forEach((function(e){l[e.toLowerCase()]=r.headers.get(e)})),t.abrupt("return",{headers:l,statusCode:r.status,statusMessage:r.statusText,body:Pr(new Uint8Array(C))});case 14:case"end":return t.stop()}}),t)})))}var Za=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},pa=new Gr("web/5.7.1");function ya(e){return new Promise((function(g){setTimeout(g,e)}))}function Ga(e,g){if(null==e)return null;if("string"===typeof e)return e;if(Tr(e)){if(g&&("text"===g.split("/")[0]||"application/json"===g.split(";")[0].trim()))try{return LC(e)}catch(t){}return eC(e)}return e}function fa(e,g,t){var n=null;if(null!=g){n=QC(g);var I="string"===typeof e?{url:e}:Vr(e);if(I.headers){var r=0!==Object.keys(I.headers).filter((function(e){return"content-type"===e.toLowerCase()})).length;r||(I.headers=Vr(I.headers),I.headers["content-type"]="application/json")}else I.headers={"content-type":"application/json"};e=I}return function(e,g,t){var n="object"===typeof e&&null!=e.throttleLimit?e.throttleLimit:12;pa.assertArgument(n>0&&n%1===0,"invalid connection throttle limit","connection.throttleLimit",n);var I="object"===typeof e?e.throttleCallback:null,r="object"===typeof e&&"number"===typeof e.throttleSlotInterval?e.throttleSlotInterval:100;pa.assertArgument(r>0&&r%1===0,"invalid connection throttle slot interval","connection.throttleSlotInterval",r);var C="object"===typeof e&&!!e.errorPassThrough,l={},a=null,o={method:"GET"},i=!1,c=12e4;if("string"===typeof e)a=e;else if("object"===typeof e){if(null!=e&&null!=e.url||pa.throwArgumentError("missing URL","connection.url",e),a=e.url,"number"===typeof e.timeout&&e.timeout>0&&(c=e.timeout),e.headers)for(var u in e.headers)l[u.toLowerCase()]={key:u,value:String(e.headers[u])},["if-none-match","if-modified-since"].indexOf(u.toLowerCase())>=0&&(i=!0);if(o.allowGzip=!!e.allowGzip,null!=e.user&&null!=e.password){"https:"!==a.substring(0,6)&&!0!==e.allowInsecureAuthentication&&pa.throwError("basic authentication requires a secure https url",Gr.errors.INVALID_ARGUMENT,{argument:"url",url:a,user:e.user,password:"[REDACTED]"});var s=e.user+":"+e.password;l.authorization={key:"Authorization",value:"Basic "+ma(QC(s))}}null!=e.skipFetchSetup&&(o.skipFetchSetup=!!e.skipFetchSetup),null!=e.fetchOptions&&(o.fetchOptions=Vr(e.fetchOptions))}var A,d=new RegExp("^data:([^;:]*)?(;base64)?,(.*)$","i"),m=a?a.match(d):null;if(m)try{var h={statusCode:200,statusMessage:"OK",headers:{"content-type":m[1]||"text/plain"},body:m[2]?da(m[3]):(A=m[3],QC(A.replace(/%([0-9a-f][0-9a-f])/gi,(function(e,g){return String.fromCharCode(parseInt(g,16))}))))},b=h.body;return t&&(b=t(h.body,h)),Promise.resolve(b)}catch(G){pa.throwError("processing response error",Gr.errors.SERVER_ERROR,{body:Ga(m[1],m[2]),error:G,requestBody:null,requestMethod:"GET",url:a})}g&&(o.method="POST",o.body=g,null==l["content-type"]&&(l["content-type"]={key:"Content-Type",value:"application/octet-stream"}),null==l["content-length"]&&(l["content-length"]={key:"Content-Length",value:String(g.length)}));var Z={};Object.keys(l).forEach((function(e){var g=l[e];Z[g.key]=g.value})),o.headers=Z;var p=function(){var e=null;return{promise:new Promise((function(g,t){c&&(e=setTimeout((function(){null!=e&&(e=null,t(pa.makeError("timeout",Gr.errors.TIMEOUT,{requestBody:Ga(o.body,Z["content-type"]),requestMethod:o.method,timeout:c,url:a})))}),c))})),cancel:function(){null!=e&&(clearTimeout(e),e=null)}}}(),y=function(){return Za(this,void 0,void 0,Ir().mark((function e(){var g,l,c,u,s,A,d,m,h,b;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g=0;case 1:if(!(g<n)){e.next=65;break}return l=null,e.prev=3,e.next=6,ba(a,o);case 6:if(l=e.sent,!(g<n)){e.next=28;break}if(301!==l.statusCode&&302!==l.statusCode){e.next=15;break}if(c=l.headers.location||"","GET"!==o.method||!c.match(/^https:/)){e.next=13;break}return a=l.headers.location,e.abrupt("continue",62);case 13:e.next=28;break;case 15:if(429!==l.statusCode){e.next=28;break}if(u=!0,!I){e.next=21;break}return e.next=20,I(g,a);case 20:u=e.sent;case 21:if(!u){e.next=28;break}return s=0,A=l.headers["retry-after"],s="string"===typeof A&&A.match(/^[1-9][0-9]*$/)?1e3*parseInt(A):r*parseInt(String(Math.random()*Math.pow(2,g))),e.next=27,ya(s);case 27:return e.abrupt("continue",62);case 28:e.next=34;break;case 30:e.prev=30,e.t0=e.catch(3),null==(l=e.t0.response)&&(p.cancel(),pa.throwError("missing response",Gr.errors.SERVER_ERROR,{requestBody:Ga(o.body,Z["content-type"]),requestMethod:o.method,serverError:e.t0,url:a}));case 34:if(d=l.body,i&&304===l.statusCode?d=null:!C&&(l.statusCode<200||l.statusCode>=300)&&(p.cancel(),pa.throwError("bad response",Gr.errors.SERVER_ERROR,{status:l.statusCode,headers:l.headers,body:Ga(d,l.headers?l.headers["content-type"]:null),requestBody:Ga(o.body,Z["content-type"]),requestMethod:o.method,url:a})),!t){e.next=60;break}return e.prev=37,e.next=40,t(d,l);case 40:return m=e.sent,p.cancel(),e.abrupt("return",m);case 45:if(e.prev=45,e.t1=e.catch(37),!(e.t1.throttleRetry&&g<n)){e.next=58;break}if(h=!0,!I){e.next=53;break}return e.next=52,I(g,a);case 52:h=e.sent;case 53:if(!h){e.next=58;break}return b=r*parseInt(String(Math.random()*Math.pow(2,g))),e.next=57,ya(b);case 57:return e.abrupt("continue",62);case 58:p.cancel(),pa.throwError("processing response error",Gr.errors.SERVER_ERROR,{body:Ga(d,l.headers?l.headers["content-type"]:null),error:e.t1,requestBody:Ga(o.body,Z["content-type"]),requestMethod:o.method,url:a});case 60:return p.cancel(),e.abrupt("return",d);case 62:g++,e.next=1;break;case 65:return e.abrupt("return",pa.throwError("failed response",Gr.errors.SERVER_ERROR,{requestBody:Ga(o.body,Z["content-type"]),requestMethod:o.method,url:a}));case 66:case"end":return e.stop()}}),e,null,[[3,30],[37,45]])})))}();return Promise.race([p.promise,y])}(e,n,(function(e,g){var n=null;if(null!=e)try{n=JSON.parse(LC(e))}catch(I){pa.throwError("invalid JSON",Gr.errors.SERVER_ERROR,{body:e,error:I})}return t&&(n=t(n,g)),n}))}function Ba(e,g){return g||(g={}),null==(g=Vr(g)).floor&&(g.floor=0),null==g.ceiling&&(g.ceiling=1e4),null==g.interval&&(g.interval=250),new Promise((function(t,n){var I=null,r=!1,C=function(){return!r&&(r=!0,I&&clearTimeout(I),!0)};g.timeout&&(I=setTimeout((function(){C()&&n(new Error("timeout"))}),g.timeout));var l=g.retryLimit,a=0;!function I(){return e().then((function(e){if(void 0!==e)C()&&t(e);else if(g.oncePoll)g.oncePoll.once("poll",I);else if(g.onceBlock)g.onceBlock.once("block",I);else if(!r){if(++a>l)return void(C()&&n(new Error("retry limit reached")));var o=g.interval*parseInt(String(Math.random()*Math.pow(2,a)));o<g.floor&&(o=g.floor),o>g.ceiling&&(o=g.ceiling),setTimeout(I,o)}return null}),(function(e){C()&&n(e)}))}()}))}var va=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},Sa=new Gr("abstract-provider/5.7.0"),Wa=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,null,[{key:"isForkEvent",value:function(e){return!(!e||!e._isForkEvent)}}]),t}(Yr),Va=function(){function e(){it(this,e),Sa.checkAbstract(this instanceof e?this.constructor:void 0,e),vr(this,"_isProvider",!0)}return ut(e,[{key:"getFeeData",value:function(){return va(this,void 0,void 0,Ir().mark((function e(){var g,t,n,I,r,C;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wr({block:this.getBlock("latest"),gasPrice:this.getGasPrice().catch((function(e){return null}))});case 2:return g=e.sent,t=g.block,n=g.gasPrice,I=null,r=null,C=null,t&&t.baseFeePerGas&&(I=t.baseFeePerGas,C=uC.from("1500000000"),r=t.baseFeePerGas.mul(2).add(C)),e.abrupt("return",{lastBaseFeePerGas:I,maxFeePerGas:r,maxPriorityFeePerGas:C,gasPrice:n});case 8:case"end":return e.stop()}}),e,this)})))}},{key:"addListener",value:function(e,g){return this.on(e,g)}},{key:"removeListener",value:function(e,g){return this.off(e,g)}}],[{key:"isProvider",value:function(e){return!(!e||!e._isProvider)}}]),e}(),ka=function(){function e(g){it(this,e),vr(this,"alphabet",g),vr(this,"base",g.length),vr(this,"_alphabetMap",{}),vr(this,"_leader",g.charAt(0));for(var t=0;t<g.length;t++)this._alphabetMap[g.charAt(t)]=t}return ut(e,[{key:"encode",value:function(e){var g=Pr(e);if(0===g.length)return"";for(var t=[0],n=0;n<g.length;++n){for(var I=g[n],r=0;r<t.length;++r)I+=t[r]<<8,t[r]=I%this.base,I=I/this.base|0;for(;I>0;)t.push(I%this.base),I=I/this.base|0}for(var C="",l=0;0===g[l]&&l<g.length-1;++l)C+=this._leader;for(var a=t.length-1;a>=0;--a)C+=this.alphabet[t[a]];return C}},{key:"decode",value:function(e){if("string"!==typeof e)throw new TypeError("Expected String");var g=[];if(0===e.length)return new Uint8Array(g);g.push(0);for(var t=0;t<e.length;t++){var n=this._alphabetMap[e[t]];if(void 0===n)throw new Error("Non-base"+this.base+" character");for(var I=n,r=0;r<g.length;++r)I+=g[r]*this.base,g[r]=255&I,I>>=8;for(;I>0;)g.push(255&I),I>>=8}for(var C=0;e[C]===this._leader&&C<e.length-1;++C)g.push(0);return Pr(new Uint8Array(g.reverse()))}}]),e}(),Ra=(new ka("abcdefghijklmnopqrstuvwxyz234567"),new ka("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"));function Xa(e,g){null==g&&(g=1);var t=[],n=t.forEach;return function e(g,I){n.call(g,(function(g){I>0&&Array.isArray(g)?e(g,I-1):t.push(g)}))}(e,g),t}function Ja(e){return function(e){var g=0;return function(){return e[g++]}}(function(e){var g=0;function t(){return e[g++]<<8|e[g++]}for(var n=t(),I=1,r=[0,1],C=1;C<n;C++)r.push(I+=t());var l=t(),a=g;g+=l;var o=0,i=0;function c(){return 0==o&&(i=i<<8|e[g++],o=8),i>>--o&1}for(var u=Math.pow(2,31),s=u>>>1,A=s>>1,d=u-1,m=0,h=0;h<31;h++)m=m<<1|c();for(var b=[],Z=0,p=u;;){for(var y=Math.floor(((m-Z+1)*I-1)/p),G=0,f=n;f-G>1;){var B=G+f>>>1;y<r[B]?f=B:G=B}if(0==G)break;b.push(G);for(var v=Z+Math.floor(p*r[G]/I),S=Z+Math.floor(p*r[G+1]/I)-1;0==((v^S)&s);)m=m<<1&d|c(),v=v<<1&d,S=S<<1&d|1;for(;v&~S&A;)m=m&s|m<<1&d>>>1|c(),v=v<<1^s,S=(S^s)<<1|s|1;Z=v,p=1+S-v}var W=n-4;return b.map((function(g){switch(g-W){case 3:return W+65792+(e[a++]<<16|e[a++]<<8|e[a++]);case 2:return W+256+(e[a++]<<8|e[a++]);case 1:return W+e[a++];default:return g-1}}))}(e))}function Ya(e){return 1&e?~e>>1:e>>1}function wa(e,g){for(var t=Array(e),n=0,I=-1;n<e;n++)t[n]=I+=1+g();return t}function Ha(e,g){for(var t=Array(e),n=0,I=0;n<e;n++)t[n]=I+=Ya(g());return t}function Na(e,g){for(var t=wa(e(),e),n=e(),I=wa(n,e),r=function(e,g){for(var t=Array(e),n=0;n<e;n++)t[n]=1+g();return t}(n,e),C=0;C<n;C++)for(var l=0;l<r[C];l++)t.push(I[C]+l);return g?t.map((function(e){return g[e]})):t}function Fa(e,g,t){for(var n=Array(e).fill(void 0).map((function(){return[]})),I=0;I<g;I++)Ha(e,t).forEach((function(e,g){return n[g].push(e)}));return n}function Ka(e,g){var t=1+g(),n=g(),I=function(e){for(var g=[];;){var t=e();if(0==t)break;g.push(t)}return g}(g);return Xa(Fa(I.length,1+e,g).map((function(e,g){var r=e[0],C=e.slice(1);return Array(I[g]).fill(void 0).map((function(e,g){var I=g*n;return[r+g*t,C.map((function(e){return e+I}))]}))})))}function xa(e,g){return Fa(1+g(),1+e,g).map((function(e){return[e[0],e.slice(1)]}))}var Ea=Ja(da("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA==")),Ma=new Set(Na(Ea)),za=new Set(Na(Ea)),Ua=function(e){for(var g=[];;){var t=e();if(0==t)break;g.push(Ka(t,e))}for(;;){var n=e()-1;if(n<0)break;g.push(xa(n,e))}return function(e){for(var g={},t=0;t<e.length;t++){var n=e[t];g[n[0]]=n[1]}return g}(Xa(g))}(Ea),Qa=function(e){var g=Na(e).sort((function(e,g){return e-g}));return function t(){var n=[];for(;;){var I=Na(e,g);if(0==I.length)break;n.push({set:new Set(I),node:t()})}n.sort((function(e,g){return g.set.size-e.set.size}));var r=e();return{branches:n,valid:r%3,fe0f:!!(1&(r=r/3|0)),save:1==(r>>=1),check:2==r}}()}(Ea),La=45,Ta=95;function Da(e){return function(e){return UC(QC(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:FC.current))}(e)}function ja(e){return e.filter((function(e){return 65039!=e}))}function Pa(e){var g,t=Vn(e.split("."));try{for(t.s();!(g=t.n()).done;){var n=g.value,I=Da(n);try{for(var r=I.lastIndexOf(Ta)-1;r>=0;r--)if(I[r]!==Ta)throw new Error("underscore only allowed at start");if(I.length>=4&&I.every((function(e){return e<128}))&&I[2]===La&&I[3]===La)throw new Error("invalid label extension")}catch(C){throw new Error('Invalid label "'.concat(n,'": ').concat(C.message))}}}catch(C){t.e(C)}finally{t.f()}return e}function Oa(e){return Pa(function(e,g){var t=Da(e).reverse(),n=[];for(;t.length;){var I=_a(t);if(I)n.push.apply(n,h(g(I)));else{var r=t.pop();if(Ma.has(r))n.push(r);else if(!za.has(r)){var C=Ua[r];if(!C)throw new Error("Disallowed codepoint: 0x".concat(r.toString(16).toUpperCase()));n.push.apply(n,h(C))}}}return Pa((l=String.fromCodePoint.apply(String,n),l.normalize("NFC")));var l}(e,ja))}function _a(e,g){var t,n,I,r=Qa,C=[],l=e.length;g&&(g.length=0);for(var a=function(){var a=e[--l];if(r=null===(t=r.branches.find((function(e){return e.set.has(a)})))||void 0===t?void 0:t.node,!r)return"break";if(r.save)I=a;else if(r.check&&a===I)return"break";C.push(a),r.fe0f&&(C.push(65039),l>0&&65039==e[l-1]&&l--),r.valid&&(n=C.slice(),2==r.valid&&n.splice(1,1),g&&g.push.apply(g,h(e.slice(l).reverse())),e.length=l)};l;){if("break"===a())break}return n}var qa=new Gr(xC),$a=new Uint8Array(32);function eo(e){if(0===e.length)throw new Error("invalid ENS name; empty component");return e}function go(e){var g=QC(Oa(e)),t=[];if(0===e.length)return t;for(var n=0,I=0;I<g.length;I++){46===g[I]&&(t.push(eo(g.slice(n,I))),n=I+1)}if(n>=g.length)throw new Error("invalid ENS name; empty component");return t.push(eo(g.slice(n))),t}function to(e){"string"!==typeof e&&qa.throwArgumentError("invalid ENS name; not a string","name",e);for(var g=$a,t=go(e);t.length;)g=ZC(Or([g,ZC(t.pop())]));return eC(g)}$a.fill(0);var no=new Gr("networks/5.7.1");function Io(e){var g=function(g,t){null==t&&(t={});var n=[];if(g.InfuraProvider&&"-"!==t.infura)try{n.push(new g.InfuraProvider(e,t.infura))}catch(l){}if(g.EtherscanProvider&&"-"!==t.etherscan)try{n.push(new g.EtherscanProvider(e,t.etherscan))}catch(l){}if(g.AlchemyProvider&&"-"!==t.alchemy)try{n.push(new g.AlchemyProvider(e,t.alchemy))}catch(l){}if(g.PocketProvider&&"-"!==t.pocket){try{var I=new g.PocketProvider(e,t.pocket);I.network&&-1===["goerli","ropsten","rinkeby","sepolia"].indexOf(I.network.name)&&n.push(I)}catch(l){}}if(g.CloudflareProvider&&"-"!==t.cloudflare)try{n.push(new g.CloudflareProvider(e))}catch(l){}if(g.AnkrProvider&&"-"!==t.ankr)try{var r=new g.AnkrProvider(e,t.ankr);r.network&&-1===["ropsten"].indexOf(r.network.name)&&n.push(r)}catch(l){}if(0===n.length)return null;if(g.FallbackProvider){var C=1;return null!=t.quorum?C=t.quorum:"homestead"===e&&(C=2),new g.FallbackProvider(n,C)}return n[0]};return g.renetwork=function(e){return Io(e)},g}function ro(e,g){var t=function(t,n){return t.JsonRpcProvider?new t.JsonRpcProvider(e,g):null};return t.renetwork=function(g){return ro(e,g)},t}var Co={chainId:1,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"homestead",_defaultProvider:Io("homestead")},lo={chainId:3,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"ropsten",_defaultProvider:Io("ropsten")},ao={chainId:63,name:"classicMordor",_defaultProvider:ro("https://www.ethercluster.com/mordor","classicMordor")},oo={unspecified:{chainId:0,name:"unspecified"},homestead:Co,mainnet:Co,morden:{chainId:2,name:"morden"},ropsten:lo,testnet:lo,rinkeby:{chainId:4,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"rinkeby",_defaultProvider:Io("rinkeby")},kovan:{chainId:42,name:"kovan",_defaultProvider:Io("kovan")},goerli:{chainId:5,ensAddress:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e",name:"goerli",_defaultProvider:Io("goerli")},kintsugi:{chainId:1337702,name:"kintsugi"},sepolia:{chainId:11155111,name:"sepolia",_defaultProvider:Io("sepolia")},classic:{chainId:61,name:"classic",_defaultProvider:ro("https://www.ethercluster.com/etc","classic")},classicMorden:{chainId:62,name:"classicMorden"},classicMordor:ao,classicTestnet:ao,classicKotti:{chainId:6,name:"classicKotti",_defaultProvider:ro("https://www.ethercluster.com/kotti","classicKotti")},xdai:{chainId:100,name:"xdai"},matic:{chainId:137,name:"matic",_defaultProvider:Io("matic")},maticmum:{chainId:80001,name:"maticmum"},optimism:{chainId:10,name:"optimism",_defaultProvider:Io("optimism")},"optimism-kovan":{chainId:69,name:"optimism-kovan"},"optimism-goerli":{chainId:420,name:"optimism-goerli"},arbitrum:{chainId:42161,name:"arbitrum"},"arbitrum-rinkeby":{chainId:421611,name:"arbitrum-rinkeby"},"arbitrum-goerli":{chainId:421613,name:"arbitrum-goerli"},bnb:{chainId:56,name:"bnb"},bnbt:{chainId:97,name:"bnbt"}};new Gr("sha2/5.7.0");function io(e){return"0x"+Al().sha256().update(Pr(e)).digest("hex")}var co=t(1360),uo=t.n(co),so=new Gr(wr),Ao=function(){function e(){it(this,e),this.formats=this.getDefaultFormats()}return ut(e,[{key:"getDefaultFormats",value:function(){var g=this,t={},n=this.address.bind(this),I=this.bigNumber.bind(this),r=this.blockTag.bind(this),C=this.data.bind(this),l=this.hash.bind(this),a=this.hex.bind(this),o=this.number.bind(this),i=this.type.bind(this);return t.transaction={hash:l,type:i,accessList:e.allowNull(this.accessList.bind(this),null),blockHash:e.allowNull(l,null),blockNumber:e.allowNull(o,null),transactionIndex:e.allowNull(o,null),confirmations:e.allowNull(o,null),from:n,gasPrice:e.allowNull(I),maxPriorityFeePerGas:e.allowNull(I),maxFeePerGas:e.allowNull(I),gasLimit:I,to:e.allowNull(n,null),value:I,nonce:o,data:C,r:e.allowNull(this.uint256),s:e.allowNull(this.uint256),v:e.allowNull(o),creates:e.allowNull(n,null),raw:e.allowNull(C)},t.transactionRequest={from:e.allowNull(n),nonce:e.allowNull(o),gasLimit:e.allowNull(I),gasPrice:e.allowNull(I),maxPriorityFeePerGas:e.allowNull(I),maxFeePerGas:e.allowNull(I),to:e.allowNull(n),value:e.allowNull(I),data:e.allowNull((function(e){return g.data(e,!0)})),type:e.allowNull(o),accessList:e.allowNull(this.accessList.bind(this),null)},t.receiptLog={transactionIndex:o,blockNumber:o,transactionHash:l,address:n,topics:e.arrayOf(l),data:C,logIndex:o,blockHash:l},t.receipt={to:e.allowNull(this.address,null),from:e.allowNull(this.address,null),contractAddress:e.allowNull(n,null),transactionIndex:o,root:e.allowNull(a),gasUsed:I,logsBloom:e.allowNull(C),blockHash:l,transactionHash:l,logs:e.arrayOf(this.receiptLog.bind(this)),blockNumber:o,confirmations:e.allowNull(o,null),cumulativeGasUsed:I,effectiveGasPrice:e.allowNull(I),status:e.allowNull(o),type:i},t.block={hash:e.allowNull(l),parentHash:l,number:o,timestamp:o,nonce:e.allowNull(a),difficulty:this.difficulty.bind(this),gasLimit:I,gasUsed:I,miner:e.allowNull(n),extraData:C,transactions:e.allowNull(e.arrayOf(l)),baseFeePerGas:e.allowNull(I)},t.blockWithTransactions=Vr(t.block),t.blockWithTransactions.transactions=e.allowNull(e.arrayOf(this.transactionResponse.bind(this))),t.filter={fromBlock:e.allowNull(r,void 0),toBlock:e.allowNull(r,void 0),blockHash:e.allowNull(l,void 0),address:e.allowNull(n,void 0),topics:e.allowNull(this.topics.bind(this),void 0)},t.filterLog={blockNumber:e.allowNull(o),blockHash:e.allowNull(l),transactionIndex:o,removed:e.allowNull(this.boolean.bind(this)),address:n,data:e.allowFalsish(C,"0x"),topics:e.arrayOf(l),transactionHash:l,logIndex:o},t}},{key:"accessList",value:function(e){return oa(e||[])}},{key:"number",value:function(e){return"0x"===e?0:uC.from(e).toNumber()}},{key:"type",value:function(e){return"0x"===e||null==e?0:uC.from(e).toNumber()}},{key:"bigNumber",value:function(e){return uC.from(e)}},{key:"boolean",value:function(e){if("boolean"===typeof e)return e;if("string"===typeof e){if("true"===(e=e.toLowerCase()))return!0;if("false"===e)return!1}throw new Error("invalid boolean - "+e)}},{key:"hex",value:function(e,g){return"string"===typeof e&&(g||"0x"===e.substring(0,2)||(e="0x"+e),qr(e))?e.toLowerCase():so.throwArgumentError("invalid hash","value",e)}},{key:"data",value:function(e,g){var t=this.hex(e,g);if(t.length%2!==0)throw new Error("invalid data; odd-length - "+e);return t}},{key:"address",value:function(e){return HC(e)}},{key:"callAddress",value:function(e){if(!qr(e,32))return null;var g=HC(tC(e,12));return"0x0000000000000000000000000000000000000000"===g?null:g}},{key:"contractAddress",value:function(e){return NC(e)}},{key:"blockTag",value:function(e){if(null==e)return"latest";if("earliest"===e)return"0x0";switch(e){case"earliest":return"0x0";case"latest":case"pending":case"safe":case"finalized":return e}if("number"===typeof e||qr(e))return IC(e);throw new Error("invalid blockTag")}},{key:"hash",value:function(e,g){var t=this.hex(e,g);return 32!==gC(t)?so.throwArgumentError("invalid hash","value",e):t}},{key:"difficulty",value:function(e){if(null==e)return null;var g=uC.from(e);try{return g.toNumber()}catch(t){}return null}},{key:"uint256",value:function(e){if(!qr(e))throw new Error("invalid uint256");return rC(e,32)}},{key:"_block",value:function(g,t){null!=g.author&&null==g.miner&&(g.miner=g.author);var n=null!=g._difficulty?g._difficulty:g.difficulty,I=e.check(t,g);return I._difficulty=null==n?null:uC.from(n),I}},{key:"block",value:function(e){return this._block(e,this.formats.block)}},{key:"blockWithTransactions",value:function(e){return this._block(e,this.formats.blockWithTransactions)}},{key:"transactionRequest",value:function(g){return e.check(this.formats.transactionRequest,g)}},{key:"transactionResponse",value:function(g){null!=g.gas&&null==g.gasLimit&&(g.gasLimit=g.gas),g.to&&uC.from(g.to).isZero()&&(g.to="0x0000000000000000000000000000000000000000"),null!=g.input&&null==g.data&&(g.data=g.input),null==g.to&&null==g.creates&&(g.creates=this.contractAddress(g)),1!==g.type&&2!==g.type||null!=g.accessList||(g.accessList=[]);var t=e.check(this.formats.transaction,g);if(null!=g.chainId){var n=g.chainId;qr(n)&&(n=uC.from(n).toNumber()),t.chainId=n}else{var I=g.networkId;null==I&&null==t.v&&(I=g.chainId),qr(I)&&(I=uC.from(I).toNumber()),"number"!==typeof I&&null!=t.v&&((I=(t.v-35)/2)<0&&(I=0),I=parseInt(I)),"number"!==typeof I&&(I=0),t.chainId=I}return t.blockHash&&"x"===t.blockHash.replace(/0/g,"")&&(t.blockHash=null),t}},{key:"transaction",value:function(e){return Aa(e)}},{key:"receiptLog",value:function(g){return e.check(this.formats.receiptLog,g)}},{key:"receipt",value:function(g){var t=e.check(this.formats.receipt,g);if(null!=t.root)if(t.root.length<=4){var n=uC.from(t.root).toNumber();0===n||1===n?(null!=t.status&&t.status!==n&&so.throwArgumentError("alt-root-status/status mismatch","value",{root:t.root,status:t.status}),t.status=n,delete t.root):so.throwArgumentError("invalid alt-root-status","value.root",t.root)}else 66!==t.root.length&&so.throwArgumentError("invalid root hash","value.root",t.root);return null!=t.status&&(t.byzantium=!0),t}},{key:"topics",value:function(e){var g=this;return Array.isArray(e)?e.map((function(e){return g.topics(e)})):null!=e?this.hash(e,!0):null}},{key:"filter",value:function(g){return e.check(this.formats.filter,g)}},{key:"filterLog",value:function(g){return e.check(this.formats.filterLog,g)}}],[{key:"check",value:function(e,g){var t={};for(var n in e)try{var I=e[n](g[n]);void 0!==I&&(t[n]=I)}catch(r){throw r.checkKey=n,r.checkValue=g[n],r}return t}},{key:"allowNull",value:function(e,g){return function(t){return null==t?g:e(t)}}},{key:"allowFalsish",value:function(e,g){return function(t){return t?e(t):g}}},{key:"arrayOf",value:function(e){return function(g){if(!Array.isArray(g))throw new Error("not an array");var t=[];return g.forEach((function(g){t.push(e(g))})),t}}}]),e}();var mo=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},ho=new Gr(wr);function bo(e){return null==e?"null":(32!==gC(e)&&ho.throwArgumentError("invalid topic","topic",e),e.toLowerCase())}function Zo(e){for(e=e.slice();e.length>0&&null==e[e.length-1];)e.pop();return e.map((function(e){if(Array.isArray(e)){var g={};e.forEach((function(e){g[bo(e)]=!0}));var t=Object.keys(g);return t.sort(),t.join("|")}return bo(e)})).join("&")}function po(e){if("string"===typeof e){if(32===gC(e=e.toLowerCase()))return"tx:"+e;if(-1===e.indexOf(":"))return e}else{if(Array.isArray(e))return"filter:*:"+Zo(e);if(Wa.isForkEvent(e))throw ho.warn("not implemented"),new Error("not implemented");if(e&&"object"===typeof e)return"filter:"+(e.address||"*")+":"+Zo(e.topics||[])}throw new Error("invalid event - "+e)}function yo(){return(new Date).getTime()}function Go(e){return new Promise((function(g){setTimeout(g,e)}))}var fo=["block","network","pending","poll"],Bo=function(){function e(g,t,n){it(this,e),vr(this,"tag",g),vr(this,"listener",t),vr(this,"once",n),this._lastBlockNumber=-2,this._inflight=!1}return ut(e,[{key:"event",get:function(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}},{key:"type",get:function(){return this.tag.split(":")[0]}},{key:"hash",get:function(){var e=this.tag.split(":");return"tx"!==e[0]?null:e[1]}},{key:"filter",get:function(){var e=this.tag.split(":");if("filter"!==e[0])return null;var g,t=e[1],n=""===(g=e[2])?[]:g.split(/&/g).map((function(e){if(""===e)return[];var g=e.split("|").map((function(e){return"null"===e?null:e}));return 1===g.length?g[0]:g})),I={};return n.length>0&&(I.topics=n),t&&"*"!==t&&(I.address=t),I}},{key:"pollable",value:function(){return this.tag.indexOf(":")>=0||fo.indexOf(this.tag)>=0}}]),e}(),vo={0:{symbol:"btc",p2pkh:0,p2sh:5,prefix:"bc"},2:{symbol:"ltc",p2pkh:48,p2sh:50,prefix:"ltc"},3:{symbol:"doge",p2pkh:30,p2sh:22},60:{symbol:"eth",ilk:"eth"},61:{symbol:"etc",ilk:"eth"},700:{symbol:"xdai",ilk:"eth"}};function So(e){return rC(uC.from(e).toHexString(),32)}function Wo(e){return Ra.encode(Or([e,tC(io(io(e)),0,4)]))}var Vo=new RegExp("^(ipfs)://(.*)$","i"),ko=[new RegExp("^(https)://(.*)$","i"),new RegExp("^(data):(.*)$","i"),Vo,new RegExp("^eip155:[0-9]+/(erc[0-9]+):(.*)$","i")];function Ro(e,g){try{return LC(Xo(e,g))}catch(t){}return null}function Xo(e,g){if("0x"===e)return null;var t=uC.from(tC(e,g,g+32)).toNumber(),n=uC.from(tC(e,t,t+32)).toNumber();return tC(e,t+32,t+32+n)}function Jo(e){return e.match(/^ipfs:\/\/ipfs\//i)?e=e.substring(12):e.match(/^ipfs:\/\//i)?e=e.substring(7):ho.throwArgumentError("unsupported IPFS format","link",e),"https://gateway.ipfs.io/ipfs/".concat(e)}function Yo(e){var g=Pr(e);if(g.length>32)throw new Error("internal; should not happen");var t=new Uint8Array(32);return t.set(g,32-g.length),t}function wo(e){if(e.length%32===0)return e;var g=new Uint8Array(32*Math.ceil(e.length/32));return g.set(e),g}function Ho(e){for(var g=[],t=0,n=0;n<e.length;n++)g.push(null),t+=32;for(var I=0;I<e.length;I++){var r=Pr(e[I]);g[I]=Yo(t),g.push(Yo(r.length)),g.push(wo(r)),t+=32+32*Math.ceil(r.length/32)}return nC(g)}var No=function(){function e(g,t,n,I){it(this,e),vr(this,"provider",g),vr(this,"name",n),vr(this,"address",g.formatter.address(t)),vr(this,"_resolvedAddress",I)}return ut(e,[{key:"supportsWildcard",value:function(){var e=this;return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then((function(e){return uC.from(e).eq(1)})).catch((function(g){if(g.code===Gr.errors.CALL_EXCEPTION)return!1;throw e._supportsEip2544=null,g}))),this._supportsEip2544}},{key:"_fetch",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I,r;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={to:this.address,ccipReadEnabled:!0,data:nC([e,to(this.name),g||"0x"])},I=!1,t.next=4,this.supportsWildcard();case 4:if(!t.sent){t.next=7;break}I=!0,n.data=nC(["0x9061b923",Ho([(C=this.name,eC(Or(go(C).map((function(e){if(e.length>63)throw new Error("invalid DNS encoded entry; length exceeds 63 bytes");var g=new Uint8Array(e.length+1);return g.set(e,1),g[0]=g.length-1,g}))))+"00"),n.data])]);case 7:return t.prev=7,t.next=10,this.provider.call(n);case 10:return Pr(r=t.sent).length%32===4&&ho.throwError("resolver threw error",Gr.errors.CALL_EXCEPTION,{transaction:n,data:r}),I&&(r=Xo(r,0)),t.abrupt("return",r);case 16:if(t.prev=16,t.t0=t.catch(7),t.t0.code!==Gr.errors.CALL_EXCEPTION){t.next=20;break}return t.abrupt("return",null);case 20:throw t.t0;case 21:case"end":return t.stop()}var C}),t,this,[[7,16]])})))}},{key:"_fetchBytes",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._fetch(e,g);case 2:if(null==(n=t.sent)){t.next=5;break}return t.abrupt("return",Xo(n,0));case 5:return t.abrupt("return",null);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"_getAddress",value:function(e,g){var t=vo[String(e)];if(null==t&&ho.throwError("unsupported coin type: ".concat(e),Gr.errors.UNSUPPORTED_OPERATION,{operation:"getAddress(".concat(e,")")}),"eth"===t.ilk)return this.provider.formatter.address(g);var n=Pr(g);if(null!=t.p2pkh){var I=g.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(I){var r=parseInt(I[1],16);if(I[2].length===2*r&&r>=1&&r<=75)return Wo(Or([[t.p2pkh],"0x"+I[2]]))}}if(null!=t.p2sh){var C=g.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(C){var l=parseInt(C[1],16);if(C[2].length===2*l&&l>=1&&l<=75)return Wo(Or([[t.p2sh],"0x"+C[2]]))}}if(null!=t.prefix){var a=n[1],o=n[0];if(0===o?20!==a&&32!==a&&(o=-1):o=-1,o>=0&&n.length===2+a&&a>=1&&a<=75){var i=uo().toWords(n.slice(2));return i.unshift(o),uo().encode(t.prefix,i)}}return null}},{key:"getAddress",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null==e&&(e=60),60!==e){g.next=16;break}return g.prev=2,g.next=5,this._fetch("0x3b3b57de");case 5:if("0x"!==(t=g.sent)&&"0x0000000000000000000000000000000000000000000000000000000000000000"!==t){g.next=8;break}return g.abrupt("return",null);case 8:return g.abrupt("return",this.provider.formatter.callAddress(t));case 11:if(g.prev=11,g.t0=g.catch(2),g.t0.code!==Gr.errors.CALL_EXCEPTION){g.next=15;break}return g.abrupt("return",null);case 15:throw g.t0;case 16:return g.next=18,this._fetchBytes("0xf1cb7e06",So(e));case 18:if(null!=(n=g.sent)&&"0x"!==n){g.next=21;break}return g.abrupt("return",null);case 21:return null==(I=this._getAddress(e,n))&&ho.throwError("invalid or unsupported coin data",Gr.errors.UNSUPPORTED_OPERATION,{operation:"getAddress(".concat(e,")"),coinType:e,data:n}),g.abrupt("return",I);case 24:case"end":return g.stop()}}),g,this,[[2,11]])})))}},{key:"getAvatar",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g,t,n,I,r,C,l,a,o,i,c,u,s,A,d,m;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g=[{type:"name",content:this.name}],e.prev=1,e.next=4,this.getText("avatar");case 4:if(null!=(t=e.sent)){e.next=7;break}return e.abrupt("return",null);case 7:n=0;case 8:if(!(n<ko.length)){e.next=91;break}if(null!=(I=t.match(ko[n]))){e.next=12;break}return e.abrupt("continue",88);case 12:r=I[1].toLowerCase(),e.t0=r,e.next="https"===e.t0?16:"data"===e.t0?18:"ipfs"===e.t0?20:"erc721"===e.t0||"erc1155"===e.t0?22:88;break;case 16:return g.push({type:"url",content:t}),e.abrupt("return",{linkage:g,url:t});case 18:return g.push({type:"data",content:t}),e.abrupt("return",{linkage:g,url:t});case 20:return g.push({type:"ipfs",content:t}),e.abrupt("return",{linkage:g,url:Jo(t)});case 22:if(C="erc721"===r?"0xc87b56dd":"0x0e89341c",g.push({type:r,content:t}),e.t1=this._resolvedAddress,e.t1){e.next=29;break}return e.next=28,this.getAddress();case 28:e.t1=e.sent;case 29:if(l=e.t1,2===(a=(I[2]||"").split("/")).length){e.next=33;break}return e.abrupt("return",null);case 33:return e.next=35,this.provider.formatter.address(a[0]);case 35:if(o=e.sent,i=rC(uC.from(a[1]).toHexString(),32),"erc721"!==r){e.next=48;break}return e.t2=this.provider.formatter,e.next=41,this.provider.call({to:o,data:nC(["0x6352211e",i])});case 41:if(e.t3=e.sent,c=e.t2.callAddress.call(e.t2,e.t3),l===c){e.next=45;break}return e.abrupt("return",null);case 45:g.push({type:"owner",content:c}),e.next=57;break;case 48:if("erc1155"!==r){e.next=57;break}return e.t4=uC,e.next=52,this.provider.call({to:o,data:nC(["0x00fdd58e",rC(l,32),i])});case 52:if(e.t5=e.sent,!(u=e.t4.from.call(e.t4,e.t5)).isZero()){e.next=56;break}return e.abrupt("return",null);case 56:g.push({type:"balance",content:u.toString()});case 57:return s={to:this.provider.formatter.address(a[0]),data:nC([C,i])},e.t6=Ro,e.next=61,this.provider.call(s);case 61:if(e.t7=e.sent,null!=(A=(0,e.t6)(e.t7,0))){e.next=65;break}return e.abrupt("return",null);case 65:return g.push({type:"metadata-url-base",content:A}),"erc1155"===r&&(A=A.replace("{id}",i.substring(2)),g.push({type:"metadata-url-expanded",content:A})),A.match(/^ipfs:/i)&&(A=Jo(A)),g.push({type:"metadata-url",content:A}),e.next=71,fa(A);case 71:if(d=e.sent){e.next=74;break}return e.abrupt("return",null);case 74:if(g.push({type:"metadata",content:JSON.stringify(d)}),"string"===typeof(m=d.image)){e.next=78;break}return e.abrupt("return",null);case 78:if(!m.match(/^(https:\/\/|data:)/i)){e.next=81;break}e.next=86;break;case 81:if(null!=m.match(Vo)){e.next=84;break}return e.abrupt("return",null);case 84:g.push({type:"url-ipfs",content:m}),m=Jo(m);case 86:return g.push({type:"url",content:m}),e.abrupt("return",{linkage:g,url:m});case 88:n++,e.next=8;break;case 91:e.next=95;break;case 93:e.prev=93,e.t8=e.catch(1);case 95:return e.abrupt("return",null);case 96:case"end":return e.stop()}}),e,this,[[1,93]])})))}},{key:"getContentHash",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g,t,n,I,r,C,l,a,o;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchBytes("0xbc1c58d1");case 2:if(null!=(g=e.sent)&&"0x"!==g){e.next=5;break}return e.abrupt("return",null);case 5:if(!(t=g.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/))){e.next=10;break}if(n=parseInt(t[3],16),t[4].length!==2*n){e.next=10;break}return e.abrupt("return","ipfs://"+Ra.encode("0x"+t[1]));case 10:if(!(I=g.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/))){e.next=15;break}if(r=parseInt(I[3],16),I[4].length!==2*r){e.next=15;break}return e.abrupt("return","ipns://"+Ra.encode("0x"+I[1]));case 15:if(!(C=g.match(/^0xe40101fa011b20([0-9a-f]*)$/))){e.next=19;break}if(64!==C[1].length){e.next=19;break}return e.abrupt("return","bzz://"+C[1]);case 19:if(!(l=g.match(/^0x90b2c605([0-9a-f]*)$/))){e.next=25;break}if(68!==l[1].length){e.next=25;break}return a={"=":"","+":"-","/":"_"},o=ma("0x"+l[1]).replace(/[=+\/]/g,(function(e){return a[e]})),e.abrupt("return","sia://"+o);case 25:return e.abrupt("return",ho.throwError("invalid or unsupported content hash data",Gr.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:g}));case 26:case"end":return e.stop()}}),e,this)})))}},{key:"getText",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=QC(e),(t=Or([So(64),So(t.length),t])).length%32!==0&&(t=Or([t,rC("0x",32-e.length%32)])),g.next=5,this._fetchBytes("0x59d1d43c",eC(t));case 5:if(null!=(n=g.sent)&&"0x"!==n){g.next=8;break}return g.abrupt("return",null);case 8:return g.abrupt("return",LC(n));case 9:case"end":return g.stop()}}),g,this)})))}}]),e}(),Fo=null,Ko=1,xo=function(e){gn(t,e);var g=In(t);function t(e){var n;if(it(this,t),(n=g.call(this))._events=[],n._emitted={block:-2},n.disableCcipRead=!1,n.formatter=(this instanceof t?this.constructor:void 0).getFormatter(),vr(nn(n),"anyNetwork","any"===e),n.anyNetwork&&(e=n.detectNetwork()),e instanceof Promise)n._networkPromise=e,e.catch((function(e){})),n._ready().catch((function(e){}));else{var I=Sr(this instanceof t?this.constructor:void 0,"getNetwork")(e);I?(vr(nn(n),"_network",I),n.emit("network",I,null)):ho.throwArgumentError("invalid network","network",e)}return n._maxInternalBlockNumber=-1024,n._lastBlockNumber=-2,n._maxFilterBlockRange=10,n._pollingInterval=4e3,n._fastQueryDate=0,n}return ut(t,[{key:"_ready",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this._network){e.next=17;break}if(g=null,!this._networkPromise){e.next=11;break}return e.prev=3,e.next=6,this._networkPromise;case 6:g=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(3);case 11:if(null!=g){e.next=15;break}return e.next=14,this.detectNetwork();case 14:g=e.sent;case 15:g||ho.throwError("no network detected",Gr.errors.UNKNOWN_ERROR,{}),null==this._network&&(this.anyNetwork?this._network=g:vr(this,"_network",g),this.emit("network",g,null));case 17:return e.abrupt("return",this._network);case 18:case"end":return e.stop()}}),e,this,[[3,9]])})))}},{key:"ready",get:function(){var e=this;return Ba((function(){return e._ready().then((function(e){return e}),(function(e){if(e.code!==Gr.errors.NETWORK_ERROR||"noNetwork"!==e.event)throw e}))}))}},{key:"ccipReadFetch",value:function(e,g,t){return mo(this,void 0,void 0,Ir().mark((function n(){var I,r,C,l,a,o,i,c,u;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.disableCcipRead&&0!==t.length){n.next=2;break}return n.abrupt("return",null);case 2:I=e.to.toLowerCase(),r=g.toLowerCase(),C=[],l=0;case 6:if(!(l<t.length)){n.next=22;break}return a=t[l],o=a.replace("{sender}",I).replace("{data}",r),i=a.indexOf("{data}")>=0?null:JSON.stringify({data:r,sender:I}),n.next=12,fa({url:o,errorPassThrough:!0},i,(function(e,g){return e.status=g.statusCode,e}));case 12:if(!(c=n.sent).data){n.next=15;break}return n.abrupt("return",c.data);case 15:if(u=c.message||"unknown error",!(c.status>=400&&c.status<500)){n.next=18;break}return n.abrupt("return",ho.throwError("response not found during CCIP fetch: ".concat(u),Gr.errors.SERVER_ERROR,{url:a,errorMessage:u}));case 18:C.push(u);case 19:l++,n.next=6;break;case 22:return n.abrupt("return",ho.throwError("error encountered during CCIP fetch: ".concat(C.map((function(e){return JSON.stringify(e)})).join(", ")),Gr.errors.SERVER_ERROR,{urls:t,errorMessages:C}));case 23:case"end":return n.stop()}}),n,this)})))}},{key:"_getInternalBlockNumber",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I,r,C=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ready();case 2:if(!(e>0)){g.next=20;break}case 3:if(!this._internalBlockNumber){g.next=20;break}return t=this._internalBlockNumber,g.prev=5,g.next=8,t;case 8:if(n=g.sent,!(yo()-n.respTime<=e)){g.next=11;break}return g.abrupt("return",n.blockNumber);case 11:return g.abrupt("break",20);case 14:if(g.prev=14,g.t0=g.catch(5),this._internalBlockNumber!==t){g.next=18;break}return g.abrupt("break",20);case 18:g.next=3;break;case 20:return I=yo(),r=Wr({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then((function(e){return null}),(function(e){return e}))}).then((function(e){var g=e.blockNumber,t=e.networkError;if(t)throw C._internalBlockNumber===r&&(C._internalBlockNumber=null),t;var n=yo();return(g=uC.from(g).toNumber())<C._maxInternalBlockNumber&&(g=C._maxInternalBlockNumber),C._maxInternalBlockNumber=g,C._setFastBlockNumber(g),{blockNumber:g,reqTime:I,respTime:n}})),this._internalBlockNumber=r,r.catch((function(e){C._internalBlockNumber===r&&(C._internalBlockNumber=null)})),g.next=26,r;case 26:return g.abrupt("return",g.sent.blockNumber);case 27:case"end":return g.stop()}}),g,this,[[5,14]])})))}},{key:"poll",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g,t,n,I,r=this;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g=Ko++,t=[],n=null,e.prev=3,e.next=6,this._getInternalBlockNumber(100+this.pollingInterval/2);case 6:n=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),this.emit("error",e.t0),e.abrupt("return");case 13:if(this._setFastBlockNumber(n),this.emit("poll",g,n),n!==this._lastBlockNumber){e.next=18;break}return this.emit("didPoll",g),e.abrupt("return");case 18:if(-2===this._emitted.block&&(this._emitted.block=n-1),Math.abs(this._emitted.block-n)>1e3)ho.warn("network block skew detected; skipping block events (emitted=".concat(this._emitted.block," blockNumber").concat(n,")")),this.emit("error",ho.makeError("network block skew detected",Gr.errors.NETWORK_ERROR,{blockNumber:n,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",n);else for(I=this._emitted.block+1;I<=n;I++)this.emit("block",I);return this._emitted.block!==n&&(this._emitted.block=n,Object.keys(this._emitted).forEach((function(e){if("block"!==e){var g=r._emitted[e];"pending"!==g&&n-g>12&&delete r._emitted[e]}}))),-2===this._lastBlockNumber&&(this._lastBlockNumber=n-1),this._events.forEach((function(e){switch(e.type){case"tx":var g=e.hash,I=r.getTransactionReceipt(g).then((function(e){return e&&null!=e.blockNumber?(r._emitted["t:"+g]=e.blockNumber,r.emit(g,e),null):null})).catch((function(e){r.emit("error",e)}));t.push(I);break;case"filter":if(!e._inflight){e._inflight=!0,-2===e._lastBlockNumber&&(e._lastBlockNumber=n-1);var C=e.filter;C.fromBlock=e._lastBlockNumber+1,C.toBlock=n;var l=C.toBlock-r._maxFilterBlockRange;l>C.fromBlock&&(C.fromBlock=l),C.fromBlock<0&&(C.fromBlock=0);var a=r.getLogs(C).then((function(g){e._inflight=!1,0!==g.length&&g.forEach((function(g){g.blockNumber>e._lastBlockNumber&&(e._lastBlockNumber=g.blockNumber),r._emitted["b:"+g.blockHash]=g.blockNumber,r._emitted["t:"+g.transactionHash]=g.blockNumber,r.emit(C,g)}))})).catch((function(g){r.emit("error",g),e._inflight=!1}));t.push(a)}}})),this._lastBlockNumber=n,Promise.all(t).then((function(){r.emit("didPoll",g)})).catch((function(e){r.emit("error",e)})),e.abrupt("return");case 26:case"end":return e.stop()}}),e,this,[[3,9]])})))}},{key:"resetEventsBlock",value:function(e){this._lastBlockNumber=e-1,this.polling&&this.poll()}},{key:"network",get:function(){return this._network}},{key:"detectNetwork",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ho.throwError("provider does not support network detection",Gr.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"}));case 1:case"end":return e.stop()}}),e)})))}},{key:"getNetwork",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g,t,n;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._ready();case 2:return g=e.sent,e.next=5,this.detectNetwork();case 5:if(t=e.sent,g.chainId===t.chainId){e.next=23;break}if(!this.anyNetwork){e.next=20;break}return this._network=t,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",t,g),e.next=19,Go(0);case 19:return e.abrupt("return",this._network);case 20:throw n=ho.makeError("underlying network changed",Gr.errors.NETWORK_ERROR,{event:"changed",network:g,detectedNetwork:t}),this.emit("error",n),n;case 23:return e.abrupt("return",g);case 24:case"end":return e.stop()}}),e,this)})))}},{key:"blockNumber",get:function(){var e=this;return this._getInternalBlockNumber(100+this.pollingInterval/2).then((function(g){e._setFastBlockNumber(g)}),(function(e){})),null!=this._fastBlockNumber?this._fastBlockNumber:-1}},{key:"polling",get:function(){return null!=this._poller},set:function(e){var g=this;e&&!this._poller?(this._poller=setInterval((function(){g.poll()}),this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout((function(){g.poll(),g._bootstrapPoll=setTimeout((function(){g._poller||g.poll(),g._bootstrapPoll=null}),g.pollingInterval)}),0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}},{key:"pollingInterval",get:function(){return this._pollingInterval},set:function(e){var g=this;if("number"!==typeof e||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval((function(){g.poll()}),this._pollingInterval))}},{key:"_getFastBlockNumber",value:function(){var e=this,g=yo();return g-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=g,this._fastBlockNumberPromise=this.getBlockNumber().then((function(g){return(null==e._fastBlockNumber||g>e._fastBlockNumber)&&(e._fastBlockNumber=g),e._fastBlockNumber}))),this._fastBlockNumberPromise}},{key:"_setFastBlockNumber",value:function(e){null!=this._fastBlockNumber&&e<this._fastBlockNumber||(this._fastQueryDate=yo(),(null==this._fastBlockNumber||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))}},{key:"waitForTransaction",value:function(e,g,t){return mo(this,void 0,void 0,Ir().mark((function n(){return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this._waitForTransaction(e,null==g?1:g,t||0,null));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"_waitForTransaction",value:function(e,g,t,n){return mo(this,void 0,void 0,Ir().mark((function I(){var r,C=this;return Ir().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,this.getTransactionReceipt(e);case 2:if(!(((r=I.sent)?r.confirmations:0)>=g)){I.next=5;break}return I.abrupt("return",r);case 5:return I.abrupt("return",new Promise((function(I,r){var l=[],a=!1,o=function(){return!!a||(a=!0,l.forEach((function(e){e()})),!1)},i=function(e){e.confirmations<g||o()||I(e)};if(C.on(e,i),l.push((function(){C.removeListener(e,i)})),n){var c=n.startBlock,u=null,s=function t(I){return mo(C,void 0,void 0,Ir().mark((function C(){var l=this;return Ir().wrap((function(C){for(;;)switch(C.prev=C.next){case 0:if(!a){C.next=2;break}return C.abrupt("return");case 2:return C.next=4,Go(1e3);case 4:this.getTransactionCount(n.from).then((function(C){return mo(l,void 0,void 0,Ir().mark((function l(){var i,s,A,d,m,h;return Ir().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(!a){l.next=2;break}return l.abrupt("return");case 2:if(!(C<=n.nonce)){l.next=6;break}c=I,l.next=41;break;case 6:return l.next=8,this.getTransaction(e);case 8:if(!(i=l.sent)||null==i.blockNumber){l.next=11;break}return l.abrupt("return");case 11:null==u&&(u=c-3)<n.startBlock&&(u=n.startBlock);case 12:if(!(u<=I)){l.next=41;break}if(!a){l.next=15;break}return l.abrupt("return");case 15:return l.next=17,this.getBlockWithTransactions(u);case 17:s=l.sent,A=0;case 19:if(!(A<s.transactions.length)){l.next=38;break}if((d=s.transactions[A]).hash!==e){l.next=23;break}return l.abrupt("return");case 23:if(d.from!==n.from||d.nonce!==n.nonce){l.next=35;break}if(!a){l.next=26;break}return l.abrupt("return");case 26:return l.next=28,this.waitForTransaction(d.hash,g);case 28:if(m=l.sent,!o()){l.next=31;break}return l.abrupt("return");case 31:return h="replaced",d.data===n.data&&d.to===n.to&&d.value.eq(n.value)?h="repriced":"0x"===d.data&&d.from===d.to&&d.value.isZero()&&(h="cancelled"),r(ho.makeError("transaction was replaced",Gr.errors.TRANSACTION_REPLACED,{cancelled:"replaced"===h||"cancelled"===h,reason:h,replacement:this._wrapTransaction(d),hash:e,receipt:m})),l.abrupt("return");case 35:A++,l.next=19;break;case 38:u++,l.next=12;break;case 41:if(!a){l.next=43;break}return l.abrupt("return");case 43:this.once("block",t);case 44:case"end":return l.stop()}}),l,this)})))}),(function(e){a||l.once("block",t)}));case 5:case"end":return C.stop()}}),C,this)})))};if(a)return;C.once("block",s),l.push((function(){C.removeListener("block",s)}))}if("number"===typeof t&&t>0){var A=setTimeout((function(){o()||r(ho.makeError("timeout exceeded",Gr.errors.TIMEOUT,{timeout:t}))}),t);A.unref&&A.unref(),l.push((function(){clearTimeout(A)}))}})));case 6:case"end":return I.stop()}}),I,this)})))}},{key:"getBlockNumber",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._getInternalBlockNumber(0));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getGasPrice",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNetwork();case 2:return e.next=4,this.perform("getGasPrice",{});case 4:return g=e.sent,e.prev=5,e.abrupt("return",uC.from(g));case 9:return e.prev=9,e.t0=e.catch(5),e.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"getGasPrice",result:g,error:e.t0}));case 12:case"end":return e.stop()}}),e,this,[[5,9]])})))}},{key:"getBalance",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNetwork();case 2:return t.next=4,Wr({address:this._getAddress(e),blockTag:this._getBlockTag(g)});case 4:return n=t.sent,t.next=7,this.perform("getBalance",n);case 7:return I=t.sent,t.prev=8,t.abrupt("return",uC.from(I));case 12:return t.prev=12,t.t0=t.catch(8),t.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"getBalance",params:n,result:I,error:t.t0}));case 15:case"end":return t.stop()}}),t,this,[[8,12]])})))}},{key:"getTransactionCount",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNetwork();case 2:return t.next=4,Wr({address:this._getAddress(e),blockTag:this._getBlockTag(g)});case 4:return n=t.sent,t.next=7,this.perform("getTransactionCount",n);case 7:return I=t.sent,t.prev=8,t.abrupt("return",uC.from(I).toNumber());case 12:return t.prev=12,t.t0=t.catch(8),t.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"getTransactionCount",params:n,result:I,error:t.t0}));case 15:case"end":return t.stop()}}),t,this,[[8,12]])})))}},{key:"getCode",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNetwork();case 2:return t.next=4,Wr({address:this._getAddress(e),blockTag:this._getBlockTag(g)});case 4:return n=t.sent,t.next=7,this.perform("getCode",n);case 7:return I=t.sent,t.prev=8,t.abrupt("return",eC(I));case 12:return t.prev=12,t.t0=t.catch(8),t.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"getCode",params:n,result:I,error:t.t0}));case 15:case"end":return t.stop()}}),t,this,[[8,12]])})))}},{key:"getStorageAt",value:function(e,g,t){return mo(this,void 0,void 0,Ir().mark((function n(){var I,r;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.getNetwork();case 2:return n.next=4,Wr({address:this._getAddress(e),blockTag:this._getBlockTag(t),position:Promise.resolve(g).then((function(e){return IC(e)}))});case 4:return I=n.sent,n.next=7,this.perform("getStorageAt",I);case 7:return r=n.sent,n.prev=8,n.abrupt("return",eC(r));case 12:return n.prev=12,n.t0=n.catch(8),n.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"getStorageAt",params:I,result:r,error:n.t0}));case 15:case"end":return n.stop()}}),n,this,[[8,12]])})))}},{key:"_wrapTransaction",value:function(e,g,t){var n=this;if(null!=g&&32!==gC(g))throw new Error("invalid response - sendTransaction");var I=e;return null!=g&&e.hash!==g&&ho.throwError("Transaction hash mismatch from Provider.sendTransaction.",Gr.errors.UNKNOWN_ERROR,{expectedHash:e.hash,returnedHash:g}),I.wait=function(g,I){return mo(n,void 0,void 0,Ir().mark((function n(){var r,C;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null==g&&(g=1),null==I&&(I=0),r=void 0,0!==g&&null!=t&&(r={data:e.data,from:e.from,nonce:e.nonce,to:e.to,value:e.value,startBlock:t}),n.next=6,this._waitForTransaction(e.hash,g,I,r);case 6:if(null!=(C=n.sent)||0!==g){n.next=9;break}return n.abrupt("return",null);case 9:return this._emitted["t:"+e.hash]=C.blockNumber,0===C.status&&ho.throwError("transaction failed",Gr.errors.CALL_EXCEPTION,{transactionHash:e.hash,transaction:e,receipt:C}),n.abrupt("return",C);case 12:case"end":return n.stop()}}),n,this)})))},I}},{key:"sendTransaction",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I,r;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getNetwork();case 2:return g.next=4,Promise.resolve(e).then((function(e){return eC(e)}));case 4:return t=g.sent,null==(n=this.formatter.transaction(e)).confirmations&&(n.confirmations=0),g.next=9,this._getInternalBlockNumber(100+2*this.pollingInterval);case 9:return I=g.sent,g.prev=10,g.next=13,this.perform("sendTransaction",{signedTransaction:t});case 13:return r=g.sent,g.abrupt("return",this._wrapTransaction(n,r,I));case 17:throw g.prev=17,g.t0=g.catch(10),g.t0.transaction=n,g.t0.transactionHash=n.hash,g.t0;case 22:case"end":return g.stop()}}),g,this,[[10,17]])})))}},{key:"_getTransactionRequest",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:return t=g.sent,n={},["from","to"].forEach((function(e){null!=t[e]&&(n[e]=Promise.resolve(t[e]).then((function(e){return e?I._getAddress(e):null})))})),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach((function(e){null!=t[e]&&(n[e]=Promise.resolve(t[e]).then((function(e){return e?uC.from(e):null})))})),["type"].forEach((function(e){null!=t[e]&&(n[e]=Promise.resolve(t[e]).then((function(e){return null!=e?e:null})))})),t.accessList&&(n.accessList=this.formatter.accessList(t.accessList)),["data"].forEach((function(e){null!=t[e]&&(n[e]=Promise.resolve(t[e]).then((function(e){return e?eC(e):null})))})),g.t0=this.formatter,g.next=12,Wr(n);case 12:return g.t1=g.sent,g.abrupt("return",g.t0.transactionRequest.call(g.t0,g.t1));case 14:case"end":return g.stop()}}),g,this)})))}},{key:"_getFilter",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:return e=g.sent,t={},null!=e.address&&(t.address=this._getAddress(e.address)),["blockHash","topics"].forEach((function(g){null!=e[g]&&(t[g]=e[g])})),["fromBlock","toBlock"].forEach((function(g){null!=e[g]&&(t[g]=n._getBlockTag(e[g]))})),g.t0=this.formatter,g.next=10,Wr(t);case 10:return g.t1=g.sent,g.abrupt("return",g.t0.filter.call(g.t0,g.t1));case 12:case"end":return g.stop()}}),g,this)})))}},{key:"_call",value:function(e,g,t){return mo(this,void 0,void 0,Ir().mark((function n(){var I,r,C,l,a,o,i,c,u,s,A,d,m,h,b;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t>=10&&ho.throwError("CCIP read exceeded maximum redirections",Gr.errors.SERVER_ERROR,{redirects:t,transaction:e}),I=e.to,n.next=4,this.perform("call",{transaction:e,blockTag:g});case 4:if(r=n.sent,!(t>=0&&"latest"===g&&null!=I&&"0x556f1830"===r.substring(0,10)&&gC(r)%32===4)){n.next=31;break}for(n.prev=6,C=tC(r,4),l=tC(C,0,32),uC.from(l).eq(I)||ho.throwError("CCIP Read sender did not match",Gr.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:r}),a=[],o=uC.from(tC(C,32,64)).toNumber(),i=uC.from(tC(C,o,o+32)).toNumber(),c=tC(C,o+32),u=0;u<i;u++)null==(s=Ro(c,32*u))&&ho.throwError("CCIP Read contained corrupt URL string",Gr.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:r}),a.push(s);return A=Xo(C,64),uC.from(tC(C,100,128)).isZero()||ho.throwError("CCIP Read callback selector included junk",Gr.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:r}),d=tC(C,96,100),m=Xo(C,128),n.next=21,this.ccipReadFetch(e,A,a);case 21:return null==(h=n.sent)&&ho.throwError("CCIP Read disabled or provided no URLs",Gr.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:e,data:r}),b={to:I,data:nC([d,Ho([h,m])])},n.abrupt("return",this._call(b,g,t+1));case 27:if(n.prev=27,n.t0=n.catch(6),n.t0.code!==Gr.errors.SERVER_ERROR){n.next=31;break}throw n.t0;case 31:return n.prev=31,n.abrupt("return",eC(r));case 35:return n.prev=35,n.t1=n.catch(31),n.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"call",params:{transaction:e,blockTag:g},result:r,error:n.t1}));case 38:case"end":return n.stop()}}),n,this,[[6,27],[31,35]])})))}},{key:"call",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNetwork();case 2:return t.next=4,Wr({transaction:this._getTransactionRequest(e),blockTag:this._getBlockTag(g),ccipReadEnabled:Promise.resolve(e.ccipReadEnabled)});case 4:return n=t.sent,t.abrupt("return",this._call(n.transaction,n.blockTag,n.ccipReadEnabled?0:-1));case 6:case"end":return t.stop()}}),t,this)})))}},{key:"estimateGas",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getNetwork();case 2:return g.next=4,Wr({transaction:this._getTransactionRequest(e)});case 4:return t=g.sent,g.next=7,this.perform("estimateGas",t);case 7:return n=g.sent,g.prev=8,g.abrupt("return",uC.from(n));case 12:return g.prev=12,g.t0=g.catch(8),g.abrupt("return",ho.throwError("bad result from backend",Gr.errors.SERVER_ERROR,{method:"estimateGas",params:t,result:n,error:g.t0}));case 15:case"end":return g.stop()}}),g,this,[[8,12]])})))}},{key:"_getAddress",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:return"string"!==typeof(e=g.sent)&&ho.throwArgumentError("invalid address or ENS name","name",e),g.next=6,this.resolveName(e);case 6:return null==(t=g.sent)&&ho.throwError("ENS name not configured",Gr.errors.UNSUPPORTED_OPERATION,{operation:"resolveName(".concat(JSON.stringify(e),")")}),g.abrupt("return",t);case 9:case"end":return g.stop()}}),g,this)})))}},{key:"_getBlock",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I,r=this;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getNetwork();case 2:return t.next=4,e;case 4:if(e=t.sent,n=-128,I={includeTransactions:!!g},!qr(e,32)){t.next=11;break}I.blockHash=e,t.next=21;break;case 11:return t.prev=11,t.next=14,this._getBlockTag(e);case 14:I.blockTag=t.sent,qr(I.blockTag)&&(n=parseInt(I.blockTag.substring(2),16)),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(11),ho.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",e);case 21:return t.abrupt("return",Ba((function(){return mo(r,void 0,void 0,Ir().mark((function e(){var t,r,C,l,a,o,i=this;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.perform("getBlock",I);case 2:if(null!=(t=e.sent)){e.next=11;break}if(null==I.blockHash){e.next=7;break}if(null!=this._emitted["b:"+I.blockHash]){e.next=7;break}return e.abrupt("return",null);case 7:if(null==I.blockTag){e.next=10;break}if(!(n>this._emitted.block)){e.next=10;break}return e.abrupt("return",null);case 10:return e.abrupt("return",void 0);case 11:if(!g){e.next=34;break}r=null,C=0;case 14:if(!(C<t.transactions.length)){e.next=31;break}if(null!=(l=t.transactions[C]).blockNumber){e.next=20;break}l.confirmations=0,e.next=28;break;case 20:if(null!=l.confirmations){e.next=28;break}if(null!=r){e.next=25;break}return e.next=24,this._getInternalBlockNumber(100+2*this.pollingInterval);case 24:r=e.sent;case 25:(a=r-l.blockNumber+1)<=0&&(a=1),l.confirmations=a;case 28:C++,e.next=14;break;case 31:return(o=this.formatter.blockWithTransactions(t)).transactions=o.transactions.map((function(e){return i._wrapTransaction(e)})),e.abrupt("return",o);case 34:return e.abrupt("return",this.formatter.block(t));case 35:case"end":return e.stop()}}),e,this)})))}),{oncePoll:this}));case 22:case"end":return t.stop()}}),t,this,[[11,18]])})))}},{key:"getBlock",value:function(e){return this._getBlock(e,!1)}},{key:"getBlockWithTransactions",value:function(e){return this._getBlock(e,!0)}},{key:"getTransaction",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getNetwork();case 2:return g.next=4,e;case 4:return e=g.sent,t={transactionHash:this.formatter.hash(e,!0)},g.abrupt("return",Ba((function(){return mo(n,void 0,void 0,Ir().mark((function g(){var n,I,r,C;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.perform("getTransaction",t);case 2:if(null!=(n=g.sent)){g.next=7;break}if(null!=this._emitted["t:"+e]){g.next=6;break}return g.abrupt("return",null);case 6:return g.abrupt("return",void 0);case 7:if(null!=(I=this.formatter.transactionResponse(n)).blockNumber){g.next=12;break}I.confirmations=0,g.next=19;break;case 12:if(null!=I.confirmations){g.next=19;break}return g.next=15,this._getInternalBlockNumber(100+2*this.pollingInterval);case 15:r=g.sent,(C=r-I.blockNumber+1)<=0&&(C=1),I.confirmations=C;case 19:return g.abrupt("return",this._wrapTransaction(I));case 20:case"end":return g.stop()}}),g,this)})))}),{oncePoll:this}));case 7:case"end":return g.stop()}}),g,this)})))}},{key:"getTransactionReceipt",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getNetwork();case 2:return g.next=4,e;case 4:return e=g.sent,t={transactionHash:this.formatter.hash(e,!0)},g.abrupt("return",Ba((function(){return mo(n,void 0,void 0,Ir().mark((function g(){var n,I,r,C;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.perform("getTransactionReceipt",t);case 2:if(null!=(n=g.sent)){g.next=7;break}if(null!=this._emitted["t:"+e]){g.next=6;break}return g.abrupt("return",null);case 6:return g.abrupt("return",void 0);case 7:if(null!=n.blockHash){g.next=9;break}return g.abrupt("return",void 0);case 9:if(null!=(I=this.formatter.receipt(n)).blockNumber){g.next=14;break}I.confirmations=0,g.next=21;break;case 14:if(null!=I.confirmations){g.next=21;break}return g.next=17,this._getInternalBlockNumber(100+2*this.pollingInterval);case 17:r=g.sent,(C=r-I.blockNumber+1)<=0&&(C=1),I.confirmations=C;case 21:return g.abrupt("return",I);case 22:case"end":return g.stop()}}),g,this)})))}),{oncePoll:this}));case 7:case"end":return g.stop()}}),g,this)})))}},{key:"getLogs",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.getNetwork();case 2:return g.next=4,Wr({filter:this._getFilter(e)});case 4:return t=g.sent,g.next=7,this.perform("getLogs",t);case 7:return(n=g.sent).forEach((function(e){null==e.removed&&(e.removed=!1)})),g.abrupt("return",Ao.arrayOf(this.formatter.filterLog.bind(this.formatter))(n));case 10:case"end":return g.stop()}}),g,this)})))}},{key:"getEtherPrice",value:function(){return mo(this,void 0,void 0,Ir().mark((function e(){return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNetwork();case 2:return e.abrupt("return",this.perform("getEtherPrice",{}));case 3:case"end":return e.stop()}}),e,this)})))}},{key:"_getBlockTag",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:if(!("number"===typeof(e=g.sent)&&e<0)){g.next=11;break}return e%1&&ho.throwArgumentError("invalid BlockTag","blockTag",e),g.next=7,this._getInternalBlockNumber(100+2*this.pollingInterval);case 7:return t=g.sent,(t+=e)<0&&(t=0),g.abrupt("return",this.formatter.blockTag(t));case 11:return g.abrupt("return",this.formatter.blockTag(e));case 12:case"end":return g.stop()}}),g,this)})))}},{key:"getResolver",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:t=e;case 1:if(""!==t&&"."!==t){g.next=4;break}return g.abrupt("return",null);case 4:if("eth"===e||"eth"!==t){g.next=6;break}return g.abrupt("return",null);case 6:return g.next=8,this._getResolver(t,"getResolver");case 8:if(null==(n=g.sent)){g.next=19;break}if(I=new No(this,n,e),g.t0=t!==e,!g.t0){g.next=16;break}return g.next=15,I.supportsWildcard();case 15:g.t0=!g.sent;case 16:if(!g.t0){g.next=18;break}return g.abrupt("return",null);case 18:return g.abrupt("return",I);case 19:t=t.split(".").slice(1).join("."),g.next=1;break;case 22:case"end":return g.stop()}}),g,this)})))}},{key:"_getResolver",value:function(e,g){return mo(this,void 0,void 0,Ir().mark((function t(){var n,I;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==g&&(g="ENS"),t.next=3,this.getNetwork();case 3:return(n=t.sent).ensAddress||ho.throwError("network does not support ENS",Gr.errors.UNSUPPORTED_OPERATION,{operation:g,network:n.name}),t.prev=5,t.next=8,this.call({to:n.ensAddress,data:"0x0178b8bf"+to(e).substring(2)});case 8:return I=t.sent,t.abrupt("return",this.formatter.callAddress(I));case 12:t.prev=12,t.t0=t.catch(5);case 14:return t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,this,[[5,12]])})))}},{key:"resolveName",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:return e=g.sent,g.prev=3,g.abrupt("return",Promise.resolve(this.formatter.address(e)));case 7:if(g.prev=7,g.t0=g.catch(3),!qr(e)){g.next=11;break}throw g.t0;case 11:return"string"!==typeof e&&ho.throwArgumentError("invalid ENS name","name",e),g.next=14,this.getResolver(e);case 14:if(t=g.sent){g.next=17;break}return g.abrupt("return",null);case 17:return g.next=19,t.getAddress();case 19:return g.abrupt("return",g.sent);case 20:case"end":return g.stop()}}),g,this,[[3,7]])})))}},{key:"lookupAddress",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,e;case 2:return e=g.sent,e=this.formatter.address(e),t=e.substring(2).toLowerCase()+".addr.reverse",g.next=7,this._getResolver(t,"lookupAddress");case 7:if(null!=(n=g.sent)){g.next=10;break}return g.abrupt("return",null);case 10:return g.t0=Ro,g.next=13,this.call({to:n,data:"0x691f3431"+to(t).substring(2)});case 13:return g.t1=g.sent,I=(0,g.t0)(g.t1,0),g.next=17,this.resolveName(I);case 17:if(g.sent==e){g.next=20;break}return g.abrupt("return",null);case 20:return g.abrupt("return",I);case 21:case"end":return g.stop()}}),g,this)})))}},{key:"getAvatar",value:function(e){return mo(this,void 0,void 0,Ir().mark((function g(){var t,n,I,r,C,l,a;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(t=null,!qr(e)){g.next=40;break}return n=this.formatter.address(e),I=n.substring(2).toLowerCase()+".addr.reverse",g.next=6,this._getResolver(I,"getAvatar");case 6:if(r=g.sent){g.next=9;break}return g.abrupt("return",null);case 9:return t=new No(this,r,I),g.prev=10,g.next=13,t.getAvatar();case 13:if(!(C=g.sent)){g.next=16;break}return g.abrupt("return",C.url);case 16:g.next=22;break;case 18:if(g.prev=18,g.t0=g.catch(10),g.t0.code===Gr.errors.CALL_EXCEPTION){g.next=22;break}throw g.t0;case 22:return g.prev=22,g.t1=Ro,g.next=26,this.call({to:r,data:"0x691f3431"+to(I).substring(2)});case 26:return g.t2=g.sent,l=(0,g.t1)(g.t2,0),g.next=30,this.getResolver(l);case 30:t=g.sent,g.next=38;break;case 33:if(g.prev=33,g.t3=g.catch(22),g.t3.code===Gr.errors.CALL_EXCEPTION){g.next=37;break}throw g.t3;case 37:return g.abrupt("return",null);case 38:g.next=45;break;case 40:return g.next=42,this.getResolver(e);case 42:if(t=g.sent){g.next=45;break}return g.abrupt("return",null);case 45:return g.next=47,t.getAvatar();case 47:if(null!=(a=g.sent)){g.next=50;break}return g.abrupt("return",null);case 50:return g.abrupt("return",a.url);case 51:case"end":return g.stop()}}),g,this,[[10,18],[22,33]])})))}},{key:"perform",value:function(e,g){return ho.throwError(e+" not implemented",Gr.errors.NOT_IMPLEMENTED,{operation:e})}},{key:"_startEvent",value:function(e){this.polling=this._events.filter((function(e){return e.pollable()})).length>0}},{key:"_stopEvent",value:function(e){this.polling=this._events.filter((function(e){return e.pollable()})).length>0}},{key:"_addEventListener",value:function(e,g,t){var n=new Bo(po(e),g,t);return this._events.push(n),this._startEvent(n),this}},{key:"on",value:function(e,g){return this._addEventListener(e,g,!1)}},{key:"once",value:function(e,g){return this._addEventListener(e,g,!0)}},{key:"emit",value:function(e){for(var g=this,t=arguments.length,n=new Array(t>1?t-1:0),I=1;I<t;I++)n[I-1]=arguments[I];var r=!1,C=[],l=po(e);return this._events=this._events.filter((function(e){return e.tag!==l||(setTimeout((function(){e.listener.apply(g,n)}),0),r=!0,!e.once||(C.push(e),!1))})),C.forEach((function(e){g._stopEvent(e)})),r}},{key:"listenerCount",value:function(e){if(!e)return this._events.length;var g=po(e);return this._events.filter((function(e){return e.tag===g})).length}},{key:"listeners",value:function(e){if(null==e)return this._events.map((function(e){return e.listener}));var g=po(e);return this._events.filter((function(e){return e.tag===g})).map((function(e){return e.listener}))}},{key:"off",value:function(e,g){var t=this;if(null==g)return this.removeAllListeners(e);var n=[],I=!1,r=po(e);return this._events=this._events.filter((function(e){return e.tag!==r||e.listener!=g||(!!I||(I=!0,n.push(e),!1))})),n.forEach((function(e){t._stopEvent(e)})),this}},{key:"removeAllListeners",value:function(e){var g=this,t=[];if(null==e)t=this._events,this._events=[];else{var n=po(e);this._events=this._events.filter((function(e){return e.tag!==n||(t.push(e),!1)}))}return t.forEach((function(e){g._stopEvent(e)})),this}}],[{key:"getFormatter",value:function(){return null==Fo&&(Fo=new Ao),Fo}},{key:"getNetwork",value:function(e){return function(e){if(null==e)return null;if("number"===typeof e){for(var g in oo){var t=oo[g];if(t.chainId===e)return{name:t.name,chainId:t.chainId,ensAddress:t.ensAddress||null,_defaultProvider:t._defaultProvider||null}}return{chainId:e,name:"unknown"}}if("string"===typeof e){var n=oo[e];return null==n?null:{name:n.name,chainId:n.chainId,ensAddress:n.ensAddress,_defaultProvider:n._defaultProvider||null}}var I=oo[e.name];if(!I)return"number"!==typeof e.chainId&&no.throwArgumentError("invalid network chainId","network",e),e;0!==e.chainId&&e.chainId!==I.chainId&&no.throwArgumentError("network chainId mismatch","network",e);var r,C=e._defaultProvider||null;return null==C&&I._defaultProvider&&(C=(r=I._defaultProvider)&&"function"===typeof r.renetwork?I._defaultProvider.renetwork(e):I._defaultProvider),{name:e.name,chainId:I.chainId,ensAddress:e.ensAddress||I.ensAddress||null,_defaultProvider:C}}(null==e?"homestead":e)}}]),t}(Va),Eo=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},Mo=new Gr(wr),zo=["call","estimateGas"];function Uo(e,g){if(null==e)return null;if("string"===typeof e.message&&e.message.match("reverted")){var t=qr(e.data)?e.data:null;if(!g||t)return{message:e.message,data:t}}if("object"===typeof e){for(var n in e){var I=Uo(e[n],g);if(I)return I}return null}if("string"===typeof e)try{return Uo(JSON.parse(e),g)}catch(r){}return null}function Qo(e,g,t){var n=t.transaction||t.signedTransaction;if("call"===e){var I=Uo(g,!0);if(I)return I.data;Mo.throwError("missing revert data in call exception; Transaction reverted without a reason string",Gr.errors.CALL_EXCEPTION,{data:"0x",transaction:n,error:g})}if("estimateGas"===e){var r=Uo(g.body,!1);null==r&&(r=Uo(g,!1)),r&&Mo.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Gr.errors.UNPREDICTABLE_GAS_LIMIT,{reason:r.message,method:e,transaction:n,error:g})}var C=g.message;throw g.code===Gr.errors.SERVER_ERROR&&g.error&&"string"===typeof g.error.message?C=g.error.message:"string"===typeof g.body?C=g.body:"string"===typeof g.responseText&&(C=g.responseText),(C=(C||"").toLowerCase()).match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&Mo.throwError("insufficient funds for intrinsic transaction cost",Gr.errors.INSUFFICIENT_FUNDS,{error:g,method:e,transaction:n}),C.match(/nonce (is )?too low/i)&&Mo.throwError("nonce has already been used",Gr.errors.NONCE_EXPIRED,{error:g,method:e,transaction:n}),C.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&Mo.throwError("replacement fee too low",Gr.errors.REPLACEMENT_UNDERPRICED,{error:g,method:e,transaction:n}),C.match(/only replay-protected/i)&&Mo.throwError("legacy pre-eip-155 transactions not supported",Gr.errors.UNSUPPORTED_OPERATION,{error:g,method:e,transaction:n}),zo.indexOf(e)>=0&&C.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&Mo.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Gr.errors.UNPREDICTABLE_GAS_LIMIT,{error:g,method:e,transaction:n}),g}function Lo(e){return new Promise((function(g){setTimeout(g,e)}))}function To(e){if(e.error){var g=new Error(e.error.message);throw g.code=e.error.code,g.data=e.error.data,g}return e.result}function Do(e){return e?e.toLowerCase():e}var jo={},Po=function(e){gn(t,e);var g=In(t);function t(e,n,I){var r;if(it(this,t),r=g.call(this),e!==jo)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");return vr(nn(r),"provider",n),null==I&&(I=0),"string"===typeof I?(vr(nn(r),"_address",r.provider.formatter.address(I)),vr(nn(r),"_index",null)):"number"===typeof I?(vr(nn(r),"_index",I),vr(nn(r),"_address",null)):Mo.throwArgumentError("invalid address or index","addressOrIndex",I),r}return ut(t,[{key:"connect",value:function(e){return Mo.throwError("cannot alter JSON-RPC Signer connection",Gr.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}},{key:"connectUnchecked",value:function(){return new Oo(jo,this.provider,this._address||this._index)}},{key:"getAddress",value:function(){var e=this;return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then((function(g){return g.length<=e._index&&Mo.throwError("unknown account #"+e._index,Gr.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),e.provider.formatter.address(g[e._index])}))}},{key:"sendUncheckedTransaction",value:function(e){var g=this;e=Vr(e);var t=this.getAddress().then((function(e){return e&&(e=e.toLowerCase()),e}));if(null==e.gasLimit){var n=Vr(e);n.from=t,e.gasLimit=this.provider.estimateGas(n)}return null!=e.to&&(e.to=Promise.resolve(e.to).then((function(e){return Eo(g,void 0,void 0,Ir().mark((function g(){var t;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:if(null!=e){g.next=2;break}return g.abrupt("return",null);case 2:return g.next=4,this.provider.resolveName(e);case 4:return null==(t=g.sent)&&Mo.throwArgumentError("provided ENS name resolves to null","tx.to",e),g.abrupt("return",t);case 7:case"end":return g.stop()}}),g,this)})))}))),Wr({tx:Wr(e),sender:t}).then((function(t){var n=t.tx,I=t.sender;null!=n.from?n.from.toLowerCase()!==I&&Mo.throwArgumentError("from address mismatch","transaction",e):n.from=I;var r=g.provider.constructor.hexlifyTransaction(n,{from:!0});return g.provider.send("eth_sendTransaction",[r]).then((function(e){return e}),(function(e){return"string"===typeof e.message&&e.message.match(/user denied/i)&&Mo.throwError("user rejected transaction",Gr.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:n}),Qo("sendTransaction",e,r)}))}))}},{key:"signTransaction",value:function(e){return Mo.throwError("signing transactions is unsupported",Gr.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}},{key:"sendTransaction",value:function(e){return Eo(this,void 0,void 0,Ir().mark((function g(){var t,n,I=this;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval);case 2:return t=g.sent,g.next=5,this.sendUncheckedTransaction(e);case 5:return n=g.sent,g.prev=6,g.next=9,Ba((function(){return Eo(I,void 0,void 0,Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.provider.getTransaction(n);case 2:if(null!==(g=e.sent)){e.next=5;break}return e.abrupt("return",void 0);case 5:return e.abrupt("return",this.provider._wrapTransaction(g,n,t));case 6:case"end":return e.stop()}}),e,this)})))}),{oncePoll:this.provider});case 9:return g.abrupt("return",g.sent);case 12:throw g.prev=12,g.t0=g.catch(6),g.t0.transactionHash=n,g.t0;case 16:case"end":return g.stop()}}),g,this,[[6,12]])})))}},{key:"signMessage",value:function(e){return Eo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t="string"===typeof e?QC(e):e,g.next=3,this.getAddress();case 3:return n=g.sent,g.prev=4,g.next=7,this.provider.send("personal_sign",[eC(t),n.toLowerCase()]);case 7:return g.abrupt("return",g.sent);case 10:throw g.prev=10,g.t0=g.catch(4),"string"===typeof g.t0.message&&g.t0.message.match(/user denied/i)&&Mo.throwError("user rejected signing",Gr.errors.ACTION_REJECTED,{action:"signMessage",from:n,messageData:e}),g.t0;case 14:case"end":return g.stop()}}),g,this,[[4,10]])})))}},{key:"_legacySignMessage",value:function(e){return Eo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t="string"===typeof e?QC(e):e,g.next=3,this.getAddress();case 3:return n=g.sent,g.prev=4,g.next=7,this.provider.send("eth_sign",[n.toLowerCase(),eC(t)]);case 7:return g.abrupt("return",g.sent);case 10:throw g.prev=10,g.t0=g.catch(4),"string"===typeof g.t0.message&&g.t0.message.match(/user denied/i)&&Mo.throwError("user rejected signing",Gr.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:n,messageData:e}),g.t0;case 14:case"end":return g.stop()}}),g,this,[[4,10]])})))}},{key:"_signTypedData",value:function(e,g,t){return Eo(this,void 0,void 0,Ir().mark((function n(){var I,r,C=this;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,al.resolveNames(e,g,t,(function(e){return C.provider.resolveName(e)}));case 2:return I=n.sent,n.next=5,this.getAddress();case 5:return r=n.sent,n.prev=6,n.next=9,this.provider.send("eth_signTypedData_v4",[r.toLowerCase(),JSON.stringify(al.getPayload(I.domain,g,I.value))]);case 9:return n.abrupt("return",n.sent);case 12:throw n.prev=12,n.t0=n.catch(6),"string"===typeof n.t0.message&&n.t0.message.match(/user denied/i)&&Mo.throwError("user rejected signing",Gr.errors.ACTION_REJECTED,{action:"_signTypedData",from:r,messageData:{domain:I.domain,types:g,value:I.value}}),n.t0;case 16:case"end":return n.stop()}}),n,this,[[6,12]])})))}},{key:"unlock",value:function(e){return Eo(this,void 0,void 0,Ir().mark((function g(){var t,n;return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=this.provider,g.next=3,this.getAddress();case 3:return n=g.sent,g.abrupt("return",t.send("personal_unlockAccount",[n.toLowerCase(),e,null]));case 5:case"end":return g.stop()}}),g,this)})))}}]),t}(xr),Oo=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"sendTransaction",value:function(e){var g=this;return this.sendUncheckedTransaction(e).then((function(e){return{hash:e,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:function(t){return g.provider.waitForTransaction(e,t)}}}))}}]),t}(Po),_o={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0},qo=function(e){gn(t,e);var g=In(t);function t(e,n){var I;it(this,t);var r=n;return null==r&&(r=new Promise((function(e,g){setTimeout((function(){I.detectNetwork().then((function(g){e(g)}),(function(e){g(e)}))}),0)}))),I=g.call(this,r),e||(e=Sr(I.constructor,"defaultUrl")()),vr(nn(I),"connection","string"===typeof e?Object.freeze({url:e}):Object.freeze(Vr(e))),I._nextId=42,I}return ut(t,[{key:"_cache",get:function(){return null==this._eventLoopCache&&(this._eventLoopCache={}),this._eventLoopCache}},{key:"detectNetwork",value:function(){var e=this;return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout((function(){e._cache.detectNetwork=null}),0)),this._cache.detectNetwork}},{key:"_uncachedDetectNetwork",value:function(){return Eo(this,void 0,void 0,Ir().mark((function e(){var g,t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lo(0);case 2:return g=null,e.prev=3,e.next=6,this.send("eth_chainId",[]);case 6:g=e.sent,e.next=19;break;case 9:return e.prev=9,e.t0=e.catch(3),e.prev=11,e.next=14,this.send("net_version",[]);case 14:g=e.sent,e.next=19;break;case 17:e.prev=17,e.t1=e.catch(11);case 19:if(null==g){e.next=28;break}return t=Sr(this.constructor,"getNetwork"),e.prev=21,e.abrupt("return",t(uC.from(g).toNumber()));case 25:return e.prev=25,e.t2=e.catch(21),e.abrupt("return",Mo.throwError("could not detect network",Gr.errors.NETWORK_ERROR,{chainId:g,event:"invalidNetwork",serverError:e.t2}));case 28:return e.abrupt("return",Mo.throwError("could not detect network",Gr.errors.NETWORK_ERROR,{event:"noNetwork"}));case 29:case"end":return e.stop()}}),e,this,[[3,9],[11,17],[21,25]])})))}},{key:"getSigner",value:function(e){return new Po(jo,this,e)}},{key:"getUncheckedSigner",value:function(e){return this.getSigner(e).connectUnchecked()}},{key:"listAccounts",value:function(){var e=this;return this.send("eth_accounts",[]).then((function(g){return g.map((function(g){return e.formatter.address(g)}))}))}},{key:"send",value:function(e,g){var t=this,n={method:e,params:g,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:Jr(n),provider:this});var I=["eth_chainId","eth_blockNumber"].indexOf(e)>=0;if(I&&this._cache[e])return this._cache[e];var r=fa(this.connection,JSON.stringify(n),To).then((function(e){return t.emit("debug",{action:"response",request:n,response:e,provider:t}),e}),(function(e){throw t.emit("debug",{action:"response",error:e,request:n,provider:t}),e}));return I&&(this._cache[e]=r,setTimeout((function(){t._cache[e]=null}),0)),r}},{key:"prepareRequest",value:function(e,g){switch(e){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[Do(g.address),g.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[Do(g.address),g.blockTag]];case"getCode":return["eth_getCode",[Do(g.address),g.blockTag]];case"getStorageAt":return["eth_getStorageAt",[Do(g.address),rC(g.position,32),g.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[g.signedTransaction]];case"getBlock":return g.blockTag?["eth_getBlockByNumber",[g.blockTag,!!g.includeTransactions]]:g.blockHash?["eth_getBlockByHash",[g.blockHash,!!g.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[g.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[g.transactionHash]];case"call":return["eth_call",[Sr(this.constructor,"hexlifyTransaction")(g.transaction,{from:!0}),g.blockTag]];case"estimateGas":return["eth_estimateGas",[Sr(this.constructor,"hexlifyTransaction")(g.transaction,{from:!0})]];case"getLogs":return g.filter&&null!=g.filter.address&&(g.filter.address=Do(g.filter.address)),["eth_getLogs",[g.filter]]}return null}},{key:"perform",value:function(e,g){return Eo(this,void 0,void 0,Ir().mark((function t(){var n,I,r;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("call"!==e&&"estimateGas"!==e){t.next=8;break}if(!(n=g.transaction)||null==n.type||!uC.from(n.type).isZero()){t.next=8;break}if(null!=n.maxFeePerGas||null!=n.maxPriorityFeePerGas){t.next=8;break}return t.next=6,this.getFeeData();case 6:null==(I=t.sent).maxFeePerGas&&null==I.maxPriorityFeePerGas&&((g=Vr(g)).transaction=Vr(n),delete g.transaction.type);case 8:return null==(r=this.prepareRequest(e,g))&&Mo.throwError(e+" not implemented",Gr.errors.NOT_IMPLEMENTED,{operation:e}),t.prev=10,t.next=13,this.send(r[0],r[1]);case 13:return t.abrupt("return",t.sent);case 16:return t.prev=16,t.t0=t.catch(10),t.abrupt("return",Qo(e,t.t0,g));case 19:case"end":return t.stop()}}),t,this,[[10,16]])})))}},{key:"_startEvent",value:function(e){"pending"===e.tag&&this._startPending(),en($t(t.prototype),"_startEvent",this).call(this,e)}},{key:"_startPending",value:function(){if(null==this._pendingFilter){var e=this,g=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=g,g.then((function(t){return function n(){e.send("eth_getFilterChanges",[t]).then((function(t){if(e._pendingFilter!=g)return null;var n=Promise.resolve();return t.forEach((function(g){e._emitted["t:"+g.toLowerCase()]="pending",n=n.then((function(){return e.getTransaction(g).then((function(g){return e.emit("pending",g),null}))}))})),n.then((function(){return Lo(1e3)}))})).then((function(){if(e._pendingFilter==g)return setTimeout((function(){n()}),0),null;e.send("eth_uninstallFilter",[t])})).catch((function(e){}))}(),t})).catch((function(e){}))}}},{key:"_stopEvent",value:function(e){"pending"===e.tag&&0===this.listenerCount("pending")&&(this._pendingFilter=null),en($t(t.prototype),"_stopEvent",this).call(this,e)}}],[{key:"defaultUrl",value:function(){return"http://localhost:8545"}},{key:"hexlifyTransaction",value:function(e,g){var t=Vr(_o);if(g)for(var n in g)g[n]&&(t[n]=!0);!function(e,g){e&&"object"===typeof e||Br.throwArgumentError("invalid object","object",e),Object.keys(e).forEach((function(t){g[t]||Br.throwArgumentError("invalid object key - "+t,"transaction:"+t,e)}))}(e,t);var I={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach((function(g){if(null!=e[g]){var t=IC(uC.from(e[g]));"gasLimit"===g&&(g="gas"),I[g]=t}})),["from","to","data"].forEach((function(g){null!=e[g]&&(I[g]=eC(e[g]))})),e.accessList&&(I.accessList=oa(e.accessList)),I}}]),t}(xo),$o=new Gr(wr),ei=1;function gi(e,g){var t="Web3LegacyFetcher";return function(e,n){var I=this,r={method:e,params:n,id:ei++,jsonrpc:"2.0"};return new Promise((function(e,n){I.emit("debug",{action:"request",fetcher:t,request:Jr(r),provider:I}),g(r,(function(g,C){if(g)return I.emit("debug",{action:"response",fetcher:t,error:g,request:r,provider:I}),n(g);if(I.emit("debug",{action:"response",fetcher:t,request:r,response:C,provider:I}),C.error){var l=new Error(C.error.message);return l.code=C.error.code,l.data=C.error.data,n(l)}e(C.result)}))}))}}var ti=function(e){gn(t,e);var g=In(t);function t(e,n){var I;it(this,t),null==e&&$o.throwArgumentError("missing provider","provider",e);var r=null,C=null,l=null;return"function"===typeof e?(r="unknown:",C=e):(!(r=e.host||e.path||"")&&e.isMetaMask&&(r="metamask"),l=e,e.request?(""===r&&(r="eip-1193:"),C=function(e){return function(g,t){var n=this;null==t&&(t=[]);var I={method:g,params:t};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:Jr(I),provider:this}),e.request(I).then((function(e){return n.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:I,response:e,provider:n}),e}),(function(e){throw n.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:I,error:e,provider:n}),e}))}}(e)):e.sendAsync?C=gi(0,e.sendAsync.bind(e)):e.send?C=gi(0,e.send.bind(e)):$o.throwArgumentError("unsupported provider","provider",e),r||(r="unknown:")),vr(nn(I=g.call(this,r,n)),"jsonRpcFetchFunc",C),vr(nn(I),"provider",l),I}return ut(t,[{key:"send",value:function(e,g){return this.jsonRpcFetchFunc(e,g)}}]),t}(qo),ni="abi/5.7.0",Ii=new Gr(ni);var ri=function(){function e(g,t,n,I){it(this,e),this.name=g,this.type=t,this.localName=n,this.dynamic=I}return ut(e,[{key:"_throwError",value:function(e,g){Ii.throwArgumentError(e,this.localName,g)}}]),e}(),Ci=function(){function e(g){it(this,e),vr(this,"wordSize",g||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(g)}return ut(e,[{key:"data",get:function(){return nC(this._data)}},{key:"length",get:function(){return this._dataLength}},{key:"_writeData",value:function(e){return this._data.push(e),this._dataLength+=e.length,e.length}},{key:"appendWriter",value:function(e){return this._writeData(Or(e._data))}},{key:"writeBytes",value:function(e){var g=Pr(e),t=g.length%this.wordSize;return t&&(g=Or([g,this._padding.slice(t)])),this._writeData(g)}},{key:"_getValue",value:function(e){var g=Pr(uC.from(e));return g.length>this.wordSize&&Ii.throwError("value out-of-bounds",Gr.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:g.length}),g.length%this.wordSize&&(g=Or([this._padding.slice(g.length%this.wordSize),g])),g}},{key:"writeValue",value:function(e){return this._writeData(this._getValue(e))}},{key:"writeUpdatableValue",value:function(){var e=this,g=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,function(t){e._data[g]=e._getValue(t)}}}]),e}(),li=function(){function e(g,t,n,I){it(this,e),vr(this,"_data",Pr(g)),vr(this,"wordSize",t||32),vr(this,"_coerceFunc",n),vr(this,"allowLoose",I),this._offset=0}return ut(e,[{key:"data",get:function(){return eC(this._data)}},{key:"consumed",get:function(){return this._offset}},{key:"coerce",value:function(g,t){return this._coerceFunc?this._coerceFunc(g,t):e.coerce(g,t)}},{key:"_peekBytes",value:function(e,g,t){var n=Math.ceil(g/this.wordSize)*this.wordSize;return this._offset+n>this._data.length&&(this.allowLoose&&t&&this._offset+g<=this._data.length?n=g:Ii.throwError("data out-of-bounds",Gr.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+n})),this._data.slice(this._offset,this._offset+n)}},{key:"subReader",value:function(g){return new e(this._data.slice(this._offset+g),this.wordSize,this._coerceFunc,this.allowLoose)}},{key:"readBytes",value:function(e,g){var t=this._peekBytes(0,e,!!g);return this._offset+=t.length,t.slice(0,e)}},{key:"readValue",value:function(){return uC.from(this.readBytes(this.wordSize))}}],[{key:"coerce",value:function(e,g){var t=e.match("^u?int([0-9]+)$");return t&&parseInt(t[1])<=48&&(g=g.toNumber()),g}}]),e}(),ai=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"address","address",e,!1)}return ut(t,[{key:"defaultValue",value:function(){return"0x0000000000000000000000000000000000000000"}},{key:"encode",value:function(e,g){try{g=HC(g)}catch(t){this._throwError(t.message,g)}return e.writeValue(g)}},{key:"decode",value:function(e){return HC(rC(e.readValue().toHexString(),20))}}]),t}(ri),oi=function(e){gn(t,e);var g=In(t);function t(e){var n;return it(this,t),(n=g.call(this,e.name,e.type,void 0,e.dynamic)).coder=e,n}return ut(t,[{key:"defaultValue",value:function(){return this.coder.defaultValue()}},{key:"encode",value:function(e,g){return this.coder.encode(e,g)}},{key:"decode",value:function(e){return this.coder.decode(e)}}]),t}(ri),ii=new Gr(ni);function ci(e,g,t){var n=null;if(Array.isArray(t))n=t;else if(t&&"object"===typeof t){var I={};n=g.map((function(e){var g=e.localName;return g||ii.throwError("cannot encode object for signature with missing names",Gr.errors.INVALID_ARGUMENT,{argument:"values",coder:e,value:t}),I[g]&&ii.throwError("cannot encode object for signature with duplicate names",Gr.errors.INVALID_ARGUMENT,{argument:"values",coder:e,value:t}),I[g]=!0,t[g]}))}else ii.throwArgumentError("invalid tuple value","tuple",t);g.length!==n.length&&ii.throwArgumentError("types/value length mismatch","tuple",t);var r=new Ci(e.wordSize),C=new Ci(e.wordSize),l=[];g.forEach((function(e,g){var t=n[g];if(e.dynamic){var I=C.length;e.encode(C,t);var a=r.writeUpdatableValue();l.push((function(e){a(e+I)}))}else e.encode(r,t)})),l.forEach((function(e){e(r.length)}));var a=e.appendWriter(r);return a+=e.appendWriter(C)}function ui(e,g){var t=[],n=e.subReader(0);g.forEach((function(g){var I=null;if(g.dynamic){var r=e.readValue(),C=n.subReader(r.toNumber());try{I=g.decode(C)}catch(l){if(l.code===Gr.errors.BUFFER_OVERRUN)throw l;(I=l).baseType=g.name,I.name=g.localName,I.type=g.type}}else try{I=g.decode(e)}catch(l){if(l.code===Gr.errors.BUFFER_OVERRUN)throw l;(I=l).baseType=g.name,I.name=g.localName,I.type=g.type}void 0!=I&&t.push(I)}));var I=g.reduce((function(e,g){var t=g.localName;return t&&(e[t]||(e[t]=0),e[t]++),e}),{});g.forEach((function(e,g){var n=e.localName;if(n&&1===I[n]&&("length"===n&&(n="_length"),null==t[n])){var r=t[g];r instanceof Error?Object.defineProperty(t,n,{enumerable:!0,get:function(){throw r}}):t[n]=r}}));for(var r=function(){var e=t[C];e instanceof Error&&Object.defineProperty(t,C,{enumerable:!0,get:function(){throw e}})},C=0;C<t.length;C++)r();return Object.freeze(t)}var si=function(e){gn(t,e);var g=In(t);function t(e,n,I){var r;it(this,t);var C=e.type+"["+(n>=0?n:"")+"]",l=-1===n||e.dynamic;return(r=g.call(this,"array",C,I,l)).coder=e,r.length=n,r}return ut(t,[{key:"defaultValue",value:function(){for(var e=this.coder.defaultValue(),g=[],t=0;t<this.length;t++)g.push(e);return g}},{key:"encode",value:function(e,g){Array.isArray(g)||this._throwError("expected array value",g);var t=this.length;-1===t&&(t=g.length,e.writeValue(g.length)),ii.checkArgumentCount(g.length,t,"coder array"+(this.localName?" "+this.localName:""));for(var n=[],I=0;I<g.length;I++)n.push(this.coder);return ci(e,n,g)}},{key:"decode",value:function(e){var g=this.length;-1===g&&32*(g=e.readValue().toNumber())>e._data.length&&ii.throwError("insufficient data length",Gr.errors.BUFFER_OVERRUN,{length:e._data.length,count:g});for(var t=[],n=0;n<g;n++)t.push(new oi(this.coder));return e.coerce(this.name,ui(e,t))}}]),t}(ri),Ai=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"bool","bool",e,!1)}return ut(t,[{key:"defaultValue",value:function(){return!1}},{key:"encode",value:function(e,g){return e.writeValue(g?1:0)}},{key:"decode",value:function(e){return e.coerce(this.type,!e.readValue().isZero())}}]),t}(ri),di=function(e){gn(t,e);var g=In(t);function t(e,n){return it(this,t),g.call(this,e,e,n,!0)}return ut(t,[{key:"defaultValue",value:function(){return"0x"}},{key:"encode",value:function(e,g){g=Pr(g);var t=e.writeValue(g.length);return t+=e.writeBytes(g)}},{key:"decode",value:function(e){return e.readBytes(e.readValue().toNumber(),!0)}}]),t}(ri),mi=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"bytes",e)}return ut(t,[{key:"decode",value:function(e){return e.coerce(this.name,eC(en($t(t.prototype),"decode",this).call(this,e)))}}]),t}(di),hi=function(e){gn(t,e);var g=In(t);function t(e,n){var I;it(this,t);var r="bytes"+String(e);return(I=g.call(this,r,r,n,!1)).size=e,I}return ut(t,[{key:"defaultValue",value:function(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}},{key:"encode",value:function(e,g){var t=Pr(g);return t.length!==this.size&&this._throwError("incorrect data length",g),e.writeBytes(t)}},{key:"decode",value:function(e){return e.coerce(this.name,eC(e.readBytes(this.size)))}}]),t}(ri),bi=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"null","",e,!1)}return ut(t,[{key:"defaultValue",value:function(){return null}},{key:"encode",value:function(e,g){return null!=g&&this._throwError("not null",g),e.writeBytes([])}},{key:"decode",value:function(e){return e.readBytes(0),e.coerce(this.name,null)}}]),t}(ri),Zi=function(e){gn(t,e);var g=In(t);function t(e,n,I){var r;it(this,t);var C=(n?"int":"uint")+8*e;return(r=g.call(this,C,C,I,!1)).size=e,r.signed=n,r}return ut(t,[{key:"defaultValue",value:function(){return 0}},{key:"encode",value:function(e,g){var t=uC.from(g),n=ul.mask(8*e.wordSize);if(this.signed){var I=n.mask(8*this.size-1);(t.gt(I)||t.lt(I.add(cl).mul(ol)))&&this._throwError("value out-of-bounds",g)}else(t.lt(il)||t.gt(n.mask(8*this.size)))&&this._throwError("value out-of-bounds",g);return t=t.toTwos(8*this.size).mask(8*this.size),this.signed&&(t=t.fromTwos(8*this.size).toTwos(8*e.wordSize)),e.writeValue(t)}},{key:"decode",value:function(e){var g=e.readValue().mask(8*this.size);return this.signed&&(g=g.fromTwos(8*this.size)),e.coerce(this.name,g)}}]),t}(ri),pi=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"string",e)}return ut(t,[{key:"defaultValue",value:function(){return""}},{key:"encode",value:function(e,g){return en($t(t.prototype),"encode",this).call(this,e,QC(g))}},{key:"decode",value:function(e){return LC(en($t(t.prototype),"decode",this).call(this,e))}}]),t}(di),yi=function(e){gn(t,e);var g=In(t);function t(e,n){var I;it(this,t);var r=!1,C=[];e.forEach((function(e){e.dynamic&&(r=!0),C.push(e.type)}));var l="tuple("+C.join(",")+")";return(I=g.call(this,"tuple",l,n,r)).coders=e,I}return ut(t,[{key:"defaultValue",value:function(){var e=[];this.coders.forEach((function(g){e.push(g.defaultValue())}));var g=this.coders.reduce((function(e,g){var t=g.localName;return t&&(e[t]||(e[t]=0),e[t]++),e}),{});return this.coders.forEach((function(t,n){var I=t.localName;I&&1===g[I]&&("length"===I&&(I="_length"),null==e[I]&&(e[I]=e[n]))})),Object.freeze(e)}},{key:"encode",value:function(e,g){return ci(e,this.coders,g)}},{key:"decode",value:function(e){return e.coerce(this.name,ui(e,this.coders))}}]),t}(ri),Gi=new Gr(ni),fi={},Bi={calldata:!0,memory:!0,storage:!0},vi={calldata:!0,memory:!0};function Si(e,g){if("bytes"===e||"string"===e){if(Bi[g])return!0}else if("address"===e){if("payable"===g)return!0}else if((e.indexOf("[")>=0||"tuple"===e)&&vi[g])return!0;return(Bi[g]||"payable"===g)&&Gi.throwArgumentError("invalid modifier","name",g),!1}function Wi(e,g){for(var t in g)vr(e,t,g[t])}var Vi=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),ki=new RegExp(/^(.*)\[([0-9]*)\]$/),Ri=function(){function e(g,t){it(this,e),g!==fi&&Gi.throwError("use fromString",Gr.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),Wi(this,t);var n=this.type.match(ki);Wi(this,n?{arrayLength:parseInt(n[2]||"-1"),arrayChildren:e.fromObject({type:n[1],components:this.components}),baseType:"array"}:{arrayLength:null,arrayChildren:null,baseType:null!=this.components?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}return ut(e,[{key:"format",value:function(e){if(e||(e=Vi.sighash),Vi[e]||Gi.throwArgumentError("invalid format type","format",e),e===Vi.json){var g={type:"tuple"===this.baseType?"tuple":this.type,name:this.name||void 0};return"boolean"===typeof this.indexed&&(g.indexed=this.indexed),this.components&&(g.components=this.components.map((function(g){return JSON.parse(g.format(e))}))),JSON.stringify(g)}var t="";return"array"===this.baseType?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):"tuple"===this.baseType?(e!==Vi.sighash&&(t+=this.type),t+="("+this.components.map((function(g){return g.format(e)})).join(e===Vi.full?", ":",")+")"):t+=this.type,e!==Vi.sighash&&(!0===this.indexed&&(t+=" indexed"),e===Vi.full&&this.name&&(t+=" "+this.name)),t}}],[{key:"from",value:function(g,t){return"string"===typeof g?e.fromString(g,t):e.fromObject(g)}},{key:"fromObject",value:function(g){return e.isParamType(g)?g:new e(fi,{name:g.name||null,type:Mi(g.type),indexed:null==g.indexed?null:!!g.indexed,components:g.components?g.components.map(e.fromObject):null})}},{key:"fromString",value:function(g,t){return n=function(e,g){var t=e;function n(g){Gi.throwArgumentError("unexpected character at position ".concat(g),"param",e)}function I(e){var t={type:"",name:"",parent:e,state:{allowType:!0}};return g&&(t.indexed=!1),t}e=e.replace(/\s/g," ");for(var r={type:"",name:"",state:{allowType:!0}},C=r,l=0;l<e.length;l++){var a=e[l];switch(a){case"(":C.state.allowType&&""===C.type?C.type="tuple":C.state.allowParams||n(l),C.state.allowType=!1,C.type=Mi(C.type),C.components=[I(C)],C=C.components[0];break;case")":delete C.state,"indexed"===C.name&&(g||n(l),C.indexed=!0,C.name=""),Si(C.type,C.name)&&(C.name=""),C.type=Mi(C.type);var o=C;(C=C.parent)||n(l),delete o.parent,C.state.allowParams=!1,C.state.allowName=!0,C.state.allowArray=!0;break;case",":delete C.state,"indexed"===C.name&&(g||n(l),C.indexed=!0,C.name=""),Si(C.type,C.name)&&(C.name=""),C.type=Mi(C.type);var i=I(C.parent);C.parent.components.push(i),delete C.parent,C=i;break;case" ":C.state.allowType&&""!==C.type&&(C.type=Mi(C.type),delete C.state.allowType,C.state.allowName=!0,C.state.allowParams=!0),C.state.allowName&&""!==C.name&&("indexed"===C.name?(g||n(l),C.indexed&&n(l),C.indexed=!0,C.name=""):Si(C.type,C.name)?C.name="":C.state.allowName=!1);break;case"[":C.state.allowArray||n(l),C.type+=a,C.state.allowArray=!1,C.state.allowName=!1,C.state.readArray=!0;break;case"]":C.state.readArray||n(l),C.type+=a,C.state.readArray=!1,C.state.allowArray=!0,C.state.allowName=!0;break;default:C.state.allowType?(C.type+=a,C.state.allowParams=!0,C.state.allowArray=!0):C.state.allowName?(C.name+=a,delete C.state.allowArray):C.state.readArray?C.type+=a:n(l)}}return C.parent&&Gi.throwArgumentError("unexpected eof","param",e),delete r.state,"indexed"===C.name?(g||n(t.length-7),C.indexed&&n(t.length-7),C.indexed=!0,C.name=""):Si(C.type,C.name)&&(C.name=""),r.type=Mi(r.type),r}(g,!!t),e.fromObject({name:n.name,type:n.type,indexed:n.indexed,components:n.components});var n}},{key:"isParamType",value:function(e){return!(null==e||!e._isParamType)}}]),e}();function Xi(e,g){return function(e){e=e.trim();for(var g=[],t="",n=0,I=0;I<e.length;I++){var r=e[I];","===r&&0===n?(g.push(t),t=""):(t+=r,"("===r?n++:")"===r&&-1===--n&&Gi.throwArgumentError("unbalanced parenthesis","value",e))}t&&g.push(t);return g}(e).map((function(e){return Ri.fromString(e,g)}))}var Ji=function(){function e(g,t){it(this,e),g!==fi&&Gi.throwError("use a static from method",Gr.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),Wi(this,t),this._isFragment=!0,Object.freeze(this)}return ut(e,null,[{key:"from",value:function(g){return e.isFragment(g)?g:"string"===typeof g?e.fromString(g):e.fromObject(g)}},{key:"fromObject",value:function(g){if(e.isFragment(g))return g;switch(g.type){case"function":return Ki.fromObject(g);case"event":return Yi.fromObject(g);case"constructor":return Fi.fromObject(g);case"error":return Ei.fromObject(g);case"fallback":case"receive":return null}return Gi.throwArgumentError("invalid fragment object","value",g)}},{key:"fromString",value:function(e){return"event"===(e=(e=(e=e.replace(/\s/g," ")).replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," ")).trim()).split(" ")[0]?Yi.fromString(e.substring(5).trim()):"function"===e.split(" ")[0]?Ki.fromString(e.substring(8).trim()):"constructor"===e.split("(")[0].trim()?Fi.fromString(e.trim()):"error"===e.split(" ")[0]?Ei.fromString(e.substring(5).trim()):Gi.throwArgumentError("unsupported fragment","value",e)}},{key:"isFragment",value:function(e){return!(!e||!e._isFragment)}}]),e}(),Yi=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"format",value:function(e){if(e||(e=Vi.sighash),Vi[e]||Gi.throwArgumentError("invalid format type","format",e),e===Vi.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map((function(g){return JSON.parse(g.format(e))}))});var g="";return e!==Vi.sighash&&(g+="event "),g+=this.name+"("+this.inputs.map((function(g){return g.format(e)})).join(e===Vi.full?", ":",")+") ",e!==Vi.sighash&&this.anonymous&&(g+="anonymous "),g.trim()}}],[{key:"from",value:function(e){return"string"===typeof e?t.fromString(e):t.fromObject(e)}},{key:"fromObject",value:function(e){if(t.isEventFragment(e))return e;"event"!==e.type&&Gi.throwArgumentError("invalid event object","value",e);var g={name:Ui(e.name),anonymous:e.anonymous,inputs:e.inputs?e.inputs.map(Ri.fromObject):[],type:"event"};return new t(fi,g)}},{key:"fromString",value:function(e){var g=e.match(Qi);g||Gi.throwArgumentError("invalid event string","value",e);var n=!1;return g[3].split(" ").forEach((function(e){switch(e.trim()){case"anonymous":n=!0;break;case"":break;default:Gi.warn("unknown modifier: "+e)}})),t.fromObject({name:g[1].trim(),anonymous:n,inputs:Xi(g[2],!0),type:"event"})}},{key:"isEventFragment",value:function(e){return e&&e._isFragment&&"event"===e.type}}]),t}(Ji);function wi(e,g){g.gas=null;var t=e.split("@");return 1!==t.length?(t.length>2&&Gi.throwArgumentError("invalid human-readable ABI signature","value",e),t[1].match(/^[0-9]+$/)||Gi.throwArgumentError("invalid human-readable ABI signature gas","value",e),g.gas=uC.from(t[1]),t[0]):e}function Hi(e,g){g.constant=!1,g.payable=!1,g.stateMutability="nonpayable",e.split(" ").forEach((function(e){switch(e.trim()){case"constant":g.constant=!0;break;case"payable":g.payable=!0,g.stateMutability="payable";break;case"nonpayable":g.payable=!1,g.stateMutability="nonpayable";break;case"pure":g.constant=!0,g.stateMutability="pure";break;case"view":g.constant=!0,g.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+e)}}))}function Ni(e){var g={constant:!1,payable:!0,stateMutability:"payable"};return null!=e.stateMutability?(g.stateMutability=e.stateMutability,g.constant="view"===g.stateMutability||"pure"===g.stateMutability,null!=e.constant&&!!e.constant!==g.constant&&Gi.throwArgumentError("cannot have constant function with mutability "+g.stateMutability,"value",e),g.payable="payable"===g.stateMutability,null!=e.payable&&!!e.payable!==g.payable&&Gi.throwArgumentError("cannot have payable function with mutability "+g.stateMutability,"value",e)):null!=e.payable?(g.payable=!!e.payable,null!=e.constant||g.payable||"constructor"===e.type||Gi.throwArgumentError("unable to determine stateMutability","value",e),g.constant=!!e.constant,g.constant?g.stateMutability="view":g.stateMutability=g.payable?"payable":"nonpayable",g.payable&&g.constant&&Gi.throwArgumentError("cannot have constant payable function","value",e)):null!=e.constant?(g.constant=!!e.constant,g.payable=!g.constant,g.stateMutability=g.constant?"view":"payable"):"constructor"!==e.type&&Gi.throwArgumentError("unable to determine stateMutability","value",e),g}var Fi=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"format",value:function(e){if(e||(e=Vi.sighash),Vi[e]||Gi.throwArgumentError("invalid format type","format",e),e===Vi.json)return JSON.stringify({type:"constructor",stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((function(g){return JSON.parse(g.format(e))}))});e===Vi.sighash&&Gi.throwError("cannot format a constructor for sighash",Gr.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});var g="constructor("+this.inputs.map((function(g){return g.format(e)})).join(e===Vi.full?", ":",")+") ";return this.stateMutability&&"nonpayable"!==this.stateMutability&&(g+=this.stateMutability+" "),g.trim()}}],[{key:"from",value:function(e){return"string"===typeof e?t.fromString(e):t.fromObject(e)}},{key:"fromObject",value:function(e){if(t.isConstructorFragment(e))return e;"constructor"!==e.type&&Gi.throwArgumentError("invalid constructor object","value",e);var g=Ni(e);g.constant&&Gi.throwArgumentError("constructor cannot be constant","value",e);var n={name:null,type:e.type,inputs:e.inputs?e.inputs.map(Ri.fromObject):[],payable:g.payable,stateMutability:g.stateMutability,gas:e.gas?uC.from(e.gas):null};return new t(fi,n)}},{key:"fromString",value:function(e){var g={type:"constructor"},n=(e=wi(e,g)).match(Qi);return n&&"constructor"===n[1].trim()||Gi.throwArgumentError("invalid constructor string","value",e),g.inputs=Xi(n[2].trim(),!1),Hi(n[3].trim(),g),t.fromObject(g)}},{key:"isConstructorFragment",value:function(e){return e&&e._isFragment&&"constructor"===e.type}}]),t}(Ji),Ki=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"format",value:function(e){if(e||(e=Vi.sighash),Vi[e]||Gi.throwArgumentError("invalid format type","format",e),e===Vi.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map((function(g){return JSON.parse(g.format(e))})),outputs:this.outputs.map((function(g){return JSON.parse(g.format(e))}))});var g="";return e!==Vi.sighash&&(g+="function "),g+=this.name+"("+this.inputs.map((function(g){return g.format(e)})).join(e===Vi.full?", ":",")+") ",e!==Vi.sighash&&(this.stateMutability?"nonpayable"!==this.stateMutability&&(g+=this.stateMutability+" "):this.constant&&(g+="view "),this.outputs&&this.outputs.length&&(g+="returns ("+this.outputs.map((function(g){return g.format(e)})).join(", ")+") "),null!=this.gas&&(g+="@"+this.gas.toString()+" ")),g.trim()}}],[{key:"from",value:function(e){return"string"===typeof e?t.fromString(e):t.fromObject(e)}},{key:"fromObject",value:function(e){if(t.isFunctionFragment(e))return e;"function"!==e.type&&Gi.throwArgumentError("invalid function object","value",e);var g=Ni(e),n={type:e.type,name:Ui(e.name),constant:g.constant,inputs:e.inputs?e.inputs.map(Ri.fromObject):[],outputs:e.outputs?e.outputs.map(Ri.fromObject):[],payable:g.payable,stateMutability:g.stateMutability,gas:e.gas?uC.from(e.gas):null};return new t(fi,n)}},{key:"fromString",value:function(e){var g={type:"function"},n=(e=wi(e,g)).split(" returns ");n.length>2&&Gi.throwArgumentError("invalid function string","value",e);var I=n[0].match(Qi);if(I||Gi.throwArgumentError("invalid function signature","value",e),g.name=I[1].trim(),g.name&&Ui(g.name),g.inputs=Xi(I[2],!1),Hi(I[3].trim(),g),n.length>1){var r=n[1].match(Qi);""==r[1].trim()&&""==r[3].trim()||Gi.throwArgumentError("unexpected tokens","value",e),g.outputs=Xi(r[2],!1)}else g.outputs=[];return t.fromObject(g)}},{key:"isFunctionFragment",value:function(e){return e&&e._isFragment&&"function"===e.type}}]),t}(Fi);function xi(e){var g=e.format();return"Error(string)"!==g&&"Panic(uint256)"!==g||Gi.throwArgumentError("cannot specify user defined ".concat(g," error"),"fragment",e),e}var Ei=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"format",value:function(e){if(e||(e=Vi.sighash),Vi[e]||Gi.throwArgumentError("invalid format type","format",e),e===Vi.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map((function(g){return JSON.parse(g.format(e))}))});var g="";return e!==Vi.sighash&&(g+="error "),(g+=this.name+"("+this.inputs.map((function(g){return g.format(e)})).join(e===Vi.full?", ":",")+") ").trim()}}],[{key:"from",value:function(e){return"string"===typeof e?t.fromString(e):t.fromObject(e)}},{key:"fromObject",value:function(e){if(t.isErrorFragment(e))return e;"error"!==e.type&&Gi.throwArgumentError("invalid error object","value",e);var g={type:e.type,name:Ui(e.name),inputs:e.inputs?e.inputs.map(Ri.fromObject):[]};return xi(new t(fi,g))}},{key:"fromString",value:function(e){var g={type:"error"},n=e.match(Qi);return n||Gi.throwArgumentError("invalid error signature","value",e),g.name=n[1].trim(),g.name&&Ui(g.name),g.inputs=Xi(n[2],!1),xi(t.fromObject(g))}},{key:"isErrorFragment",value:function(e){return e&&e._isFragment&&"error"===e.type}}]),t}(Ji);function Mi(e){return e.match(/^uint($|[^1-9])/)?e="uint256"+e.substring(4):e.match(/^int($|[^1-9])/)&&(e="int256"+e.substring(3)),e}var zi=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function Ui(e){return e&&e.match(zi)||Gi.throwArgumentError('invalid identifier "'.concat(e,'"'),"value",e),e}var Qi=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$");var Li=new Gr(ni),Ti=new RegExp(/^bytes([0-9]*)$/),Di=new RegExp(/^(u?int)([0-9]*)$/),ji=function(){function e(g){it(this,e),vr(this,"coerceFunc",g||null)}return ut(e,[{key:"_getCoder",value:function(e){var g=this;switch(e.baseType){case"address":return new ai(e.name);case"bool":return new Ai(e.name);case"string":return new pi(e.name);case"bytes":return new mi(e.name);case"array":return new si(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new yi((e.components||[]).map((function(e){return g._getCoder(e)})),e.name);case"":return new bi(e.name)}var t=e.type.match(Di);if(t){var n=parseInt(t[2]||"256");return(0===n||n>256||n%8!==0)&&Li.throwArgumentError("invalid "+t[1]+" bit length","param",e),new Zi(n/8,"int"===t[1],e.name)}if(t=e.type.match(Ti)){var I=parseInt(t[1]);return(0===I||I>32)&&Li.throwArgumentError("invalid bytes length","param",e),new hi(I,e.name)}return Li.throwArgumentError("invalid type","type",e.type)}},{key:"_getWordSize",value:function(){return 32}},{key:"_getReader",value:function(e,g){return new li(e,this._getWordSize(),this.coerceFunc,g)}},{key:"_getWriter",value:function(){return new Ci(this._getWordSize())}},{key:"getDefaultValue",value:function(e){var g=this,t=e.map((function(e){return g._getCoder(Ri.from(e))}));return new yi(t,"_").defaultValue()}},{key:"encode",value:function(e,g){var t=this;e.length!==g.length&&Li.throwError("types/values length mismatch",Gr.errors.INVALID_ARGUMENT,{count:{types:e.length,values:g.length},value:{types:e,values:g}});var n=e.map((function(e){return t._getCoder(Ri.from(e))})),I=new yi(n,"_"),r=this._getWriter();return I.encode(r,g),r.data}},{key:"decode",value:function(e,g,t){var n=this,I=e.map((function(e){return n._getCoder(Ri.from(e))}));return new yi(I,"_").decode(this._getReader(Pr(g),t))}}]),e}(),Pi=new ji,Oi=new Gr(ni),_i=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t)}(Yr),qi=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t)}(Yr),$i=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t)}(Yr),ec=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,null,[{key:"isIndexed",value:function(e){return!(!e||!e._isIndexed)}}]),t}(Yr),gc={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function tc(e,g){var t=new Error("deferred error during ABI decoding triggered accessing ".concat(e));return t.error=g,t}var nc=function(){function e(g){var t=this;it(this,e);vr(this,"fragments",("string"===typeof g?JSON.parse(g):g).map((function(e){return Ji.from(e)})).filter((function(e){return null!=e}))),vr(this,"_abiCoder",Sr(this instanceof e?this.constructor:void 0,"getAbiCoder")()),vr(this,"functions",{}),vr(this,"errors",{}),vr(this,"events",{}),vr(this,"structs",{}),this.fragments.forEach((function(e){var g=null;switch(e.type){case"constructor":return t.deploy?void Oi.warn("duplicate definition - constructor"):void vr(t,"deploy",e);case"function":g=t.functions;break;case"event":g=t.events;break;case"error":g=t.errors;break;default:return}var n=e.format();g[n]?Oi.warn("duplicate definition - "+n):g[n]=e})),this.deploy||vr(this,"deploy",Fi.from({payable:!1,type:"constructor"})),vr(this,"_isInterface",!0)}return ut(e,[{key:"format",value:function(e){e||(e=Vi.full),e===Vi.sighash&&Oi.throwArgumentError("interface does not support formatting sighash","format",e);var g=this.fragments.map((function(g){return g.format(e)}));return e===Vi.json?JSON.stringify(g.map((function(e){return JSON.parse(e)}))):g}},{key:"getFunction",value:function(e){if(qr(e)){for(var g in this.functions)if(e===this.getSighash(g))return this.functions[g];Oi.throwArgumentError("no matching function","sighash",e)}if(-1===e.indexOf("(")){var t=e.trim(),n=Object.keys(this.functions).filter((function(e){return e.split("(")[0]===t}));return 0===n.length?Oi.throwArgumentError("no matching function","name",t):n.length>1&&Oi.throwArgumentError("multiple matching functions","name",t),this.functions[n[0]]}var I=this.functions[Ki.fromString(e).format()];return I||Oi.throwArgumentError("no matching function","signature",e),I}},{key:"getEvent",value:function(e){if(qr(e)){var g=e.toLowerCase();for(var t in this.events)if(g===this.getEventTopic(t))return this.events[t];Oi.throwArgumentError("no matching event","topichash",g)}if(-1===e.indexOf("(")){var n=e.trim(),I=Object.keys(this.events).filter((function(e){return e.split("(")[0]===n}));return 0===I.length?Oi.throwArgumentError("no matching event","name",n):I.length>1&&Oi.throwArgumentError("multiple matching events","name",n),this.events[I[0]]}var r=this.events[Yi.fromString(e).format()];return r||Oi.throwArgumentError("no matching event","signature",e),r}},{key:"getError",value:function(e){if(qr(e)){var g=Sr(this.constructor,"getSighash");for(var t in this.errors){if(e===g(this.errors[t]))return this.errors[t]}Oi.throwArgumentError("no matching error","sighash",e)}if(-1===e.indexOf("(")){var n=e.trim(),I=Object.keys(this.errors).filter((function(e){return e.split("(")[0]===n}));return 0===I.length?Oi.throwArgumentError("no matching error","name",n):I.length>1&&Oi.throwArgumentError("multiple matching errors","name",n),this.errors[I[0]]}var r=this.errors[Ki.fromString(e).format()];return r||Oi.throwArgumentError("no matching error","signature",e),r}},{key:"getSighash",value:function(e){if("string"===typeof e)try{e=this.getFunction(e)}catch(g){try{e=this.getError(e)}catch(H){throw g}}return Sr(this.constructor,"getSighash")(e)}},{key:"getEventTopic",value:function(e){return"string"===typeof e&&(e=this.getEvent(e)),Sr(this.constructor,"getEventTopic")(e)}},{key:"_decodeParams",value:function(e,g){return this._abiCoder.decode(e,g)}},{key:"_encodeParams",value:function(e,g){return this._abiCoder.encode(e,g)}},{key:"encodeDeploy",value:function(e){return this._encodeParams(this.deploy.inputs,e||[])}},{key:"decodeErrorResult",value:function(e,g){"string"===typeof e&&(e=this.getError(e));var t=Pr(g);return eC(t.slice(0,4))!==this.getSighash(e)&&Oi.throwArgumentError("data signature does not match error ".concat(e.name,"."),"data",eC(t)),this._decodeParams(e.inputs,t.slice(4))}},{key:"encodeErrorResult",value:function(e,g){return"string"===typeof e&&(e=this.getError(e)),eC(Or([this.getSighash(e),this._encodeParams(e.inputs,g||[])]))}},{key:"decodeFunctionData",value:function(e,g){"string"===typeof e&&(e=this.getFunction(e));var t=Pr(g);return eC(t.slice(0,4))!==this.getSighash(e)&&Oi.throwArgumentError("data signature does not match function ".concat(e.name,"."),"data",eC(t)),this._decodeParams(e.inputs,t.slice(4))}},{key:"encodeFunctionData",value:function(e,g){return"string"===typeof e&&(e=this.getFunction(e)),eC(Or([this.getSighash(e),this._encodeParams(e.inputs,g||[])]))}},{key:"decodeFunctionResult",value:function(e,g){"string"===typeof e&&(e=this.getFunction(e));var t=Pr(g),n=null,I="",r=null,C=null,l=null;switch(t.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(e.outputs,t)}catch(i){}break;case 4:var a=eC(t.slice(0,4)),o=gc[a];if(o)r=this._abiCoder.decode(o.inputs,t.slice(4)),C=o.name,l=o.signature,o.reason&&(n=r[0]),"Error"===C?I="; VM Exception while processing transaction: reverted with reason string ".concat(JSON.stringify(r[0])):"Panic"===C&&(I="; VM Exception while processing transaction: reverted with panic code ".concat(r[0]));else try{var i=this.getError(a);r=this._abiCoder.decode(i.inputs,t.slice(4)),C=i.name,l=i.format()}catch(i){}}return Oi.throwError("call revert exception"+I,Gr.errors.CALL_EXCEPTION,{method:e.format(),data:eC(g),errorArgs:r,errorName:C,errorSignature:l,reason:n})}},{key:"encodeFunctionResult",value:function(e,g){return"string"===typeof e&&(e=this.getFunction(e)),eC(this._abiCoder.encode(e.outputs,g||[]))}},{key:"encodeFilterTopics",value:function(e,g){var t=this;"string"===typeof e&&(e=this.getEvent(e)),g.length>e.inputs.length&&Oi.throwError("too many arguments for "+e.format(),Gr.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:g});var n=[];e.anonymous||n.push(this.getEventTopic(e));var I=function(e,g){return"string"===e.type?TC(g):"bytes"===e.type?ZC(eC(g)):("bool"===e.type&&"boolean"===typeof g&&(g=g?"0x01":"0x00"),e.type.match(/^u?int/)&&(g=uC.from(g).toHexString()),"address"===e.type&&t._abiCoder.encode(["address"],[g]),rC(eC(g),32))};for(g.forEach((function(g,t){var r=e.inputs[t];r.indexed?null==g?n.push(null):"array"===r.baseType||"tuple"===r.baseType?Oi.throwArgumentError("filtering with tuples or arrays not supported","contract."+r.name,g):Array.isArray(g)?n.push(g.map((function(e){return I(r,e)}))):n.push(I(r,g)):null!=g&&Oi.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+r.name,g)}));n.length&&null===n[n.length-1];)n.pop();return n}},{key:"encodeEventLog",value:function(e,g){var t=this;"string"===typeof e&&(e=this.getEvent(e));var n=[],I=[],r=[];return e.anonymous||n.push(this.getEventTopic(e)),g.length!==e.inputs.length&&Oi.throwArgumentError("event arguments/values mismatch","values",g),e.inputs.forEach((function(e,C){var l=g[C];if(e.indexed)if("string"===e.type)n.push(TC(l));else if("bytes"===e.type)n.push(ZC(l));else{if("tuple"===e.baseType||"array"===e.baseType)throw new Error("not implemented");n.push(t._abiCoder.encode([e.type],[l]))}else I.push(e),r.push(l)})),{data:this._abiCoder.encode(I,r),topics:n}}},{key:"decodeEventLog",value:function(e,g,t){if("string"===typeof e&&(e=this.getEvent(e)),null!=t&&!e.anonymous){var n=this.getEventTopic(e);qr(t[0],32)&&t[0].toLowerCase()===n||Oi.throwError("fragment/topic mismatch",Gr.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:n,value:t[0]}),t=t.slice(1)}var I=[],r=[],C=[];e.inputs.forEach((function(e,g){e.indexed?"string"===e.type||"bytes"===e.type||"tuple"===e.baseType||"array"===e.baseType?(I.push(Ri.fromObject({type:"bytes32",name:e.name})),C.push(!0)):(I.push(e),C.push(!1)):(r.push(e),C.push(!1))}));var l=null!=t?this._abiCoder.decode(I,Or(t)):null,a=this._abiCoder.decode(r,g,!0),o=[],i=0,c=0;e.inputs.forEach((function(e,g){if(e.indexed)if(null==l)o[g]=new ec({_isIndexed:!0,hash:null});else if(C[g])o[g]=new ec({_isIndexed:!0,hash:l[c++]});else try{o[g]=l[c++]}catch(n){o[g]=n}else try{o[g]=a[i++]}catch(n){o[g]=n}if(e.name&&null==o[e.name]){var t=o[g];t instanceof Error?Object.defineProperty(o,e.name,{enumerable:!0,get:function(){throw tc("property ".concat(JSON.stringify(e.name)),t)}}):o[e.name]=t}}));for(var u=function(e){var g=o[e];g instanceof Error&&Object.defineProperty(o,e,{enumerable:!0,get:function(){throw tc("index ".concat(e),g)}})},s=0;s<o.length;s++)u(s);return Object.freeze(o)}},{key:"parseTransaction",value:function(e){var g=this.getFunction(e.data.substring(0,10).toLowerCase());return g?new qi({args:this._abiCoder.decode(g.inputs,"0x"+e.data.substring(10)),functionFragment:g,name:g.name,signature:g.format(),sighash:this.getSighash(g),value:uC.from(e.value||"0")}):null}},{key:"parseLog",value:function(e){var g=this.getEvent(e.topics[0]);return!g||g.anonymous?null:new _i({eventFragment:g,name:g.name,signature:g.format(),topic:this.getEventTopic(g),args:this.decodeEventLog(g,e.data,e.topics)})}},{key:"parseError",value:function(e){var g=eC(e),t=this.getError(g.substring(0,10).toLowerCase());return t?new $i({args:this._abiCoder.decode(t.inputs,"0x"+g.substring(10)),errorFragment:t,name:t.name,signature:t.format(),sighash:this.getSighash(t)}):null}}],[{key:"getAbiCoder",value:function(){return Pi}},{key:"getAddress",value:function(e){return HC(e)}},{key:"getSighash",value:function(e){return tC(TC(e.format()),0,4)}},{key:"getEventTopic",value:function(e){return TC(e.format())}},{key:"isInterface",value:function(e){return!(!e||!e._isInterface)}}]),e}(),Ic=function(e,g,t,n){return new(t||(t=Promise))((function(I,r){function C(e){try{a(n.next(e))}catch(Hb){r(Hb)}}function l(e){try{a(n.throw(e))}catch(Hb){r(Hb)}}function a(e){var g;e.done?I(e.value):(g=e.value,g instanceof t?g:new t((function(e){e(g)}))).then(C,l)}a((n=n.apply(e,g||[])).next())}))},rc=new Gr("contracts/5.7.0");function Cc(e,g){return Ic(this,void 0,void 0,Ir().mark((function t(){var n,I;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g;case 2:return"string"!==typeof(n=t.sent)&&rc.throwArgumentError("invalid address or ENS name","name",n),t.prev=4,t.abrupt("return",HC(n));case 8:t.prev=8,t.t0=t.catch(4);case 10:return e||rc.throwError("a provider or signer is needed to resolve ENS names",Gr.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"}),t.next=13,e.resolveName(n);case 13:return null==(I=t.sent)&&rc.throwArgumentError("resolver or addr is not configured for ENS name","name",n),t.abrupt("return",I);case 16:case"end":return t.stop()}}),t,null,[[4,8]])})))}function lc(e,g,t){return Ic(this,void 0,void 0,Ir().mark((function n(){return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!Array.isArray(t)){n.next=4;break}return n.next=3,Promise.all(t.map((function(t,n){return lc(e,Array.isArray(g)?g[n]:g[t.name],t)})));case 3:case 7:case 11:case 17:return n.abrupt("return",n.sent);case 4:if("address"!==t.type){n.next=8;break}return n.next=7,Cc(e,g);case 8:if("tuple"!==t.type){n.next=12;break}return n.next=11,lc(e,g,t.components);case 12:if("array"!==t.baseType){n.next=18;break}if(Array.isArray(g)){n.next=15;break}return n.abrupt("return",Promise.reject(rc.makeError("invalid value for array",Gr.errors.INVALID_ARGUMENT,{argument:"value",value:g})));case 15:return n.next=17,Promise.all(g.map((function(g){return lc(e,g,t.arrayChildren)})));case 18:return n.abrupt("return",g);case 19:case"end":return n.stop()}}),n)})))}function ac(e,g,t){return Ic(this,void 0,void 0,Ir().mark((function n(){var I,r,C,l,a,o,i,c,u,s,A=this;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return I={},t.length===g.inputs.length+1&&"object"===typeof t[t.length-1]&&(I=Vr(t.pop())),rc.checkArgumentCount(t.length,g.inputs.length,"passed to contract"),e.signer?I.from?I.from=Wr({override:Cc(e.signer,I.from),signer:e.signer.getAddress()}).then((function(e){return Ic(A,void 0,void 0,Ir().mark((function g(){return Ir().wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return HC(e.signer)!==e.override&&rc.throwError("Contract with a Signer cannot override from",Gr.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),g.abrupt("return",e.override);case 2:case"end":return g.stop()}}),g)})))})):I.from=e.signer.getAddress():I.from&&(I.from=Cc(e.provider,I.from)),n.next=6,Wr({args:lc(e.signer||e.provider,t,g.inputs),address:e.resolvedAddress,overrides:Wr(I)||{}});case 6:if(r=n.sent,C=e.interface.encodeFunctionData(g,r.args),l={data:C,to:r.address},null!=(a=r.overrides).nonce&&(l.nonce=uC.from(a.nonce).toNumber()),null!=a.gasLimit&&(l.gasLimit=uC.from(a.gasLimit)),null!=a.gasPrice&&(l.gasPrice=uC.from(a.gasPrice)),null!=a.maxFeePerGas&&(l.maxFeePerGas=uC.from(a.maxFeePerGas)),null!=a.maxPriorityFeePerGas&&(l.maxPriorityFeePerGas=uC.from(a.maxPriorityFeePerGas)),null!=a.from&&(l.from=a.from),null!=a.type&&(l.type=a.type),null!=a.accessList&&(l.accessList=oa(a.accessList)),null==l.gasLimit&&null!=g.gas){for(o=21e3,i=Pr(C),c=0;c<i.length;c++)o+=4,i[c]&&(o+=64);l.gasLimit=uC.from(g.gas).add(o)}return a.value&&((u=uC.from(a.value)).isZero()||g.payable||rc.throwError("non-payable method cannot override value",Gr.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:I.value}),l.value=u),a.customData&&(l.customData=Vr(a.customData)),a.ccipReadEnabled&&(l.ccipReadEnabled=!!a.ccipReadEnabled),delete I.nonce,delete I.gasLimit,delete I.gasPrice,delete I.from,delete I.value,delete I.type,delete I.accessList,delete I.maxFeePerGas,delete I.maxPriorityFeePerGas,delete I.customData,delete I.ccipReadEnabled,s=Object.keys(I).filter((function(e){return null!=I[e]})),s.length&&rc.throwError("cannot override ".concat(s.map((function(e){return JSON.stringify(e)})).join(",")),Gr.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:s}),n.abrupt("return",l);case 36:case"end":return n.stop()}}),n)})))}function oc(e,g){var t=g.wait.bind(g);g.wait=function(g){return t(g).then((function(g){return g.events=g.logs.map((function(t){var n=Jr(t),I=null;try{I=e.interface.parseLog(t)}catch(Hb){}return I&&(n.args=I.args,n.decode=function(g,t){return e.interface.decodeEventLog(I.eventFragment,g,t)},n.event=I.name,n.eventSignature=I.signature),n.removeListener=function(){return e.provider},n.getBlock=function(){return e.provider.getBlock(g.blockHash)},n.getTransaction=function(){return e.provider.getTransaction(g.transactionHash)},n.getTransactionReceipt=function(){return Promise.resolve(g)},n})),g}))}}function ic(e,g,t){var n=e.signer||e.provider;return function(){for(var I=arguments.length,r=new Array(I),C=0;C<I;C++)r[C]=arguments[C];return Ic(this,void 0,void 0,Ir().mark((function I(){var C,l,a,o,i;return Ir().wrap((function(I){for(;;)switch(I.prev=I.next){case 0:if(C=void 0,r.length!==g.inputs.length+1||"object"!==typeof r[r.length-1]){I.next=9;break}if(null==(l=Vr(r.pop())).blockTag){I.next=7;break}return I.next=6,l.blockTag;case 6:C=I.sent;case 7:delete l.blockTag,r.push(l);case 9:if(null==e.deployTransaction){I.next=12;break}return I.next=12,e._deployed(C);case 12:return I.next=14,ac(e,g,r);case 14:return a=I.sent,I.next=17,n.call(a,C);case 17:return o=I.sent,I.prev=18,i=e.interface.decodeFunctionResult(g,o),t&&1===g.outputs.length&&(i=i[0]),I.abrupt("return",i);case 24:throw I.prev=24,I.t0=I.catch(18),I.t0.code===Gr.errors.CALL_EXCEPTION&&(I.t0.address=e.address,I.t0.args=r,I.t0.transaction=a),I.t0;case 28:case"end":return I.stop()}}),I,null,[[18,24]])})))}}function cc(e,g,t){return g.constant?ic(e,g,t):function(e,g){return function(){for(var t=arguments.length,n=new Array(t),I=0;I<t;I++)n[I]=arguments[I];return Ic(this,void 0,void 0,Ir().mark((function t(){var I,r;return Ir().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.signer||rc.throwError("sending a transaction requires a signer",Gr.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),null==e.deployTransaction){t.next=4;break}return t.next=4,e._deployed();case 4:return t.next=6,ac(e,g,n);case 6:return I=t.sent,t.next=9,e.signer.sendTransaction(I);case 9:return r=t.sent,oc(e,r),t.abrupt("return",r);case 12:case"end":return t.stop()}}),t)})))}}(e,g)}function uc(e){return!e.address||null!=e.topics&&0!==e.topics.length?(e.address||"*")+"@"+(e.topics?e.topics.map((function(e){return Array.isArray(e)?e.join("|"):e})).join(":"):""):"*"}var sc=function(){function e(g,t){it(this,e),vr(this,"tag",g),vr(this,"filter",t),this._listeners=[]}return ut(e,[{key:"addListener",value:function(e,g){this._listeners.push({listener:e,once:g})}},{key:"removeListener",value:function(e){var g=!1;this._listeners=this._listeners.filter((function(t){return!(!g&&t.listener===e)||(g=!0,!1)}))}},{key:"removeAllListeners",value:function(){this._listeners=[]}},{key:"listeners",value:function(){return this._listeners.map((function(e){return e.listener}))}},{key:"listenerCount",value:function(){return this._listeners.length}},{key:"run",value:function(e){var g=this,t=this.listenerCount();return this._listeners=this._listeners.filter((function(t){var n=e.slice();return setTimeout((function(){t.listener.apply(g,n)}),0),!t.once})),t}},{key:"prepareEvent",value:function(e){}},{key:"getEmit",value:function(e){return[e]}}]),e}(),Ac=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.call(this,"error",null)}return ut(t)}(sc),dc=function(e){gn(t,e);var g=In(t);function t(e,n,I,r){var C;it(this,t);var l={address:e},a=n.getEventTopic(I);return r?(a!==r[0]&&rc.throwArgumentError("topic mismatch","topics",r),l.topics=r.slice()):l.topics=[a],vr(nn(C=g.call(this,uc(l),l)),"address",e),vr(nn(C),"interface",n),vr(nn(C),"fragment",I),C}return ut(t,[{key:"prepareEvent",value:function(e){var g=this;en($t(t.prototype),"prepareEvent",this).call(this,e),e.event=this.fragment.name,e.eventSignature=this.fragment.format(),e.decode=function(e,t){return g.interface.decodeEventLog(g.fragment,e,t)};try{e.args=this.interface.decodeEventLog(this.fragment,e.data,e.topics)}catch(n){e.args=null,e.decodeError=n}}},{key:"getEmit",value:function(e){var g=function(e){var g=[];return function e(t,n){if(Array.isArray(n))for(var I in n){var r=t.slice();r.push(I);try{e(r,n[I])}catch(C){g.push({path:r,error:C})}}}([],e),g}(e.args);if(g.length)throw g[0].error;var t=(e.args||[]).slice();return t.push(e),t}}]),t}(sc),mc=function(e){gn(t,e);var g=In(t);function t(e,n){var I;return it(this,t),vr(nn(I=g.call(this,"*",{address:e})),"address",e),vr(nn(I),"interface",n),I}return ut(t,[{key:"prepareEvent",value:function(e){var g=this;en($t(t.prototype),"prepareEvent",this).call(this,e);try{var n=this.interface.parseLog(e);e.event=n.name,e.eventSignature=n.signature,e.decode=function(e,t){return g.interface.decodeEventLog(n.eventFragment,e,t)},e.args=n.args}catch(I){}}}]),t}(sc),hc=function(){function e(g,t,n){var I=this;it(this,e),vr(this,"interface",Sr(this instanceof e?this.constructor:void 0,"getInterface")(t)),null==n?(vr(this,"provider",null),vr(this,"signer",null)):xr.isSigner(n)?(vr(this,"provider",n.provider||null),vr(this,"signer",n)):Va.isProvider(n)?(vr(this,"provider",n),vr(this,"signer",null)):rc.throwArgumentError("invalid signer or provider","signerOrProvider",n),vr(this,"callStatic",{}),vr(this,"estimateGas",{}),vr(this,"functions",{}),vr(this,"populateTransaction",{}),vr(this,"filters",{});var r={};if(Object.keys(this.interface.events).forEach((function(e){var g=I.interface.events[e];vr(I.filters,e,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{address:I.address,topics:I.interface.encodeFilterTopics(g,t)}})),r[g.name]||(r[g.name]=[]),r[g.name].push(e)})),Object.keys(r).forEach((function(e){var g=r[e];1===g.length?vr(I.filters,e,I.filters[g[0]]):rc.warn("Duplicate definition of ".concat(e," (").concat(g.join(", "),")"))})),vr(this,"_runningEvents",{}),vr(this,"_wrappedEmits",{}),null==g&&rc.throwArgumentError("invalid contract address or ENS name","addressOrName",g),vr(this,"address",g),this.provider)vr(this,"resolvedAddress",Cc(this.provider,g));else try{vr(this,"resolvedAddress",Promise.resolve(HC(g)))}catch(a){rc.throwError("provider is required to use ENS name as contract address",Gr.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch((function(e){}));var C={},l={};Object.keys(this.interface.functions).forEach((function(e){var g=I.interface.functions[e];if(l[e])rc.warn("Duplicate ABI entry for ".concat(JSON.stringify(e)));else{l[e]=!0;var t=g.name;C["%".concat(t)]||(C["%".concat(t)]=[]),C["%".concat(t)].push(e),null==I[e]&&vr(I,e,cc(I,g,!0)),null==I.functions[e]&&vr(I.functions,e,cc(I,g,!1)),null==I.callStatic[e]&&vr(I.callStatic,e,ic(I,g,!0)),null==I.populateTransaction[e]&&vr(I.populateTransaction,e,function(e,g){return function(){for(var t=arguments.length,n=new Array(t),I=0;I<t;I++)n[I]=arguments[I];return ac(e,g,n)}}(I,g)),null==I.estimateGas[e]&&vr(I.estimateGas,e,function(e,g){var t=e.signer||e.provider;return function(){for(var n=arguments.length,I=new Array(n),r=0;r<n;r++)I[r]=arguments[r];return Ic(this,void 0,void 0,Ir().mark((function n(){var r;return Ir().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t||rc.throwError("estimate require a provider or signer",Gr.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"}),n.next=3,ac(e,g,I);case 3:return r=n.sent,n.next=6,t.estimateGas(r);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n)})))}}(I,g))}})),Object.keys(C).forEach((function(e){var g=C[e];if(!(g.length>1)){e=e.substring(1);var t=g[0];try{null==I[e]&&vr(I,e,I[t])}catch(Hb){}null==I.functions[e]&&vr(I.functions,e,I.functions[t]),null==I.callStatic[e]&&vr(I.callStatic,e,I.callStatic[t]),null==I.populateTransaction[e]&&vr(I.populateTransaction,e,I.populateTransaction[t]),null==I.estimateGas[e]&&vr(I.estimateGas,e,I.estimateGas[t])}}))}return ut(e,[{key:"deployed",value:function(){return this._deployed()}},{key:"_deployed",value:function(e){var g=this;return this._deployedPromise||(this.deployTransaction?this._deployedPromise=this.deployTransaction.wait().then((function(){return g})):this._deployedPromise=this.provider.getCode(this.address,e).then((function(e){return"0x"===e&&rc.throwError("contract not deployed",Gr.errors.UNSUPPORTED_OPERATION,{contractAddress:g.address,operation:"getDeployed"}),g}))),this._deployedPromise}},{key:"fallback",value:function(e){var g=this;this.signer||rc.throwError("sending a transactions require a signer",Gr.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});var t=Vr(e||{});return["from","to"].forEach((function(e){null!=t[e]&&rc.throwError("cannot override "+e,Gr.errors.UNSUPPORTED_OPERATION,{operation:e})})),t.to=this.resolvedAddress,this.deployed().then((function(){return g.signer.sendTransaction(t)}))}},{key:"connect",value:function(e){"string"===typeof e&&(e=new Er(e,this.provider));var g=new this.constructor(this.address,this.interface,e);return this.deployTransaction&&vr(g,"deployTransaction",this.deployTransaction),g}},{key:"attach",value:function(e){return new this.constructor(e,this.interface,this.signer||this.provider)}},{key:"_normalizeRunningEvent",value:function(e){return this._runningEvents[e.tag]?this._runningEvents[e.tag]:e}},{key:"_getRunningEvent",value:function(e){if("string"===typeof e){if("error"===e)return this._normalizeRunningEvent(new Ac);if("event"===e)return this._normalizeRunningEvent(new sc("event",null));if("*"===e)return this._normalizeRunningEvent(new mc(this.address,this.interface));var g=this.interface.getEvent(e);return this._normalizeRunningEvent(new dc(this.address,this.interface,g))}if(e.topics&&e.topics.length>0){try{var t=e.topics[0];if("string"!==typeof t)throw new Error("invalid topic");var n=this.interface.getEvent(t);return this._normalizeRunningEvent(new dc(this.address,this.interface,n,e.topics))}catch(r){}var I={address:this.address,topics:e.topics};return this._normalizeRunningEvent(new sc(uc(I),I))}return this._normalizeRunningEvent(new mc(this.address,this.interface))}},{key:"_checkRunningEvents",value:function(e){if(0===e.listenerCount()){delete this._runningEvents[e.tag];var g=this._wrappedEmits[e.tag];g&&e.filter&&(this.provider.off(e.filter,g),delete this._wrappedEmits[e.tag])}}},{key:"_wrapEvent",value:function(e,g,t){var n=this,I=Jr(g);return I.removeListener=function(){t&&(e.removeListener(t),n._checkRunningEvents(e))},I.getBlock=function(){return n.provider.getBlock(g.blockHash)},I.getTransaction=function(){return n.provider.getTransaction(g.transactionHash)},I.getTransactionReceipt=function(){return n.provider.getTransactionReceipt(g.transactionHash)},e.prepareEvent(I),I}},{key:"_addEventListener",value:function(e,g,t){var n=this;if(this.provider||rc.throwError("events require a provider or a signer with a provider",Gr.errors.UNSUPPORTED_OPERATION,{operation:"once"}),e.addListener(g,t),this._runningEvents[e.tag]=e,!this._wrappedEmits[e.tag]){var I=function(t){var I=n._wrapEvent(e,t,g);if(null==I.decodeError)try{var r=e.getEmit(I);n.emit.apply(n,[e.filter].concat(h(r)))}catch(C){I.decodeError=C.error}null!=e.filter&&n.emit("event",I),null!=I.decodeError&&n.emit("error",I.decodeError,I)};this._wrappedEmits[e.tag]=I,null!=e.filter&&this.provider.on(e.filter,I)}}},{key:"queryFilter",value:function(e,g,t){var n=this,I=this._getRunningEvent(e),r=Vr(I.filter);return"string"===typeof g&&qr(g,32)?(null!=t&&rc.throwArgumentError("cannot specify toBlock with blockhash","toBlock",t),r.blockHash=g):(r.fromBlock=null!=g?g:0,r.toBlock=null!=t?t:"latest"),this.provider.getLogs(r).then((function(e){return e.map((function(e){return n._wrapEvent(I,e,null)}))}))}},{key:"on",value:function(e,g){return this._addEventListener(this._getRunningEvent(e),g,!1),this}},{key:"once",value:function(e,g){return this._addEventListener(this._getRunningEvent(e),g,!0),this}},{key:"emit",value:function(e){if(!this.provider)return!1;for(var g=this._getRunningEvent(e),t=arguments.length,n=new Array(t>1?t-1:0),I=1;I<t;I++)n[I-1]=arguments[I];var r=g.run(n)>0;return this._checkRunningEvents(g),r}},{key:"listenerCount",value:function(e){var g=this;return this.provider?null==e?Object.keys(this._runningEvents).reduce((function(e,t){return e+g._runningEvents[t].listenerCount()}),0):this._getRunningEvent(e).listenerCount():0}},{key:"listeners",value:function(e){if(!this.provider)return[];if(null==e){var g=[];for(var t in this._runningEvents)this._runningEvents[t].listeners().forEach((function(e){g.push(e)}));return g}return this._getRunningEvent(e).listeners()}},{key:"removeAllListeners",value:function(e){if(!this.provider)return this;if(null==e){for(var g in this._runningEvents){var t=this._runningEvents[g];t.removeAllListeners(),this._checkRunningEvents(t)}return this}var n=this._getRunningEvent(e);return n.removeAllListeners(),this._checkRunningEvents(n),this}},{key:"off",value:function(e,g){if(!this.provider)return this;var t=this._getRunningEvent(e);return t.removeListener(g),this._checkRunningEvents(t),this}},{key:"removeListener",value:function(e,g){return this.off(e,g)}}],[{key:"getContractAddress",value:function(e){return NC(e)}},{key:"getInterface",value:function(e){return nc.isInterface(e)?e:new nc(e)}},{key:"isIndexed",value:function(e){return ec.isIndexed(e)}}]),e}(),bc=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t)}(hc),Zc=JSON.parse('[{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"addOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"p_name","type":"string"},{"internalType":"string","name":"p_type","type":"string"},{"internalType":"string","name":"p_code","type":"string"},{"internalType":"uint256","name":"p_production_date","type":"uint256"},{"internalType":"uint256","name":"p_exp_date","type":"uint256"}],"name":"AddProduct","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"s_name","type":"string"},{"internalType":"string","name":"s_country","type":"string"},{"internalType":"string","name":"s_address","type":"string"},{"internalType":"uint256","name":"s_date","type":"uint256"},{"internalType":"uint256","name":"r_date","type":"uint256"}],"name":"AddShipment","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"s_id","type":"uint256"},{"internalType":"string","name":"p_code","type":"string"}],"name":"ProductForShipment","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"findOwner","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getProducts","outputs":[{"components":[{"internalType":"uint256","name":"product_id","type":"uint256"},{"internalType":"string","name":"product_name","type":"string"},{"internalType":"string","name":"product_type","type":"string"},{"internalType":"string","name":"product_code","type":"string"},{"internalType":"uint256","name":"product_production_date","type":"uint256"},{"internalType":"uint256","name":"product_exp_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Product[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"p_code","type":"string"}],"name":"getProductShipmentHistory","outputs":[{"components":[{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"pre_ship_id","type":"tuple"},{"internalType":"uint256","name":"product_id","type":"uint256"},{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"next_ship_id","type":"tuple"}],"internalType":"struct counterfeitProduct.TraceProduct[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getShipments","outputs":[{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTraceProducts","outputs":[{"components":[{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"pre_ship_id","type":"tuple"},{"internalType":"uint256","name":"product_id","type":"uint256"},{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"next_ship_id","type":"tuple"}],"internalType":"struct counterfeitProduct.TraceProduct[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"product","outputs":[{"internalType":"uint256","name":"product_id","type":"uint256"},{"internalType":"string","name":"product_name","type":"string"},{"internalType":"string","name":"product_type","type":"string"},{"internalType":"string","name":"product_code","type":"string"},{"internalType":"uint256","name":"product_production_date","type":"uint256"},{"internalType":"uint256","name":"product_exp_date","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"shipment","outputs":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"traceProduct","outputs":[{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"pre_ship_id","type":"tuple"},{"internalType":"uint256","name":"product_id","type":"uint256"},{"components":[{"internalType":"string","name":"shipment_name","type":"string"},{"internalType":"string","name":"shipment_country","type":"string"},{"internalType":"string","name":"shipment_address","type":"string"},{"internalType":"uint256","name":"sending_date","type":"uint256"},{"internalType":"uint256","name":"receiving_date","type":"uint256"}],"internalType":"struct counterfeitProduct.Shipment","name":"next_ship_id","type":"tuple"}],"stateMutability":"view","type":"function"}]'),pc=t(2426),yc=t.n(pc),Gc=function(e){if(!e)return"No Account";var g=e.match(/^(0x[a-zA-Z0-9]{2})[a-zA-Z0-9]+([a-zA-Z0-9]{2})$/);return g?"".concat(g[1],"\u2026").concat(g[2]):e},fc=Zc,Bc=(0,e.createContext)({}),vc=window.ethereum,Sc=function(g){var t=g.children,n=c((0,e.useState)(""),2),I=n[0],r=n[1];vc&&(vc.on("accountsChanged",(function(e){r(e[0])})),vc.on("chainChanged",(function(){window.location.reload()})));var C=function(){var e=new ti(vc).getSigner();return new bc("0xD7D411254Ace1a64DD94b7a4B0d1b0168EBA36DC",fc,e)},l=function(){var e=Cr(Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,vc){e.next=3;break}return e.abrupt("return",_.error("Please Install MetaMask"));case 3:return e.next=5,vc.request({method:"eth_accounts"});case 5:g=e.sent,o()||(g.length?r(g[0]):console.log("No Account Found!")),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),_.error("no ethereum object.");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Cr(Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,vc){e.next=3;break}return e.abrupt("return",_.error("Please Install MetaMask"));case 3:if(!o()){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,vc.request({method:"eth_requestAccounts"});case 7:g=e.sent,r(g[0]),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),_.error("no ethereum object.");case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),o=function(){return"5"!=vc.networkVersion&&(_.error("Unsupported Chain Id Error!"),!0)},i=function(){var e=Cr(Ir().mark((function e(){var g,t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g=C(),e.next=4,g.getProducts();case 4:return t=e.sent,e.abrupt("return",t);case 8:e.prev=8,e.t0=e.catch(0),_.error("no ethereum object.");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=Cr(Ir().mark((function e(g){var t,n,I,r,l,a,o;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.product_name,n=g.product_type,I=g.product_code,r=g.product_production_date,l=g.product_exp_date,e.prev=1,a=C(),e.next=5,a.AddProduct(t,n,I,r,l);case 5:return o=e.sent,e.next=8,o.wait();case 8:return e.abrupt("return",!0);case 11:throw e.prev=11,e.t0=e.catch(1),new Error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(g){return e.apply(this,arguments)}}(),s=function(){var e=Cr(Ir().mark((function e(){var g,t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g=C(),e.next=4,g.getShipments();case 4:return t=e.sent,e.abrupt("return",t);case 8:e.prev=8,e.t0=e.catch(0),_.error("no ethereum object.");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=Cr(Ir().mark((function e(g){var t,n,I,r,l,a,o;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.shipment_name,n=g.shipment_country,I=g.shipment_address,r=g.sending_date,l=g.receiving_date,e.prev=1,a=C(),e.next=5,a.AddShipment(t,n,I,r,l);case 5:return o=e.sent,e.next=8,o.wait();case 8:return e.abrupt("return",!0);case 11:throw e.prev=11,e.t0=e.catch(1),new Error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(g){return e.apply(this,arguments)}}(),d=function(){var e=Cr(Ir().mark((function e(g){var t,n;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=C(),e.next=4,t.getProductShipmentHistory(g);case 4:return n=e.sent,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),_.error("no ethereum object.");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(g){return e.apply(this,arguments)}}(),m=function(){var e=Cr(Ir().mark((function e(g){var t,n,I,r;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.product_code,n=g.shipment_id,e.prev=1,I=C(),e.next=5,I.ProductForShipment(n,t);case 5:return r=e.sent,e.next=8,r.wait();case 8:return e.abrupt("return",!0);case 11:e.prev=11,e.t0=e.catch(1),_.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(g){return e.apply(this,arguments)}}();return(0,q.jsx)(Bc.Provider,{value:{connectWallet:a,checkIfWalletConnected:l,currentAccount:I,getProducts:i,AddProduct:u,AddShipment:A,getShipments:s,getProductShipingHistory:d,addProductToTraceShipment:m},children:t})},Wc=function(){return(0,e.useContext)(Bc)},Vc=function(){var g=c((0,e.useState)([]),2),t=g[0],n=g[1],I=Wc(),r=I.getProducts,C=I.currentAccount,l=fI();(0,e.useEffect)((function(){C&&a()}),[C]);var a=function(){var e=Cr(Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r();case 3:g=e.sent,n(g),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)("div",{children:[C&&(0,q.jsx)("div",{className:"mb-3",children:(0,q.jsx)(or,{onClick:function(){return l("/addProduct")},children:"Add Product"})}),(0,q.jsxs)(ur,{style:{backgroundColor:"gray"},striped:!0,bordered:!0,hover:!0,children:[(0,q.jsx)("thead",{children:(0,q.jsxs)("tr",{children:[(0,q.jsx)("th",{children:"Id"}),(0,q.jsx)("th",{children:"Name"}),(0,q.jsx)("th",{children:"Type"}),(0,q.jsx)("th",{children:"Code"}),(0,q.jsx)("th",{children:"Prod_date"}),(0,q.jsx)("th",{children:"Exp_date"})]})}),(0,q.jsx)("tbody",{children:t.map((function(e,g){return(0,q.jsxs)("tr",{onClick:function(){return g=e.product_code,void l("/product/shiping/history/".concat(g));var g},children:[(0,q.jsx)("td",{children:g+1}),(0,q.jsx)("td",{children:e.product_name}),(0,q.jsx)("td",{children:e.product_type}),(0,q.jsx)("td",{children:e.product_code}),(0,q.jsx)("td",{children:yc()(Number(String(e.product_production_date))).format("YYYY-MM-DD")}),(0,q.jsx)("td",{children:yc()(Number(String(e.product_production_date))).format("YYYY-MM-DD")})]},g)}))})]})]})},kc=["as","className","type","tooltip"],Rc={type:Et().string,tooltip:Et().bool,as:Et().elementType},Xc=e.forwardRef((function(e,g){var t=e.as,n=void 0===t?"div":t,I=e.className,r=e.type,C=void 0===r?"valid":r,l=e.tooltip,a=void 0!==l&&l,o=d(e,kc);return(0,q.jsx)(n,s(s({},o),{},{ref:g,className:ge()(I,"".concat(C,"-").concat(a?"tooltip":"feedback"))}))}));Xc.displayName="Feedback",Xc.propTypes=Rc;var Jc=Xc,Yc=e.createContext({}),wc=["id","bsPrefix","className","type","isValid","isInvalid","as"],Hc=e.forwardRef((function(g,t){var n=g.id,I=g.bsPrefix,r=g.className,C=g.type,l=void 0===C?"checkbox":C,a=g.isValid,o=void 0!==a&&a,i=g.isInvalid,c=void 0!==i&&i,u=g.as,A=void 0===u?"input":u,m=d(g,wc),h=(0,e.useContext)(Yc).controlId;return I=Fe(I,"form-check-input"),(0,q.jsx)(A,s(s({},m),{},{ref:t,type:l,id:n||h,className:ge()(r,I,o&&"is-valid",c&&"is-invalid")}))}));Hc.displayName="FormCheckInput";var Nc=Hc,Fc=["bsPrefix","className","htmlFor"],Kc=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.htmlFor,C=d(g,Fc),l=(0,e.useContext)(Yc).controlId;return n=Fe(n,"form-check-label"),(0,q.jsx)("label",s(s({},C),{},{ref:t,htmlFor:r||l,className:ge()(I,n)}))}));Kc.displayName="FormCheckLabel";var xc=Kc;var Ec=["id","bsPrefix","bsSwitchPrefix","inline","reverse","disabled","isValid","isInvalid","feedbackTooltip","feedback","feedbackType","className","style","title","type","label","children","as"],Mc=e.forwardRef((function(g,t){var n=g.id,I=g.bsPrefix,r=g.bsSwitchPrefix,C=g.inline,l=void 0!==C&&C,a=g.reverse,o=void 0!==a&&a,i=g.disabled,c=void 0!==i&&i,u=g.isValid,A=void 0!==u&&u,m=g.isInvalid,h=void 0!==m&&m,b=g.feedbackTooltip,Z=void 0!==b&&b,p=g.feedback,y=g.feedbackType,G=g.className,f=g.style,B=g.title,v=void 0===B?"":B,S=g.type,W=void 0===S?"checkbox":S,V=g.label,k=g.children,R=g.as,X=void 0===R?"input":R,J=d(g,Ec);I=Fe(I,"form-check"),r=Fe(r,"form-switch");var Y=(0,e.useContext)(Yc).controlId,w=(0,e.useMemo)((function(){return{controlId:n||Y}}),[Y,n]),H=!k&&null!=V&&!1!==V||function(g,t){return e.Children.toArray(g).some((function(g){return e.isValidElement(g)&&g.type===t}))}(k,xc),N=(0,q.jsx)(Nc,s(s({},J),{},{type:"switch"===W?"checkbox":W,ref:t,isValid:A,isInvalid:h,disabled:c,as:X}));return(0,q.jsx)(Yc.Provider,{value:w,children:(0,q.jsx)("div",{style:f,className:ge()(G,H&&I,l&&"".concat(I,"-inline"),o&&"".concat(I,"-reverse"),"switch"===W&&r),children:k||(0,q.jsxs)(q.Fragment,{children:[N,H&&(0,q.jsx)(xc,{title:v,children:V}),p&&(0,q.jsx)(Jc,{type:y,tooltip:Z,children:p})]})})})}));Mc.displayName="FormCheck";var zc=Object.assign(Mc,{Input:Nc,Label:xc}),Uc=(t(2391),["bsPrefix","type","size","htmlSize","id","className","isValid","isInvalid","plaintext","readOnly","as"]),Qc=e.forwardRef((function(g,t){var n,I,r=g.bsPrefix,l=g.type,a=g.size,o=g.htmlSize,i=g.id,c=g.className,u=g.isValid,A=void 0!==u&&u,m=g.isInvalid,h=void 0!==m&&m,b=g.plaintext,Z=g.readOnly,p=g.as,y=void 0===p?"input":p,G=d(g,Uc),f=(0,e.useContext)(Yc).controlId;(r=Fe(r,"form-control"),b)?n=C({},"".concat(r,"-plaintext"),!0):(C(I={},r,!0),C(I,"".concat(r,"-").concat(a),a),n=I);return(0,q.jsx)(y,s(s({},G),{},{type:l,size:o,ref:t,readOnly:Z,id:i||f,className:ge()(c,n,A&&"is-valid",h&&"is-invalid","color"===l&&"".concat(r,"-color"))}))}));Qc.displayName="FormControl";var Lc=Object.assign(Qc,{Feedback:Jc}),Tc=De("form-floating"),Dc=["controlId","as"],jc=e.forwardRef((function(g,t){var n=g.controlId,I=g.as,r=void 0===I?"div":I,C=d(g,Dc),l=(0,e.useMemo)((function(){return{controlId:n}}),[n]);return(0,q.jsx)(Yc.Provider,{value:l,children:(0,q.jsx)(r,s(s({},C),{},{ref:t}))})}));jc.displayName="FormGroup";var Pc=jc,Oc=["as","bsPrefix","className"],_c=["className"];var qc=e.forwardRef((function(e,g){var t=function(e){var g=e.as,t=e.bsPrefix,n=e.className,I=d(e,Oc);t=Fe(t,"col");var r=Ke(),C=xe(),l=[],a=[];return r.forEach((function(e){var g,n,r,o=I[e];delete I[e],"object"===typeof o&&null!=o?(g=o.span,n=o.offset,r=o.order):g=o;var i=e!==C?"-".concat(e):"";g&&l.push(!0===g?"".concat(t).concat(i):"".concat(t).concat(i,"-").concat(g)),null!=r&&a.push("order".concat(i,"-").concat(r)),null!=n&&a.push("offset".concat(i,"-").concat(n))})),[s(s({},I),{},{className:ge().apply(void 0,[n].concat(l,a))}),{as:g,bsPrefix:t,spans:l}]}(e),n=c(t,2),I=n[0],r=I.className,C=d(I,_c),l=n[1],a=l.as,o=void 0===a?"div":a,i=l.bsPrefix,u=l.spans;return(0,q.jsx)(o,s(s({},C),{},{ref:g,className:ge()(r,!u.length&&i)}))}));qc.displayName="Col";var $c=qc,eu=["as","bsPrefix","column","visuallyHidden","className","htmlFor"],gu=e.forwardRef((function(g,t){var n=g.as,I=void 0===n?"label":n,r=g.bsPrefix,C=g.column,l=void 0!==C&&C,a=g.visuallyHidden,o=void 0!==a&&a,i=g.className,c=g.htmlFor,u=d(g,eu),A=(0,e.useContext)(Yc).controlId;r=Fe(r,"form-label");var m="col-form-label";"string"===typeof l&&(m="".concat(m," ").concat(m,"-").concat(l));var h=ge()(i,r,o&&"visually-hidden",l&&m);return c=c||A,l?(0,q.jsx)($c,s({ref:t,as:"label",className:h,htmlFor:c},u)):(0,q.jsx)(I,s({ref:t,className:h,htmlFor:c},u))}));gu.displayName="FormLabel";var tu=gu,nu=["bsPrefix","className","id"],Iu=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.id,C=d(g,nu),l=(0,e.useContext)(Yc).controlId;return n=Fe(n,"form-range"),(0,q.jsx)("input",s(s({},C),{},{type:"range",ref:t,className:ge()(I,n),id:r||l}))}));Iu.displayName="FormRange";var ru=Iu,Cu=["bsPrefix","size","htmlSize","className","isValid","isInvalid","id"],lu=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.size,r=g.htmlSize,C=g.className,l=g.isValid,a=void 0!==l&&l,o=g.isInvalid,i=void 0!==o&&o,c=g.id,u=d(g,Cu),A=(0,e.useContext)(Yc).controlId;return n=Fe(n,"form-select"),(0,q.jsx)("select",s(s({},u),{},{size:r,ref:t,className:ge()(C,n,I&&"".concat(n,"-").concat(I),a&&"is-valid",i&&"is-invalid"),id:c||A}))}));lu.displayName="FormSelect";var au=lu,ou=["bsPrefix","className","as","muted"],iu=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.as,r=void 0===I?"small":I,C=e.muted,l=d(e,ou);return t=Fe(t,"form-text"),(0,q.jsx)(r,s(s({},l),{},{ref:g,className:ge()(n,t,C&&"text-muted")}))}));iu.displayName="FormText";var cu=iu,uu=e.forwardRef((function(e,g){return(0,q.jsx)(zc,s(s({},e),{},{ref:g,type:"switch"}))}));uu.displayName="Switch";var su=Object.assign(uu,{Input:zc.Input,Label:zc.Label}),Au=["bsPrefix","className","children","controlId","label"],du=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.children,r=e.controlId,C=e.label,l=d(e,Au);return t=Fe(t,"form-floating"),(0,q.jsxs)(Pc,s(s({ref:g,className:ge()(n,t),controlId:r},l),{},{children:[I,(0,q.jsx)("label",{htmlFor:r,children:C})]}))}));du.displayName="FloatingLabel";var mu=du,hu=["className","validated","as"],bu={_ref:Et().any,validated:Et().bool,as:Et().elementType},Zu=e.forwardRef((function(e,g){var t=e.className,n=e.validated,I=e.as,r=void 0===I?"form":I,C=d(e,hu);return(0,q.jsx)(r,s(s({},C),{},{ref:g,className:ge()(t,n&&"was-validated")}))}));Zu.displayName="Form",Zu.propTypes=bu;var pu=Object.assign(Zu,{Group:Pc,Control:Lc,Floating:Tc,Check:zc,Switch:su,Label:tu,Text:cu,Range:ru,Select:au,FloatingLabel:mu}),yu=["bsPrefix","className","as"],Gu=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.as,r=void 0===I?"div":I,C=d(e,yu),l=Fe(t,"row"),a=Ke(),o=xe(),i="".concat(l,"-cols"),c=[];return a.forEach((function(e){var g,t=C[e];delete C[e],g=null!=t&&"object"===typeof t?t.cols:t;var n=e!==o?"-".concat(e):"";null!=g&&c.push("".concat(i).concat(n,"-").concat(g))})),(0,q.jsx)(r,s(s({ref:g},C),{},{className:ge().apply(void 0,[n,l].concat(c))}))}));Gu.displayName="Row";var fu=Gu,Bu=t(9008),vu=t.n(Bu),Su=function(e){return function(e){return!!e&&"object"===typeof e}(e)&&!function(e){var g=Object.prototype.toString.call(e);return"[object RegExp]"===g||"[object Date]"===g||function(e){return e.$$typeof===Wu}(e)}(e)};var Wu="function"===typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function Vu(e,g){return!1!==g.clone&&g.isMergeableObject(e)?Ru((t=e,Array.isArray(t)?[]:{}),e,g):e;var t}function ku(e,g,t){return e.concat(g).map((function(e){return Vu(e,t)}))}function Ru(e,g,t){(t=t||{}).arrayMerge=t.arrayMerge||ku,t.isMergeableObject=t.isMergeableObject||Su;var n=Array.isArray(g);return n===Array.isArray(e)?n?t.arrayMerge(e,g,t):function(e,g,t){var n={};return t.isMergeableObject(e)&&Object.keys(e).forEach((function(g){n[g]=Vu(e[g],t)})),Object.keys(g).forEach((function(I){t.isMergeableObject(g[I])&&e[I]?n[I]=Ru(e[I],g[I],t):n[I]=Vu(g[I],t)})),n}(e,g,t):Vu(g,t)}Ru.all=function(e,g){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,t){return Ru(e,t,g)}),{})};var Xu=Ru,Ju="object"==typeof global&&global&&global.Object===Object&&global,Yu="object"==typeof self&&self&&self.Object===Object&&self,wu=Ju||Yu||Function("return this")(),Hu=wu.Symbol,Nu=Object.prototype,Fu=Nu.hasOwnProperty,Ku=Nu.toString,xu=Hu?Hu.toStringTag:void 0;var Eu=function(e){var g=Fu.call(e,xu),t=e[xu];try{e[xu]=void 0;var n=!0}catch(Hb){}var I=Ku.call(e);return n&&(g?e[xu]=t:delete e[xu]),I},Mu=Object.prototype.toString;var zu=function(e){return Mu.call(e)},Uu=Hu?Hu.toStringTag:void 0;var Qu=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Uu&&Uu in Object(e)?Eu(e):zu(e)};var Lu=function(e,g){return function(t){return e(g(t))}},Tu=Lu(Object.getPrototypeOf,Object);var Du=function(e){return null!=e&&"object"==typeof e},ju=Function.prototype,Pu=Object.prototype,Ou=ju.toString,_u=Pu.hasOwnProperty,qu=Ou.call(Object);var $u=function(e){if(!Du(e)||"[object Object]"!=Qu(e))return!1;var g=Tu(e);if(null===g)return!0;var t=_u.call(g,"constructor")&&g.constructor;return"function"==typeof t&&t instanceof t&&Ou.call(t)==qu},es=t(77),gs=t.n(es);var ts=function(e,g){};var ns=function(){this.__data__=[],this.size=0};var Is=function(e,g){return e===g||e!==e&&g!==g};var rs=function(e,g){for(var t=e.length;t--;)if(Is(e[t][0],g))return t;return-1},Cs=Array.prototype.splice;var ls=function(e){var g=this.__data__,t=rs(g,e);return!(t<0)&&(t==g.length-1?g.pop():Cs.call(g,t,1),--this.size,!0)};var as=function(e){var g=this.__data__,t=rs(g,e);return t<0?void 0:g[t][1]};var os=function(e){return rs(this.__data__,e)>-1};var is=function(e,g){var t=this.__data__,n=rs(t,e);return n<0?(++this.size,t.push([e,g])):t[n][1]=g,this};function cs(e){var g=-1,t=null==e?0:e.length;for(this.clear();++g<t;){var n=e[g];this.set(n[0],n[1])}}cs.prototype.clear=ns,cs.prototype.delete=ls,cs.prototype.get=as,cs.prototype.has=os,cs.prototype.set=is;var us=cs;var ss=function(){this.__data__=new us,this.size=0};var As=function(e){var g=this.__data__,t=g.delete(e);return this.size=g.size,t};var ds=function(e){return this.__data__.get(e)};var ms=function(e){return this.__data__.has(e)};var hs=function(e){var g=typeof e;return null!=e&&("object"==g||"function"==g)};var bs=function(e){if(!hs(e))return!1;var g=Qu(e);return"[object Function]"==g||"[object GeneratorFunction]"==g||"[object AsyncFunction]"==g||"[object Proxy]"==g},Zs=wu["__core-js_shared__"],ps=function(){var e=/[^.]+$/.exec(Zs&&Zs.keys&&Zs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var ys=function(e){return!!ps&&ps in e},Gs=Function.prototype.toString;var fs=function(e){if(null!=e){try{return Gs.call(e)}catch(Hb){}try{return e+""}catch(Hb){}}return""},Bs=/^\[object .+?Constructor\]$/,vs=Function.prototype,Ss=Object.prototype,Ws=vs.toString,Vs=Ss.hasOwnProperty,ks=RegExp("^"+Ws.call(Vs).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Rs=function(e){return!(!hs(e)||ys(e))&&(bs(e)?ks:Bs).test(fs(e))};var Xs=function(e,g){return null==e?void 0:e[g]};var Js=function(e,g){var t=Xs(e,g);return Rs(t)?t:void 0},Ys=Js(wu,"Map"),ws=Js(Object,"create");var Hs=function(){this.__data__=ws?ws(null):{},this.size=0};var Ns=function(e){var g=this.has(e)&&delete this.__data__[e];return this.size-=g?1:0,g},Fs=Object.prototype.hasOwnProperty;var Ks=function(e){var g=this.__data__;if(ws){var t=g[e];return"__lodash_hash_undefined__"===t?void 0:t}return Fs.call(g,e)?g[e]:void 0},xs=Object.prototype.hasOwnProperty;var Es=function(e){var g=this.__data__;return ws?void 0!==g[e]:xs.call(g,e)};var Ms=function(e,g){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=ws&&void 0===g?"__lodash_hash_undefined__":g,this};function zs(e){var g=-1,t=null==e?0:e.length;for(this.clear();++g<t;){var n=e[g];this.set(n[0],n[1])}}zs.prototype.clear=Hs,zs.prototype.delete=Ns,zs.prototype.get=Ks,zs.prototype.has=Es,zs.prototype.set=Ms;var Us=zs;var Qs=function(){this.size=0,this.__data__={hash:new Us,map:new(Ys||us),string:new Us}};var Ls=function(e){var g=typeof e;return"string"==g||"number"==g||"symbol"==g||"boolean"==g?"__proto__"!==e:null===e};var Ts=function(e,g){var t=e.__data__;return Ls(g)?t["string"==typeof g?"string":"hash"]:t.map};var Ds=function(e){var g=Ts(this,e).delete(e);return this.size-=g?1:0,g};var js=function(e){return Ts(this,e).get(e)};var Ps=function(e){return Ts(this,e).has(e)};var Os=function(e,g){var t=Ts(this,e),n=t.size;return t.set(e,g),this.size+=t.size==n?0:1,this};function _s(e){var g=-1,t=null==e?0:e.length;for(this.clear();++g<t;){var n=e[g];this.set(n[0],n[1])}}_s.prototype.clear=Qs,_s.prototype.delete=Ds,_s.prototype.get=js,_s.prototype.has=Ps,_s.prototype.set=Os;var qs=_s;var $s=function(e,g){var t=this.__data__;if(t instanceof us){var n=t.__data__;if(!Ys||n.length<199)return n.push([e,g]),this.size=++t.size,this;t=this.__data__=new qs(n)}return t.set(e,g),this.size=t.size,this};function eA(e){var g=this.__data__=new us(e);this.size=g.size}eA.prototype.clear=ss,eA.prototype.delete=As,eA.prototype.get=ds,eA.prototype.has=ms,eA.prototype.set=$s;var gA=eA;var tA=function(e,g){for(var t=-1,n=null==e?0:e.length;++t<n&&!1!==g(e[t],t,e););return e},nA=function(){try{var e=Js(Object,"defineProperty");return e({},"",{}),e}catch(Hb){}}();var IA=function(e,g,t){"__proto__"==g&&nA?nA(e,g,{configurable:!0,enumerable:!0,value:t,writable:!0}):e[g]=t},rA=Object.prototype.hasOwnProperty;var CA=function(e,g,t){var n=e[g];rA.call(e,g)&&Is(n,t)&&(void 0!==t||g in e)||IA(e,g,t)};var lA=function(e,g,t,n){var I=!t;t||(t={});for(var r=-1,C=g.length;++r<C;){var l=g[r],a=n?n(t[l],e[l],l,t,e):void 0;void 0===a&&(a=e[l]),I?IA(t,l,a):CA(t,l,a)}return t};var aA=function(e,g){for(var t=-1,n=Array(e);++t<e;)n[t]=g(t);return n};var oA=function(e){return Du(e)&&"[object Arguments]"==Qu(e)},iA=Object.prototype,cA=iA.hasOwnProperty,uA=iA.propertyIsEnumerable,sA=oA(function(){return arguments}())?oA:function(e){return Du(e)&&cA.call(e,"callee")&&!uA.call(e,"callee")},AA=sA,dA=Array.isArray;var mA=function(){return!1},hA="object"==typeof exports&&exports&&!exports.nodeType&&exports,bA=hA&&"object"==typeof module&&module&&!module.nodeType&&module,ZA=bA&&bA.exports===hA?wu.Buffer:void 0,pA=(ZA?ZA.isBuffer:void 0)||mA,yA=/^(?:0|[1-9]\d*)$/;var GA=function(e,g){var t=typeof e;return!!(g=null==g?9007199254740991:g)&&("number"==t||"symbol"!=t&&yA.test(e))&&e>-1&&e%1==0&&e<g};var fA=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},BA={};BA["[object Float32Array]"]=BA["[object Float64Array]"]=BA["[object Int8Array]"]=BA["[object Int16Array]"]=BA["[object Int32Array]"]=BA["[object Uint8Array]"]=BA["[object Uint8ClampedArray]"]=BA["[object Uint16Array]"]=BA["[object Uint32Array]"]=!0,BA["[object Arguments]"]=BA["[object Array]"]=BA["[object ArrayBuffer]"]=BA["[object Boolean]"]=BA["[object DataView]"]=BA["[object Date]"]=BA["[object Error]"]=BA["[object Function]"]=BA["[object Map]"]=BA["[object Number]"]=BA["[object Object]"]=BA["[object RegExp]"]=BA["[object Set]"]=BA["[object String]"]=BA["[object WeakMap]"]=!1;var vA=function(e){return Du(e)&&fA(e.length)&&!!BA[Qu(e)]};var SA=function(e){return function(g){return e(g)}},WA="object"==typeof exports&&exports&&!exports.nodeType&&exports,VA=WA&&"object"==typeof module&&module&&!module.nodeType&&module,kA=VA&&VA.exports===WA&&Ju.process,RA=function(){try{var e=VA&&VA.require&&VA.require("util").types;return e||kA&&kA.binding&&kA.binding("util")}catch(Hb){}}(),XA=RA&&RA.isTypedArray,JA=XA?SA(XA):vA,YA=Object.prototype.hasOwnProperty;var wA=function(e,g){var t=dA(e),n=!t&&AA(e),I=!t&&!n&&pA(e),r=!t&&!n&&!I&&JA(e),C=t||n||I||r,l=C?aA(e.length,String):[],a=l.length;for(var o in e)!g&&!YA.call(e,o)||C&&("length"==o||I&&("offset"==o||"parent"==o)||r&&("buffer"==o||"byteLength"==o||"byteOffset"==o)||GA(o,a))||l.push(o);return l},HA=Object.prototype;var NA=function(e){var g=e&&e.constructor;return e===("function"==typeof g&&g.prototype||HA)},FA=Lu(Object.keys,Object),KA=Object.prototype.hasOwnProperty;var xA=function(e){if(!NA(e))return FA(e);var g=[];for(var t in Object(e))KA.call(e,t)&&"constructor"!=t&&g.push(t);return g};var EA=function(e){return null!=e&&fA(e.length)&&!bs(e)};var MA=function(e){return EA(e)?wA(e):xA(e)};var zA=function(e,g){return e&&lA(g,MA(g),e)};var UA=function(e){var g=[];if(null!=e)for(var t in Object(e))g.push(t);return g},QA=Object.prototype.hasOwnProperty;var LA=function(e){if(!hs(e))return UA(e);var g=NA(e),t=[];for(var n in e)("constructor"!=n||!g&&QA.call(e,n))&&t.push(n);return t};var TA=function(e){return EA(e)?wA(e,!0):LA(e)};var DA=function(e,g){return e&&lA(g,TA(g),e)},jA="object"==typeof exports&&exports&&!exports.nodeType&&exports,PA=jA&&"object"==typeof module&&module&&!module.nodeType&&module,OA=PA&&PA.exports===jA?wu.Buffer:void 0,_A=OA?OA.allocUnsafe:void 0;var qA=function(e,g){if(g)return e.slice();var t=e.length,n=_A?_A(t):new e.constructor(t);return e.copy(n),n};var $A=function(e,g){var t=-1,n=e.length;for(g||(g=Array(n));++t<n;)g[t]=e[t];return g};var ed=function(e,g){for(var t=-1,n=null==e?0:e.length,I=0,r=[];++t<n;){var C=e[t];g(C,t,e)&&(r[I++]=C)}return r};var gd=function(){return[]},td=Object.prototype.propertyIsEnumerable,nd=Object.getOwnPropertySymbols,Id=nd?function(e){return null==e?[]:(e=Object(e),ed(nd(e),(function(g){return td.call(e,g)})))}:gd,rd=Id;var Cd=function(e,g){return lA(e,rd(e),g)};var ld=function(e,g){for(var t=-1,n=g.length,I=e.length;++t<n;)e[I+t]=g[t];return e},ad=Object.getOwnPropertySymbols?function(e){for(var g=[];e;)ld(g,rd(e)),e=Tu(e);return g}:gd,od=ad;var id=function(e,g){return lA(e,od(e),g)};var cd=function(e,g,t){var n=g(e);return dA(e)?n:ld(n,t(e))};var ud=function(e){return cd(e,MA,rd)};var sd=function(e){return cd(e,TA,od)},Ad=Js(wu,"DataView"),dd=Js(wu,"Promise"),md=Js(wu,"Set"),hd=Js(wu,"WeakMap"),bd="[object Map]",Zd="[object Promise]",pd="[object Set]",yd="[object WeakMap]",Gd="[object DataView]",fd=fs(Ad),Bd=fs(Ys),vd=fs(dd),Sd=fs(md),Wd=fs(hd),Vd=Qu;(Ad&&Vd(new Ad(new ArrayBuffer(1)))!=Gd||Ys&&Vd(new Ys)!=bd||dd&&Vd(dd.resolve())!=Zd||md&&Vd(new md)!=pd||hd&&Vd(new hd)!=yd)&&(Vd=function(e){var g=Qu(e),t="[object Object]"==g?e.constructor:void 0,n=t?fs(t):"";if(n)switch(n){case fd:return Gd;case Bd:return bd;case vd:return Zd;case Sd:return pd;case Wd:return yd}return g});var kd=Vd,Rd=Object.prototype.hasOwnProperty;var Xd=function(e){var g=e.length,t=new e.constructor(g);return g&&"string"==typeof e[0]&&Rd.call(e,"index")&&(t.index=e.index,t.input=e.input),t},Jd=wu.Uint8Array;var Yd=function(e){var g=new e.constructor(e.byteLength);return new Jd(g).set(new Jd(e)),g};var wd=function(e,g){var t=g?Yd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.byteLength)},Hd=/\w*$/;var Nd=function(e){var g=new e.constructor(e.source,Hd.exec(e));return g.lastIndex=e.lastIndex,g},Fd=Hu?Hu.prototype:void 0,Kd=Fd?Fd.valueOf:void 0;var xd=function(e){return Kd?Object(Kd.call(e)):{}};var Ed=function(e,g){var t=g?Yd(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)};var Md=function(e,g,t){var n=e.constructor;switch(g){case"[object ArrayBuffer]":return Yd(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return wd(e,t);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Ed(e,t);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return Nd(e);case"[object Symbol]":return xd(e)}},zd=Object.create,Ud=function(){function e(){}return function(g){if(!hs(g))return{};if(zd)return zd(g);e.prototype=g;var t=new e;return e.prototype=void 0,t}}(),Qd=Ud;var Ld=function(e){return"function"!=typeof e.constructor||NA(e)?{}:Qd(Tu(e))};var Td=function(e){return Du(e)&&"[object Map]"==kd(e)},Dd=RA&&RA.isMap,jd=Dd?SA(Dd):Td;var Pd=function(e){return Du(e)&&"[object Set]"==kd(e)},Od=RA&&RA.isSet,_d=Od?SA(Od):Pd,qd="[object Arguments]",$d="[object Function]",em="[object Object]",gm={};gm[qd]=gm["[object Array]"]=gm["[object ArrayBuffer]"]=gm["[object DataView]"]=gm["[object Boolean]"]=gm["[object Date]"]=gm["[object Float32Array]"]=gm["[object Float64Array]"]=gm["[object Int8Array]"]=gm["[object Int16Array]"]=gm["[object Int32Array]"]=gm["[object Map]"]=gm["[object Number]"]=gm[em]=gm["[object RegExp]"]=gm["[object Set]"]=gm["[object String]"]=gm["[object Symbol]"]=gm["[object Uint8Array]"]=gm["[object Uint8ClampedArray]"]=gm["[object Uint16Array]"]=gm["[object Uint32Array]"]=!0,gm["[object Error]"]=gm[$d]=gm["[object WeakMap]"]=!1;var tm=function e(g,t,n,I,r,C){var l,a=1&t,o=2&t,i=4&t;if(n&&(l=r?n(g,I,r,C):n(g)),void 0!==l)return l;if(!hs(g))return g;var c=dA(g);if(c){if(l=Xd(g),!a)return $A(g,l)}else{var u=kd(g),s=u==$d||"[object GeneratorFunction]"==u;if(pA(g))return qA(g,a);if(u==em||u==qd||s&&!r){if(l=o||s?{}:Ld(g),!a)return o?id(g,DA(l,g)):Cd(g,zA(l,g))}else{if(!gm[u])return r?g:{};l=Md(g,u,a)}}C||(C=new gA);var A=C.get(g);if(A)return A;C.set(g,l),_d(g)?g.forEach((function(I){l.add(e(I,t,n,I,g,C))})):jd(g)&&g.forEach((function(I,r){l.set(r,e(I,t,n,r,g,C))}));var d=c?void 0:(i?o?sd:ud:o?TA:MA)(g);return tA(d||g,(function(I,r){d&&(I=g[r=I]),CA(l,r,e(I,t,n,r,g,C))})),l};var nm=function(e){return tm(e,4)};var Im=function(e,g){for(var t=-1,n=null==e?0:e.length,I=Array(n);++t<n;)I[t]=g(e[t],t,e);return I};var rm=function(e){return"symbol"==typeof e||Du(e)&&"[object Symbol]"==Qu(e)};function Cm(e,g){if("function"!=typeof e||null!=g&&"function"!=typeof g)throw new TypeError("Expected a function");var t=function t(){var n=arguments,I=g?g.apply(this,n):n[0],r=t.cache;if(r.has(I))return r.get(I);var C=e.apply(this,n);return t.cache=r.set(I,C)||r,C};return t.cache=new(Cm.Cache||qs),t}Cm.Cache=qs;var lm=Cm;var am=function(e){var g=lm(e,(function(e){return 500===t.size&&t.clear(),e})),t=g.cache;return g},om=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,im=/\\(\\)?/g,cm=am((function(e){var g=[];return 46===e.charCodeAt(0)&&g.push(""),e.replace(om,(function(e,t,n,I){g.push(n?I.replace(im,"$1"):t||e)})),g})),um=cm;var sm=function(e){if("string"==typeof e||rm(e))return e;var g=e+"";return"0"==g&&1/e==-Infinity?"-0":g},Am=Hu?Hu.prototype:void 0,dm=Am?Am.toString:void 0;var mm=function e(g){if("string"==typeof g)return g;if(dA(g))return Im(g,e)+"";if(rm(g))return dm?dm.call(g):"";var t=g+"";return"0"==t&&1/g==-Infinity?"-0":t};var hm=function(e){return null==e?"":mm(e)};var bm=function(e){return dA(e)?Im(e,sm):rm(e)?[e]:$A(um(hm(e)))};t(2110);var Zm=function(e){return tm(e,5)};function pm(){return pm=Object.assign||function(e){for(var g=1;g<arguments.length;g++){var t=arguments[g];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},pm.apply(this,arguments)}function ym(e,g){e.prototype=Object.create(g.prototype),e.prototype.constructor=e,e.__proto__=g}function Gm(e,g){if(null==e)return{};var t,n,I={},r=Object.keys(e);for(n=0;n<r.length;n++)t=r[n],g.indexOf(t)>=0||(I[t]=e[t]);return I}function fm(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Bm=(0,e.createContext)(void 0);Bm.displayName="FormikContext";Bm.Provider,Bm.Consumer;function vm(){var g=(0,e.useContext)(Bm);return g||ts(!1),g}var Sm=function(e){return Array.isArray(e)&&0===e.length},Wm=function(e){return"function"===typeof e},Vm=function(e){return null!==e&&"object"===typeof e},km=function(e){return String(Math.floor(Number(e)))===e},Rm=function(e){return"[object String]"===Object.prototype.toString.call(e)},Xm=function(g){return 0===e.Children.count(g)},Jm=function(e){return Vm(e)&&Wm(e.then)};function Ym(e,g,t,n){void 0===n&&(n=0);for(var I=bm(g);e&&n<I.length;)e=e[I[n++]];return n===I.length||e?void 0===e?t:e:t}function wm(e,g,t){for(var n=nm(e),I=n,r=0,C=bm(g);r<C.length-1;r++){var l=C[r],a=Ym(e,C.slice(0,r+1));if(a&&(Vm(a)||Array.isArray(a)))I=I[l]=nm(a);else{var o=C[r+1];I=I[l]=km(o)&&Number(o)>=0?[]:{}}}return(0===r?e:I)[C[r]]===t?e:(void 0===t?delete I[C[r]]:I[C[r]]=t,0===r&&void 0===t&&delete n[C[r]],n)}function Hm(e,g,t,n){void 0===t&&(t=new WeakMap),void 0===n&&(n={});for(var I=0,r=Object.keys(e);I<r.length;I++){var C=r[I],l=e[C];Vm(l)?t.get(l)||(t.set(l,!0),n[C]=Array.isArray(l)?[]:{},Hm(l,g,t,n[C])):n[C]=g}return n}var Nm={},Fm={};function Km(g){var t=g.validateOnChange,n=void 0===t||t,I=g.validateOnBlur,r=void 0===I||I,C=g.validateOnMount,l=void 0!==C&&C,a=g.isInitialValid,o=g.enableReinitialize,i=void 0!==o&&o,c=g.onSubmit,u=Gm(g,["validateOnChange","validateOnBlur","validateOnMount","isInitialValid","enableReinitialize","onSubmit"]),s=pm({validateOnChange:n,validateOnBlur:r,validateOnMount:l,onSubmit:c},u),A=(0,e.useRef)(s.initialValues),d=(0,e.useRef)(s.initialErrors||Nm),m=(0,e.useRef)(s.initialTouched||Fm),h=(0,e.useRef)(s.initialStatus),b=(0,e.useRef)(!1),Z=(0,e.useRef)({});(0,e.useEffect)((function(){return b.current=!0,function(){b.current=!1}}),[]);var p=(0,e.useState)(0)[1],y=(0,e.useRef)({values:s.initialValues,errors:s.initialErrors||Nm,touched:s.initialTouched||Fm,status:s.initialStatus,isSubmitting:!1,isValidating:!1,submitCount:0}),G=y.current,f=(0,e.useCallback)((function(e){var g=y.current;y.current=function(e,g){switch(g.type){case"SET_VALUES":return pm({},e,{values:g.payload});case"SET_TOUCHED":return pm({},e,{touched:g.payload});case"SET_ERRORS":return gs()(e.errors,g.payload)?e:pm({},e,{errors:g.payload});case"SET_STATUS":return pm({},e,{status:g.payload});case"SET_ISSUBMITTING":return pm({},e,{isSubmitting:g.payload});case"SET_ISVALIDATING":return pm({},e,{isValidating:g.payload});case"SET_FIELD_VALUE":return pm({},e,{values:wm(e.values,g.payload.field,g.payload.value)});case"SET_FIELD_TOUCHED":return pm({},e,{touched:wm(e.touched,g.payload.field,g.payload.value)});case"SET_FIELD_ERROR":return pm({},e,{errors:wm(e.errors,g.payload.field,g.payload.value)});case"RESET_FORM":return pm({},e,g.payload);case"SET_FORMIK_STATE":return g.payload(e);case"SUBMIT_ATTEMPT":return pm({},e,{touched:Hm(e.values,!0),isSubmitting:!0,submitCount:e.submitCount+1});case"SUBMIT_FAILURE":case"SUBMIT_SUCCESS":return pm({},e,{isSubmitting:!1});default:return e}}(g,e),g!==y.current&&p((function(e){return e+1}))}),[]),B=(0,e.useCallback)((function(e,g){return new Promise((function(t,n){var I=s.validate(e,g);null==I?t(Nm):Jm(I)?I.then((function(e){t(e||Nm)}),(function(e){n(e)})):t(I)}))}),[s.validate]),v=(0,e.useCallback)((function(e,g){var t=s.validationSchema,n=Wm(t)?t(g):t,I=g&&n.validateAt?n.validateAt(g,e):function(e,g,t,n){void 0===t&&(t=!1);var I=xm(e);return g[t?"validateSync":"validate"](I,{abortEarly:!1,context:n||I})}(e,n);return new Promise((function(e,g){I.then((function(){e(Nm)}),(function(t){"ValidationError"===t.name?e(function(e){var g={};if(e.inner){if(0===e.inner.length)return wm(g,e.path,e.message);var t=e.inner,n=Array.isArray(t),I=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(I>=t.length)break;r=t[I++]}else{if((I=t.next()).done)break;r=I.value}var C=r;Ym(g,C.path)||(g=wm(g,C.path,C.message))}}return g}(t)):g(t)}))}))}),[s.validationSchema]),S=(0,e.useCallback)((function(e,g){return new Promise((function(t){return t(Z.current[e].validate(g))}))}),[]),W=(0,e.useCallback)((function(e){var g=Object.keys(Z.current).filter((function(e){return Wm(Z.current[e].validate)})),t=g.length>0?g.map((function(g){return S(g,Ym(e,g))})):[Promise.resolve("DO_NOT_DELETE_YOU_WILL_BE_FIRED")];return Promise.all(t).then((function(e){return e.reduce((function(e,t,n){return"DO_NOT_DELETE_YOU_WILL_BE_FIRED"===t||t&&(e=wm(e,g[n],t)),e}),{})}))}),[S]),V=(0,e.useCallback)((function(e){return Promise.all([W(e),s.validationSchema?v(e):{},s.validate?B(e):{}]).then((function(e){var g=e[0],t=e[1],n=e[2];return Xu.all([g,t,n],{arrayMerge:Em})}))}),[s.validate,s.validationSchema,W,B,v]),k=zm((function(e){return void 0===e&&(e=G.values),f({type:"SET_ISVALIDATING",payload:!0}),V(e).then((function(e){return b.current&&(f({type:"SET_ISVALIDATING",payload:!1}),f({type:"SET_ERRORS",payload:e})),e}))}));(0,e.useEffect)((function(){l&&!0===b.current&&gs()(A.current,s.initialValues)&&k(A.current)}),[l,k]);var R=(0,e.useCallback)((function(e){var g=e&&e.values?e.values:A.current,t=e&&e.errors?e.errors:d.current?d.current:s.initialErrors||{},n=e&&e.touched?e.touched:m.current?m.current:s.initialTouched||{},I=e&&e.status?e.status:h.current?h.current:s.initialStatus;A.current=g,d.current=t,m.current=n,h.current=I;var r=function(){f({type:"RESET_FORM",payload:{isSubmitting:!!e&&!!e.isSubmitting,errors:t,touched:n,status:I,values:g,isValidating:!!e&&!!e.isValidating,submitCount:e&&e.submitCount&&"number"===typeof e.submitCount?e.submitCount:0}})};if(s.onReset){var C=s.onReset(G.values,P);Jm(C)?C.then(r):r()}else r()}),[s.initialErrors,s.initialStatus,s.initialTouched]);(0,e.useEffect)((function(){!0!==b.current||gs()(A.current,s.initialValues)||i&&(A.current=s.initialValues,R(),l&&k(A.current))}),[i,s.initialValues,R,l,k]),(0,e.useEffect)((function(){i&&!0===b.current&&!gs()(d.current,s.initialErrors)&&(d.current=s.initialErrors||Nm,f({type:"SET_ERRORS",payload:s.initialErrors||Nm}))}),[i,s.initialErrors]),(0,e.useEffect)((function(){i&&!0===b.current&&!gs()(m.current,s.initialTouched)&&(m.current=s.initialTouched||Fm,f({type:"SET_TOUCHED",payload:s.initialTouched||Fm}))}),[i,s.initialTouched]),(0,e.useEffect)((function(){i&&!0===b.current&&!gs()(h.current,s.initialStatus)&&(h.current=s.initialStatus,f({type:"SET_STATUS",payload:s.initialStatus}))}),[i,s.initialStatus,s.initialTouched]);var X=zm((function(e){if(Z.current[e]&&Wm(Z.current[e].validate)){var g=Ym(G.values,e),t=Z.current[e].validate(g);return Jm(t)?(f({type:"SET_ISVALIDATING",payload:!0}),t.then((function(e){return e})).then((function(g){f({type:"SET_FIELD_ERROR",payload:{field:e,value:g}}),f({type:"SET_ISVALIDATING",payload:!1})}))):(f({type:"SET_FIELD_ERROR",payload:{field:e,value:t}}),Promise.resolve(t))}return s.validationSchema?(f({type:"SET_ISVALIDATING",payload:!0}),v(G.values,e).then((function(e){return e})).then((function(g){f({type:"SET_FIELD_ERROR",payload:{field:e,value:Ym(g,e)}}),f({type:"SET_ISVALIDATING",payload:!1})}))):Promise.resolve()})),J=(0,e.useCallback)((function(e,g){var t=g.validate;Z.current[e]={validate:t}}),[]),Y=(0,e.useCallback)((function(e){delete Z.current[e]}),[]),w=zm((function(e,g){return f({type:"SET_TOUCHED",payload:e}),(void 0===g?r:g)?k(G.values):Promise.resolve()})),H=(0,e.useCallback)((function(e){f({type:"SET_ERRORS",payload:e})}),[]),N=zm((function(e,g){var t=Wm(e)?e(G.values):e;return f({type:"SET_VALUES",payload:t}),(void 0===g?n:g)?k(t):Promise.resolve()})),F=(0,e.useCallback)((function(e,g){f({type:"SET_FIELD_ERROR",payload:{field:e,value:g}})}),[]),K=zm((function(e,g,t){return f({type:"SET_FIELD_VALUE",payload:{field:e,value:g}}),(void 0===t?n:t)?k(wm(G.values,e,g)):Promise.resolve()})),x=(0,e.useCallback)((function(e,g){var t,n=g,I=e;if(!Rm(e)){e.persist&&e.persist();var r=e.target?e.target:e.currentTarget,C=r.type,l=r.name,a=r.id,o=r.value,i=r.checked,c=(r.outerHTML,r.options),u=r.multiple;n=g||(l||a),I=/number|range/.test(C)?(t=parseFloat(o),isNaN(t)?"":t):/checkbox/.test(C)?function(e,g,t){if("boolean"===typeof e)return Boolean(g);var n=[],I=!1,r=-1;if(Array.isArray(e))n=e,I=(r=e.indexOf(t))>=0;else if(!t||"true"==t||"false"==t)return Boolean(g);if(g&&t&&!I)return n.concat(t);if(!I)return n;return n.slice(0,r).concat(n.slice(r+1))}(Ym(G.values,n),i,o):c&&u?function(e){return Array.from(e).filter((function(e){return e.selected})).map((function(e){return e.value}))}(c):o}n&&K(n,I)}),[K,G.values]),E=zm((function(e){if(Rm(e))return function(g){return x(g,e)};x(e)})),M=zm((function(e,g,t){return void 0===g&&(g=!0),f({type:"SET_FIELD_TOUCHED",payload:{field:e,value:g}}),(void 0===t?r:t)?k(G.values):Promise.resolve()})),z=(0,e.useCallback)((function(e,g){e.persist&&e.persist();var t=e.target,n=t.name,I=t.id,r=(t.outerHTML,g||(n||I));M(r,!0)}),[M]),U=zm((function(e){if(Rm(e))return function(g){return z(g,e)};z(e)})),Q=(0,e.useCallback)((function(e){Wm(e)?f({type:"SET_FORMIK_STATE",payload:e}):f({type:"SET_FORMIK_STATE",payload:function(){return e}})}),[]),L=(0,e.useCallback)((function(e){f({type:"SET_STATUS",payload:e})}),[]),T=(0,e.useCallback)((function(e){f({type:"SET_ISSUBMITTING",payload:e})}),[]),D=zm((function(){return f({type:"SUBMIT_ATTEMPT"}),k().then((function(e){var g=e instanceof Error;if(!g&&0===Object.keys(e).length){var t;try{if(void 0===(t=O()))return}catch(n){throw n}return Promise.resolve(t).then((function(e){return b.current&&f({type:"SUBMIT_SUCCESS"}),e})).catch((function(e){if(b.current)throw f({type:"SUBMIT_FAILURE"}),e}))}if(b.current&&(f({type:"SUBMIT_FAILURE"}),g))throw e}))})),j=zm((function(e){e&&e.preventDefault&&Wm(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&Wm(e.stopPropagation)&&e.stopPropagation(),D().catch((function(e){console.warn("Warning: An unhandled error was caught from submitForm()",e)}))})),P={resetForm:R,validateForm:k,validateField:X,setErrors:H,setFieldError:F,setFieldTouched:M,setFieldValue:K,setStatus:L,setSubmitting:T,setTouched:w,setValues:N,setFormikState:Q,submitForm:D},O=zm((function(){return c(G.values,P)})),_=zm((function(e){e&&e.preventDefault&&Wm(e.preventDefault)&&e.preventDefault(),e&&e.stopPropagation&&Wm(e.stopPropagation)&&e.stopPropagation(),R()})),q=(0,e.useCallback)((function(e){return{value:Ym(G.values,e),error:Ym(G.errors,e),touched:!!Ym(G.touched,e),initialValue:Ym(A.current,e),initialTouched:!!Ym(m.current,e),initialError:Ym(d.current,e)}}),[G.errors,G.touched,G.values]),$=(0,e.useCallback)((function(e){return{setValue:function(g,t){return K(e,g,t)},setTouched:function(g,t){return M(e,g,t)},setError:function(g){return F(e,g)}}}),[K,M,F]),ee=(0,e.useCallback)((function(e){var g=Vm(e),t=g?e.name:e,n=Ym(G.values,t),I={name:t,value:n,onChange:E,onBlur:U};if(g){var r=e.type,C=e.value,l=e.as,a=e.multiple;"checkbox"===r?void 0===C?I.checked=!!n:(I.checked=!(!Array.isArray(n)||!~n.indexOf(C)),I.value=C):"radio"===r?(I.checked=n===C,I.value=C):"select"===l&&a&&(I.value=I.value||[],I.multiple=!0)}return I}),[U,E,G.values]),ge=(0,e.useMemo)((function(){return!gs()(A.current,G.values)}),[A.current,G.values]),te=(0,e.useMemo)((function(){return"undefined"!==typeof a?ge?G.errors&&0===Object.keys(G.errors).length:!1!==a&&Wm(a)?a(s):a:G.errors&&0===Object.keys(G.errors).length}),[a,ge,G.errors,s]);return pm({},G,{initialValues:A.current,initialErrors:d.current,initialTouched:m.current,initialStatus:h.current,handleBlur:U,handleChange:E,handleReset:_,handleSubmit:j,resetForm:R,setErrors:H,setFormikState:Q,setFieldTouched:M,setFieldValue:K,setFieldError:F,setStatus:L,setSubmitting:T,setTouched:w,setValues:N,submitForm:D,validateForm:k,validateField:X,isValid:te,dirty:ge,unregisterField:Y,registerField:J,getFieldProps:ee,getFieldMeta:q,getFieldHelpers:$,validateOnBlur:r,validateOnChange:n,validateOnMount:l})}function xm(e){var g=Array.isArray(e)?[]:{};for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=String(t);!0===Array.isArray(e[n])?g[n]=e[n].map((function(e){return!0===Array.isArray(e)||$u(e)?xm(e):""!==e?e:void 0})):$u(e[n])?g[n]=xm(e[n]):g[n]=""!==e[n]?e[n]:void 0}return g}function Em(e,g,t){var n=e.slice();return g.forEach((function(g,I){if("undefined"===typeof n[I]){var r=!1!==t.clone&&t.isMergeableObject(g);n[I]=r?Xu(Array.isArray(g)?[]:{},g,t):g}else t.isMergeableObject(g)?n[I]=Xu(e[I],g,t):-1===e.indexOf(g)&&n.push(g)})),n}var Mm="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?e.useLayoutEffect:e.useEffect;function zm(g){var t=(0,e.useRef)(g);return Mm((function(){t.current=g})),(0,e.useCallback)((function(){for(var e=arguments.length,g=new Array(e),n=0;n<e;n++)g[n]=arguments[n];return t.current.apply(void 0,g)}),[])}(0,e.forwardRef)((function(g,t){var n=g.action,I=Gm(g,["action"]),r=null!=n?n:"#",C=vm(),l=C.handleReset,a=C.handleSubmit;return(0,e.createElement)("form",pm({onSubmit:a,ref:t,onReset:l,action:r},I))})).displayName="Form";var Um=function(e,g,t){var n=Qm(e);return n.splice(g,0,t),n},Qm=function(e){if(e){if(Array.isArray(e))return[].concat(e);var g=Object.keys(e).map((function(e){return parseInt(e)})).reduce((function(e,g){return g>e?g:e}),0);return Array.from(pm({},e,{length:g+1}))}return[]},Lm=function(e,g){var t="function"===typeof e?e:g;return function(e){if(Array.isArray(e)||Vm(e)){var g=Qm(e);return t(g)}return e}},Tm=function(g){function t(e){var t;return(t=g.call(this,e)||this).updateArrayField=function(e,g,n){var I=t.props,r=I.name;(0,I.formik.setFormikState)((function(t){var I=Lm(n,e),C=Lm(g,e),l=wm(t.values,r,e(Ym(t.values,r))),a=n?I(Ym(t.errors,r)):void 0,o=g?C(Ym(t.touched,r)):void 0;return Sm(a)&&(a=void 0),Sm(o)&&(o=void 0),pm({},t,{values:l,errors:n?wm(t.errors,r,a):t.errors,touched:g?wm(t.touched,r,o):t.touched})}))},t.push=function(e){return t.updateArrayField((function(g){return[].concat(Qm(g),[Zm(e)])}),!1,!1)},t.handlePush=function(e){return function(){return t.push(e)}},t.swap=function(e,g){return t.updateArrayField((function(t){return function(e,g,t){var n=Qm(e),I=n[g];return n[g]=n[t],n[t]=I,n}(t,e,g)}),!0,!0)},t.handleSwap=function(e,g){return function(){return t.swap(e,g)}},t.move=function(e,g){return t.updateArrayField((function(t){return function(e,g,t){var n=Qm(e),I=n[g];return n.splice(g,1),n.splice(t,0,I),n}(t,e,g)}),!0,!0)},t.handleMove=function(e,g){return function(){return t.move(e,g)}},t.insert=function(e,g){return t.updateArrayField((function(t){return Um(t,e,g)}),(function(g){return Um(g,e,null)}),(function(g){return Um(g,e,null)}))},t.handleInsert=function(e,g){return function(){return t.insert(e,g)}},t.replace=function(e,g){return t.updateArrayField((function(t){return function(e,g,t){var n=Qm(e);return n[g]=t,n}(t,e,g)}),!1,!1)},t.handleReplace=function(e,g){return function(){return t.replace(e,g)}},t.unshift=function(e){var g=-1;return t.updateArrayField((function(t){var n=t?[e].concat(t):[e];return g=n.length,n}),(function(e){return e?[null].concat(e):[null]}),(function(e){return e?[null].concat(e):[null]})),g},t.handleUnshift=function(e){return function(){return t.unshift(e)}},t.handleRemove=function(e){return function(){return t.remove(e)}},t.handlePop=function(){return function(){return t.pop()}},t.remove=t.remove.bind(fm(t)),t.pop=t.pop.bind(fm(t)),t}ym(t,g);var n=t.prototype;return n.componentDidUpdate=function(e){this.props.validateOnChange&&this.props.formik.validateOnChange&&!gs()(Ym(e.formik.values,e.name),Ym(this.props.formik.values,this.props.name))&&this.props.formik.validateForm(this.props.formik.values)},n.remove=function(e){var g;return this.updateArrayField((function(t){var n=t?Qm(t):[];return g||(g=n[e]),Wm(n.splice)&&n.splice(e,1),Wm(n.every)&&n.every((function(e){return void 0===e}))?[]:n}),!0,!0),g},n.pop=function(){var e;return this.updateArrayField((function(g){var t=g.slice();return e||(e=t&&t.pop&&t.pop()),t}),!0,!0),e},n.render=function(){var g={push:this.push,pop:this.pop,swap:this.swap,move:this.move,insert:this.insert,replace:this.replace,unshift:this.unshift,remove:this.remove,handlePush:this.handlePush,handlePop:this.handlePop,handleSwap:this.handleSwap,handleMove:this.handleMove,handleInsert:this.handleInsert,handleReplace:this.handleReplace,handleUnshift:this.handleUnshift,handleRemove:this.handleRemove},t=this.props,n=t.component,I=t.render,r=t.children,C=t.name,l=pm({},g,{form:Gm(t.formik,["validate","validationSchema"]),name:C});return n?(0,e.createElement)(n,l):I?I(l):r?"function"===typeof r?r(l):Xm(r)?null:e.Children.only(r):null},t}(e.Component);Tm.defaultProps={validateOnChange:!0};var Dm=t(2758),jm=t(1564),Pm=t(6514),Om=t.n(Pm),_m=Object.prototype.toString,qm=Error.prototype.toString,$m=RegExp.prototype.toString,eh="undefined"!==typeof Symbol?Symbol.prototype.toString:function(){return""},gh=/^Symbol\((.*)\)(.*)$/;function th(e){var g=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==e||!0===e||!1===e)return""+e;var t=typeof e;if("number"===t)return function(e){return e!=+e?"NaN":0===e&&1/e<0?"-0":""+e}(e);if("string"===t)return g?'"'.concat(e,'"'):e;if("function"===t)return"[Function "+(e.name||"anonymous")+"]";if("symbol"===t)return eh.call(e).replace(gh,"Symbol($1)");var n=_m.call(e).slice(8,-1);return"Date"===n?isNaN(e.getTime())?""+e:e.toISOString(e):"Error"===n||e instanceof Error?"["+qm.call(e)+"]":"RegExp"===n?$m.call(e):null}function nh(e,g){var t=th(e,g);return null!==t?t:JSON.stringify(e,(function(e,t){var n=th(this[e],g);return null!==n?n:t}),2)}function Ih(e){return null==e?[]:[].concat(e)}var rh=/\$\{\s*(\w+)\s*\}/g,Ch=function(e){gn(t,e);var g=In(t);function t(e,n,I,r){var C;return it(this,t),(C=g.call(this)).value=void 0,C.path=void 0,C.type=void 0,C.errors=void 0,C.params=void 0,C.inner=void 0,C.name="ValidationError",C.value=n,C.path=I,C.type=r,C.errors=[],C.inner=[],Ih(e).forEach((function(e){var g;t.isError(e)?((g=C.errors).push.apply(g,h(e.errors)),C.inner=C.inner.concat(e.inner.length?e.inner:e)):C.errors.push(e)})),C.message=C.errors.length>1?"".concat(C.errors.length," errors occurred"):C.errors[0],Error.captureStackTrace&&Error.captureStackTrace(nn(C),t),C}return ut(t,null,[{key:"formatError",value:function(e,g){var t=g.label||g.path||"this";return t!==g.path&&(g=Object.assign({},g,{path:t})),"string"===typeof e?e.replace(rh,(function(e,t){return nh(g[t])})):"function"===typeof e?e(g):e}},{key:"isError",value:function(e){return e&&"ValidationError"===e.name}}]),t}(Wn(Error)),lh={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:function(e){var g=e.path,t=e.type,n=e.value,I=e.originalValue,r=null!=I&&I!==n?" (cast from the value `".concat(nh(I,!0),"`)."):".";return"mixed"!==t?"".concat(g," must be a `").concat(t,"` type, ")+"but the final value was: `".concat(nh(n,!0),"`")+r:"".concat(g," must match the configured type. ")+"The validated value was: `".concat(nh(n,!0),"`")+r}},ah={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},oh={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},ih={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},ch={isValue:"${path} field must be ${value}"},uh={noUnknown:"${path} field has unspecified keys: ${unknown}"},sh={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},Ah=function(e){var g=e.path,t=e.value,n=e.spec.types.length;if(Array.isArray(t)){if(t.length<n)return"".concat(g," tuple value has too few items, expected a length of ").concat(n," but got ").concat(t.length," for value: `").concat(nh(t,!0),"`");if(t.length>n)return"".concat(g," tuple value has too many items, expected a length of ").concat(n," but got ").concat(t.length," for value: `").concat(nh(t,!0),"`")}return Ch.formatError(lh.notType,e)},dh=(Object.assign(Object.create(null),{mixed:lh,string:ah,number:oh,date:ih,object:uh,array:sh,boolean:ch}),function(e){return e&&e.__isYupSchema__}),mh=function(){function e(g,t){it(this,e),this.fn=void 0,this.refs=g,this.refs=g,this.fn=t}return ut(e,[{key:"resolve",value:function(e,g){var t=this.refs.map((function(e){return e.getValue(null==g?void 0:g.value,null==g?void 0:g.parent,null==g?void 0:g.context)})),n=this.fn(t,e,g);if(void 0===n||n===e)return e;if(!dh(n))throw new TypeError("conditions must return a schema object");return n.resolve(g)}}],[{key:"fromOptions",value:function(g,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");var n=t.is,I=t.then,r=t.otherwise,C="function"===typeof n?n:function(){for(var e=arguments.length,g=new Array(e),t=0;t<e;t++)g[t]=arguments[t];return g.every((function(e){return e===n}))};return new e(g,(function(e,g){var t,n=C.apply(void 0,h(e))?I:r;return null!=(t=null==n?void 0:n(g))?t:g}))}}]),e}(),hh="$",bh=".";var Zh=function(){function e(g){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(it(this,e),this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,"string"!==typeof g)throw new TypeError("ref must be a string, got: "+g);if(this.key=g.trim(),""===g)throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===hh,this.isValue=this.key[0]===bh,this.isSibling=!this.isContext&&!this.isValue;var n=this.isContext?hh:this.isValue?bh:"";this.path=this.key.slice(n.length),this.getter=this.path&&(0,Dm.getter)(this.path,!0),this.map=t.map}return ut(e,[{key:"getValue",value:function(e,g,t){var n=this.isContext?t:this.isValue?e:g;return this.getter&&(n=this.getter(n||{})),this.map&&(n=this.map(n)),n}},{key:"cast",value:function(e,g){return this.getValue(e,null==g?void 0:g.parent,null==g?void 0:g.context)}},{key:"resolve",value:function(){return this}},{key:"describe",value:function(){return{type:"ref",key:this.key}}},{key:"toString",value:function(){return"Ref(".concat(this.key,")")}}],[{key:"isRef",value:function(e){return e&&e.__isYupRef}}]),e}();Zh.prototype.__isYupRef=!0;var ph=function(e){return null==e};function yh(e){function g(g,t,n){var I=g.value,r=g.path,C=void 0===r?"":r,l=g.options,a=g.originalValue,o=g.schema,i=e.name,c=e.test,u=e.params,s=e.message,A=e.skipAbsent,d=l.parent,m=l.context,h=l.abortEarly;function b(e){return Zh.isRef(e)?e.getValue(I,d,m):e}function Z(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=Object.assign({value:I,originalValue:a,label:o.spec.label,path:e.path||C,spec:o.spec},u,e.params),t=0,n=Object.keys(g);t<n.length;t++){var r=n[t];g[r]=b(g[r])}var l=new Ch(Ch.formatError(e.message||s,g),I,g.path,e.type||i);return l.params=g,l}var p=(void 0===h?o.spec.abortEarly:h)?t:n,y={path:C,parent:d,type:i,from:l.from,createError:Z,resolve:b,options:l,originalValue:a,schema:o},G=function(e){Ch.isError(e)?p(e):e?n(null):p(Z())},f=function(e){Ch.isError(e)?p(e):t(e)},B=A&&ph(I);if(l.sync){var v;try{var S;if("function"===typeof(null==(S=v=!!B||c.call(y,I,y))?void 0:S.then))throw new Error('Validation test of type: "'.concat(y.type,'" returned a Promise during a synchronous validate. ')+"This test will finish after the validate call has returned")}catch(W){return void f(W)}G(v)}else try{Promise.resolve(!!B||c.call(y,I,y)).then(G,f)}catch(W){f(W)}}return g.OPTIONS=e,g}function Gh(e,g,t){var n,I,r,C=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t;return g?((0,Dm.forEach)(g,(function(l,a,o){var i=a?l.slice(1,l.length-1):l,c="tuple"===(e=e.resolve({context:C,parent:n,value:t})).type,u=o?parseInt(i,10):0;if(e.innerType||c){if(c&&!o)throw new Error('Yup.reach cannot implicitly index into a tuple type. the path part "'.concat(r,'" must contain an index to the tuple element, e.g. "').concat(r,'[0]"'));if(t&&u>=t.length)throw new Error("Yup.reach cannot resolve an array item at index: ".concat(l,", in the path: ").concat(g,". ")+"because there is no value at that index. ");n=t,t=t&&t[u],e=c?e.spec.types[u]:e.innerType}if(!o){if(!e.fields||!e.fields[i])throw new Error("The schema does not contain the path: ".concat(g,". ")+"(failed at: ".concat(r,' which is a type: "').concat(e.type,'")'));n=t,t=t&&t[i],e=e.fields[i]}I=i,r=a?"["+l+"]":"."+l})),{schema:e,parent:n,parentPath:I}):{parent:n,parentPath:g,schema:e}}var fh=function(e){gn(t,e);var g=In(t);function t(){return it(this,t),g.apply(this,arguments)}return ut(t,[{key:"describe",value:function(){var e,g=[],t=Vn(this.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;g.push(Zh.isRef(n)?n.describe():n)}}catch(I){t.e(I)}finally{t.f()}return g}},{key:"resolveAll",value:function(e){var g,t=[],n=Vn(this.values());try{for(n.s();!(g=n.n()).done;){var I=g.value;t.push(e(I))}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"clone",value:function(){return new t(this.values())}},{key:"merge",value:function(e,g){var t=this.clone();return e.forEach((function(e){return t.add(e)})),g.forEach((function(e){return t.delete(e)})),t}}]),t}(Wn(Set));function Bh(e){var g,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map;if(dh(e)||!e||"object"!==typeof e)return e;if(t.has(e))return t.get(e);if(e instanceof Date)g=new Date(e.getTime()),t.set(e,g);else if(e instanceof RegExp)g=new RegExp(e),t.set(e,g);else if(Array.isArray(e)){g=new Array(e.length),t.set(e,g);for(var n=0;n<e.length;n++)g[n]=Bh(e[n],t)}else if(e instanceof Map){g=new Map,t.set(e,g);var I,r=Vn(e.entries());try{for(r.s();!(I=r.n()).done;){var C=c(I.value,2),l=C[0],a=C[1];g.set(l,Bh(a,t))}}catch(b){r.e(b)}finally{r.f()}}else if(e instanceof Set){g=new Set,t.set(e,g);var o,i=Vn(e);try{for(i.s();!(o=i.n()).done;){var u=o.value;g.add(Bh(u,t))}}catch(b){i.e(b)}finally{i.f()}}else{if(!(e instanceof Object))throw Error("Unable to clone ".concat(e));g={},t.set(e,g);for(var s=0,A=Object.entries(e);s<A.length;s++){var d=c(A[s],2),m=d[0],h=d[1];g[m]=Bh(h,t)}}return g}var vh=function(){function e(g){var t=this;it(this,e),this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new fh,this._blacklist=new fh,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation((function(){t.typeError(lh.notType)})),this.type=g.type,this._typeCheck=g.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,nullable:!1,optional:!0,coerce:!0},null==g?void 0:g.spec),this.withMutation((function(e){e.nonNullable()}))}return ut(e,[{key:"_type",get:function(){return this.type}},{key:"clone",value:function(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;var g=Object.create(Object.getPrototypeOf(this));return g.type=this.type,g._typeCheck=this._typeCheck,g._whitelist=this._whitelist.clone(),g._blacklist=this._blacklist.clone(),g.internalTests=Object.assign({},this.internalTests),g.exclusiveTests=Object.assign({},this.exclusiveTests),g.deps=h(this.deps),g.conditions=h(this.conditions),g.tests=h(this.tests),g.transforms=h(this.transforms),g.spec=Bh(Object.assign({},this.spec,e)),g}},{key:"label",value:function(e){var g=this.clone();return g.spec.label=e,g}},{key:"meta",value:function(){if(0===arguments.length)return this.spec.meta;var e=this.clone();return e.spec.meta=Object.assign(e.spec.meta||{},arguments.length<=0?void 0:arguments[0]),e}},{key:"withMutation",value:function(e){var g=this._mutate;this._mutate=!0;var t=e(this);return this._mutate=g,t}},{key:"concat",value:function(e){if(!e||e===this)return this;if(e.type!==this.type&&"mixed"!==this.type)throw new TypeError("You cannot `concat()` schema's of different types: ".concat(this.type," and ").concat(e.type));var g=this,t=e.clone(),n=Object.assign({},g.spec,t.spec);return t.spec=n,t.internalTests=Object.assign({},g.internalTests,t.internalTests),t._whitelist=g._whitelist.merge(e._whitelist,e._blacklist),t._blacklist=g._blacklist.merge(e._blacklist,e._whitelist),t.tests=g.tests,t.exclusiveTests=g.exclusiveTests,t.withMutation((function(g){e.tests.forEach((function(e){g.test(e.OPTIONS)}))})),t.transforms=[].concat(h(g.transforms),h(t.transforms)),t}},{key:"isType",value:function(e){return null==e?!(!this.spec.nullable||null!==e)||!(!this.spec.optional||void 0!==e):this._typeCheck(e)}},{key:"resolve",value:function(e){var g=this;if(g.conditions.length){var t=g.conditions;(g=g.clone()).conditions=[],g=(g=t.reduce((function(g,t){return t.resolve(g,e)}),g)).resolve(e)}return g}},{key:"resolveOptions",value:function(e){var g,t,n;return Object.assign({},e,{from:e.from||[],strict:null!=(g=e.strict)?g:this.spec.strict,abortEarly:null!=(t=e.abortEarly)?t:this.spec.abortEarly,recursive:null!=(n=e.recursive)?n:this.spec.recursive})}},{key:"cast",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=this.resolve(Object.assign({value:e},g)),n="ignore-optionality"===g.assert,I=t._cast(e,g);if(!1!==g.assert&&!t.isType(I)){if(n&&ph(I))return I;var r=nh(e),C=nh(I);throw new TypeError("The value of ".concat(g.path||"field"," could not be cast to a value ")+'that satisfies the schema type: "'.concat(t.type,'". \n\n')+"attempted value: ".concat(r," \n")+(C!==r?"result of cast: ".concat(C):""))}return I}},{key:"_cast",value:function(e,g){var t=this,n=void 0===e?e:this.transforms.reduce((function(g,n){return n.call(t,g,e,t)}),e);return void 0===n&&(n=this.getDefault(g)),n}},{key:"_validate",value:function(e){var g=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,I=arguments.length>3?arguments[3]:void 0,r=t.path,C=t.originalValue,l=void 0===C?e:C,a=t.strict,o=void 0===a?this.spec.strict:a,i=e;o||(i=this._cast(i,Object.assign({assert:!1},t)));for(var c=[],u=0,s=Object.values(this.internalTests);u<s.length;u++){var A=s[u];A&&c.push(A)}this.runTests({path:r,value:i,originalValue:l,options:t,tests:c},n,(function(e){if(e.length)return I(e,i);g.runTests({path:r,value:i,originalValue:l,options:t,tests:g.tests},n,I)}))}},{key:"runTests",value:function(e,g,t){var n=!1,I=e.tests,r=e.value,C=e.originalValue,l=e.path,a=e.options,o=function(e){n||(n=!0,g(e,r))},i=function(e){n||(n=!0,t(e,r))},c=I.length,u=[];if(!c)return i([]);for(var s={value:r,originalValue:C,path:l,options:a,schema:this},A=0;A<I.length;A++){(0,I[A])(s,o,(function(e){e&&(u=u.concat(e)),--c<=0&&i(u)}))}}},{key:"asNestedTest",value:function(e){var g,t=this,n=e.key,I=e.index,r=e.parent,l=e.parentPath,a=e.originalParent,o=e.options,i=null!=n?n:I;if(null==i)throw TypeError("Must include `key` or `index` for nested validations");var c="number"===typeof i,u=r[i],s=Object.assign({},o,(C(g={strict:!0,parent:r,value:u,originalValue:a[i],key:void 0},c?"index":"key",i),C(g,"path",c||i.includes(".")?"".concat(l||"","[").concat(u?i:'"'.concat(i,'"'),"]"):(l?"".concat(l,"."):"")+n),g));return function(e,g,n){return t.resolve(s)._validate(u,s,g,n)}}},{key:"validate",value:function(e,g){var t=this.resolve(Object.assign({},g,{value:e}));return new Promise((function(n,I){return t._validate(e,g,(function(e,g){Ch.isError(e)&&(e.value=g),I(e)}),(function(e,g){e.length?I(new Ch(e,g)):n(g)}))}))}},{key:"validateSync",value:function(e,g){var t;return this.resolve(Object.assign({},g,{value:e}))._validate(e,Object.assign({},g,{sync:!0}),(function(e,g){throw Ch.isError(e)&&(e.value=g),e}),(function(g,n){if(g.length)throw new Ch(g,e);t=n})),t}},{key:"isValid",value:function(e,g){return this.validate(e,g).then((function(){return!0}),(function(e){if(Ch.isError(e))return!1;throw e}))}},{key:"isValidSync",value:function(e,g){try{return this.validateSync(e,g),!0}catch(t){if(Ch.isError(t))return!1;throw t}}},{key:"_getDefault",value:function(e){var g=this.spec.default;return null==g?g:"function"===typeof g?g.call(this,e):Bh(g)}},{key:"getDefault",value:function(e){return this.resolve(e||{})._getDefault(e)}},{key:"default",value:function(e){return 0===arguments.length?this._getDefault():this.clone({default:e})}},{key:"strict",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.clone({strict:e})}},{key:"nullability",value:function(e,g){var t=this.clone({nullable:e});return t.internalTests.nullable=yh({message:g,name:"nullable",test:function(e){return null!==e||this.schema.spec.nullable}}),t}},{key:"optionality",value:function(e,g){var t=this.clone({optional:e});return t.internalTests.optionality=yh({message:g,name:"optionality",test:function(e){return void 0!==e||this.schema.spec.optional}}),t}},{key:"optional",value:function(){return this.optionality(!0)}},{key:"defined",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lh.defined;return this.optionality(!1,e)}},{key:"nullable",value:function(){return this.nullability(!0)}},{key:"nonNullable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lh.notNull;return this.nullability(!1,e)}},{key:"required",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lh.required;return this.clone().withMutation((function(g){return g.nonNullable(e).defined(e)}))}},{key:"notRequired",value:function(){return this.clone().withMutation((function(e){return e.nullable().optional()}))}},{key:"transform",value:function(e){var g=this.clone();return g.transforms.push(e),g}},{key:"test",value:function(){var e;if(void 0===(e=1===arguments.length?"function"===typeof(arguments.length<=0?void 0:arguments[0])?{test:arguments.length<=0?void 0:arguments[0]}:arguments.length<=0?void 0:arguments[0]:2===arguments.length?{name:arguments.length<=0?void 0:arguments[0],test:arguments.length<=1?void 0:arguments[1]}:{name:arguments.length<=0?void 0:arguments[0],message:arguments.length<=1?void 0:arguments[1],test:arguments.length<=2?void 0:arguments[2]}).message&&(e.message=lh.default),"function"!==typeof e.test)throw new TypeError("`test` is a required parameters");var g=this.clone(),t=yh(e),n=e.exclusive||e.name&&!0===g.exclusiveTests[e.name];if(e.exclusive&&!e.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return e.name&&(g.exclusiveTests[e.name]=!!e.exclusive),g.tests=g.tests.filter((function(g){if(g.OPTIONS.name===e.name){if(n)return!1;if(g.OPTIONS.test===t.OPTIONS.test)return!1}return!0})),g.tests.push(t),g}},{key:"when",value:function(e,g){Array.isArray(e)||"string"===typeof e||(g=e,e=".");var t=this.clone(),n=Ih(e).map((function(e){return new Zh(e)}));return n.forEach((function(e){e.isSibling&&t.deps.push(e.key)})),t.conditions.push("function"===typeof g?new mh(n,g):mh.fromOptions(n,g)),t}},{key:"typeError",value:function(e){var g=this.clone();return g.internalTests.typeError=yh({message:e,name:"typeError",skipAbsent:!0,test:function(e){return!!this.schema._typeCheck(e)||this.createError({params:{type:this.schema.type}})}}),g}},{key:"oneOf",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lh.oneOf,t=this.clone();return e.forEach((function(e){t._whitelist.add(e),t._blacklist.delete(e)})),t.internalTests.whiteList=yh({message:g,name:"oneOf",skipAbsent:!0,test:function(e){var g=this.schema._whitelist,t=g.resolveAll(this.resolve);return!!t.includes(e)||this.createError({params:{values:Array.from(g).join(", "),resolved:t}})}}),t}},{key:"notOneOf",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lh.notOneOf,t=this.clone();return e.forEach((function(e){t._blacklist.add(e),t._whitelist.delete(e)})),t.internalTests.blacklist=yh({message:g,name:"notOneOf",test:function(e){var g=this.schema._blacklist,t=g.resolveAll(this.resolve);return!t.includes(e)||this.createError({params:{values:Array.from(g).join(", "),resolved:t}})}}),t}},{key:"strip",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],g=this.clone();return g.spec.strip=e,g}},{key:"describe",value:function(e){var g=(e?this.resolve(e):this).clone(),t=g.spec,n=t.label;return{meta:t.meta,label:n,optional:t.optional,nullable:t.nullable,default:g.getDefault(e),type:g.type,oneOf:g._whitelist.describe(),notOneOf:g._blacklist.describe(),tests:g.tests.map((function(e){return{name:e.OPTIONS.name,params:e.OPTIONS.params}})).filter((function(e,g,t){return t.findIndex((function(g){return g.name===e.name}))===g}))}}}]),e}();vh.prototype.__isYupSchema__=!0;for(var Sh=function(){var e=Vh[Wh];vh.prototype["".concat(e,"At")]=function(g,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},I=Gh(this,g,t,n.context),r=I.parent,C=I.parentPath;return I.schema[e](r&&r[C],Object.assign({},n,{parent:r,path:g}))}},Wh=0,Vh=["validate","validateSync"];Wh<Vh.length;Wh++)Sh();for(var kh=0,Rh=["equals","is"];kh<Rh.length;kh++){var Xh=Rh[kh];vh.prototype[Xh]=vh.prototype.oneOf}for(var Jh=0,Yh=["not","nope"];Jh<Yh.length;Jh++){var wh=Yh[Jh];vh.prototype[wh]=vh.prototype.notOneOf}var Hh=function(){return!0};var Nh=function(e){gn(t,e);var g=In(t);function t(e){return it(this,t),g.call(this,"function"===typeof e?{type:"mixed",check:e}:Object.assign({type:"mixed",check:Hh},e))}return ut(t)}(vh);Nh.prototype;var Fh=function(e){gn(t,e);var g=In(t);function t(){var e;return it(this,t),e=g.call(this,{type:"boolean",check:function(e){return e instanceof Boolean&&(e=e.valueOf()),"boolean"===typeof e}}),e.withMutation((function(){e.transform((function(e,g,t){if(t.spec.coerce&&!t.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e}))})),e}return ut(t,[{key:"isTrue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ch.isValue;return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test:function(e){return ph(e)||!0===e}})}},{key:"isFalse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ch.isValue;return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test:function(e){return ph(e)||!1===e}})}},{key:"default",value:function(e){return en($t(t.prototype),"default",this).call(this,e)}},{key:"defined",value:function(e){return en($t(t.prototype),"defined",this).call(this,e)}},{key:"optional",value:function(){return en($t(t.prototype),"optional",this).call(this)}},{key:"required",value:function(e){return en($t(t.prototype),"required",this).call(this,e)}},{key:"notRequired",value:function(){return en($t(t.prototype),"notRequired",this).call(this)}},{key:"nullable",value:function(){return en($t(t.prototype),"nullable",this).call(this)}},{key:"nonNullable",value:function(e){return en($t(t.prototype),"nonNullable",this).call(this,e)}},{key:"strip",value:function(e){return en($t(t.prototype),"strip",this).call(this,e)}}]),t}(vh);Fh.prototype;var Kh=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,xh=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,Eh=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Mh=function(e){return ph(e)||e===e.trim()},zh={}.toString();function Uh(){return new Qh}var Qh=function(e){gn(t,e);var g=In(t);function t(){var e;return it(this,t),(e=g.call(this,{type:"string",check:function(e){return e instanceof String&&(e=e.valueOf()),"string"===typeof e}})).withMutation((function(){e.transform((function(e,g,t){if(!t.spec.coerce||t.isType(e))return e;if(Array.isArray(e))return e;var n=null!=e&&e.toString?e.toString():e;return n===zh?e:n}))})),e}return ut(t,[{key:"required",value:function(e){return en($t(t.prototype),"required",this).call(this,e).withMutation((function(g){return g.test({message:e||lh.required,name:"required",skipAbsent:!0,test:function(e){return!!e.length}})}))}},{key:"notRequired",value:function(){return en($t(t.prototype),"notRequired",this).call(this).withMutation((function(e){return e.tests=e.tests.filter((function(e){return"required"!==e.OPTIONS.name})),e}))}},{key:"length",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ah.length;return this.test({message:g,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test:function(g){return g.length===this.resolve(e)}})}},{key:"min",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ah.min;return this.test({message:g,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(g){return g.length>=this.resolve(e)}})}},{key:"max",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ah.max;return this.test({name:"max",exclusive:!0,message:g,params:{max:e},skipAbsent:!0,test:function(g){return g.length<=this.resolve(e)}})}},{key:"matches",value:function(e,g){var t,n,I=!1;if(g)if("object"===typeof g){var r=g.excludeEmptyString;I=void 0!==r&&r,t=g.message,n=g.name}else t=g;return this.test({name:n||"matches",message:t||ah.matches,params:{regex:e},skipAbsent:!0,test:function(g){return""===g&&I||-1!==g.search(e)}})}},{key:"email",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.email;return this.matches(Kh,{name:"email",message:e,excludeEmptyString:!0})}},{key:"url",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.url;return this.matches(xh,{name:"url",message:e,excludeEmptyString:!0})}},{key:"uuid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.uuid;return this.matches(Eh,{name:"uuid",message:e,excludeEmptyString:!1})}},{key:"ensure",value:function(){return this.default("").transform((function(e){return null===e?"":e}))}},{key:"trim",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.trim;return this.transform((function(e){return null!=e?e.trim():e})).test({message:e,name:"trim",test:Mh})}},{key:"lowercase",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.lowercase;return this.transform((function(e){return ph(e)?e:e.toLowerCase()})).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(e){return ph(e)||e===e.toLowerCase()}})}},{key:"uppercase",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ah.uppercase;return this.transform((function(e){return ph(e)?e:e.toUpperCase()})).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:function(e){return ph(e)||e===e.toUpperCase()}})}}]),t}(vh);Uh.prototype=Qh.prototype;var Lh=function(e){gn(t,e);var g=In(t);function t(){var e;return it(this,t),(e=g.call(this,{type:"number",check:function(e){return e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&!function(e){return e!=+e}(e)}})).withMutation((function(){e.transform((function(e,g,t){if(!t.spec.coerce)return e;var n=e;if("string"===typeof n){if(""===(n=n.replace(/\s/g,"")))return NaN;n=+n}return t.isType(n)||null===n?n:parseFloat(n)}))})),e}return ut(t,[{key:"min",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.min;return this.test({message:g,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(g){return g>=this.resolve(e)}})}},{key:"max",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.max;return this.test({message:g,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(g){return g<=this.resolve(e)}})}},{key:"lessThan",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.lessThan;return this.test({message:g,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test:function(g){return g<this.resolve(e)}})}},{key:"moreThan",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oh.moreThan;return this.test({message:g,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test:function(g){return g>this.resolve(e)}})}},{key:"positive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oh.positive;return this.moreThan(0,e)}},{key:"negative",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oh.negative;return this.lessThan(0,e)}},{key:"integer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:oh.integer;return this.test({name:"integer",message:e,skipAbsent:!0,test:function(e){return Number.isInteger(e)}})}},{key:"truncate",value:function(){return this.transform((function(e){return ph(e)?e:0|e}))}},{key:"round",value:function(e){var g,t=["ceil","floor","round","trunc"];if("trunc"===(e=(null==(g=e)?void 0:g.toLowerCase())||"round"))return this.truncate();if(-1===t.indexOf(e.toLowerCase()))throw new TypeError("Only valid options for round() are: "+t.join(", "));return this.transform((function(g){return ph(g)?g:Math[e](g)}))}}]),t}(vh);Lh.prototype;var Th=/^(\d{4}|[+\-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,\.](\d{1,}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;var Dh=new Date("");function jh(){return new Ph}var Ph=function(e){gn(t,e);var g=In(t);function t(){var e;return it(this,t),e=g.call(this,{type:"date",check:function(e){return g=e,"[object Date]"===Object.prototype.toString.call(g)&&!isNaN(e.getTime());var g}}),e.withMutation((function(){e.transform((function(e,g,n){return!n.spec.coerce||n.isType(e)||null===e?e:(e=function(e){var g,t,n=[1,4,5,6,7,10,11],I=0;if(t=Th.exec(e)){for(var r,C=0;r=n[C];++C)t[r]=+t[r]||0;t[2]=(+t[2]||1)-1,t[3]=+t[3]||1,t[7]=t[7]?String(t[7]).substr(0,3):0,void 0!==t[8]&&""!==t[8]||void 0!==t[9]&&""!==t[9]?("Z"!==t[8]&&void 0!==t[9]&&(I=60*t[10]+t[11],"+"===t[9]&&(I=0-I)),g=Date.UTC(t[1],t[2],t[3],t[4],t[5]+I,t[6],t[7])):g=+new Date(t[1],t[2],t[3],t[4],t[5],t[6],t[7])}else g=Date.parse?Date.parse(e):NaN;return g}(e),isNaN(e)?t.INVALID_DATE:new Date(e))}))})),e}return ut(t,[{key:"prepareParam",value:function(e,g){var t;if(Zh.isRef(e))t=e;else{var n=this.cast(e);if(!this._typeCheck(n))throw new TypeError("`".concat(g,"` must be a Date or a value that can be `cast()` to a Date"));t=n}return t}},{key:"min",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ih.min,t=this.prepareParam(e,"min");return this.test({message:g,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(e){return e>=this.resolve(t)}})}},{key:"max",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ih.max,t=this.prepareParam(e,"max");return this.test({message:g,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(e){return e<=this.resolve(t)}})}}]),t}(vh);function Oh(e,g){var t=1/0;return e.some((function(e,n){var I;if(null!=(I=g.path)&&I.includes(e))return t=n,!0})),t}function _h(e){return function(g,t){return Oh(e,g)-Oh(e,t)}}Ph.INVALID_DATE=Dh,jh.prototype=Ph.prototype,jh.INVALID_DATE=Dh;var qh=function(e,g,t){if("string"!==typeof e)return e;var n=e;try{n=JSON.parse(e)}catch(I){}return t.isType(n)?n:e};function $h(e){if("fields"in e){for(var g={},t=0,n=Object.entries(e.fields);t<n.length;t++){var I=c(n[t],2),r=I[0],C=I[1];g[r]=$h(C)}return e.setFields(g)}if("array"===e.type){var l=e.optional();return l.innerType&&(l.innerType=$h(l.innerType)),l}return"tuple"===e.type?e.optional().clone({types:e.spec.types.map($h)}):"optional"in e?e.optional():e}var eb=function(e){return"[object Object]"===Object.prototype.toString.call(e)};var gb=_h([]);function tb(e){return new nb(e)}var nb=function(e){gn(t,e);var g=In(t);function t(e){var n;return it(this,t),(n=g.call(this,{type:"object",check:function(e){return eb(e)||"function"===typeof e}})).fields=Object.create(null),n._sortErrors=gb,n._nodes=[],n._excludedEdges=[],n.withMutation((function(){e&&n.shape(e)})),n}return ut(t,[{key:"_cast",value:function(e){var g,n=this,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=en($t(t.prototype),"_cast",this).call(this,e,I);if(void 0===r)return this.getDefault(I);if(!this._typeCheck(r))return r;var C,l=this.fields,a=null!=(g=I.stripUnknown)?g:this.spec.noUnknown,o=[].concat(this._nodes,Object.keys(r).filter((function(e){return!n._nodes.includes(e)}))),i={},c=Object.assign({},I,{parent:i,__validating:I.__validating||!1}),u=!1,s=Vn(o);try{for(s.s();!(C=s.n()).done;){var A=C.value,d=l[A],m=A in r;if(d){var h,b=r[A];c.path=(I.path?"".concat(I.path,"."):"")+A;var Z=(d=d.resolve({value:b,context:I.context,parent:i}))instanceof vh?d.spec:void 0,p=null==Z?void 0:Z.strict;if(null!=Z&&Z.strip){u=u||A in r;continue}void 0!==(h=I.__validating&&p?r[A]:d.cast(r[A],c))&&(i[A]=h)}else m&&!a&&(i[A]=r[A]);m===A in i&&i[A]===r[A]||(u=!0)}}catch(y){s.e(y)}finally{s.f()}return u?i:r}},{key:"_validate",value:function(e){var g=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},I=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,C=n.from,l=void 0===C?[]:C,a=n.originalValue,o=void 0===a?e:a,i=n.recursive,c=void 0===i?this.spec.recursive:i;n.from=[{schema:this,value:o}].concat(h(l)),n.__validating=!0,n.originalValue=o,en($t(t.prototype),"_validate",this).call(this,e,n,I,(function(e,t){if(c&&eb(t)){o=o||t;var C,l=[],a=Vn(g._nodes);try{for(a.s();!(C=a.n()).done;){var i=C.value,u=g.fields[i];u&&!Zh.isRef(u)&&l.push(u.asNestedTest({options:n,key:i,parent:t,parentPath:n.path,originalParent:o}))}}catch(s){a.e(s)}finally{a.f()}g.runTests({tests:l,value:t,originalValue:o,options:n},I,(function(n){r(n.sort(g._sortErrors).concat(e),t)}))}else r(e,t)}))}},{key:"clone",value:function(e){var g=en($t(t.prototype),"clone",this).call(this,e);return g.fields=Object.assign({},this.fields),g._nodes=this._nodes,g._excludedEdges=this._excludedEdges,g._sortErrors=this._sortErrors,g}},{key:"concat",value:function(e){for(var g=this,n=en($t(t.prototype),"concat",this).call(this,e),I=n.fields,r=0,C=Object.entries(this.fields);r<C.length;r++){var l=c(C[r],2),a=l[0],o=l[1],i=I[a];I[a]=void 0===i?o:i}return n.withMutation((function(t){return t.setFields(I,[].concat(h(g._excludedEdges),h(e._excludedEdges)))}))}},{key:"_getDefault",value:function(e){var g=this;if("default"in this.spec)return en($t(t.prototype),"_getDefault",this).call(this,e);if(this._nodes.length){var n={};return this._nodes.forEach((function(t){var I,r=g.fields[t],C=e;null!=(I=C)&&I.value&&(C=Object.assign({},C,{parent:C.value,value:C.value[t]})),n[t]=r&&"getDefault"in r?r.getDefault(C):void 0})),n}}},{key:"setFields",value:function(e,g){var t=this.clone();return t.fields=e,t._nodes=function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=[],n=new Set,I=new Set(g.map((function(e){var g=c(e,2),t=g[0],n=g[1];return"".concat(t,"-").concat(n)})));function r(e,g){var r=(0,Dm.split)(e)[0];n.add(r),I.has("".concat(g,"-").concat(r))||t.push([g,r])}for(var C=function(){var g=a[l],t=e[g];n.add(g),Zh.isRef(t)&&t.isSibling?r(t.path,g):dh(t)&&"deps"in t&&t.deps.forEach((function(e){return r(e,g)}))},l=0,a=Object.keys(e);l<a.length;l++)C();return Om().array(Array.from(n),t).reverse()}(e,g),t._sortErrors=_h(Object.keys(e)),g&&(t._excludedEdges=g),t}},{key:"shape",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return this.clone().withMutation((function(t){var n=t._excludedEdges;return g.length&&(Array.isArray(g[0])||(g=[g]),n=[].concat(h(t._excludedEdges),h(g))),t.setFields(Object.assign(t.fields,e),n)}))}},{key:"partial",value:function(){for(var e={},g=0,t=Object.entries(this.fields);g<t.length;g++){var n=c(t[g],2),I=n[0],r=n[1];e[I]="optional"in r&&r.optional instanceof Function?r.optional():r}return this.setFields(e)}},{key:"deepPartial",value:function(){return $h(this)}},{key:"pick",value:function(e){var g,t={},n=Vn(e);try{for(n.s();!(g=n.n()).done;){var I=g.value;this.fields[I]&&(t[I]=this.fields[I])}}catch(r){n.e(r)}finally{n.f()}return this.setFields(t)}},{key:"omit",value:function(e){var g,t=Object.assign({},this.fields),n=Vn(e);try{for(n.s();!(g=n.n()).done;){delete t[g.value]}}catch(I){n.e(I)}finally{n.f()}return this.setFields(t)}},{key:"from",value:function(e,g,t){var n=(0,Dm.getter)(e,!0);return this.transform((function(I){if(!I)return I;var r=I;return function(e,g){var t=h((0,Dm.normalizePath)(g));if(1===t.length)return t[0]in e;var n=t.pop(),I=(0,Dm.getter)((0,Dm.join)(t),!0)(e);return!(!I||!(n in I))}(I,e)&&(r=Object.assign({},I),t||delete r[e],r[g]=n(I)),r}))}},{key:"json",value:function(){return this.transform(qh)}},{key:"noUnknown",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uh.noUnknown;"boolean"!==typeof e&&(g=e,e=!0);var t=this.test({name:"noUnknown",exclusive:!0,message:g,test:function(g){if(null==g)return!0;var t=function(e,g){var t=Object.keys(e.fields);return Object.keys(g).filter((function(e){return-1===t.indexOf(e)}))}(this.schema,g);return!e||0===t.length||this.createError({params:{unknown:t.join(", ")}})}});return t.spec.noUnknown=e,t}},{key:"unknown",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uh.noUnknown;return this.noUnknown(!e,g)}},{key:"transformKeys",value:function(e){return this.transform((function(g){if(!g)return g;for(var t={},n=0,I=Object.keys(g);n<I.length;n++){var r=I[n];t[e(r)]=g[r]}return t}))}},{key:"camelCase",value:function(){return this.transformKeys(jm.camelCase)}},{key:"snakeCase",value:function(){return this.transformKeys(jm.snakeCase)}},{key:"constantCase",value:function(){return this.transformKeys((function(e){return(0,jm.snakeCase)(e).toUpperCase()}))}},{key:"describe",value:function(e){var g=en($t(t.prototype),"describe",this).call(this,e);g.fields={};for(var n=0,I=Object.entries(this.fields);n<I.length;n++){var r,C=c(I[n],2),l=C[0],a=C[1],o=e;null!=(r=o)&&r.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[l]})),g.fields[l]=a.describe(o)}return g}}]),t}(vh);tb.prototype=nb.prototype;var Ib=function(e){gn(t,e);var g=In(t);function t(e){var n;return it(this,t),n=g.call(this,{type:"array",spec:{types:e},check:function(e){return Array.isArray(e)}}),n.innerType=void 0,n.innerType=e,n}return ut(t,[{key:"_cast",value:function(e,g){var n=this,I=en($t(t.prototype),"_cast",this).call(this,e,g);if(!this._typeCheck(I)||!this.innerType)return I;var r=!1,C=I.map((function(e,t){var I=n.innerType.cast(e,Object.assign({},g,{path:"".concat(g.path||"","[").concat(t,"]")}));return I!==e&&(r=!0),I}));return r?C:I}},{key:"_validate",value:function(e){var g,n=this,I=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,C=arguments.length>3?arguments[3]:void 0,l=this.innerType,a=null!=(g=I.recursive)?g:this.spec.recursive;null!=I.originalValue&&I.originalValue,en($t(t.prototype),"_validate",this).call(this,e,I,r,(function(g,t){var o;if(a&&l&&n._typeCheck(t)){for(var i=new Array(t.length),c=0;c<t.length;c++){var u;i[c]=l.asNestedTest({options:I,index:c,parent:t,parentPath:I.path,originalParent:null!=(u=I.originalValue)?u:e})}n.runTests({value:t,tests:i,originalValue:null!=(o=I.originalValue)?o:e,options:I},r,(function(e){return C(e.concat(g),t)}))}else C(g,t)}))}},{key:"clone",value:function(e){var g=en($t(t.prototype),"clone",this).call(this,e);return g.innerType=this.innerType,g}},{key:"json",value:function(){return this.transform(qh)}},{key:"concat",value:function(e){var g=en($t(t.prototype),"concat",this).call(this,e);return g.innerType=this.innerType,e.innerType&&(g.innerType=g.innerType?g.innerType.concat(e.innerType):e.innerType),g}},{key:"of",value:function(e){var g=this.clone();if(!dh(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+nh(e));return g.innerType=e,g.spec=Object.assign({},g.spec,{types:e}),g}},{key:"length",value:function(e){var g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sh.length;return this.test({message:g,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test:function(g){return g.length===this.resolve(e)}})}},{key:"min",value:function(e,g){return g=g||sh.min,this.test({message:g,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test:function(g){return g.length>=this.resolve(e)}})}},{key:"max",value:function(e,g){return g=g||sh.max,this.test({message:g,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test:function(g){return g.length<=this.resolve(e)}})}},{key:"ensure",value:function(){var e=this;return this.default((function(){return[]})).transform((function(g,t){return e._typeCheck(g)?g:null==t?[]:[].concat(t)}))}},{key:"compact",value:function(e){var g=e?function(g,t,n){return!e(g,t,n)}:function(e){return!!e};return this.transform((function(e){return null!=e?e.filter(g):e}))}},{key:"describe",value:function(e){var g=en($t(t.prototype),"describe",this).call(this,e);if(this.innerType){var n,I=e;null!=(n=I)&&n.value&&(I=Object.assign({},I,{parent:I.value,value:I.value[0]})),g.innerType=this.innerType.describe(I)}return g}}]),t}(vh);Ib.prototype;var rb=function(e){gn(t,e);var g=In(t);function t(e){var n;return it(this,t),n=g.call(this,{type:"tuple",spec:{types:e},check:function(e){var g=this.spec.types;return Array.isArray(e)&&e.length===g.length}}),n.withMutation((function(){n.typeError(Ah)})),n}return ut(t,[{key:"_cast",value:function(e,g){var n=this.spec.types,I=en($t(t.prototype),"_cast",this).call(this,e,g);if(!this._typeCheck(I))return I;var r=!1,C=n.map((function(e,t){var n=e.cast(I[t],Object.assign({},g,{path:"".concat(g.path||"","[").concat(t,"]")}));return n!==I[t]&&(r=!0),n}));return r?C:I}},{key:"_validate",value:function(e){var g=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},I=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,C=this.spec.types;en($t(t.prototype),"_validate",this).call(this,e,n,I,(function(t,l){var a;if(g._typeCheck(l)){var o,i=[],u=Vn(C.entries());try{for(u.s();!(o=u.n()).done;){var s,A=c(o.value,2),d=A[0],m=A[1];i[d]=m.asNestedTest({options:n,index:d,parent:l,parentPath:n.path,originalParent:null!=(s=n.originalValue)?s:e})}}catch(h){u.e(h)}finally{u.f()}g.runTests({value:l,tests:i,originalValue:null!=(a=n.originalValue)?a:e,options:n},I,(function(e){return r(e.concat(t),l)}))}else r(t,l)}))}},{key:"describe",value:function(e){var g=en($t(t.prototype),"describe",this).call(this,e);return g.innerType=this.spec.types.map((function(g,t){var n,I=e;return null!=(n=I)&&n.value&&(I=Object.assign({},I,{parent:I.value,value:I.value[t]})),g.describe(I)})),g}}]),t}(vh);rb.prototype;var Cb,lb={height:300,width:300,display:"flex",justifycontent:"center",alignitem:"center"},ab=tb().shape({product_code:Uh().required("Product_Code is required"),shipment_id:Uh().required("Shipment_Name is required")}),ob=function(){var g=c((0,e.useState)([]),2),t=g[0],n=g[1],I=Wc(),r=I.addProductToTraceShipment,C=I.getShipments,l=I.currentAccount,a=c((0,e.useState)(!1),2),o=a[0],i=a[1],u=c((0,e.useState)(null),2),A=u[0],d=u[1];(0,e.useEffect)((function(){A||h()}),[A]),(0,e.useEffect)((function(){l&&m()}),[l]);var m=function(){var e=Cr(Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C();case 3:g=e.sent,n(g),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),h=function(){var e=Cr(Ir().mark((function e(){var g,t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,g={video:{facingMode:"environment",width:640,height:480}},e.next=4,navigator.mediaDevices.getUserMedia(g);case 4:t=e.sent,d(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Cr(Ir().mark((function e(g){var t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(g),e.prev=1,i(!0),t=s({},g),e.next=6,r(t);case 6:_.success("Successfully Added To Shipment!"),i(!1),W(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),_.error(e.t0.message),i(!1);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(g){return e.apply(this,arguments)}}(),Z=Km({onSubmit:b,initialValues:{product_code:"",shipment_id:""},validationSchema:ab}),p=Z.values,y=Z.errors,G=Z.touched,f=Z.handleBlur,B=Z.handleChange,v=Z.handleSubmit,S=Z.setFieldValue,W=Z.resetForm;return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{style:{width:"300px",height:"300px",marginTop:"-110px",paddingLeft:"500px",paddingTop:"0px"},children:(0,q.jsx)(vu(),{delay:100,style:lb,onError:function(e){_.error(e)},onScan:function(e){e&&S("product_code",e.text)}})}),(0,q.jsx)("div",{children:(0,q.jsxs)(pu,{onSubmit:v,children:[(0,q.jsxs)(fu,{children:[(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{name:"product_code",id:"product_code",placeholder:"Product_Code",onChange:B,onBlur:f,value:p.product_code,readOnly:!0}),(0,q.jsx)("small",{className:"text-danger",children:G.product_code&&y.product_code})]})}),(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsxs)(Lc,{as:"select",name:"shipment_id",placeholder:"Shipment_Name",id:"shipment_id",onChange:B,onBlur:f,value:p.shipment_id,children:[(0,q.jsx)("option",{defaultValue:"",children:"Select Shipment"}),t.map((function(e,g){return(0,q.jsx)("option",{value:g,children:e.shipment_name},g)}))]}),(0,q.jsx)("small",{className:"text-danger",children:G.shipment_id&&y.shipment_id})]})})]}),(0,q.jsx)(Pc,{className:"text-end",children:(0,q.jsx)(or,{type:"submit",disabled:o,children:o?"Loading...":"Save"})})]})})]})};function ib(e){if((!Cb&&0!==Cb||e)&&Vg){var g=document.createElement("div");g.style.position="absolute",g.style.top="-9999px",g.style.width="50px",g.style.height="50px",g.style.overflow="scroll",document.body.appendChild(g),Cb=g.offsetWidth-g.clientWidth,document.body.removeChild(g)}return Cb}var cb=De("modal-body"),ub=["bsPrefix","className","contentClassName","centered","size","fullscreen","children","scrollable"],sb=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.contentClassName,r=e.centered,C=e.size,l=e.fullscreen,a=e.children,o=e.scrollable,i=d(e,ub);t=Fe(t,"modal");var c="".concat(t,"-dialog"),u="string"===typeof l?"".concat(t,"-fullscreen-").concat(l):"".concat(t,"-fullscreen");return(0,q.jsx)("div",s(s({},i),{},{ref:g,className:ge()(c,n,C&&"".concat(t,"-").concat(C),r&&"".concat(c,"-centered"),o&&"".concat(c,"-scrollable"),l&&u),children:(0,q.jsx)("div",{className:ge()("".concat(t,"-content"),I),children:a})}))}));sb.displayName="ModalDialog";var Ab=sb,db=De("modal-footer"),mb=["bsPrefix","className","closeLabel","closeButton"],hb=e.forwardRef((function(e,g){var t=e.bsPrefix,n=e.className,I=e.closeLabel,r=void 0===I?"Close":I,C=e.closeButton,l=void 0!==C&&C,a=d(e,mb);return t=Fe(t,"modal-header"),(0,q.jsx)(Dt,s(s({ref:g},a),{},{className:ge()(n,t),closeLabel:r,closeButton:l}))}));hb.displayName="ModalHeader";var bb=hb,Zb=De("modal-title",{Component:_t("h4")}),pb=["bsPrefix","className","style","dialogClassName","contentClassName","children","dialogAs","aria-labelledby","aria-describedby","aria-label","show","animation","backdrop","keyboard","onEscapeKeyDown","onShow","onHide","container","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","onEntered","onExit","onExiting","onEnter","onEntering","onExited","backdropClassName","manager"];function yb(e){return(0,q.jsx)(Jt,s(s({},e),{},{timeout:null}))}function Gb(e){return(0,q.jsx)(Jt,s(s({},e),{},{timeout:null}))}var fb=e.forwardRef((function(g,t){var n=g.bsPrefix,I=g.className,r=g.style,C=g.dialogClassName,l=g.contentClassName,a=g.children,o=g.dialogAs,i=void 0===o?Ab:o,u=g["aria-labelledby"],A=g["aria-describedby"],m=g["aria-label"],h=g.show,b=void 0!==h&&h,Z=g.animation,p=void 0===Z||Z,y=g.backdrop,G=void 0===y||y,f=g.keyboard,B=void 0===f||f,v=g.onEscapeKeyDown,S=g.onShow,W=g.onHide,V=g.container,k=g.autoFocus,R=void 0===k||k,X=g.enforceFocus,J=void 0===X||X,Y=g.restoreFocus,w=void 0===Y||Y,H=g.restoreFocusOptions,N=g.onEntered,F=g.onExit,K=g.onExiting,x=g.onEnter,E=g.onEntering,M=g.onExited,z=g.backdropClassName,U=g.manager,Q=d(g,pb),L=c((0,e.useState)({}),2),T=L[0],D=L[1],j=c((0,e.useState)(!1),2),P=j[0],O=j[1],_=(0,e.useRef)(!1),$=(0,e.useRef)(!1),ee=(0,e.useRef)(null),te=c((0,e.useState)(null),2),ne=te[0],Ie=te[1],re=ue(t,Ie),Ce=ye(W),le="rtl"===(0,e.useContext)(Ne).dir;n=Fe(n,"modal");var ae=(0,e.useMemo)((function(){return{onHide:Ce}}),[Ce]);function oe(){return U||un({isRTL:le})}function ie(e){if(Vg){var g=oe().getScrollbarWidth()>0,t=e.scrollHeight>og(e).documentElement.clientHeight;D({paddingRight:g&&!t?ib():void 0,paddingLeft:!g&&t?ib():void 0})}}var ce=ye((function(){ne&&ie(ne.dialog)}));ot((function(){Yg(window,"resize",ce),null==ee.current||ee.current()}));var se=function(){_.current=!0},Ae=function(e){_.current&&ne&&e.target===ne.dialog&&($.current=!0),_.current=!1},de=function(){O(!0),ee.current=Ng(ne.dialog,(function(){O(!1)}))},me=function(e){"static"!==G?$.current||e.target!==e.currentTarget?$.current=!1:null==W||W():function(e){e.target===e.currentTarget&&de()}(e)},he=(0,e.useCallback)((function(e){return(0,q.jsx)("div",s(s({},e),{},{className:ge()("".concat(n,"-backdrop"),z,!p&&"show")}))}),[p,z,n]),be=s(s({},r),T);be.display="block";return(0,q.jsx)(Kt.Provider,{value:ae,children:(0,q.jsx)(Wt,{show:b,ref:re,backdrop:G,container:V,keyboard:!0,autoFocus:R,enforceFocus:J,restoreFocus:w,restoreFocusOptions:H,onEscapeKeyDown:function(e){B?null==v||v(e):(e.preventDefault(),"static"===G&&de())},onShow:S,onHide:W,onEnter:function(e,g){e&&ie(e),null==x||x(e,g)},onEntering:function(e,g){null==E||E(e,g),Jg(window,"resize",ce)},onEntered:N,onExit:function(e){null==ee.current||ee.current(),null==F||F(e)},onExiting:K,onExited:function(e){e&&(e.style.display=""),null==M||M(e),Yg(window,"resize",ce)},manager:oe(),transition:p?yb:void 0,backdropTransition:p?Gb:void 0,renderBackdrop:he,renderDialog:function(e){return(0,q.jsx)("div",s(s({role:"dialog"},e),{},{style:be,className:ge()(I,n,P&&"".concat(n,"-static"),!p&&"show"),onClick:G?me:void 0,onMouseUp:Ae,"aria-label":m,"aria-labelledby":u,"aria-describedby":A,children:(0,q.jsx)(i,s(s({},Q),{},{onMouseDown:se,className:C,contentClassName:l,children:a}))}))}})})}));fb.displayName="Modal";var Bb=Object.assign(fb,{Body:cb,Header:bb,Title:Zb,Footer:db,Dialog:Ab,TRANSITION_DURATION:300,BACKDROP_TRANSITION_DURATION:150}),vb=tb().shape({shipment_name:Uh().required("Shipment Code is required"),shipment_country:Uh().required("Recipient's Name is required"),shipment_address:Uh().required("Address is required"),sending_date:Uh().required("Sending date is required"),receiving_date:Uh().required("Receiving date is required")}),Sb=function(){var g=c((0,e.useState)([]),2),t=g[0],n=g[1],I=c((0,e.useState)(!1),2),r=I[0],C=I[1],l=Wc(),a=l.getShipments,o=l.currentAccount,i=l.AddShipment,u=c((0,e.useState)(!1),2),A=u[0],d=u[1],m=function(){d(!1),v()};(0,e.useEffect)((function(){o&&h()}),[o]);var h=function(){var e=Cr(Ir().mark((function e(){var g;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a();case 3:g=e.sent,n(g),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),_.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=Cr(Ir().mark((function e(g){var t;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C(!0),t=s(s({},g),{},{sending_date:yc()(g.sending_date).valueOf(),receiving_date:yc()(g.receiving_date).valueOf()}),e.next=5,i(t);case 5:e.sent,_.success("Successfully Added!"),m(),v(),h(),C(!1),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),_.error(e.t0.message),C(!1);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(g){return e.apply(this,arguments)}}(),Z=Km({onSubmit:b,initialValues:{shipment_name:"",shipment_country:"",shipment_address:"",sending_date:"",receiving_date:""},validationSchema:vb}),p=Z.errors,y=Z.touched,G=Z.handleBlur,f=Z.handleChange,B=Z.handleSubmit,v=Z.resetForm;return(0,q.jsxs)("div",{style:{marginTop:"100px"},children:[o&&(0,q.jsx)("div",{className:"mb-3",children:(0,q.jsx)(or,{onClick:function(){return d(!0)},children:"Add Shipment"})}),(0,q.jsxs)(ur,{striped:!0,bordered:!0,hover:!0,children:[(0,q.jsx)("thead",{children:(0,q.jsxs)("tr",{children:[(0,q.jsx)("th",{children:"Id"}),(0,q.jsx)("th",{children:"Code"}),(0,q.jsx)("th",{children:"Recipient's Name"}),(0,q.jsx)("th",{children:"Address"}),(0,q.jsx)("th",{children:"Sending_date"}),(0,q.jsx)("th",{children:"Receiving_date"})]})}),(0,q.jsx)("tbody",{children:t.map((function(e,g){return(0,q.jsxs)("tr",{children:[(0,q.jsx)("td",{children:g+1}),(0,q.jsx)("td",{children:e.shipment_name}),(0,q.jsx)("td",{children:e.shipment_country}),(0,q.jsx)("td",{children:e.shipment_address}),(0,q.jsx)("td",{children:yc()(Number(String(e.sending_date))).format("YYYY-MM-DD")}),(0,q.jsx)("td",{children:yc()(Number(String(e.receiving_date))).format("YYYY-MM-DD")})]},g)}))})]}),(0,q.jsxs)(Bb,{show:A,onHide:m,children:[(0,q.jsx)(Bb.Header,{closeButton:!0,children:(0,q.jsx)(Bb.Title,{children:"Add Shipment"})}),(0,q.jsx)(Bb.Body,{children:(0,q.jsxs)(pu,{onSubmit:B,children:[(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"shipment_name",id:"shipment_name",placeholder:"code",onChange:f,onBlur:G}),(0,q.jsx)("small",{className:"text-danger",children:y.shipment_name&&p.shipment_name})]}),(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"shipment_country",id:"shipment_country",placeholder:"Country",onChange:f,onBlur:G}),(0,q.jsx)("small",{className:"text-danger",children:y.shipment_country&&p.shipment_country})]}),(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"shipment_address",id:"shipment_address",placeholder:"Address",onChange:f,onBlur:G}),(0,q.jsx)("small",{className:"text-danger",children:y.shipment_address&&p.shipment_address})]}),(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"date",name:"sending_date",id:"sending_date",placeholder:"Sending date",onChange:f,onBlur:G}),(0,q.jsx)("small",{className:"text-danger",children:y.sending_date&&p.sending_date})]}),(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"date",name:"receiving_date",id:"receiving_date",placeholder:"Receiving date",onChange:f,onBlur:G}),(0,q.jsx)("small",{className:"text-danger",children:y.receiving_date&&p.receiving_date})]}),(0,q.jsxs)(Pc,{children:[(0,q.jsx)(or,{variant:"secondary",onClick:m,children:"Close"})," ",(0,q.jsx)(or,{variant:"primary",type:"submit",disabled:r,children:r?"Loading":"Save"})]})]})})]})]})},Wb=function(){var g=Wc(),t=g.connectWallet,n=g.checkIfWalletConnected,I=g.currentAccount;return(0,e.useEffect)((function(){n()}),[]),(0,q.jsx)(q.Fragment,{children:(0,q.jsx)("div",{className:"mb-3 text-end",children:I?Gc(I):(0,q.jsx)(or,{onClick:t,children:"Connect"})})})},Vb=function(){var g=Wc().getProductShipingHistory,t=function(){var g=e.useContext(bI).matches,t=g[g.length-1];return t?t.params:{}}().p_code,n=c((0,e.useState)([]),2),I=n[0],r=n[1];(0,e.useEffect)((function(){C()}),[]);var C=function(){var e=Cr(Ir().mark((function e(){var n;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g(t);case 3:n=e.sent,console.log(n),r(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),_.error(e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)("div",{style:{marginTop:"230px",paddingTop:"-2000px"},children:[(0,q.jsxs)("h5",{children:["Product Shipping History of ",t.toUpperCase()]}),(0,q.jsxs)("div",{children:[(0,q.jsx)("span",{children:"Factory"}),I.map((function(e,g){return(0,q.jsxs)("span",{children:[(0,q.jsx)("span",{children:" --\x3e  "}),(0,q.jsx)("span",{children:e.next_ship_id.shipment_country.toUpperCase()})," ",(0,q.jsx)("span",{children:", "}),(0,q.jsx)("span",{children:e.next_ship_id.shipment_address.toUpperCase()})]},g)}))]})]})})},kb=t(741),Rb=tb().shape({product_name:Uh().required("Name is required"),product_type:Uh().required("Type is required"),product_code:Uh().required("Code is required"),product_production_date:Uh().required("Production date is required"),product_exp_date:Uh().required("Expiry date is required")}),Xb=function(){var g=Wc().AddProduct,t=fI(),n=c((0,e.useState)(!1),2),I=n[0],r=n[1],C=c((0,e.useState)(""),2),l=C[0],a=C[1],o=function(){var e=Cr(Ir().mark((function e(t){var n;return Ir().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(""),r(!0),n=s(s({},t),{},{product_production_date:yc()(t.product_production_date).valueOf(),product_exp_date:yc()(t.product_exp_date).valueOf()}),e.next=6,g(n);case 6:_.success("Successfully Added!"),r(!1),i(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),_.error(e.t0.message),r(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(g){return e.apply(this,arguments)}}(),i=function(){kb.toDataURL(A.product_code,{width:300,margin:2,color:{dark:"#000",light:"#fff"}},(function(e,g){e&&console.error(e),a(g)}))},u=Km({onSubmit:o,initialValues:{product_name:"",product_type:"",product_code:"",product_production_date:"",product_exp_date:""},validationSchema:Rb}),A=u.values,d=u.errors,m=u.touched,h=u.handleBlur,b=u.handleChange,Z=u.handleSubmit;u.resetForm;return(0,q.jsxs)("div",{style:{marginTop:"100px",paddingTop:"-500px"},children:[(0,q.jsxs)("div",{className:"mb-3 d-flex justify-content-between",children:[(0,q.jsx)("h4",{children:"Add Product"}),(0,q.jsx)(or,{onClick:function(){return t("/products")},children:"Back"})]}),(0,q.jsx)("div",{children:(0,q.jsxs)(pu,{onSubmit:Z,children:[(0,q.jsxs)(fu,{xs:1,sm:2,lg:3,children:[(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"product_name",id:"product_name",placeholder:"Name",onChange:b,onBlur:h}),(0,q.jsx)("small",{className:"text-danger",children:m.product_name&&d.product_name})]})}),(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"product_type",id:"product_type",placeholder:"Type",onChange:b,onBlur:h}),(0,q.jsx)("small",{className:"text-danger",children:m.product_type&&d.product_type})]})}),(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"text",name:"product_code",id:"product_code",placeholder:"Code",onChange:b,onBlur:h}),(0,q.jsx)("small",{className:"text-danger",children:m.product_code&&d.product_code})]})}),(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"date",name:"product_production_date",id:"product_production_date",placeholder:"Production date",onChange:b,onBlur:h}),(0,q.jsx)("small",{className:"text-danger",children:m.product_production_date&&d.product_production_date})]})}),(0,q.jsx)($c,{children:(0,q.jsxs)(Pc,{className:"mb-3",children:[(0,q.jsx)(Lc,{type:"date",name:"product_exp_date",id:"product_exp_date",placeholder:"Expiry date",onChange:b,onBlur:h}),(0,q.jsx)("small",{className:"text-danger",children:m.product_exp_date&&d.product_exp_date})]})})]}),(0,q.jsx)(Pc,{className:"text-end",children:(0,q.jsx)(or,{variant:"primary",type:"submit",disabled:I,children:I?"Loading":"Save"})}),l&&(0,q.jsxs)("div",{className:"text-center",children:[(0,q.jsx)("div",{children:(0,q.jsx)("img",{src:l})}),(0,q.jsx)(or,{href:l,download:"".concat(A.product_code,".png"),children:"DownLoad"})]})]})})]})},Jb=function(){return(0,q.jsx)("div",{style:{display:"flex",justifyContent:"center",backgroundColor:"#696969",paddingBottom:"0px",height:"70px"},children:(0,q.jsx)("footer",{children:(0,q.jsx)("p",{style:{paddingTop:"20px"},children:"Shiptory @copyright"})})})};var Yb=function(){return(0,q.jsx)("div",{style:{display:"flex",marginRight:"0px",padding:"0",backgroundColor:"gray"},className:"App",children:(0,q.jsxs)(DI,{children:[(0,q.jsx)($,{}),(0,q.jsx)(er,{}),(0,q.jsxs)(nr,{className:"py-2",children:[(0,q.jsx)(Wb,{}),(0,q.jsxs)(EI,{children:[(0,q.jsx)(KI,{path:"/products",element:(0,q.jsx)(Vc,{})}),(0,q.jsx)(KI,{path:"/addProduct",element:(0,q.jsx)(Xb,{})}),(0,q.jsx)(KI,{path:"/shipments",element:(0,q.jsx)(Sb,{})}),(0,q.jsx)(KI,{path:"/traceProduct",element:(0,q.jsx)(ob,{})}),(0,q.jsx)(KI,{path:"/product/shiping/history/:p_code",element:(0,q.jsx)(Vb,{})}),(0,q.jsx)(KI,{path:"*",element:(0,q.jsx)(FI,{to:"/products",replace:!0})})]})]}),(0,q.jsx)(Jb,{})]})})},wb=function(e){e&&e instanceof Function&&t.e(787).then(t.bind(t,787)).then((function(g){var t=g.getCLS,n=g.getFID,I=g.getFCP,r=g.getLCP,C=g.getTTFB;t(e),n(e),I(e),r(e),C(e)}))};n.createRoot(document.getElementById("root")).render((0,q.jsxs)(e.StrictMode,{children:[(0,q.jsx)(Sc,{children:(0,q.jsx)(Yb,{})}),(0,q.jsx)(M,{})]})),wb()}()}();
//# sourceMappingURL=main.4ece991d.js.map